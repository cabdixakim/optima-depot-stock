function Hm(r,e){return function(){return r.apply(e,arguments)}}const{toString:F2}=Object.prototype,{getPrototypeOf:ad}=Object,{iterator:qc,toStringTag:zm}=Symbol,Xc=(r=>e=>{const t=F2.call(e);return r[t]||(r[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),jn=r=>(r=r.toLowerCase(),e=>Xc(e)===r),Kc=r=>e=>typeof e===r,{isArray:Ho}=Array,Mo=Kc("undefined");function ah(r){return r!==null&&!Mo(r)&&r.constructor!==null&&!Mo(r.constructor)&&ji(r.constructor.isBuffer)&&r.constructor.isBuffer(r)}const jm=jn("ArrayBuffer");function R2(r){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(r):e=r&&r.buffer&&jm(r.buffer),e}const L2=Kc("string"),ji=Kc("function"),Wm=Kc("number"),oh=r=>r!==null&&typeof r=="object",N2=r=>r===!0||r===!1,wc=r=>{if(Xc(r)!=="object")return!1;const e=ad(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(zm in r)&&!(qc in r)},P2=r=>{if(!oh(r)||ah(r))return!1;try{return Object.keys(r).length===0&&Object.getPrototypeOf(r)===Object.prototype}catch{return!1}},D2=jn("Date"),M2=jn("File"),O2=jn("Blob"),I2=jn("FileList"),B2=r=>oh(r)&&ji(r.pipe),H2=r=>{let e;return r&&(typeof FormData=="function"&&r instanceof FormData||ji(r.append)&&((e=Xc(r))==="formdata"||e==="object"&&ji(r.toString)&&r.toString()==="[object FormData]"))},z2=jn("URLSearchParams"),[j2,W2,U2,V2]=["ReadableStream","Request","Response","Headers"].map(jn),G2=r=>r.trim?r.trim():r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function lh(r,e,{allOwnKeys:t=!1}={}){if(r===null||typeof r>"u")return;let i,n;if(typeof r!="object"&&(r=[r]),Ho(r))for(i=0,n=r.length;i<n;i++)e.call(null,r[i],i,r);else{if(ah(r))return;const s=t?Object.getOwnPropertyNames(r):Object.keys(r),a=s.length;let o;for(i=0;i<a;i++)o=s[i],e.call(null,r[o],o,r)}}function Um(r,e){if(ah(r))return null;e=e.toLowerCase();const t=Object.keys(r);let i=t.length,n;for(;i-- >0;)if(n=t[i],e===n.toLowerCase())return n;return null}const Ea=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Vm=r=>!Mo(r)&&r!==Ea;function Af(){const{caseless:r,skipUndefined:e}=Vm(this)&&this||{},t={},i=(n,s)=>{const a=r&&Um(t,s)||s;wc(t[a])&&wc(n)?t[a]=Af(t[a],n):wc(n)?t[a]=Af({},n):Ho(n)?t[a]=n.slice():(!e||!Mo(n))&&(t[a]=n)};for(let n=0,s=arguments.length;n<s;n++)arguments[n]&&lh(arguments[n],i);return t}const q2=(r,e,t,{allOwnKeys:i}={})=>(lh(e,(n,s)=>{t&&ji(n)?r[s]=Hm(n,t):r[s]=n},{allOwnKeys:i}),r),X2=r=>(r.charCodeAt(0)===65279&&(r=r.slice(1)),r),K2=(r,e,t,i)=>{r.prototype=Object.create(e.prototype,i),r.prototype.constructor=r,Object.defineProperty(r,"super",{value:e.prototype}),t&&Object.assign(r.prototype,t)},Y2=(r,e,t,i)=>{let n,s,a;const o={};if(e=e||{},r==null)return e;do{for(n=Object.getOwnPropertyNames(r),s=n.length;s-- >0;)a=n[s],(!i||i(a,r,e))&&!o[a]&&(e[a]=r[a],o[a]=!0);r=t!==!1&&ad(r)}while(r&&(!t||t(r,e))&&r!==Object.prototype);return e},$2=(r,e,t)=>{r=String(r),(t===void 0||t>r.length)&&(t=r.length),t-=e.length;const i=r.indexOf(e,t);return i!==-1&&i===t},J2=r=>{if(!r)return null;if(Ho(r))return r;let e=r.length;if(!Wm(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=r[e];return t},Z2=(r=>e=>r&&e instanceof r)(typeof Uint8Array<"u"&&ad(Uint8Array)),Q2=(r,e)=>{const i=(r&&r[qc]).call(r);let n;for(;(n=i.next())&&!n.done;){const s=n.value;e.call(r,s[0],s[1])}},eb=(r,e)=>{let t;const i=[];for(;(t=r.exec(e))!==null;)i.push(t);return i},tb=jn("HTMLFormElement"),rb=r=>r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,i,n){return i.toUpperCase()+n}),W0=(({hasOwnProperty:r})=>(e,t)=>r.call(e,t))(Object.prototype),ib=jn("RegExp"),Gm=(r,e)=>{const t=Object.getOwnPropertyDescriptors(r),i={};lh(t,(n,s)=>{let a;(a=e(n,s,r))!==!1&&(i[s]=a||n)}),Object.defineProperties(r,i)},nb=r=>{Gm(r,(e,t)=>{if(ji(r)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const i=r[t];if(ji(i)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},sb=(r,e)=>{const t={},i=n=>{n.forEach(s=>{t[s]=!0})};return Ho(r)?i(r):i(String(r).split(e)),t},ab=()=>{},ob=(r,e)=>r!=null&&Number.isFinite(r=+r)?r:e;function lb(r){return!!(r&&ji(r.append)&&r[zm]==="FormData"&&r[qc])}const hb=r=>{const e=new Array(10),t=(i,n)=>{if(oh(i)){if(e.indexOf(i)>=0)return;if(ah(i))return i;if(!("toJSON"in i)){e[n]=i;const s=Ho(i)?[]:{};return lh(i,(a,o)=>{const l=t(a,n+1);!Mo(l)&&(s[o]=l)}),e[n]=void 0,s}}return i};return t(r,0)},cb=jn("AsyncFunction"),ub=r=>r&&(oh(r)||ji(r))&&ji(r.then)&&ji(r.catch),qm=((r,e)=>r?setImmediate:e?((t,i)=>(Ea.addEventListener("message",({source:n,data:s})=>{n===Ea&&s===t&&i.length&&i.shift()()},!1),n=>{i.push(n),Ea.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",ji(Ea.postMessage)),fb=typeof queueMicrotask<"u"?queueMicrotask.bind(Ea):typeof process<"u"&&process.nextTick||qm,db=r=>r!=null&&ji(r[qc]),Ae={isArray:Ho,isArrayBuffer:jm,isBuffer:ah,isFormData:H2,isArrayBufferView:R2,isString:L2,isNumber:Wm,isBoolean:N2,isObject:oh,isPlainObject:wc,isEmptyObject:P2,isReadableStream:j2,isRequest:W2,isResponse:U2,isHeaders:V2,isUndefined:Mo,isDate:D2,isFile:M2,isBlob:O2,isRegExp:ib,isFunction:ji,isStream:B2,isURLSearchParams:z2,isTypedArray:Z2,isFileList:I2,forEach:lh,merge:Af,extend:q2,trim:G2,stripBOM:X2,inherits:K2,toFlatObject:Y2,kindOf:Xc,kindOfTest:jn,endsWith:$2,toArray:J2,forEachEntry:Q2,matchAll:eb,isHTMLForm:tb,hasOwnProperty:W0,hasOwnProp:W0,reduceDescriptors:Gm,freezeMethods:nb,toObjectSet:sb,toCamelCase:rb,noop:ab,toFiniteNumber:ob,findKey:Um,global:Ea,isContextDefined:Vm,isSpecCompliantForm:lb,toJSONObject:hb,isAsyncFn:cb,isThenable:ub,setImmediate:qm,asap:fb,isIterable:db};function Rt(r,e,t,i,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=r,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),i&&(this.request=i),n&&(this.response=n,this.status=n.status?n.status:null)}Ae.inherits(Rt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ae.toJSONObject(this.config),code:this.code,status:this.status}}});const Xm=Rt.prototype,Km={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(r=>{Km[r]={value:r}});Object.defineProperties(Rt,Km);Object.defineProperty(Xm,"isAxiosError",{value:!0});Rt.from=(r,e,t,i,n,s)=>{const a=Object.create(Xm);Ae.toFlatObject(r,a,function(c){return c!==Error.prototype},h=>h!=="isAxiosError");const o=r&&r.message?r.message:"Error",l=e==null&&r?r.code:e;return Rt.call(a,o,l,t,i,n),r&&a.cause==null&&Object.defineProperty(a,"cause",{value:r,configurable:!0}),a.name=r&&r.name||"Error",s&&Object.assign(a,s),a};const pb=null;function Ff(r){return Ae.isPlainObject(r)||Ae.isArray(r)}function Ym(r){return Ae.endsWith(r,"[]")?r.slice(0,-2):r}function U0(r,e,t){return r?r.concat(e).map(function(n,s){return n=Ym(n),!t&&s?"["+n+"]":n}).join(t?".":""):e}function mb(r){return Ae.isArray(r)&&!r.some(Ff)}const gb=Ae.toFlatObject(Ae,{},null,function(e){return/^is[A-Z]/.test(e)});function Yc(r,e,t){if(!Ae.isObject(r))throw new TypeError("target must be an object");e=e||new FormData,t=Ae.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,b){return!Ae.isUndefined(b[m])});const i=t.metaTokens,n=t.visitor||c,s=t.dots,a=t.indexes,l=(t.Blob||typeof Blob<"u"&&Blob)&&Ae.isSpecCompliantForm(e);if(!Ae.isFunction(n))throw new TypeError("visitor must be a function");function h(g){if(g===null)return"";if(Ae.isDate(g))return g.toISOString();if(Ae.isBoolean(g))return g.toString();if(!l&&Ae.isBlob(g))throw new Rt("Blob is not supported. Use a Buffer instead.");return Ae.isArrayBuffer(g)||Ae.isTypedArray(g)?l&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function c(g,m,b){let w=g;if(g&&!b&&typeof g=="object"){if(Ae.endsWith(m,"{}"))m=i?m:m.slice(0,-2),g=JSON.stringify(g);else if(Ae.isArray(g)&&mb(g)||(Ae.isFileList(g)||Ae.endsWith(m,"[]"))&&(w=Ae.toArray(g)))return m=Ym(m),w.forEach(function(C,F){!(Ae.isUndefined(C)||C===null)&&e.append(a===!0?U0([m],F,s):a===null?m:m+"[]",h(C))}),!1}return Ff(g)?!0:(e.append(U0(b,m,s),h(g)),!1)}const d=[],p=Object.assign(gb,{defaultVisitor:c,convertValue:h,isVisitable:Ff});function f(g,m){if(!Ae.isUndefined(g)){if(d.indexOf(g)!==-1)throw Error("Circular reference detected in "+m.join("."));d.push(g),Ae.forEach(g,function(w,E){(!(Ae.isUndefined(w)||w===null)&&n.call(e,w,Ae.isString(E)?E.trim():E,m,p))===!0&&f(w,m?m.concat(E):[E])}),d.pop()}}if(!Ae.isObject(r))throw new TypeError("data must be an object");return f(r),e}function V0(r){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(r).replace(/[!'()~]|%20|%00/g,function(i){return e[i]})}function od(r,e){this._pairs=[],r&&Yc(r,this,e)}const $m=od.prototype;$m.append=function(e,t){this._pairs.push([e,t])};$m.toString=function(e){const t=e?function(i){return e.call(this,i,V0)}:V0;return this._pairs.map(function(n){return t(n[0])+"="+t(n[1])},"").join("&")};function vb(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Jm(r,e,t){if(!e)return r;const i=t&&t.encode||vb;Ae.isFunction(t)&&(t={serialize:t});const n=t&&t.serialize;let s;if(n?s=n(e,t):s=Ae.isURLSearchParams(e)?e.toString():new od(e,t).toString(i),s){const a=r.indexOf("#");a!==-1&&(r=r.slice(0,a)),r+=(r.indexOf("?")===-1?"?":"&")+s}return r}class G0{constructor(){this.handlers=[]}use(e,t,i){return this.handlers.push({fulfilled:e,rejected:t,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Ae.forEach(this.handlers,function(i){i!==null&&e(i)})}}const Zm={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},bb=typeof URLSearchParams<"u"?URLSearchParams:od,wb=typeof FormData<"u"?FormData:null,xb=typeof Blob<"u"?Blob:null,yb={isBrowser:!0,classes:{URLSearchParams:bb,FormData:wb,Blob:xb},protocols:["http","https","file","blob","url","data"]},ld=typeof window<"u"&&typeof document<"u",Rf=typeof navigator=="object"&&navigator||void 0,Eb=ld&&(!Rf||["ReactNative","NativeScript","NS"].indexOf(Rf.product)<0),Cb=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",_b=ld&&window.location.href||"http://localhost",kb=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ld,hasStandardBrowserEnv:Eb,hasStandardBrowserWebWorkerEnv:Cb,navigator:Rf,origin:_b},Symbol.toStringTag,{value:"Module"})),Ei={...kb,...yb};function Sb(r,e){return Yc(r,new Ei.classes.URLSearchParams,{visitor:function(t,i,n,s){return Ei.isNode&&Ae.isBuffer(t)?(this.append(i,t.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...e})}function Tb(r){return Ae.matchAll(/\w+|\[(\w*)]/g,r).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Ab(r){const e={},t=Object.keys(r);let i;const n=t.length;let s;for(i=0;i<n;i++)s=t[i],e[s]=r[s];return e}function Qm(r){function e(t,i,n,s){let a=t[s++];if(a==="__proto__")return!0;const o=Number.isFinite(+a),l=s>=t.length;return a=!a&&Ae.isArray(n)?n.length:a,l?(Ae.hasOwnProp(n,a)?n[a]=[n[a],i]:n[a]=i,!o):((!n[a]||!Ae.isObject(n[a]))&&(n[a]=[]),e(t,i,n[a],s)&&Ae.isArray(n[a])&&(n[a]=Ab(n[a])),!o)}if(Ae.isFormData(r)&&Ae.isFunction(r.entries)){const t={};return Ae.forEachEntry(r,(i,n)=>{e(Tb(i),n,t,0)}),t}return null}function Fb(r,e,t){if(Ae.isString(r))try{return(e||JSON.parse)(r),Ae.trim(r)}catch(i){if(i.name!=="SyntaxError")throw i}return(t||JSON.stringify)(r)}const hh={transitional:Zm,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const i=t.getContentType()||"",n=i.indexOf("application/json")>-1,s=Ae.isObject(e);if(s&&Ae.isHTMLForm(e)&&(e=new FormData(e)),Ae.isFormData(e))return n?JSON.stringify(Qm(e)):e;if(Ae.isArrayBuffer(e)||Ae.isBuffer(e)||Ae.isStream(e)||Ae.isFile(e)||Ae.isBlob(e)||Ae.isReadableStream(e))return e;if(Ae.isArrayBufferView(e))return e.buffer;if(Ae.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(s){if(i.indexOf("application/x-www-form-urlencoded")>-1)return Sb(e,this.formSerializer).toString();if((o=Ae.isFileList(e))||i.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Yc(o?{"files[]":e}:e,l&&new l,this.formSerializer)}}return s||n?(t.setContentType("application/json",!1),Fb(e)):e}],transformResponse:[function(e){const t=this.transitional||hh.transitional,i=t&&t.forcedJSONParsing,n=this.responseType==="json";if(Ae.isResponse(e)||Ae.isReadableStream(e))return e;if(e&&Ae.isString(e)&&(i&&!this.responseType||n)){const a=!(t&&t.silentJSONParsing)&&n;try{return JSON.parse(e,this.parseReviver)}catch(o){if(a)throw o.name==="SyntaxError"?Rt.from(o,Rt.ERR_BAD_RESPONSE,this,null,this.response):o}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ei.classes.FormData,Blob:Ei.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ae.forEach(["delete","get","head","post","put","patch"],r=>{hh.headers[r]={}});const Rb=Ae.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Lb=r=>{const e={};let t,i,n;return r&&r.split(`
`).forEach(function(a){n=a.indexOf(":"),t=a.substring(0,n).trim().toLowerCase(),i=a.substring(n+1).trim(),!(!t||e[t]&&Rb[t])&&(t==="set-cookie"?e[t]?e[t].push(i):e[t]=[i]:e[t]=e[t]?e[t]+", "+i:i)}),e},q0=Symbol("internals");function wl(r){return r&&String(r).trim().toLowerCase()}function xc(r){return r===!1||r==null?r:Ae.isArray(r)?r.map(xc):String(r)}function Nb(r){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=t.exec(r);)e[i[1]]=i[2];return e}const Pb=r=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(r.trim());function Qu(r,e,t,i,n){if(Ae.isFunction(i))return i.call(this,e,t);if(n&&(e=t),!!Ae.isString(e)){if(Ae.isString(i))return e.indexOf(i)!==-1;if(Ae.isRegExp(i))return i.test(e)}}function Db(r){return r.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,i)=>t.toUpperCase()+i)}function Mb(r,e){const t=Ae.toCamelCase(" "+e);["get","set","has"].forEach(i=>{Object.defineProperty(r,i+t,{value:function(n,s,a){return this[i].call(this,e,n,s,a)},configurable:!0})})}let Wi=class{constructor(e){e&&this.set(e)}set(e,t,i){const n=this;function s(o,l,h){const c=wl(l);if(!c)throw new Error("header name must be a non-empty string");const d=Ae.findKey(n,c);(!d||n[d]===void 0||h===!0||h===void 0&&n[d]!==!1)&&(n[d||l]=xc(o))}const a=(o,l)=>Ae.forEach(o,(h,c)=>s(h,c,l));if(Ae.isPlainObject(e)||e instanceof this.constructor)a(e,t);else if(Ae.isString(e)&&(e=e.trim())&&!Pb(e))a(Lb(e),t);else if(Ae.isObject(e)&&Ae.isIterable(e)){let o={},l,h;for(const c of e){if(!Ae.isArray(c))throw TypeError("Object iterator must return a key-value pair");o[h=c[0]]=(l=o[h])?Ae.isArray(l)?[...l,c[1]]:[l,c[1]]:c[1]}a(o,t)}else e!=null&&s(t,e,i);return this}get(e,t){if(e=wl(e),e){const i=Ae.findKey(this,e);if(i){const n=this[i];if(!t)return n;if(t===!0)return Nb(n);if(Ae.isFunction(t))return t.call(this,n,i);if(Ae.isRegExp(t))return t.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=wl(e),e){const i=Ae.findKey(this,e);return!!(i&&this[i]!==void 0&&(!t||Qu(this,this[i],i,t)))}return!1}delete(e,t){const i=this;let n=!1;function s(a){if(a=wl(a),a){const o=Ae.findKey(i,a);o&&(!t||Qu(i,i[o],o,t))&&(delete i[o],n=!0)}}return Ae.isArray(e)?e.forEach(s):s(e),n}clear(e){const t=Object.keys(this);let i=t.length,n=!1;for(;i--;){const s=t[i];(!e||Qu(this,this[s],s,e,!0))&&(delete this[s],n=!0)}return n}normalize(e){const t=this,i={};return Ae.forEach(this,(n,s)=>{const a=Ae.findKey(i,s);if(a){t[a]=xc(n),delete t[s];return}const o=e?Db(s):String(s).trim();o!==s&&delete t[s],t[o]=xc(n),i[o]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return Ae.forEach(this,(i,n)=>{i!=null&&i!==!1&&(t[n]=e&&Ae.isArray(i)?i.join(", "):i)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const i=new this(e);return t.forEach(n=>i.set(n)),i}static accessor(e){const i=(this[q0]=this[q0]={accessors:{}}).accessors,n=this.prototype;function s(a){const o=wl(a);i[o]||(Mb(n,a),i[o]=!0)}return Ae.isArray(e)?e.forEach(s):s(e),this}};Wi.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ae.reduceDescriptors(Wi.prototype,({value:r},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>r,set(i){this[t]=i}}});Ae.freezeMethods(Wi);function ef(r,e){const t=this||hh,i=e||t,n=Wi.from(i.headers);let s=i.data;return Ae.forEach(r,function(o){s=o.call(t,s,n.normalize(),e?e.status:void 0)}),n.normalize(),s}function eg(r){return!!(r&&r.__CANCEL__)}function zo(r,e,t){Rt.call(this,r??"canceled",Rt.ERR_CANCELED,e,t),this.name="CanceledError"}Ae.inherits(zo,Rt,{__CANCEL__:!0});function tg(r,e,t){const i=t.config.validateStatus;!t.status||!i||i(t.status)?r(t):e(new Rt("Request failed with status code "+t.status,[Rt.ERR_BAD_REQUEST,Rt.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function Ob(r){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(r);return e&&e[1]||""}function Ib(r,e){r=r||10;const t=new Array(r),i=new Array(r);let n=0,s=0,a;return e=e!==void 0?e:1e3,function(l){const h=Date.now(),c=i[s];a||(a=h),t[n]=l,i[n]=h;let d=s,p=0;for(;d!==n;)p+=t[d++],d=d%r;if(n=(n+1)%r,n===s&&(s=(s+1)%r),h-a<e)return;const f=c&&h-c;return f?Math.round(p*1e3/f):void 0}}function Bb(r,e){let t=0,i=1e3/e,n,s;const a=(h,c=Date.now())=>{t=c,n=null,s&&(clearTimeout(s),s=null),r(...h)};return[(...h)=>{const c=Date.now(),d=c-t;d>=i?a(h,c):(n=h,s||(s=setTimeout(()=>{s=null,a(n)},i-d)))},()=>n&&a(n)]}const Cc=(r,e,t=3)=>{let i=0;const n=Ib(50,250);return Bb(s=>{const a=s.loaded,o=s.lengthComputable?s.total:void 0,l=a-i,h=n(l),c=a<=o;i=a;const d={loaded:a,total:o,progress:o?a/o:void 0,bytes:l,rate:h||void 0,estimated:h&&o&&c?(o-a)/h:void 0,event:s,lengthComputable:o!=null,[e?"download":"upload"]:!0};r(d)},t)},X0=(r,e)=>{const t=r!=null;return[i=>e[0]({lengthComputable:t,total:r,loaded:i}),e[1]]},K0=r=>(...e)=>Ae.asap(()=>r(...e)),Hb=Ei.hasStandardBrowserEnv?((r,e)=>t=>(t=new URL(t,Ei.origin),r.protocol===t.protocol&&r.host===t.host&&(e||r.port===t.port)))(new URL(Ei.origin),Ei.navigator&&/(msie|trident)/i.test(Ei.navigator.userAgent)):()=>!0,zb=Ei.hasStandardBrowserEnv?{write(r,e,t,i,n,s){const a=[r+"="+encodeURIComponent(e)];Ae.isNumber(t)&&a.push("expires="+new Date(t).toGMTString()),Ae.isString(i)&&a.push("path="+i),Ae.isString(n)&&a.push("domain="+n),s===!0&&a.push("secure"),document.cookie=a.join("; ")},read(r){const e=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(r){this.write(r,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function jb(r){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}function Wb(r,e){return e?r.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):r}function rg(r,e,t){let i=!jb(e);return r&&(i||t==!1)?Wb(r,e):e}const Y0=r=>r instanceof Wi?{...r}:r;function Pa(r,e){e=e||{};const t={};function i(h,c,d,p){return Ae.isPlainObject(h)&&Ae.isPlainObject(c)?Ae.merge.call({caseless:p},h,c):Ae.isPlainObject(c)?Ae.merge({},c):Ae.isArray(c)?c.slice():c}function n(h,c,d,p){if(Ae.isUndefined(c)){if(!Ae.isUndefined(h))return i(void 0,h,d,p)}else return i(h,c,d,p)}function s(h,c){if(!Ae.isUndefined(c))return i(void 0,c)}function a(h,c){if(Ae.isUndefined(c)){if(!Ae.isUndefined(h))return i(void 0,h)}else return i(void 0,c)}function o(h,c,d){if(d in e)return i(h,c);if(d in r)return i(void 0,h)}const l={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:o,headers:(h,c,d)=>n(Y0(h),Y0(c),d,!0)};return Ae.forEach(Object.keys({...r,...e}),function(c){const d=l[c]||n,p=d(r[c],e[c],c);Ae.isUndefined(p)&&d!==o||(t[c]=p)}),t}const ig=r=>{const e=Pa({},r);let{data:t,withXSRFToken:i,xsrfHeaderName:n,xsrfCookieName:s,headers:a,auth:o}=e;if(e.headers=a=Wi.from(a),e.url=Jm(rg(e.baseURL,e.url,e.allowAbsoluteUrls),r.params,r.paramsSerializer),o&&a.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),Ae.isFormData(t)){if(Ei.hasStandardBrowserEnv||Ei.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if(Ae.isFunction(t.getHeaders)){const l=t.getHeaders(),h=["content-type","content-length"];Object.entries(l).forEach(([c,d])=>{h.includes(c.toLowerCase())&&a.set(c,d)})}}if(Ei.hasStandardBrowserEnv&&(i&&Ae.isFunction(i)&&(i=i(e)),i||i!==!1&&Hb(e.url))){const l=n&&s&&zb.read(s);l&&a.set(n,l)}return e},Ub=typeof XMLHttpRequest<"u",Vb=Ub&&function(r){return new Promise(function(t,i){const n=ig(r);let s=n.data;const a=Wi.from(n.headers).normalize();let{responseType:o,onUploadProgress:l,onDownloadProgress:h}=n,c,d,p,f,g;function m(){f&&f(),g&&g(),n.cancelToken&&n.cancelToken.unsubscribe(c),n.signal&&n.signal.removeEventListener("abort",c)}let b=new XMLHttpRequest;b.open(n.method.toUpperCase(),n.url,!0),b.timeout=n.timeout;function w(){if(!b)return;const C=Wi.from("getAllResponseHeaders"in b&&b.getAllResponseHeaders()),L={data:!o||o==="text"||o==="json"?b.responseText:b.response,status:b.status,statusText:b.statusText,headers:C,config:r,request:b};tg(function(S){t(S),m()},function(S){i(S),m()},L),b=null}"onloadend"in b?b.onloadend=w:b.onreadystatechange=function(){!b||b.readyState!==4||b.status===0&&!(b.responseURL&&b.responseURL.indexOf("file:")===0)||setTimeout(w)},b.onabort=function(){b&&(i(new Rt("Request aborted",Rt.ECONNABORTED,r,b)),b=null)},b.onerror=function(F){const L=F&&F.message?F.message:"Network Error",D=new Rt(L,Rt.ERR_NETWORK,r,b);D.event=F||null,i(D),b=null},b.ontimeout=function(){let F=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const L=n.transitional||Zm;n.timeoutErrorMessage&&(F=n.timeoutErrorMessage),i(new Rt(F,L.clarifyTimeoutError?Rt.ETIMEDOUT:Rt.ECONNABORTED,r,b)),b=null},s===void 0&&a.setContentType(null),"setRequestHeader"in b&&Ae.forEach(a.toJSON(),function(F,L){b.setRequestHeader(L,F)}),Ae.isUndefined(n.withCredentials)||(b.withCredentials=!!n.withCredentials),o&&o!=="json"&&(b.responseType=n.responseType),h&&([p,g]=Cc(h,!0),b.addEventListener("progress",p)),l&&b.upload&&([d,f]=Cc(l),b.upload.addEventListener("progress",d),b.upload.addEventListener("loadend",f)),(n.cancelToken||n.signal)&&(c=C=>{b&&(i(!C||C.type?new zo(null,r,b):C),b.abort(),b=null)},n.cancelToken&&n.cancelToken.subscribe(c),n.signal&&(n.signal.aborted?c():n.signal.addEventListener("abort",c)));const E=Ob(n.url);if(E&&Ei.protocols.indexOf(E)===-1){i(new Rt("Unsupported protocol "+E+":",Rt.ERR_BAD_REQUEST,r));return}b.send(s||null)})},Gb=(r,e)=>{const{length:t}=r=r?r.filter(Boolean):[];if(e||t){let i=new AbortController,n;const s=function(h){if(!n){n=!0,o();const c=h instanceof Error?h:this.reason;i.abort(c instanceof Rt?c:new zo(c instanceof Error?c.message:c))}};let a=e&&setTimeout(()=>{a=null,s(new Rt(`timeout ${e} of ms exceeded`,Rt.ETIMEDOUT))},e);const o=()=>{r&&(a&&clearTimeout(a),a=null,r.forEach(h=>{h.unsubscribe?h.unsubscribe(s):h.removeEventListener("abort",s)}),r=null)};r.forEach(h=>h.addEventListener("abort",s));const{signal:l}=i;return l.unsubscribe=()=>Ae.asap(o),l}},qb=function*(r,e){let t=r.byteLength;if(t<e){yield r;return}let i=0,n;for(;i<t;)n=i+e,yield r.slice(i,n),i=n},Xb=async function*(r,e){for await(const t of Kb(r))yield*qb(t,e)},Kb=async function*(r){if(r[Symbol.asyncIterator]){yield*r;return}const e=r.getReader();try{for(;;){const{done:t,value:i}=await e.read();if(t)break;yield i}}finally{await e.cancel()}},$0=(r,e,t,i)=>{const n=Xb(r,e);let s=0,a,o=l=>{a||(a=!0,i&&i(l))};return new ReadableStream({async pull(l){try{const{done:h,value:c}=await n.next();if(h){o(),l.close();return}let d=c.byteLength;if(t){let p=s+=d;t(p)}l.enqueue(new Uint8Array(c))}catch(h){throw o(h),h}},cancel(l){return o(l),n.return()}},{highWaterMark:2})},J0=64*1024,{isFunction:nc}=Ae,Yb=(({Request:r,Response:e})=>({Request:r,Response:e}))(Ae.global),{ReadableStream:Z0,TextEncoder:Q0}=Ae.global,ep=(r,...e)=>{try{return!!r(...e)}catch{return!1}},$b=r=>{r=Ae.merge.call({skipUndefined:!0},Yb,r);const{fetch:e,Request:t,Response:i}=r,n=e?nc(e):typeof fetch=="function",s=nc(t),a=nc(i);if(!n)return!1;const o=n&&nc(Z0),l=n&&(typeof Q0=="function"?(g=>m=>g.encode(m))(new Q0):async g=>new Uint8Array(await new t(g).arrayBuffer())),h=s&&o&&ep(()=>{let g=!1;const m=new t(Ei.origin,{body:new Z0,method:"POST",get duplex(){return g=!0,"half"}}).headers.has("Content-Type");return g&&!m}),c=a&&o&&ep(()=>Ae.isReadableStream(new i("").body)),d={stream:c&&(g=>g.body)};n&&["text","arrayBuffer","blob","formData","stream"].forEach(g=>{!d[g]&&(d[g]=(m,b)=>{let w=m&&m[g];if(w)return w.call(m);throw new Rt(`Response type '${g}' is not supported`,Rt.ERR_NOT_SUPPORT,b)})});const p=async g=>{if(g==null)return 0;if(Ae.isBlob(g))return g.size;if(Ae.isSpecCompliantForm(g))return(await new t(Ei.origin,{method:"POST",body:g}).arrayBuffer()).byteLength;if(Ae.isArrayBufferView(g)||Ae.isArrayBuffer(g))return g.byteLength;if(Ae.isURLSearchParams(g)&&(g=g+""),Ae.isString(g))return(await l(g)).byteLength},f=async(g,m)=>{const b=Ae.toFiniteNumber(g.getContentLength());return b??p(m)};return async g=>{let{url:m,method:b,data:w,signal:E,cancelToken:C,timeout:F,onDownloadProgress:L,onUploadProgress:D,responseType:S,headers:A,withCredentials:O="same-origin",fetchOptions:U}=ig(g),R=e||fetch;S=S?(S+"").toLowerCase():"text";let k=Gb([E,C&&C.toAbortSignal()],F),M=null;const V=k&&k.unsubscribe&&(()=>{k.unsubscribe()});let oe;try{if(D&&h&&b!=="get"&&b!=="head"&&(oe=await f(A,w))!==0){let ge=new t(m,{method:"POST",body:w,duplex:"half"}),_;if(Ae.isFormData(w)&&(_=ge.headers.get("content-type"))&&A.setContentType(_),ge.body){const[P,N]=X0(oe,Cc(K0(D)));w=$0(ge.body,J0,P,N)}}Ae.isString(O)||(O=O?"include":"omit");const K=s&&"credentials"in t.prototype,Y={...U,signal:k,method:b.toUpperCase(),headers:A.normalize().toJSON(),body:w,duplex:"half",credentials:K?O:void 0};M=s&&new t(m,Y);let se=await(s?R(M,U):R(m,Y));const q=c&&(S==="stream"||S==="response");if(c&&(L||q&&V)){const ge={};["status","statusText","headers"].forEach(I=>{ge[I]=se[I]});const _=Ae.toFiniteNumber(se.headers.get("content-length")),[P,N]=L&&X0(_,Cc(K0(L),!0))||[];se=new i($0(se.body,J0,P,()=>{N&&N(),V&&V()}),ge)}S=S||"text";let fe=await d[Ae.findKey(d,S)||"text"](se,g);return!q&&V&&V(),await new Promise((ge,_)=>{tg(ge,_,{data:fe,headers:Wi.from(se.headers),status:se.status,statusText:se.statusText,config:g,request:M})})}catch(K){throw V&&V(),K&&K.name==="TypeError"&&/Load failed|fetch/i.test(K.message)?Object.assign(new Rt("Network Error",Rt.ERR_NETWORK,g,M),{cause:K.cause||K}):Rt.from(K,K&&K.code,g,M)}}},Jb=new Map,ng=r=>{let e=r?r.env:{};const{fetch:t,Request:i,Response:n}=e,s=[i,n,t];let a=s.length,o=a,l,h,c=Jb;for(;o--;)l=s[o],h=c.get(l),h===void 0&&c.set(l,h=o?new Map:$b(e)),c=h;return h};ng();const Lf={http:pb,xhr:Vb,fetch:{get:ng}};Ae.forEach(Lf,(r,e)=>{if(r){try{Object.defineProperty(r,"name",{value:e})}catch{}Object.defineProperty(r,"adapterName",{value:e})}});const tp=r=>`- ${r}`,Zb=r=>Ae.isFunction(r)||r===null||r===!1,sg={getAdapter:(r,e)=>{r=Ae.isArray(r)?r:[r];const{length:t}=r;let i,n;const s={};for(let a=0;a<t;a++){i=r[a];let o;if(n=i,!Zb(i)&&(n=Lf[(o=String(i)).toLowerCase()],n===void 0))throw new Rt(`Unknown adapter '${o}'`);if(n&&(Ae.isFunction(n)||(n=n.get(e))))break;s[o||"#"+a]=n}if(!n){const a=Object.entries(s).map(([l,h])=>`adapter ${l} `+(h===!1?"is not supported by the environment":"is not available in the build"));let o=t?a.length>1?`since :
`+a.map(tp).join(`
`):" "+tp(a[0]):"as no adapter specified";throw new Rt("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n},adapters:Lf};function tf(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new zo(null,r)}function rp(r){return tf(r),r.headers=Wi.from(r.headers),r.data=ef.call(r,r.transformRequest),["post","put","patch"].indexOf(r.method)!==-1&&r.headers.setContentType("application/x-www-form-urlencoded",!1),sg.getAdapter(r.adapter||hh.adapter,r)(r).then(function(i){return tf(r),i.data=ef.call(r,r.transformResponse,i),i.headers=Wi.from(i.headers),i},function(i){return eg(i)||(tf(r),i&&i.response&&(i.response.data=ef.call(r,r.transformResponse,i.response),i.response.headers=Wi.from(i.response.headers))),Promise.reject(i)})}const ag="1.12.2",$c={};["object","boolean","number","function","string","symbol"].forEach((r,e)=>{$c[r]=function(i){return typeof i===r||"a"+(e<1?"n ":" ")+r}});const ip={};$c.transitional=function(e,t,i){function n(s,a){return"[Axios v"+ag+"] Transitional option '"+s+"'"+a+(i?". "+i:"")}return(s,a,o)=>{if(e===!1)throw new Rt(n(a," has been removed"+(t?" in "+t:"")),Rt.ERR_DEPRECATED);return t&&!ip[a]&&(ip[a]=!0,console.warn(n(a," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(s,a,o):!0}};$c.spelling=function(e){return(t,i)=>(console.warn(`${i} is likely a misspelling of ${e}`),!0)};function Qb(r,e,t){if(typeof r!="object")throw new Rt("options must be an object",Rt.ERR_BAD_OPTION_VALUE);const i=Object.keys(r);let n=i.length;for(;n-- >0;){const s=i[n],a=e[s];if(a){const o=r[s],l=o===void 0||a(o,s,r);if(l!==!0)throw new Rt("option "+s+" must be "+l,Rt.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Rt("Unknown option "+s,Rt.ERR_BAD_OPTION)}}const yc={assertOptions:Qb,validators:$c},$n=yc.validators;let _a=class{constructor(e){this.defaults=e||{},this.interceptors={request:new G0,response:new G0}}async request(e,t){try{return await this._request(e,t)}catch(i){if(i instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const s=n.stack?n.stack.replace(/^.+\n/,""):"";try{i.stack?s&&!String(i.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+s):i.stack=s}catch{}}throw i}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=Pa(this.defaults,t);const{transitional:i,paramsSerializer:n,headers:s}=t;i!==void 0&&yc.assertOptions(i,{silentJSONParsing:$n.transitional($n.boolean),forcedJSONParsing:$n.transitional($n.boolean),clarifyTimeoutError:$n.transitional($n.boolean)},!1),n!=null&&(Ae.isFunction(n)?t.paramsSerializer={serialize:n}:yc.assertOptions(n,{encode:$n.function,serialize:$n.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),yc.assertOptions(t,{baseUrl:$n.spelling("baseURL"),withXsrfToken:$n.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let a=s&&Ae.merge(s.common,s[t.method]);s&&Ae.forEach(["delete","get","head","post","put","patch","common"],g=>{delete s[g]}),t.headers=Wi.concat(a,s);const o=[];let l=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(t)===!1||(l=l&&m.synchronous,o.unshift(m.fulfilled,m.rejected))});const h=[];this.interceptors.response.forEach(function(m){h.push(m.fulfilled,m.rejected)});let c,d=0,p;if(!l){const g=[rp.bind(this),void 0];for(g.unshift(...o),g.push(...h),p=g.length,c=Promise.resolve(t);d<p;)c=c.then(g[d++],g[d++]);return c}p=o.length;let f=t;for(;d<p;){const g=o[d++],m=o[d++];try{f=g(f)}catch(b){m.call(this,b);break}}try{c=rp.call(this,f)}catch(g){return Promise.reject(g)}for(d=0,p=h.length;d<p;)c=c.then(h[d++],h[d++]);return c}getUri(e){e=Pa(this.defaults,e);const t=rg(e.baseURL,e.url,e.allowAbsoluteUrls);return Jm(t,e.params,e.paramsSerializer)}};Ae.forEach(["delete","get","head","options"],function(e){_a.prototype[e]=function(t,i){return this.request(Pa(i||{},{method:e,url:t,data:(i||{}).data}))}});Ae.forEach(["post","put","patch"],function(e){function t(i){return function(s,a,o){return this.request(Pa(o||{},{method:e,headers:i?{"Content-Type":"multipart/form-data"}:{},url:s,data:a}))}}_a.prototype[e]=t(),_a.prototype[e+"Form"]=t(!0)});let ew=class og{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(s){t=s});const i=this;this.promise.then(n=>{if(!i._listeners)return;let s=i._listeners.length;for(;s-- >0;)i._listeners[s](n);i._listeners=null}),this.promise.then=n=>{let s;const a=new Promise(o=>{i.subscribe(o),s=o}).then(n);return a.cancel=function(){i.unsubscribe(s)},a},e(function(s,a,o){i.reason||(i.reason=new zo(s,a,o),t(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=i=>{e.abort(i)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new og(function(n){e=n}),cancel:e}}};function tw(r){return function(t){return r.apply(null,t)}}function rw(r){return Ae.isObject(r)&&r.isAxiosError===!0}const Nf={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Nf).forEach(([r,e])=>{Nf[e]=r});function lg(r){const e=new _a(r),t=Hm(_a.prototype.request,e);return Ae.extend(t,_a.prototype,e,{allOwnKeys:!0}),Ae.extend(t,e,null,{allOwnKeys:!0}),t.create=function(n){return lg(Pa(r,n))},t}const Ir=lg(hh);Ir.Axios=_a;Ir.CanceledError=zo;Ir.CancelToken=ew;Ir.isCancel=eg;Ir.VERSION=ag;Ir.toFormData=Yc;Ir.AxiosError=Rt;Ir.Cancel=Ir.CanceledError;Ir.all=function(e){return Promise.all(e)};Ir.spread=tw;Ir.isAxiosError=rw;Ir.mergeConfig=Pa;Ir.AxiosHeaders=Wi;Ir.formToJSON=r=>Qm(Ae.isHTMLForm(r)?new FormData(r):r);Ir.getAdapter=sg.getAdapter;Ir.HttpStatusCode=Nf;Ir.default=Ir;const{Axios:ZR,AxiosError:QR,CanceledError:e8,isCancel:t8,CancelToken:r8,VERSION:i8,all:n8,Cancel:s8,isAxiosError:a8,spread:o8,toFormData:l8,AxiosHeaders:h8,HttpStatusCode:c8,formToJSON:u8,getAdapter:f8,mergeConfig:d8}=Ir;window.axios=Ir;window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";class hi{constructor(e){this.table=e}reloadData(e,t,i){return this.table.dataLoader.load(e,void 0,void 0,void 0,t,i)}langText(){return this.table.modules.localize.getText(...arguments)}langBind(){return this.table.modules.localize.bind(...arguments)}langLocale(){return this.table.modules.localize.getLocale(...arguments)}commsConnections(){return this.table.modules.comms.getConnections(...arguments)}commsSend(){return this.table.modules.comms.send(...arguments)}layoutMode(){return this.table.modules.layout.getMode()}layoutRefresh(e){return this.table.modules.layout.layout(e)}subscribe(){return this.table.eventBus.subscribe(...arguments)}unsubscribe(){return this.table.eventBus.unsubscribe(...arguments)}subscribed(e){return this.table.eventBus.subscribed(e)}subscriptionChange(){return this.table.eventBus.subscriptionChange(...arguments)}dispatch(){return this.table.eventBus.dispatch(...arguments)}chain(){return this.table.eventBus.chain(...arguments)}confirm(){return this.table.eventBus.confirm(...arguments)}dispatchExternal(){return this.table.externalEvents.dispatch(...arguments)}subscribedExternal(e){return this.table.externalEvents.subscribed(e)}subscriptionChangeExternal(){return this.table.externalEvents.subscriptionChange(...arguments)}options(e){return this.table.options[e]}setOption(e,t){return typeof t<"u"&&(this.table.options[e]=t),this.table.options[e]}deprecationCheck(e,t,i){return this.table.deprecationAdvisor.check(e,t,i)}deprecationCheckMsg(e,t){return this.table.deprecationAdvisor.checkMsg(e,t)}deprecationMsg(e){return this.table.deprecationAdvisor.msg(e)}module(e){return this.table.module(e)}}class hr{static elVisible(e){return!(e.offsetWidth<=0&&e.offsetHeight<=0)}static elOffset(e){var t=e.getBoundingClientRect();return{top:t.top+window.pageYOffset-document.documentElement.clientTop,left:t.left+window.pageXOffset-document.documentElement.clientLeft}}static retrieveNestedData(e,t,i){var n=e?t.split(e):[t],s=n.length,a;for(let o=0;o<s&&(i=i[n[o]],a=i,!!i);o++);return a}static deepClone(e,t,i=[]){var n={}.__proto__,s=[].__proto__;t||(t=Object.assign(Array.isArray(e)?[]:{},e));for(var a in e){let o=e[a],l,h;o!=null&&typeof o=="object"&&(o.__proto__===n||o.__proto__===s)&&(l=i.findIndex(c=>c.subject===o),l>-1?t[a]=i[l].copy:(h=Object.assign(Array.isArray(o)?[]:{},o),i.unshift({subject:o,copy:h}),t[a]=this.deepClone(o,h,i)))}return t}}let iw=class hg extends hi{constructor(e,t,i){super(e),this.element=t,this.container=this._lookupContainer(),this.parent=i,this.reversedX=!1,this.childPopup=null,this.blurable=!1,this.blurCallback=null,this.blurEventsBound=!1,this.renderedCallback=null,this.visible=!1,this.hideable=!0,this.element.classList.add("tabulator-popup-container"),this.blurEvent=this.hide.bind(this,!1),this.escEvent=this._escapeCheck.bind(this),this.destroyBinding=this.tableDestroyed.bind(this),this.destroyed=!1}tableDestroyed(){this.destroyed=!0,this.hide(!0)}_lookupContainer(){var e=this.table.options.popupContainer;return typeof e=="string"?(e=document.querySelector(e),e||console.warn("Menu Error - no container element found matching selector:",this.table.options.popupContainer,"(defaulting to document body)")):e===!0&&(e=this.table.element),e&&!this._checkContainerIsParent(e)&&(e=!1,console.warn("Menu Error - container element does not contain this table:",this.table.options.popupContainer,"(defaulting to document body)")),e||(e=document.body),e}_checkContainerIsParent(e,t=this.table.element){return e===t?!0:t.parentNode?this._checkContainerIsParent(e,t.parentNode):!1}renderCallback(e){this.renderedCallback=e}containerEventCoords(e){var t=!(e instanceof MouseEvent),i=t?e.touches[0].pageX:e.pageX,n=t?e.touches[0].pageY:e.pageY;if(this.container!==document.body){let s=hr.elOffset(this.container);i-=s.left,n-=s.top}return{x:i,y:n}}elementPositionCoords(e,t="right"){var i=hr.elOffset(e),n,s,a;switch(this.container!==document.body&&(n=hr.elOffset(this.container),i.left-=n.left,i.top-=n.top),t){case"right":s=i.left+e.offsetWidth,a=i.top-1;break;case"bottom":s=i.left,a=i.top+e.offsetHeight;break;case"left":s=i.left,a=i.top-1;break;case"top":s=i.left,a=i.top;break;case"center":s=i.left+e.offsetWidth/2,a=i.top+e.offsetHeight/2;break}return{x:s,y:a,offset:i}}show(e,t){var i,n,s,a,o;return this.destroyed||this.table.destroyed?this:(e instanceof HTMLElement?(s=e,o=this.elementPositionCoords(e,t),a=o.offset,i=o.x,n=o.y):typeof e=="number"?(a={top:0,left:0},i=e,n=t):(o=this.containerEventCoords(e),i=o.x,n=o.y,this.reversedX=!1),this.element.style.top=n+"px",this.element.style.left=i+"px",this.container.appendChild(this.element),typeof this.renderedCallback=="function"&&this.renderedCallback(),this._fitToScreen(i,n,s,a,t),this.visible=!0,this.subscribe("table-destroy",this.destroyBinding),this.element.addEventListener("mousedown",l=>{l.stopPropagation()}),this)}_fitToScreen(e,t,i,n,s){var a=this.container===document.body?document.documentElement.scrollTop:this.container.scrollTop;(e+this.element.offsetWidth>=this.container.offsetWidth||this.reversedX)&&(this.element.style.left="",i?this.element.style.right=this.container.offsetWidth-n.left+"px":this.element.style.right=this.container.offsetWidth-e+"px",this.reversedX=!0);let o=Math.max(this.container.offsetHeight,a?this.container.scrollHeight:0);if(t+this.element.offsetHeight>o)if(i)switch(s){case"bottom":this.element.style.top=parseInt(this.element.style.top)-this.element.offsetHeight-i.offsetHeight-1+"px";break;default:this.element.style.top=parseInt(this.element.style.top)-this.element.offsetHeight+i.offsetHeight+1+"px"}else this.element.style.height=o+"px"}isVisible(){return this.visible}hideOnBlur(e){return this.blurable=!0,this.visible&&(setTimeout(()=>{this.visible&&(this.table.rowManager.element.addEventListener("scroll",this.blurEvent),this.subscribe("cell-editing",this.blurEvent),document.body.addEventListener("click",this.blurEvent),document.body.addEventListener("contextmenu",this.blurEvent),document.body.addEventListener("mousedown",this.blurEvent),window.addEventListener("resize",this.blurEvent),document.body.addEventListener("keydown",this.escEvent),this.blurEventsBound=!0)},100),this.blurCallback=e),this}_escapeCheck(e){e.keyCode==27&&this.hide()}blockHide(){this.hideable=!1}restoreHide(){this.hideable=!0}hide(e=!1){return this.visible&&this.hideable&&(this.blurable&&this.blurEventsBound&&(document.body.removeEventListener("keydown",this.escEvent),document.body.removeEventListener("click",this.blurEvent),document.body.removeEventListener("contextmenu",this.blurEvent),document.body.removeEventListener("mousedown",this.blurEvent),window.removeEventListener("resize",this.blurEvent),this.table.rowManager.element.removeEventListener("scroll",this.blurEvent),this.unsubscribe("cell-editing",this.blurEvent),this.blurEventsBound=!1),this.childPopup&&this.childPopup.hide(),this.parent&&(this.parent.childPopup=null),this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.visible=!1,this.blurCallback&&!e&&this.blurCallback(),this.unsubscribe("table-destroy",this.destroyBinding)),this}child(e){return this.childPopup&&this.childPopup.hide(),this.childPopup=new hg(this.table,e,this),this.childPopup}};class Dt extends hi{constructor(e,t){super(e),this._handler=null}initialize(){}registerTableOption(e,t){this.table.optionsList.register(e,t)}registerColumnOption(e,t){this.table.columnManager.optionsList.register(e,t)}registerTableFunction(e,t){typeof this.table[e]>"u"?this.table[e]=(...i)=>(this.table.initGuard(e),t(...i)):console.warn("Unable to bind table function, name already in use",e)}registerComponentFunction(e,t,i){return this.table.componentFunctionBinder.bind(e,t,i)}registerDataHandler(e,t){this.table.rowManager.registerDataPipelineHandler(e,t),this._handler=e}registerDisplayHandler(e,t){this.table.rowManager.registerDisplayPipelineHandler(e,t),this._handler=e}displayRows(e){var t=this.table.rowManager.displayRows.length-1,i;if(this._handler&&(i=this.table.rowManager.displayPipeline.findIndex(n=>n.handler===this._handler),i>-1&&(t=i)),e&&(t=t+e),this._handler)return t>-1?this.table.rowManager.getDisplayRows(t):this.activeRows()}activeRows(){return this.table.rowManager.activeRows}refreshData(e,t){t||(t=this._handler),t&&this.table.rowManager.refreshActiveData(t,!1,e)}footerAppend(e){return this.table.footerManager.append(e)}footerPrepend(e){return this.table.footerManager.prepend(e)}footerRemove(e){return this.table.footerManager.remove(e)}popup(e,t){return new iw(this.table,e,t)}alert(e,t){return this.table.alertManager.alert(e,t)}clearAlert(){return this.table.alertManager.clear()}}var nw={rownum:function(r,e,t,i,n,s){return s.getPosition()}};class _c extends Dt{static moduleName="accessor";static accessors=nw;constructor(e){super(e),this.allowedTypes=["","data","download","clipboard","print","htmlOutput"],this.registerColumnOption("accessor"),this.registerColumnOption("accessorParams"),this.registerColumnOption("accessorData"),this.registerColumnOption("accessorDataParams"),this.registerColumnOption("accessorDownload"),this.registerColumnOption("accessorDownloadParams"),this.registerColumnOption("accessorClipboard"),this.registerColumnOption("accessorClipboardParams"),this.registerColumnOption("accessorPrint"),this.registerColumnOption("accessorPrintParams"),this.registerColumnOption("accessorHtmlOutput"),this.registerColumnOption("accessorHtmlOutputParams")}initialize(){this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("row-data-retrieve",this.transformRow.bind(this))}initializeColumn(e){var t=!1,i={};this.allowedTypes.forEach(n=>{var s="accessor"+(n.charAt(0).toUpperCase()+n.slice(1)),a;e.definition[s]&&(a=this.lookupAccessor(e.definition[s]),a&&(t=!0,i[s]={accessor:a,params:e.definition[s+"Params"]||{}}))}),t&&(e.modules.accessor=i)}lookupAccessor(e){var t=!1;switch(typeof e){case"string":_c.accessors[e]?t=_c.accessors[e]:console.warn("Accessor Error - No such accessor found, ignoring: ",e);break;case"function":t=e;break}return t}transformRow(e,t){var i="accessor"+(t.charAt(0).toUpperCase()+t.slice(1)),n=e.getComponent(),s=hr.deepClone(e.data||{});return this.table.columnManager.traverse(function(a){var o,l,h,c;a.modules.accessor&&(l=a.modules.accessor[i]||a.modules.accessor.accessor||!1,l&&(o=a.getFieldValue(s),o!="undefined"&&(c=a.getComponent(),h=typeof l.params=="function"?l.params(o,s,t,c,n):l.params,a.setFieldValue(s,l.accessor(o,s,t,h,c,n)))))}),s}}var sw={method:"GET"};function Pf(r,e){var t=[];if(e=e||"",Array.isArray(r))r.forEach((n,s)=>{t=t.concat(Pf(n,e?e+"["+s+"]":s))});else if(typeof r=="object")for(var i in r)t=t.concat(Pf(r[i],e?e+"["+i+"]":i));else t.push({key:e,value:r});return t}function aw(r){var e=Pf(r),t=[];return e.forEach(function(i){t.push(encodeURIComponent(i.key)+"="+encodeURIComponent(i.value))}),t.join("&")}function cg(r,e,t){return r&&t&&Object.keys(t).length&&(!e.method||e.method.toLowerCase()=="get")&&(e.method="get",r+=(r.includes("?")?"&":"?")+aw(t)),r}function ow(r,e,t){var i;return new Promise((n,s)=>{if(r=this.urlGenerator.call(this.table,r,e,t),e.method.toUpperCase()!="GET")if(i=typeof this.table.options.ajaxContentType=="object"?this.table.options.ajaxContentType:this.contentTypeFormatters[this.table.options.ajaxContentType],i){for(var a in i.headers)e.headers||(e.headers={}),typeof e.headers[a]>"u"&&(e.headers[a]=i.headers[a]);e.body=i.body.call(this,r,e,t)}else console.warn("Ajax Error - Invalid ajaxContentType value:",this.table.options.ajaxContentType);r?(typeof e.headers>"u"&&(e.headers={}),typeof e.headers.Accept>"u"&&(e.headers.Accept="application/json"),typeof e.headers["X-Requested-With"]>"u"&&(e.headers["X-Requested-With"]="XMLHttpRequest"),typeof e.mode>"u"&&(e.mode="cors"),e.mode=="cors"?(typeof e.headers.Origin>"u"&&(e.headers.Origin=window.location.origin),typeof e.credentials>"u"&&(e.credentials="same-origin")):typeof e.credentials>"u"&&(e.credentials="include"),fetch(r,e).then(o=>{o.ok?o.json().then(l=>{n(l)}).catch(l=>{s(l),console.warn("Ajax Load Error - Invalid JSON returned",l)}):(console.error("Ajax Load Error - Connection Error: "+o.status,o.statusText),s(o))}).catch(o=>{console.error("Ajax Load Error - Connection Error: ",o),s(o)})):(console.warn("Ajax Load Error - No URL Set"),n([]))})}function Df(r,e){var t=[];if(e=e||"",Array.isArray(r))r.forEach((n,s)=>{t=t.concat(Df(n,e?e+"["+s+"]":s))});else if(typeof r=="object")for(var i in r)t=t.concat(Df(r[i],e?e+"["+i+"]":i));else t.push({key:e,value:r});return t}var lw={json:{headers:{"Content-Type":"application/json"},body:function(r,e,t){return JSON.stringify(t)}},form:{headers:{},body:function(r,e,t){var i=Df(t),n=new FormData;return i.forEach(function(s){n.append(s.key,s.value)}),n}}};class ko extends Dt{static moduleName="ajax";static defaultConfig=sw;static defaultURLGenerator=cg;static defaultLoaderPromise=ow;static contentTypeFormatters=lw;constructor(e){super(e),this.config={},this.url="",this.urlGenerator=!1,this.params=!1,this.loaderPromise=!1,this.registerTableOption("ajaxURL",!1),this.registerTableOption("ajaxURLGenerator",!1),this.registerTableOption("ajaxParams",{}),this.registerTableOption("ajaxConfig","get"),this.registerTableOption("ajaxContentType","form"),this.registerTableOption("ajaxRequestFunc",!1),this.registerTableOption("ajaxRequesting",function(){}),this.registerTableOption("ajaxResponse",!1),this.contentTypeFormatters=ko.contentTypeFormatters}initialize(){this.loaderPromise=this.table.options.ajaxRequestFunc||ko.defaultLoaderPromise,this.urlGenerator=this.table.options.ajaxURLGenerator||ko.defaultURLGenerator,this.table.options.ajaxURL&&this.setUrl(this.table.options.ajaxURL),this.setDefaultConfig(this.table.options.ajaxConfig),this.registerTableFunction("getAjaxUrl",this.getUrl.bind(this)),this.subscribe("data-loading",this.requestDataCheck.bind(this)),this.subscribe("data-params",this.requestParams.bind(this)),this.subscribe("data-load",this.requestData.bind(this))}requestParams(e,t,i,n){var s=this.table.options.ajaxParams;return s&&(typeof s=="function"&&(s=s.call(this.table)),n=Object.assign(Object.assign({},s),n)),n}requestDataCheck(e,t,i,n){return!!(!e&&this.url||typeof e=="string")}requestData(e,t,i,n,s){var a;return!s&&this.requestDataCheck(e)?(e&&this.setUrl(e),a=this.generateConfig(i),this.sendRequest(this.url,t,a)):s}setDefaultConfig(e={}){this.config=Object.assign({},ko.defaultConfig),typeof e=="string"?this.config.method=e:Object.assign(this.config,e)}generateConfig(e={}){var t=Object.assign({},this.config);return typeof e=="string"?t.method=e:Object.assign(t,e),t}setUrl(e){this.url=e}getUrl(){return this.url}sendRequest(e,t,i){return this.table.options.ajaxRequesting.call(this.table,e,t)!==!1?this.loaderPromise(e,i,t).then(n=>(this.table.options.ajaxResponse&&(n=this.table.options.ajaxResponse.call(this.table,e,t,n)),n)):Promise.reject()}}var hw={replace:function(r){return this.table.setData(r)},update:function(r){return this.table.updateOrAddData(r)},insert:function(r){return this.table.addData(r)}},cw={table:function(r){var e=[],t=!0,i=this.table.columnManager.columns,n=[],s=[];return r=r.split(`
`),r.forEach(function(a){e.push(a.split("	"))}),e.length&&!(e.length===1&&e[0].length<2)?(e[0].forEach(function(a){var o=i.find(function(l){return a&&l.definition.title&&a.trim()&&l.definition.title.trim()===a.trim()});o?n.push(o):t=!1}),t||(t=!0,n=[],e[0].forEach(function(a){var o=i.find(function(l){return a&&l.field&&a.trim()&&l.field.trim()===a.trim()});o?n.push(o):t=!1}),t||(n=this.table.columnManager.columnsByIndex)),t&&e.shift(),e.forEach(function(a){var o={};a.forEach(function(l,h){n[h]&&(o[n[h].field]=l)}),s.push(o)}),s):!1}},uw={copyToClipboard:["ctrl + 67","meta + 67"]},fw={copyToClipboard:function(r){this.table.modules.edit.currentCell||this.table.modExists("clipboard",!0)&&this.table.modules.clipboard.copy(!1,!0)}},dw={keybindings:{bindings:uw,actions:fw}};class kc extends Dt{static moduleName="clipboard";static moduleExtensions=dw;static pasteActions=hw;static pasteParsers=cw;constructor(e){super(e),this.mode=!0,this.pasteParser=function(){},this.pasteAction=function(){},this.customSelection=!1,this.rowRange=!1,this.blocked=!0,this.registerTableOption("clipboard",!1),this.registerTableOption("clipboardCopyStyled",!0),this.registerTableOption("clipboardCopyConfig",!1),this.registerTableOption("clipboardCopyFormatter",!1),this.registerTableOption("clipboardCopyRowRange","active"),this.registerTableOption("clipboardPasteParser","table"),this.registerTableOption("clipboardPasteAction","insert"),this.registerColumnOption("clipboard"),this.registerColumnOption("titleClipboard")}initialize(){this.mode=this.table.options.clipboard,this.rowRange=this.table.options.clipboardCopyRowRange,(this.mode===!0||this.mode==="copy")&&this.table.element.addEventListener("copy",e=>{var t,i,n;this.blocked||(e.preventDefault(),this.customSelection?(t=this.customSelection,this.table.options.clipboardCopyFormatter&&(t=this.table.options.clipboardCopyFormatter("plain",t))):(n=this.table.modules.export.generateExportList(this.table.options.clipboardCopyConfig,this.table.options.clipboardCopyStyled,this.rowRange,"clipboard"),i=this.table.modules.export.generateHTMLTable(n),t=i?this.generatePlainContent(n):"",this.table.options.clipboardCopyFormatter&&(t=this.table.options.clipboardCopyFormatter("plain",t),i=this.table.options.clipboardCopyFormatter("html",i))),window.clipboardData&&window.clipboardData.setData?window.clipboardData.setData("Text",t):e.clipboardData&&e.clipboardData.setData?(e.clipboardData.setData("text/plain",t),i&&e.clipboardData.setData("text/html",i)):e.originalEvent&&e.originalEvent.clipboardData.setData&&(e.originalEvent.clipboardData.setData("text/plain",t),i&&e.originalEvent.clipboardData.setData("text/html",i)),this.dispatchExternal("clipboardCopied",t,i),this.reset())}),(this.mode===!0||this.mode==="paste")&&this.table.element.addEventListener("paste",e=>{this.paste(e)}),this.setPasteParser(this.table.options.clipboardPasteParser),this.setPasteAction(this.table.options.clipboardPasteAction),this.registerTableFunction("copyToClipboard",this.copy.bind(this))}reset(){this.blocked=!0,this.customSelection=!1}generatePlainContent(e){var t=[];return e.forEach(i=>{var n=[];i.columns.forEach(s=>{var a="";if(s)if(i.type==="group"&&(s.value=s.component.getKey()),s.value===null)a="";else switch(typeof s.value){case"object":a=JSON.stringify(s.value);break;case"undefined":a="";break;default:a=s.value}n.push(a)}),t.push(n.join("	"))}),t.join(`
`)}copy(e,t){var i,n;this.blocked=!1,this.customSelection=!1,(this.mode===!0||this.mode==="copy")&&(this.rowRange=e||this.table.options.clipboardCopyRowRange,typeof window.getSelection<"u"&&typeof document.createRange<"u"?(e=document.createRange(),e.selectNodeContents(this.table.element),i=window.getSelection(),i.toString()&&t&&(this.customSelection=i.toString()),i.removeAllRanges(),i.addRange(e)):typeof document.selection<"u"&&typeof document.body.createTextRange<"u"&&(n=document.body.createTextRange(),n.moveToElementText(this.table.element),n.select()),document.execCommand("copy"),i&&i.removeAllRanges())}setPasteAction(e){switch(typeof e){case"string":this.pasteAction=kc.pasteActions[e],this.pasteAction||console.warn("Clipboard Error - No such paste action found:",e);break;case"function":this.pasteAction=e;break}}setPasteParser(e){switch(typeof e){case"string":this.pasteParser=kc.pasteParsers[e],this.pasteParser||console.warn("Clipboard Error - No such paste parser found:",e);break;case"function":this.pasteParser=e;break}}paste(e){var t,i,n;this.checkPasteOrigin(e)&&(t=this.getPasteData(e),i=this.pasteParser.call(this,t),i?(e.preventDefault(),this.table.modExists("mutator")&&(i=this.mutateData(i)),n=this.pasteAction.call(this,i),this.dispatchExternal("clipboardPasted",t,i,n)):this.dispatchExternal("clipboardPasteError",t))}mutateData(e){var t=[];return Array.isArray(e)?e.forEach(i=>{t.push(this.table.modules.mutator.transformRow(i,"clipboard"))}):t=e,t}checkPasteOrigin(e){var t=!0,i=this.confirm("clipboard-paste",[e]);return(i||!["DIV","SPAN"].includes(e.target.tagName))&&(t=!1),t}getPasteData(e){var t;return window.clipboardData&&window.clipboardData.getData?t=window.clipboardData.getData("Text"):e.clipboardData&&e.clipboardData.getData?t=e.clipboardData.getData("text/plain"):e.originalEvent&&e.originalEvent.clipboardData.getData&&(t=e.originalEvent.clipboardData.getData("text/plain")),t}}class pw{constructor(e){return this._row=e,new Proxy(this,{get:function(t,i,n){return typeof t[i]<"u"?t[i]:t._row.table.componentFunctionBinder.handle("row",t._row,i)}})}getData(e){return this._row.getData(e)}getElement(){return this._row.getElement()}getTable(){return this._row.table}getCells(){var e=[];return this._row.getCells().forEach(function(t){e.push(t.getComponent())}),e}getCell(e){var t=this._row.getCell(e);return t?t.getComponent():!1}_getSelf(){return this._row}}class ug{constructor(e){return this._cell=e,new Proxy(this,{get:function(t,i,n){return typeof t[i]<"u"?t[i]:t._cell.table.componentFunctionBinder.handle("cell",t._cell,i)}})}getValue(){return this._cell.getValue()}getOldValue(){return this._cell.getOldValue()}getInitialValue(){return this._cell.initialValue}getElement(){return this._cell.getElement()}getRow(){return this._cell.row.getComponent()}getData(e){return this._cell.row.getData(e)}getType(){return"cell"}getField(){return this._cell.column.getField()}getColumn(){return this._cell.column.getComponent()}setValue(e,t){typeof t>"u"&&(t=!0),this._cell.setValue(e,t)}restoreOldValue(){this._cell.setValueActual(this._cell.getOldValue())}restoreInitialValue(){this._cell.setValueActual(this._cell.initialValue)}checkHeight(){this._cell.checkHeight()}getTable(){return this._cell.table}_getSelf(){return this._cell}}class ch extends hi{constructor(e,t){super(e.table),this.table=e.table,this.column=e,this.row=t,this.element=null,this.value=null,this.initialValue,this.oldValue=null,this.modules={},this.height=null,this.width=null,this.minWidth=null,this.component=null,this.loaded=!1,this.build()}build(){this.generateElement(),this.setWidth(),this._configureCell(),this.setValueActual(this.column.getFieldValue(this.row.data)),this.initialValue=this.value}generateElement(){this.element=document.createElement("div"),this.element.className="tabulator-cell",this.element.setAttribute("role","gridcell"),this.column.isRowHeader&&this.element.classList.add("tabulator-row-header")}_configureCell(){var e=this.element,t=this.column.getField(),i={top:"flex-start",bottom:"flex-end",middle:"center"},n={left:"flex-start",right:"flex-end",center:"center"};if(e.style.textAlign=this.column.hozAlign,this.column.vertAlign&&(e.style.display="inline-flex",e.style.alignItems=i[this.column.vertAlign]||"",this.column.hozAlign&&(e.style.justifyContent=n[this.column.hozAlign]||"")),t&&e.setAttribute("tabulator-field",t),this.column.definition.cssClass){var s=this.column.definition.cssClass.split(" ");s.forEach(a=>{e.classList.add(a)})}this.dispatch("cell-init",this),this.column.visible||this.hide()}_generateContents(){var e;switch(e=this.chain("cell-format",this,null,()=>this.element.innerHTML=this.value),typeof e){case"object":if(e instanceof Node){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.element.appendChild(e)}else this.element.innerHTML="",e!=null&&console.warn("Format Error - Formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:",e);break;case"undefined":this.element.innerHTML="";break;default:this.element.innerHTML=e}}cellRendered(){this.dispatch("cell-rendered",this)}getElement(e){return this.loaded||(this.loaded=!0,e||this.layoutElement()),this.element}getValue(){return this.value}getOldValue(){return this.oldValue}setValue(e,t,i){var n=this.setValueProcessData(e,t,i);n&&(this.dispatch("cell-value-updated",this),this.cellRendered(),this.column.definition.cellEdited&&this.column.definition.cellEdited.call(this.table,this.getComponent()),this.dispatchExternal("cellEdited",this.getComponent()),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.table.rowManager.getData()))}setValueProcessData(e,t,i){var n=!1;return(this.value!==e||i)&&(n=!0,t&&(e=this.chain("cell-value-changing",[this,e],null,e))),this.setValueActual(e),n&&this.dispatch("cell-value-changed",this),n}setValueActual(e){this.oldValue=this.value,this.value=e,this.dispatch("cell-value-save-before",this),this.column.setFieldValue(this.row.data,e),this.dispatch("cell-value-save-after",this),this.loaded&&this.layoutElement()}layoutElement(){this._generateContents(),this.dispatch("cell-layout",this)}setWidth(){this.width=this.column.width,this.element.style.width=this.column.widthStyled}clearWidth(){this.width="",this.element.style.width=""}getWidth(){return this.width||this.element.offsetWidth}setMinWidth(){this.minWidth=this.column.minWidth,this.element.style.minWidth=this.column.minWidthStyled}setMaxWidth(){this.maxWidth=this.column.maxWidth,this.element.style.maxWidth=this.column.maxWidthStyled}checkHeight(){this.row.reinitializeHeight()}clearHeight(){this.element.style.height="",this.height=null,this.dispatch("cell-height",this,"")}setHeight(){this.height=this.row.height,this.element.style.height=this.row.heightStyled,this.dispatch("cell-height",this,this.row.heightStyled)}getHeight(){return this.height||this.element.offsetHeight}show(){this.element.style.display=this.column.vertAlign?"inline-flex":""}hide(){this.element.style.display="none"}delete(){this.dispatch("cell-delete",this),!this.table.rowManager.redrawBlock&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=!1,this.column.deleteCell(this),this.row.deleteCell(this),this.calcs={}}getIndex(){return this.row.getCellIndex(this)}getComponent(){return this.component||(this.component=new ug(this)),this.component}}class fg{constructor(e){return this._column=e,this.type="ColumnComponent",new Proxy(this,{get:function(t,i,n){return typeof t[i]<"u"?t[i]:t._column.table.componentFunctionBinder.handle("column",t._column,i)}})}getElement(){return this._column.getElement()}getDefinition(){return this._column.getDefinition()}getField(){return this._column.getField()}getTitleDownload(){return this._column.getTitleDownload()}getCells(){var e=[];return this._column.cells.forEach(function(t){e.push(t.getComponent())}),e}isVisible(){return this._column.visible}show(){this._column.isGroup?this._column.columns.forEach(function(e){e.show()}):this._column.show()}hide(){this._column.isGroup?this._column.columns.forEach(function(e){e.hide()}):this._column.hide()}toggle(){this._column.visible?this.hide():this.show()}delete(){return this._column.delete()}getSubColumns(){var e=[];return this._column.columns.length&&this._column.columns.forEach(function(t){e.push(t.getComponent())}),e}getParentColumn(){return this._column.getParentComponent()}_getSelf(){return this._column}scrollTo(e,t){return this._column.table.columnManager.scrollToColumn(this._column,e,t)}getTable(){return this._column.table}move(e,t){var i=this._column.table.columnManager.findColumn(e);i?this._column.table.columnManager.moveColumn(this._column,i,t):console.warn("Move Error - No matching column found:",i)}getNextColumn(){var e=this._column.nextColumn();return e?e.getComponent():!1}getPrevColumn(){var e=this._column.prevColumn();return e?e.getComponent():!1}updateDefinition(e){return this._column.updateDefinition(e)}getWidth(){return this._column.getWidth()}setWidth(e){var t;return e===!0?t=this._column.reinitializeWidth(!0):t=this._column.setWidth(e),this._column.table.columnManager.rerenderColumns(!0),t}}var dg={title:void 0,field:void 0,columns:void 0,visible:void 0,hozAlign:void 0,vertAlign:void 0,width:void 0,minWidth:40,maxWidth:void 0,maxInitialWidth:void 0,cssClass:void 0,variableHeight:void 0,headerVertical:void 0,headerHozAlign:void 0,headerWordWrap:!1,editableTitle:void 0};class rs extends hi{static defaultOptionList=dg;constructor(e,t,i){super(t.table),this.definition=e,this.parent=t,this.type="column",this.columns=[],this.cells=[],this.isGroup=!1,this.isRowHeader=i,this.element=this.createElement(),this.contentElement=!1,this.titleHolderElement=!1,this.titleElement=!1,this.groupElement=this.createGroupElement(),this.hozAlign="",this.vertAlign="",this.field="",this.fieldStructure="",this.getFieldValue="",this.setFieldValue="",this.titleDownload=null,this.titleFormatterRendered=!1,this.mapDefinitions(),this.setField(this.definition.field),this.modules={},this.width=null,this.widthStyled="",this.maxWidth=null,this.maxWidthStyled="",this.maxInitialWidth=null,this.minWidth=null,this.minWidthStyled="",this.widthFixed=!1,this.visible=!0,this.component=null,this.definition.columns?(this.isGroup=!0,this.definition.columns.forEach((n,s)=>{var a=new rs(n,this);this.attachColumn(a)}),this.checkColumnVisibility()):t.registerColumnField(this),this._initialize()}createElement(){var e=document.createElement("div");switch(e.classList.add("tabulator-col"),e.setAttribute("role","columnheader"),e.setAttribute("aria-sort","none"),this.isRowHeader&&e.classList.add("tabulator-row-header"),this.table.options.columnHeaderVertAlign){case"middle":e.style.justifyContent="center";break;case"bottom":e.style.justifyContent="flex-end";break}return e}createGroupElement(){var e=document.createElement("div");return e.classList.add("tabulator-col-group-cols"),e}mapDefinitions(){var e=this.table.options.columnDefaults;if(e)for(let t in e)typeof this.definition[t]>"u"&&(this.definition[t]=e[t]);this.definition=this.table.columnManager.optionsList.generate(rs.defaultOptionList,this.definition)}checkDefinition(){Object.keys(this.definition).forEach(e=>{rs.defaultOptionList.indexOf(e)===-1&&console.warn("Invalid column definition option in '"+(this.field||this.definition.title)+"' column:",e)})}setField(e){this.field=e,this.fieldStructure=e?this.table.options.nestedFieldSeparator?e.split(this.table.options.nestedFieldSeparator):[e]:[],this.getFieldValue=this.fieldStructure.length>1?this._getNestedData:this._getFlatData,this.setFieldValue=this.fieldStructure.length>1?this._setNestedData:this._setFlatData}registerColumnPosition(e){this.parent.registerColumnPosition(e)}registerColumnField(e){this.parent.registerColumnField(e)}reRegisterPosition(){this.isGroup?this.columns.forEach(function(e){e.reRegisterPosition()}):this.registerColumnPosition(this)}_initialize(){for(var e=this.definition;this.element.firstChild;)this.element.removeChild(this.element.firstChild);e.headerVertical&&(this.element.classList.add("tabulator-col-vertical"),e.headerVertical==="flip"&&this.element.classList.add("tabulator-col-vertical-flip")),this.contentElement=this._buildColumnHeaderContent(),this.element.appendChild(this.contentElement),this.isGroup?this._buildGroupHeader():this._buildColumnHeader(),this.dispatch("column-init",this)}_buildColumnHeader(){var e=this.definition;if(this.dispatch("column-layout",this),typeof e.visible<"u"&&(e.visible?this.show(!0):this.hide(!0)),e.cssClass){var t=e.cssClass.split(" ");t.forEach(i=>{this.element.classList.add(i)})}e.field&&this.element.setAttribute("tabulator-field",e.field),this.setMinWidth(parseInt(e.minWidth)),e.maxInitialWidth&&(this.maxInitialWidth=parseInt(e.maxInitialWidth)),e.maxWidth&&this.setMaxWidth(parseInt(e.maxWidth)),this.reinitializeWidth(),this.hozAlign=this.definition.hozAlign,this.vertAlign=this.definition.vertAlign,this.titleElement.style.textAlign=this.definition.headerHozAlign}_buildColumnHeaderContent(){var e=document.createElement("div");return e.classList.add("tabulator-col-content"),this.titleHolderElement=document.createElement("div"),this.titleHolderElement.classList.add("tabulator-col-title-holder"),e.appendChild(this.titleHolderElement),this.titleElement=this._buildColumnHeaderTitle(),this.titleHolderElement.appendChild(this.titleElement),e}_buildColumnHeaderTitle(){var e=this.definition,t=document.createElement("div");if(t.classList.add("tabulator-col-title"),e.headerWordWrap&&t.classList.add("tabulator-col-title-wrap"),e.editableTitle){var i=document.createElement("input");i.classList.add("tabulator-title-editor"),i.addEventListener("click",n=>{n.stopPropagation(),i.focus()}),i.addEventListener("mousedown",n=>{n.stopPropagation()}),i.addEventListener("change",()=>{e.title=i.value,this.dispatchExternal("columnTitleChanged",this.getComponent())}),t.appendChild(i),e.field?this.langBind("columns|"+e.field,n=>{i.value=n||e.title||"&nbsp;"}):i.value=e.title||"&nbsp;"}else e.field?this.langBind("columns|"+e.field,n=>{this._formatColumnHeaderTitle(t,n||e.title||"&nbsp;")}):this._formatColumnHeaderTitle(t,e.title||"&nbsp;");return t}_formatColumnHeaderTitle(e,t){var i=this.chain("column-format",[this,t,e],null,()=>t);switch(typeof i){case"object":i instanceof Node?e.appendChild(i):(e.innerHTML="",console.warn("Format Error - Title formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:",i));break;case"undefined":e.innerHTML="";break;default:e.innerHTML=i}}_buildGroupHeader(){if(this.element.classList.add("tabulator-col-group"),this.element.setAttribute("role","columngroup"),this.element.setAttribute("aria-title",this.definition.title),this.definition.cssClass){var e=this.definition.cssClass.split(" ");e.forEach(t=>{this.element.classList.add(t)})}this.titleElement.style.textAlign=this.definition.headerHozAlign,this.element.appendChild(this.groupElement)}_getFlatData(e){return e[this.field]}_getNestedData(e){var t=e,i=this.fieldStructure,n=i.length,s;for(let a=0;a<n&&(t=t[i[a]],s=t,!!t);a++);return s}_setFlatData(e,t){this.field&&(e[this.field]=t)}_setNestedData(e,t){var i=e,n=this.fieldStructure,s=n.length;for(let a=0;a<s;a++)if(a==s-1)i[n[a]]=t;else{if(!i[n[a]])if(typeof t<"u")i[n[a]]={};else break;i=i[n[a]]}}attachColumn(e){this.groupElement?(this.columns.push(e),this.groupElement.appendChild(e.getElement()),e.columnRendered()):console.warn("Column Warning - Column being attached to another column instead of column group")}verticalAlign(e,t){var i=this.parent.isGroup?this.parent.getGroupElement().clientHeight:t||this.parent.getHeadersElement().clientHeight;this.element.style.height=i+"px",this.dispatch("column-height",this,this.element.style.height),this.isGroup&&(this.groupElement.style.minHeight=i-this.contentElement.offsetHeight+"px"),this.columns.forEach(function(n){n.verticalAlign(e)})}clearVerticalAlign(){this.element.style.paddingTop="",this.element.style.height="",this.element.style.minHeight="",this.groupElement.style.minHeight="",this.columns.forEach(function(e){e.clearVerticalAlign()}),this.dispatch("column-height",this,"")}getElement(){return this.element}getGroupElement(){return this.groupElement}getField(){return this.field}getTitleDownload(){return this.titleDownload}getFirstColumn(){return this.isGroup?this.columns.length?this.columns[0].getFirstColumn():!1:this}getLastColumn(){return this.isGroup?this.columns.length?this.columns[this.columns.length-1].getLastColumn():!1:this}getColumns(e){var t=[];return e?this.columns.forEach(i=>{t.push(i),t=t.concat(i.getColumns(!0))}):t=this.columns,t}getCells(){return this.cells}getTopColumn(){return this.parent.isGroup?this.parent.getTopColumn():this}getDefinition(e){var t=[];return this.isGroup&&e&&(this.columns.forEach(function(i){t.push(i.getDefinition(!0))}),this.definition.columns=t),this.definition}checkColumnVisibility(){var e=!1;this.columns.forEach(function(t){t.visible&&(e=!0)}),e?(this.show(),this.dispatchExternal("columnVisibilityChanged",this.getComponent(),!1)):this.hide()}show(e,t){this.visible||(this.visible=!0,this.element.style.display="",this.parent.isGroup&&this.parent.checkColumnVisibility(),this.cells.forEach(function(i){i.show()}),!this.isGroup&&this.width===null&&this.reinitializeWidth(),this.table.columnManager.verticalAlignHeaders(),this.dispatch("column-show",this,t),e||this.dispatchExternal("columnVisibilityChanged",this.getComponent(),!0),this.parent.isGroup&&this.parent.matchChildWidths(),this.silent||this.table.columnManager.rerenderColumns())}hide(e,t){this.visible&&(this.visible=!1,this.element.style.display="none",this.table.columnManager.verticalAlignHeaders(),this.parent.isGroup&&this.parent.checkColumnVisibility(),this.cells.forEach(function(i){i.hide()}),this.dispatch("column-hide",this,t),e||this.dispatchExternal("columnVisibilityChanged",this.getComponent(),!1),this.parent.isGroup&&this.parent.matchChildWidths(),this.silent||this.table.columnManager.rerenderColumns())}matchChildWidths(){var e=0;this.contentElement&&this.columns.length&&(this.columns.forEach(function(t){t.visible&&(e+=t.getWidth())}),this.contentElement.style.maxWidth=e-1+"px",this.table.initialized&&(this.element.style.width=e+"px"),this.parent.isGroup&&this.parent.matchChildWidths())}removeChild(e){var t=this.columns.indexOf(e);t>-1&&this.columns.splice(t,1),this.columns.length||this.delete()}setWidth(e){this.widthFixed=!0,this.setWidthActual(e)}setWidthActual(e){isNaN(e)&&(e=Math.floor(this.table.element.clientWidth/100*parseInt(e))),e=Math.max(this.minWidth,e),this.maxWidth&&(e=Math.min(this.maxWidth,e)),this.width=e,this.widthStyled=e?e+"px":"",this.element.style.width=this.widthStyled,this.isGroup||this.cells.forEach(function(t){t.setWidth()}),this.parent.isGroup&&this.parent.matchChildWidths(),this.dispatch("column-width",this),this.subscribedExternal("columnWidth")&&this.dispatchExternal("columnWidth",this.getComponent())}checkCellHeights(){var e=[];this.cells.forEach(function(t){t.row.heightInitialized&&(t.row.getElement().offsetParent!==null?(e.push(t.row),t.row.clearCellHeight()):t.row.heightInitialized=!1)}),e.forEach(function(t){t.calcHeight()}),e.forEach(function(t){t.setCellHeight()})}getWidth(){var e=0;return this.isGroup?this.columns.forEach(function(t){t.visible&&(e+=t.getWidth())}):e=this.width,e}getLeftOffset(){var e=this.element.offsetLeft;return this.parent.isGroup&&(e+=this.parent.getLeftOffset()),e}getHeight(){return Math.ceil(this.element.getBoundingClientRect().height)}setMinWidth(e){this.maxWidth&&e>this.maxWidth&&(e=this.maxWidth,console.warn("the minWidth ("+e+"px) for column '"+this.field+"' cannot be bigger that its maxWidth ("+this.maxWidthStyled+")")),this.minWidth=e,this.minWidthStyled=e?e+"px":"",this.element.style.minWidth=this.minWidthStyled,this.cells.forEach(function(t){t.setMinWidth()})}setMaxWidth(e){this.minWidth&&e<this.minWidth&&(e=this.minWidth,console.warn("the maxWidth ("+e+"px) for column '"+this.field+"' cannot be smaller that its minWidth ("+this.minWidthStyled+")")),this.maxWidth=e,this.maxWidthStyled=e?e+"px":"",this.element.style.maxWidth=this.maxWidthStyled,this.cells.forEach(function(t){t.setMaxWidth()})}delete(){return new Promise((e,t)=>{this.isGroup&&this.columns.forEach(function(n){n.delete()}),this.dispatch("column-delete",this);var i=this.cells.length;for(let n=0;n<i;n++)this.cells[0].delete();this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=!1,this.contentElement=!1,this.titleElement=!1,this.groupElement=!1,this.parent.isGroup&&this.parent.removeChild(this),this.table.columnManager.deregisterColumn(this),this.table.columnManager.rerenderColumns(!0),this.dispatch("column-deleted",this),e()})}columnRendered(){this.titleFormatterRendered&&this.titleFormatterRendered(),this.dispatch("column-rendered",this)}generateCell(e){var t=new ch(this,e);return this.cells.push(t),t}nextColumn(){var e=this.table.columnManager.findColumnIndex(this);return e>-1?this._nextVisibleColumn(e+1):!1}_nextVisibleColumn(e){var t=this.table.columnManager.getColumnByIndex(e);return!t||t.visible?t:this._nextVisibleColumn(e+1)}prevColumn(){var e=this.table.columnManager.findColumnIndex(this);return e>-1?this._prevVisibleColumn(e-1):!1}_prevVisibleColumn(e){var t=this.table.columnManager.getColumnByIndex(e);return!t||t.visible?t:this._prevVisibleColumn(e-1)}reinitializeWidth(e){this.widthFixed=!1,typeof this.definition.width<"u"&&!e&&this.setWidth(this.definition.width),this.dispatch("column-width-fit-before",this),this.fitToData(e),this.dispatch("column-width-fit-after",this)}fitToData(e){if(!this.isGroup){this.widthFixed||(this.element.style.width="",this.cells.forEach(n=>{n.clearWidth()}));var t=this.element.offsetWidth;if((!this.width||!this.widthFixed)&&(this.cells.forEach(n=>{var s=n.getWidth();s>t&&(t=s)}),t)){var i=t+1;e?this.setWidth(i):(this.maxInitialWidth&&!e&&(i=Math.min(i,this.maxInitialWidth)),this.setWidthActual(i))}}}updateDefinition(e){var t;return this.isGroup||this.parent.isGroup?(console.error("Column Update Error - The updateDefinition function is only available on ungrouped columns"),Promise.reject("Column Update Error - The updateDefinition function is only available on columns, not column groups")):(t=Object.assign({},this.getDefinition()),t=Object.assign(t,e),this.table.columnManager.addColumn(t,!1,this).then(i=>(t.field==this.field&&(this.field=!1),this.delete().then(()=>i.getComponent()))))}deleteCell(e){var t=this.cells.indexOf(e);t>-1&&this.cells.splice(t,1)}getComponent(){return this.component||(this.component=new fg(this)),this.component}getPosition(){return this.table.columnManager.getVisibleColumnsByIndex().indexOf(this)+1}getParentComponent(){return this.parent instanceof rs?this.parent.getComponent():!1}}class Jc{constructor(e){return this._row=e,new Proxy(this,{get:function(t,i,n){return typeof t[i]<"u"?t[i]:t._row.table.componentFunctionBinder.handle("row",t._row,i)}})}getData(e){return this._row.getData(e)}getElement(){return this._row.getElement()}getCells(){var e=[];return this._row.getCells().forEach(function(t){e.push(t.getComponent())}),e}getCell(e){var t=this._row.getCell(e);return t?t.getComponent():!1}getIndex(){return this._row.getData("data")[this._row.table.options.index]}getPosition(){return this._row.getPosition()}watchPosition(e){return this._row.watchPosition(e)}delete(){return this._row.delete()}scrollTo(e,t){return this._row.table.rowManager.scrollToRow(this._row,e,t)}move(e,t){this._row.moveToRow(e,t)}update(e){return this._row.updateData(e)}normalizeHeight(){this._row.normalizeHeight(!0)}_getSelf(){return this._row}reformat(){return this._row.reinitialize()}getTable(){return this._row.table}getNextRow(){var e=this._row.nextRow();return e&&e.getComponent()}getPrevRow(){var e=this._row.prevRow();return e&&e.getComponent()}}class wi extends hi{constructor(e,t,i="row"){super(t.table),this.parent=t,this.data={},this.type=i,this.element=!1,this.modules={},this.cells=[],this.height=0,this.heightStyled="",this.manualHeight=!1,this.outerHeight=0,this.initialized=!1,this.heightInitialized=!1,this.position=0,this.positionWatchers=[],this.component=null,this.created=!1,this.setData(e)}create(){this.created||(this.created=!0,this.generateElement())}createElement(){var e=document.createElement("div");e.classList.add("tabulator-row"),e.setAttribute("role","row"),this.element=e}getElement(){return this.create(),this.element}detachElement(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}generateElement(){this.createElement(),this.dispatch("row-init",this)}generateCells(){this.cells=this.table.columnManager.generateCells(this)}initialize(e,t){if(this.create(),!this.initialized||e){for(this.deleteCells();this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.dispatch("row-layout-before",this),this.generateCells(),this.initialized=!0,this.table.columnManager.renderer.renderRowCells(this,t),e&&this.normalizeHeight(),this.dispatch("row-layout",this),this.table.options.rowFormatter&&this.table.options.rowFormatter(this.getComponent()),this.dispatch("row-layout-after",this)}else this.table.columnManager.renderer.rerenderRowCells(this,t)}rendered(){this.cells.forEach(e=>{e.cellRendered()})}reinitializeHeight(){this.heightInitialized=!1,this.element&&this.element.offsetParent!==null&&this.normalizeHeight(!0)}deinitialize(){this.initialized=!1}deinitializeHeight(){this.heightInitialized=!1}reinitialize(e){this.initialized=!1,this.heightInitialized=!1,this.manualHeight||(this.height=0,this.heightStyled=""),this.element&&this.element.offsetParent!==null&&this.initialize(!0),this.dispatch("row-relayout",this)}calcHeight(e){var t=0,i=0;this.table.options.rowHeight?this.height=this.table.options.rowHeight:(i=this.calcMinHeight(),t=this.calcMaxHeight(),e?this.height=Math.max(t,i):this.height=this.manualHeight?this.height:Math.max(t,i)),this.heightStyled=this.height?this.height+"px":"",this.outerHeight=this.element.offsetHeight}calcMinHeight(){return this.table.options.resizableRows?this.element.clientHeight:0}calcMaxHeight(){var e=0;return this.cells.forEach(function(t){var i=t.getHeight();i>e&&(e=i)}),e}setCellHeight(){this.cells.forEach(function(e){e.setHeight()}),this.heightInitialized=!0}clearCellHeight(){this.cells.forEach(function(e){e.clearHeight()})}normalizeHeight(e){e&&!this.table.options.rowHeight&&this.clearCellHeight(),this.calcHeight(e),this.setCellHeight()}setHeight(e,t){(this.height!=e||t)&&(this.manualHeight=!0,this.height=e,this.heightStyled=e?e+"px":"",this.setCellHeight(),this.outerHeight=this.element.offsetHeight,this.subscribedExternal("rowHeight")&&this.dispatchExternal("rowHeight",this.getComponent()))}getHeight(){return this.outerHeight}getWidth(){return this.element.offsetWidth}deleteCell(e){var t=this.cells.indexOf(e);t>-1&&this.cells.splice(t,1)}setData(e){this.data=this.chain("row-data-init-before",[this,e],void 0,e),this.dispatch("row-data-init-after",this)}updateData(e){var t=this.element&&hr.elVisible(this.element),i={},n;return new Promise((s,a)=>{typeof e=="string"&&(e=JSON.parse(e)),this.dispatch("row-data-save-before",this),this.subscribed("row-data-changing")&&(i=Object.assign(i,this.data),i=Object.assign(i,e)),n=this.chain("row-data-changing",[this,i,e],null,e);for(let o in n)this.data[o]=n[o];this.dispatch("row-data-save-after",this);for(let o in e)this.table.columnManager.getColumnsByFieldRoot(o).forEach(h=>{let c=this.getCell(h.getField());if(c){let d=h.getFieldValue(n);c.getValue()!==d&&(c.setValueProcessData(d),t&&c.cellRendered())}});t?(this.normalizeHeight(!0),this.table.options.rowFormatter&&this.table.options.rowFormatter(this.getComponent())):(this.initialized=!1,this.height=0,this.heightStyled=""),this.dispatch("row-data-changed",this,t,e),this.dispatchExternal("rowUpdated",this.getComponent()),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.table.rowManager.getData()),s()})}getData(e){return e?this.chain("row-data-retrieve",[this,e],null,this.data):this.data}getCell(e){var t=!1;return e=this.table.columnManager.findColumn(e),!this.initialized&&this.cells.length===0&&this.generateCells(),t=this.cells.find(function(i){return i.column===e}),t}getCellIndex(e){return this.cells.findIndex(function(t){return t===e})}findCell(e){return this.cells.find(t=>t.element===e)}getCells(){return!this.initialized&&this.cells.length===0&&this.generateCells(),this.cells}nextRow(){var e=this.table.rowManager.nextDisplayRow(this,!0);return e||!1}prevRow(){var e=this.table.rowManager.prevDisplayRow(this,!0);return e||!1}moveToRow(e,t){var i=this.table.rowManager.findRow(e);i?(this.table.rowManager.moveRowActual(this,i,!t),this.table.rowManager.refreshActiveData("display",!1,!0)):console.warn("Move Error - No matching row found:",e)}delete(){return this.dispatch("row-delete",this),this.deleteActual(),Promise.resolve()}deleteActual(e){this.detachModules(),this.table.rowManager.deleteRow(this,e),this.deleteCells(),this.initialized=!1,this.heightInitialized=!1,this.element=!1,this.dispatch("row-deleted",this)}detachModules(){this.dispatch("row-deleting",this)}deleteCells(){var e=this.cells.length;for(let t=0;t<e;t++)this.cells[0].delete()}wipe(){if(this.detachModules(),this.deleteCells(),this.element){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.element.parentNode&&this.element.parentNode.removeChild(this.element)}this.element=!1,this.modules={}}isDisplayed(){return this.table.rowManager.getDisplayRows().includes(this)}getPosition(){return this.isDisplayed()?this.position:!1}setPosition(e){e!=this.position&&(this.position=e,this.positionWatchers.forEach(t=>{t(this.position)}))}watchPosition(e){this.positionWatchers.push(e),e(this.position)}getGroup(){return this.modules.group||!1}getComponent(){return this.component||(this.component=new Jc(this)),this.component}}var mw={avg:function(r,e,t){var i=0,n=typeof t.precision<"u"?t.precision:2;return r.length&&(i=r.reduce(function(s,a){return Number(s)+Number(a)}),i=i/r.length,i=n!==!1?i.toFixed(n):i),parseFloat(i).toString()},max:function(r,e,t){var i=null,n=typeof t.precision<"u"?t.precision:!1;return r.forEach(function(s){s=Number(s),(s>i||i===null)&&(i=s)}),i!==null?n!==!1?i.toFixed(n):i:""},min:function(r,e,t){var i=null,n=typeof t.precision<"u"?t.precision:!1;return r.forEach(function(s){s=Number(s),(s<i||i===null)&&(i=s)}),i!==null?n!==!1?i.toFixed(n):i:""},sum:function(r,e,t){var i=0,n=typeof t.precision<"u"?t.precision:!1;return r.length&&r.forEach(function(s){s=Number(s),i+=isNaN(s)?0:Number(s)}),n!==!1?i.toFixed(n):i},concat:function(r,e,t){var i=0;return r.length&&(i=r.reduce(function(n,s){return String(n)+String(s)})),i},count:function(r,e,t){var i=0;return r.length&&r.forEach(function(n){n&&i++}),i},unique:function(r,e,t){var i=r.filter((n,s)=>(r||n===0)&&r.indexOf(n)===s);return i.length}};class So extends Dt{static moduleName="columnCalcs";static calculations=mw;constructor(e){super(e),this.topCalcs=[],this.botCalcs=[],this.genColumn=!1,this.topElement=this.createElement(),this.botElement=this.createElement(),this.topRow=!1,this.botRow=!1,this.topInitialized=!1,this.botInitialized=!1,this.blocked=!1,this.recalcAfterBlock=!1,this.registerTableOption("columnCalcs",!0),this.registerColumnOption("topCalc"),this.registerColumnOption("topCalcParams"),this.registerColumnOption("topCalcFormatter"),this.registerColumnOption("topCalcFormatterParams"),this.registerColumnOption("bottomCalc"),this.registerColumnOption("bottomCalcParams"),this.registerColumnOption("bottomCalcFormatter"),this.registerColumnOption("bottomCalcFormatterParams")}createElement(){var e=document.createElement("div");return e.classList.add("tabulator-calcs-holder"),e}initialize(){this.genColumn=new rs({field:"value"},this),this.subscribe("cell-value-changed",this.cellValueChanged.bind(this)),this.subscribe("column-init",this.initializeColumnCheck.bind(this)),this.subscribe("row-deleted",this.rowsUpdated.bind(this)),this.subscribe("scroll-horizontal",this.scrollHorizontal.bind(this)),this.subscribe("row-added",this.rowsUpdated.bind(this)),this.subscribe("column-moved",this.recalcActiveRows.bind(this)),this.subscribe("column-add",this.recalcActiveRows.bind(this)),this.subscribe("data-refreshed",this.recalcActiveRowsRefresh.bind(this)),this.subscribe("table-redraw",this.tableRedraw.bind(this)),this.subscribe("rows-visible",this.visibleRows.bind(this)),this.subscribe("scrollbar-vertical",this.adjustForScrollbar.bind(this)),this.subscribe("redraw-blocked",this.blockRedraw.bind(this)),this.subscribe("redraw-restored",this.restoreRedraw.bind(this)),this.subscribe("table-redrawing",this.resizeHolderWidth.bind(this)),this.subscribe("column-resized",this.resizeHolderWidth.bind(this)),this.subscribe("column-show",this.resizeHolderWidth.bind(this)),this.subscribe("column-hide",this.resizeHolderWidth.bind(this)),this.registerTableFunction("getCalcResults",this.getResults.bind(this)),this.registerTableFunction("recalc",this.userRecalc.bind(this)),this.resizeHolderWidth()}resizeHolderWidth(){this.topElement.style.minWidth=this.table.columnManager.headersElement.offsetWidth+"px"}tableRedraw(e){this.recalc(this.table.rowManager.activeRows),e&&this.redraw()}blockRedraw(){this.blocked=!0,this.recalcAfterBlock=!1}restoreRedraw(){this.blocked=!1,this.recalcAfterBlock&&(this.recalcAfterBlock=!1,this.recalcActiveRowsRefresh())}userRecalc(){this.recalc(this.table.rowManager.activeRows)}blockCheck(){return this.blocked&&(this.recalcAfterBlock=!0),this.blocked}visibleRows(e,t){return this.topRow&&t.unshift(this.topRow),this.botRow&&t.push(this.botRow),t}rowsUpdated(e){this.table.options.groupBy?this.recalcRowGroup(e):this.recalcActiveRows()}recalcActiveRowsRefresh(){this.table.options.groupBy&&this.table.options.dataTreeStartExpanded&&this.table.options.dataTree?this.recalcAll():this.recalcActiveRows()}recalcActiveRows(){this.recalc(this.table.rowManager.activeRows)}cellValueChanged(e){(e.column.definition.topCalc||e.column.definition.bottomCalc)&&(this.table.options.groupBy?((this.table.options.columnCalcs=="table"||this.table.options.columnCalcs=="both")&&this.recalcActiveRows(),this.table.options.columnCalcs!="table"&&this.recalcRowGroup(e.row)):this.recalcActiveRows())}initializeColumnCheck(e){(e.definition.topCalc||e.definition.bottomCalc)&&this.initializeColumn(e)}initializeColumn(e){var t=e.definition,i={topCalcParams:t.topCalcParams||{},botCalcParams:t.bottomCalcParams||{}};if(t.topCalc){switch(typeof t.topCalc){case"string":So.calculations[t.topCalc]?i.topCalc=So.calculations[t.topCalc]:console.warn("Column Calc Error - No such calculation found, ignoring: ",t.topCalc);break;case"function":i.topCalc=t.topCalc;break}i.topCalc&&(e.modules.columnCalcs=i,this.topCalcs.push(e),this.table.options.columnCalcs!="group"&&this.initializeTopRow())}if(t.bottomCalc){switch(typeof t.bottomCalc){case"string":So.calculations[t.bottomCalc]?i.botCalc=So.calculations[t.bottomCalc]:console.warn("Column Calc Error - No such calculation found, ignoring: ",t.bottomCalc);break;case"function":i.botCalc=t.bottomCalc;break}i.botCalc&&(e.modules.columnCalcs=i,this.botCalcs.push(e),this.table.options.columnCalcs!="group"&&this.initializeBottomRow())}}registerColumnField(){}removeCalcs(){var e=!1;this.topInitialized&&(this.topInitialized=!1,this.topElement.parentNode.removeChild(this.topElement),e=!0),this.botInitialized&&(this.botInitialized=!1,this.footerRemove(this.botElement),e=!0),e&&this.table.rowManager.adjustTableSize()}reinitializeCalcs(){this.topCalcs.length&&this.initializeTopRow(),this.botCalcs.length&&this.initializeBottomRow()}initializeTopRow(){var e=document.createDocumentFragment();this.topInitialized||(e.appendChild(document.createElement("br")),e.appendChild(this.topElement),this.table.columnManager.getContentsElement().insertBefore(e,this.table.columnManager.headersElement.nextSibling),this.topInitialized=!0)}initializeBottomRow(){this.botInitialized||(this.footerPrepend(this.botElement),this.botInitialized=!0)}scrollHorizontal(e){this.botInitialized&&this.botRow&&(this.botElement.scrollLeft=e)}recalc(e){var t,i;if(!this.blockCheck()&&(this.topInitialized||this.botInitialized)){if(t=this.rowsToData(e),this.topInitialized){for(this.topRow&&this.topRow.deleteCells(),i=this.generateRow("top",t),this.topRow=i;this.topElement.firstChild;)this.topElement.removeChild(this.topElement.firstChild);this.topElement.appendChild(i.getElement()),i.initialize(!0)}if(this.botInitialized){for(this.botRow&&this.botRow.deleteCells(),i=this.generateRow("bottom",t),this.botRow=i;this.botElement.firstChild;)this.botElement.removeChild(this.botElement.firstChild);this.botElement.appendChild(i.getElement()),i.initialize(!0)}this.table.rowManager.adjustTableSize(),this.table.modExists("frozenColumns")&&this.table.modules.frozenColumns.layout()}}recalcRowGroup(e){this.recalcGroup(this.table.modules.groupRows.getRowGroup(e))}recalcAll(){if((this.topCalcs.length||this.botCalcs.length)&&(this.table.options.columnCalcs!=="group"&&this.recalcActiveRows(),this.table.options.groupBy&&this.table.options.columnCalcs!=="table")){var e=this.table.modules.groupRows.getChildGroups();e.forEach(t=>{this.recalcGroup(t)})}}recalcGroup(e){var t,i;this.blockCheck()||e&&e.calcs&&(e.calcs.bottom&&(t=this.rowsToData(e.rows),i=this.generateRowData("bottom",t),e.calcs.bottom.updateData(i),e.calcs.bottom.reinitialize()),e.calcs.top&&(t=this.rowsToData(e.rows),i=this.generateRowData("top",t),e.calcs.top.updateData(i),e.calcs.top.reinitialize()))}generateTopRow(e){return this.generateRow("top",this.rowsToData(e))}generateBottomRow(e){return this.generateRow("bottom",this.rowsToData(e))}rowsToData(e){var t=[],i=this.table.options.dataTree&&this.table.options.dataTreeChildColumnCalcs,n=this.table.modules.dataTree;return e.forEach(s=>{t.push(s.getData()),i&&s.modules.dataTree?.open&&this.rowsToData(n.getFilteredTreeChildren(s)).forEach(a=>{t.push(s)})}),t}generateRow(e,t){var i=this.generateRowData(e,t),n;return this.table.modExists("mutator")&&this.table.modules.mutator.disable(),n=new wi(i,this,"calc"),this.table.modExists("mutator")&&this.table.modules.mutator.enable(),n.getElement().classList.add("tabulator-calcs","tabulator-calcs-"+e),n.component=!1,n.getComponent=()=>(n.component||(n.component=new pw(n)),n.component),n.generateCells=()=>{var s=[];this.table.columnManager.columnsByIndex.forEach(a=>{this.genColumn.setField(a.getField()),this.genColumn.hozAlign=a.hozAlign,a.definition[e+"CalcFormatter"]&&this.table.modExists("format")?this.genColumn.modules.format={formatter:this.table.modules.format.lookupFormatter(a.definition[e+"CalcFormatter"]),params:a.definition[e+"CalcFormatterParams"]||{}}:this.genColumn.modules.format={formatter:this.table.modules.format.lookupFormatter("plaintext"),params:{}},this.genColumn.definition.cssClass=a.definition.cssClass;var o=new ch(this.genColumn,n);o.getElement(),o.column=a,o.setWidth(),a.cells.push(o),s.push(o),a.visible||o.hide()}),n.cells=s},n}generateRowData(e,t){var i={},n=e=="top"?this.topCalcs:this.botCalcs,s=e=="top"?"topCalc":"botCalc",a,o;return n.forEach(function(l){var h=[];l.modules.columnCalcs&&l.modules.columnCalcs[s]&&(t.forEach(function(c){h.push(l.getFieldValue(c))}),o=s+"Params",a=typeof l.modules.columnCalcs[o]=="function"?l.modules.columnCalcs[o](h,t):l.modules.columnCalcs[o],l.setFieldValue(i,l.modules.columnCalcs[s](h,t,a)))}),i}hasTopCalcs(){return!!this.topCalcs.length}hasBottomCalcs(){return!!this.botCalcs.length}redraw(){this.topRow&&this.topRow.normalizeHeight(!0),this.botRow&&this.botRow.normalizeHeight(!0)}getResults(){var e={},t;return this.table.options.groupBy&&this.table.modExists("groupRows")?(t=this.table.modules.groupRows.getGroups(!0),t.forEach(i=>{e[i.getKey()]=this.getGroupResults(i)})):e={top:this.topRow?this.topRow.getData():{},bottom:this.botRow?this.botRow.getData():{}},e}getGroupResults(e){var t=e._getSelf(),i=e.getSubGroups(),n={},s={};return i.forEach(a=>{n[a.getKey()]=this.getGroupResults(a)}),s={top:t.calcs.top?t.calcs.top.getData():{},bottom:t.calcs.bottom?t.calcs.bottom.getData():{},groups:n},s}adjustForScrollbar(e){this.botRow&&(this.table.rtl?this.botElement.style.paddingLeft=e+"px":this.botElement.style.paddingRight=e+"px")}}class gw extends Dt{static moduleName="dataTree";constructor(e){super(e),this.indent=10,this.field="",this.collapseEl=null,this.expandEl=null,this.branchEl=null,this.elementField=!1,this.startOpen=function(){},this.registerTableOption("dataTree",!1),this.registerTableOption("dataTreeFilter",!0),this.registerTableOption("dataTreeSort",!0),this.registerTableOption("dataTreeElementColumn",!1),this.registerTableOption("dataTreeBranchElement",!0),this.registerTableOption("dataTreeChildIndent",9),this.registerTableOption("dataTreeChildField","_children"),this.registerTableOption("dataTreeCollapseElement",!1),this.registerTableOption("dataTreeExpandElement",!1),this.registerTableOption("dataTreeStartExpanded",!1),this.registerTableOption("dataTreeChildColumnCalcs",!1),this.registerTableOption("dataTreeSelectPropagate",!1),this.registerComponentFunction("row","treeCollapse",this.collapseRow.bind(this)),this.registerComponentFunction("row","treeExpand",this.expandRow.bind(this)),this.registerComponentFunction("row","treeToggle",this.toggleRow.bind(this)),this.registerComponentFunction("row","getTreeParent",this.getTreeParent.bind(this)),this.registerComponentFunction("row","getTreeChildren",this.getRowChildren.bind(this)),this.registerComponentFunction("row","addTreeChild",this.addTreeChildRow.bind(this)),this.registerComponentFunction("row","isTreeExpanded",this.isRowExpanded.bind(this))}initialize(){if(this.table.options.dataTree){var e=null,t=this.table.options;switch(this.field=t.dataTreeChildField,this.indent=t.dataTreeChildIndent,this.options("movableRows")&&console.warn("The movableRows option is not available with dataTree enabled, moving of child rows could result in unpredictable behavior"),t.dataTreeBranchElement?t.dataTreeBranchElement===!0?(this.branchEl=document.createElement("div"),this.branchEl.classList.add("tabulator-data-tree-branch")):typeof t.dataTreeBranchElement=="string"?(e=document.createElement("div"),e.innerHTML=t.dataTreeBranchElement,this.branchEl=e.firstChild):this.branchEl=t.dataTreeBranchElement:(this.branchEl=document.createElement("div"),this.branchEl.classList.add("tabulator-data-tree-branch-empty")),t.dataTreeCollapseElement?typeof t.dataTreeCollapseElement=="string"?(e=document.createElement("div"),e.innerHTML=t.dataTreeCollapseElement,this.collapseEl=e.firstChild):this.collapseEl=t.dataTreeCollapseElement:(this.collapseEl=document.createElement("div"),this.collapseEl.classList.add("tabulator-data-tree-control"),this.collapseEl.tabIndex=0,this.collapseEl.innerHTML="<div class='tabulator-data-tree-control-collapse'></div>"),t.dataTreeExpandElement?typeof t.dataTreeExpandElement=="string"?(e=document.createElement("div"),e.innerHTML=t.dataTreeExpandElement,this.expandEl=e.firstChild):this.expandEl=t.dataTreeExpandElement:(this.expandEl=document.createElement("div"),this.expandEl.classList.add("tabulator-data-tree-control"),this.expandEl.tabIndex=0,this.expandEl.innerHTML="<div class='tabulator-data-tree-control-expand'></div>"),typeof t.dataTreeStartExpanded){case"boolean":this.startOpen=function(i,n){return t.dataTreeStartExpanded};break;case"function":this.startOpen=t.dataTreeStartExpanded;break;default:this.startOpen=function(i,n){return t.dataTreeStartExpanded[n]};break}this.subscribe("row-init",this.initializeRow.bind(this)),this.subscribe("row-layout-after",this.layoutRow.bind(this)),this.subscribe("row-deleting",this.rowDeleting.bind(this)),this.subscribe("row-deleted",this.rowDelete.bind(this),0),this.subscribe("row-data-changed",this.rowDataChanged.bind(this),10),this.subscribe("cell-value-updated",this.cellValueChanged.bind(this)),this.subscribe("edit-cancelled",this.cellValueChanged.bind(this)),this.subscribe("column-moving-rows",this.columnMoving.bind(this)),this.subscribe("table-built",this.initializeElementField.bind(this)),this.subscribe("table-redrawing",this.tableRedrawing.bind(this)),this.registerDisplayHandler(this.getRows.bind(this),30)}}tableRedrawing(e){var t;e&&(t=this.table.rowManager.getRows(),t.forEach(i=>{this.reinitializeRowChildren(i)}))}initializeElementField(){var e=this.table.columnManager.getFirstVisibleColumn();this.elementField=this.table.options.dataTreeElementColumn||(e?e.field:!1)}getRowChildren(e){return this.getTreeChildren(e,!0)}columnMoving(){var e=[];return this.table.rowManager.rows.forEach(t=>{e=e.concat(this.getTreeChildren(t,!1,!0))}),e}rowDataChanged(e,t,i){this.redrawNeeded(i)&&(this.initializeRow(e),t&&(this.layoutRow(e),this.refreshData(!0)))}cellValueChanged(e){var t=e.column.getField();t===this.elementField&&this.layoutRow(e.row)}initializeRow(e){var t=e.getData()[this.field],i=Array.isArray(t),n=i||!i&&typeof t=="object"&&t!==null;!n&&e.modules.dataTree&&e.modules.dataTree.branchEl&&e.modules.dataTree.branchEl.parentNode.removeChild(e.modules.dataTree.branchEl),!n&&e.modules.dataTree&&e.modules.dataTree.controlEl&&e.modules.dataTree.controlEl.parentNode.removeChild(e.modules.dataTree.controlEl),e.modules.dataTree={index:e.modules.dataTree?e.modules.dataTree.index:0,open:n?e.modules.dataTree?e.modules.dataTree.open:this.startOpen(e.getComponent(),0):!1,controlEl:e.modules.dataTree&&n?e.modules.dataTree.controlEl:!1,branchEl:e.modules.dataTree&&n?e.modules.dataTree.branchEl:!1,parent:e.modules.dataTree?e.modules.dataTree.parent:!1,children:n}}reinitializeRowChildren(e){var t=this.getTreeChildren(e,!1,!0);t.forEach(function(i){i.reinitialize(!0)})}layoutRow(e){var t=this.elementField?e.getCell(this.elementField):e.getCells()[0],i=t.getElement(),n=e.modules.dataTree;n.branchEl&&(n.branchEl.parentNode&&n.branchEl.parentNode.removeChild(n.branchEl),n.branchEl=!1),n.controlEl&&(n.controlEl.parentNode&&n.controlEl.parentNode.removeChild(n.controlEl),n.controlEl=!1),this.generateControlElement(e,i),e.getElement().classList.add("tabulator-tree-level-"+n.index),n.index&&(this.branchEl?(n.branchEl=this.branchEl.cloneNode(!0),i.insertBefore(n.branchEl,i.firstChild),this.table.rtl?n.branchEl.style.marginRight=(n.branchEl.offsetWidth+n.branchEl.style.marginLeft)*(n.index-1)+n.index*this.indent+"px":n.branchEl.style.marginLeft=(n.branchEl.offsetWidth+n.branchEl.style.marginRight)*(n.index-1)+n.index*this.indent+"px"):this.table.rtl?i.style.paddingRight=parseInt(window.getComputedStyle(i,null).getPropertyValue("padding-right"))+n.index*this.indent+"px":i.style.paddingLeft=parseInt(window.getComputedStyle(i,null).getPropertyValue("padding-left"))+n.index*this.indent+"px")}generateControlElement(e,t){var i=e.modules.dataTree,n=i.controlEl;t=t||e.getCells()[0].getElement(),i.children!==!1&&(i.open?(i.controlEl=this.collapseEl.cloneNode(!0),i.controlEl.addEventListener("click",s=>{s.stopPropagation(),this.collapseRow(e)})):(i.controlEl=this.expandEl.cloneNode(!0),i.controlEl.addEventListener("click",s=>{s.stopPropagation(),this.expandRow(e)})),i.controlEl.addEventListener("mousedown",s=>{s.stopPropagation()}),n&&n.parentNode===t?n.parentNode.replaceChild(i.controlEl,n):t.insertBefore(i.controlEl,t.firstChild))}getRows(e){var t=[];return e.forEach((i,n)=>{var s,a;t.push(i),i instanceof wi&&(i.create(),s=i.modules.dataTree,!s.index&&s.children!==!1&&(a=this.getChildren(i,!1,!0),a.forEach(o=>{o.create(),t.push(o)})))}),t}getChildren(e,t,i){var n=e.modules.dataTree,s=[],a=[];return n.children!==!1&&(n.open||t)&&(Array.isArray(n.children)||(n.children=this.generateChildren(e)),this.table.modExists("filter")&&this.table.options.dataTreeFilter?s=this.table.modules.filter.filter(n.children):s=n.children,this.table.modExists("sort")&&this.table.options.dataTreeSort&&this.table.modules.sort.sort(s,i),s.forEach(o=>{a.push(o);var l=this.getChildren(o,!1,!0);l.forEach(h=>{a.push(h)})})),a}generateChildren(e){var t=[],i=e.getData()[this.field];return Array.isArray(i)||(i=[i]),i.forEach(n=>{var s=new wi(n||{},this.table.rowManager);s.create(),s.modules.dataTree.index=e.modules.dataTree.index+1,s.modules.dataTree.parent=e,s.modules.dataTree.children&&(s.modules.dataTree.open=this.startOpen(s.getComponent(),s.modules.dataTree.index)),t.push(s)}),t}expandRow(e,t){var i=e.modules.dataTree;i.children!==!1&&(i.open=!0,e.reinitialize(),this.refreshData(!0),this.dispatchExternal("dataTreeRowExpanded",e.getComponent(),e.modules.dataTree.index))}collapseRow(e){var t=e.modules.dataTree;t.children!==!1&&(t.open=!1,e.reinitialize(),this.refreshData(!0),this.dispatchExternal("dataTreeRowCollapsed",e.getComponent(),e.modules.dataTree.index))}toggleRow(e){var t=e.modules.dataTree;t.children!==!1&&(t.open?this.collapseRow(e):this.expandRow(e))}isRowExpanded(e){return e.modules.dataTree.open}getTreeParent(e){return e.modules.dataTree.parent?e.modules.dataTree.parent.getComponent():!1}getTreeParentRoot(e){return e.modules.dataTree&&e.modules.dataTree.parent?this.getTreeParentRoot(e.modules.dataTree.parent):e}getFilteredTreeChildren(e){var t=e.modules.dataTree,i=[],n;return t.children&&(Array.isArray(t.children)||(t.children=this.generateChildren(e)),this.table.modExists("filter")&&this.table.options.dataTreeFilter?n=this.table.modules.filter.filter(t.children):n=t.children,n.forEach(s=>{s instanceof wi&&i.push(s)})),i}rowDeleting(e){var t=e.modules.dataTree;t&&t.children&&Array.isArray(t.children)&&t.children.forEach(i=>{i instanceof wi&&i.wipe()})}rowDelete(e){var t=e.modules.dataTree.parent,i;t&&(i=this.findChildIndex(e,t),i!==!1&&t.data[this.field].splice(i,1),t.data[this.field].length||delete t.data[this.field],this.initializeRow(t),this.layoutRow(t)),this.refreshData(!0)}addTreeChildRow(e,t,i,n){var s=!1;typeof t=="string"&&(t=JSON.parse(t)),Array.isArray(e.data[this.field])||(e.data[this.field]=[],e.modules.dataTree.open=this.startOpen(e.getComponent(),e.modules.dataTree.index)),typeof n<"u"&&(s=this.findChildIndex(n,e),s!==!1&&e.data[this.field].splice(i?s:s+1,0,t)),s===!1&&(i?e.data[this.field].unshift(t):e.data[this.field].push(t)),this.initializeRow(e),this.layoutRow(e),this.refreshData(!0)}findChildIndex(e,t){var i=!1;return typeof e=="object"?e instanceof wi?i=e.data:e instanceof Jc?i=e._getSelf().data:typeof HTMLElement<"u"&&e instanceof HTMLElement?t.modules.dataTree&&(i=t.modules.dataTree.children.find(n=>n instanceof wi?n.element===e:!1),i&&(i=i.data)):e===null&&(i=!1):typeof e>"u"?i=!1:i=t.data[this.field].find(n=>n.data[this.table.options.index]==e),i&&(Array.isArray(t.data[this.field])&&(i=t.data[this.field].indexOf(i)),i==-1&&(i=!1)),i}getTreeChildren(e,t,i){var n=e.modules.dataTree,s=[];return n&&n.children&&(Array.isArray(n.children)||(n.children=this.generateChildren(e)),n.children.forEach(a=>{a instanceof wi&&(s.push(t?a.getComponent():a),i&&this.getTreeChildren(a,t,i).forEach(o=>{s.push(o)}))})),s}getChildField(){return this.field}redrawNeeded(e){return(this.field?typeof e[this.field]<"u":!1)||(this.elementField?typeof e[this.elementField]<"u":!1)}}function vw(r,e={},t){var i=e.delimiter?e.delimiter:",",n=[],s=[];r.forEach(a=>{var o=[];switch(a.type){case"group":console.warn("Download Warning - CSV downloader cannot process row groups");break;case"calc":console.warn("Download Warning - CSV downloader cannot process column calculations");break;case"header":a.columns.forEach((l,h)=>{l&&l.depth===1&&(s[h]=typeof l.value>"u"||l.value===null?"":'"'+String(l.value).split('"').join('""')+'"')});break;case"row":a.columns.forEach(l=>{if(l){switch(typeof l.value){case"object":l.value=l.value!==null?JSON.stringify(l.value):"";break;case"undefined":l.value="";break}o.push('"'+String(l.value).split('"').join('""')+'"')}}),n.push(o.join(i));break}}),s.length&&n.unshift(s.join(i)),n=n.join(`
`),e.bom&&(n="\uFEFF"+n),t(n,"text/csv")}function bw(r,e,t){var i=[];r.forEach(n=>{var s={};switch(n.type){case"header":break;case"group":console.warn("Download Warning - JSON downloader cannot process row groups");break;case"calc":console.warn("Download Warning - JSON downloader cannot process column calculations");break;case"row":n.columns.forEach(a=>{a&&(s[a.component.getTitleDownload()||a.component.getField()]=a.value)}),i.push(s);break}}),i=JSON.stringify(i,null,"	"),t(i,"application/json")}function ww(r,e={},t){var i=[],n=[],s={},a=e.rowGroupStyles||{fontStyle:"bold",fontSize:12,cellPadding:6,fillColor:220},o=e.rowCalcStyles||{fontStyle:"bold",fontSize:10,cellPadding:4,fillColor:232},l=e.jsPDF||{},h=e.title?e.title:"",c,d;l.orientation||(l.orientation=e.orientation||"landscape"),l.unit||(l.unit="pt"),r.forEach(f=>{switch(f.type){case"header":i.push(p(f));break;case"group":n.push(p(f,a));break;case"calc":n.push(p(f,o));break;case"row":n.push(p(f));break}});function p(f,g){var m=[];return f.columns.forEach(b=>{var w;if(b){switch(typeof b.value){case"object":b.value=b.value!==null?JSON.stringify(b.value):"";break;case"undefined":b.value="";break}w={content:b.value,colSpan:b.width,rowSpan:b.height},g&&(w.styles=g),m.push(w)}}),m}c=this.dependencyRegistry.lookup("jspdf","jsPDF"),d=new c(l),e.autoTable&&(typeof e.autoTable=="function"?s=e.autoTable(d)||{}:s=e.autoTable),h&&(s.didDrawPage=function(f){d.text(h,40,30)}),s.head=i,s.body=n,d.autoTable(s),e.documentProcessing&&e.documentProcessing(d),t(d.output("arraybuffer"),"application/pdf")}function xw(r,e,t){var i=this,n=e.sheetName||"Sheet1",s=this.dependencyRegistry.lookup("XLSX"),a=s.utils.book_new(),o=new hi(this),l="compress"in e?e.compress:!0,h=e.writeOptions||{bookType:"xlsx",bookSST:!0,compression:l},c;h.type="binary",a.SheetNames=[],a.Sheets={};function d(){var g=[],m=[],b={},w={s:{c:0,r:0},e:{c:r[0]?r[0].columns.reduce((E,C)=>E+(C&&C.width?C.width:1),0):0,r:r.length}};return r.forEach((E,C)=>{var F=[];E.columns.forEach(function(L,D){L?(F.push(!(L.value instanceof Date)&&typeof L.value=="object"?JSON.stringify(L.value):L.value),(L.width>1||L.height>-1)&&(L.height>1||L.width>1)&&m.push({s:{r:C,c:D},e:{r:C+L.height-1,c:D+L.width-1}})):F.push("")}),g.push(F)}),s.utils.sheet_add_aoa(b,g),b["!ref"]=s.utils.encode_range(w),m.length&&(b["!merges"]=m),b}if(e.sheetOnly){t(d());return}if(e.sheets)for(var p in e.sheets)e.sheets[p]===!0?(a.SheetNames.push(p),a.Sheets[p]=d()):(a.SheetNames.push(p),o.commsSend(e.sheets[p],"download","intercept",{type:"xlsx",options:{sheetOnly:!0},active:i.active,intercept:function(g){a.Sheets[p]=g}}));else a.SheetNames.push(n),a.Sheets[n]=d();e.documentProcessing&&(a=e.documentProcessing(a));function f(g){for(var m=new ArrayBuffer(g.length),b=new Uint8Array(m),w=0;w!=g.length;++w)b[w]=g.charCodeAt(w)&255;return m}c=s.write(a,h),t(f(c),"application/octet-stream")}function yw(r,e,t){this.modExists("export",!0)&&t(this.modules.export.generateHTMLTable(r),"text/html")}function Ew(r,e,t){const i=[];r.forEach(n=>{const s={};switch(n.type){case"header":break;case"group":console.warn("Download Warning - JSON downloader cannot process row groups");break;case"calc":console.warn("Download Warning - JSON downloader cannot process column calculations");break;case"row":n.columns.forEach(a=>{a&&(s[a.component.getTitleDownload()||a.component.getField()]=a.value)}),i.push(JSON.stringify(s));break}}),t(i.join(`
`),"application/x-ndjson")}var Cw={csv:vw,json:bw,jsonLines:Ew,pdf:ww,xlsx:xw,html:yw};class Sc extends Dt{static moduleName="download";static downloaders=Cw;constructor(e){super(e),this.registerTableOption("downloadEncoder",function(t,i){return new Blob([t],{type:i})}),this.registerTableOption("downloadConfig",{}),this.registerTableOption("downloadRowRange","active"),this.registerColumnOption("download"),this.registerColumnOption("titleDownload")}initialize(){this.deprecatedOptionsCheck(),this.registerTableFunction("download",this.download.bind(this)),this.registerTableFunction("downloadToTab",this.downloadToTab.bind(this))}deprecatedOptionsCheck(){}downloadToTab(e,t,i,n){this.download(e,t,i,n,!0)}download(e,t,i,n,s){var a=!1;function o(h,c){s?s===!0?this.triggerDownload(h,c,e,t,!0):s(h):this.triggerDownload(h,c,e,t)}if(typeof e=="function"?a=e:Sc.downloaders[e]?a=Sc.downloaders[e]:console.warn("Download Error - No such download type found: ",e),a){var l=this.generateExportList(n);a.call(this.table,l,i||{},o.bind(this))}}generateExportList(e){var t=this.table.modules.export.generateExportList(this.table.options.downloadConfig,!1,e||this.table.options.downloadRowRange,"download"),i=this.table.options.groupHeaderDownload;return i&&!Array.isArray(i)&&(i=[i]),t.forEach(n=>{var s;n.type==="group"&&(s=n.columns[0],i&&i[n.indent]&&(s.value=i[n.indent](s.value,n.component._group.getRowCount(),n.component._group.getData(),n.component)))}),t}triggerDownload(e,t,i,n,s){var a=document.createElement("a"),o=this.table.options.downloadEncoder(e,t);o&&(s?window.open(window.URL.createObjectURL(o)):(n=n||"Tabulator."+(typeof i=="function"?"txt":i),navigator.msSaveOrOpenBlob?navigator.msSaveOrOpenBlob(o,n):(a.setAttribute("href",window.URL.createObjectURL(o)),a.setAttribute("download",n),a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a))),this.dispatchExternal("downloadComplete"))}commsReceived(e,t,i){switch(t){case"intercept":this.download(i.type,"",i.options,i.active,i.intercept);break}}}function Zc(r,e){var t=e.mask,i=typeof e.maskLetterChar<"u"?e.maskLetterChar:"A",n=typeof e.maskNumberChar<"u"?e.maskNumberChar:"9",s=typeof e.maskWildcardChar<"u"?e.maskWildcardChar:"*";function a(o){var l=t[o];typeof l<"u"&&l!==s&&l!==i&&l!==n&&(r.value=r.value+""+l,a(o+1))}r.addEventListener("keydown",o=>{var l=r.value.length,h=o.key;if(o.keyCode>46&&!o.ctrlKey&&!o.metaKey){if(l>=t.length)return o.preventDefault(),o.stopPropagation(),!1;switch(t[l]){case i:if(h.toUpperCase()==h.toLowerCase())return o.preventDefault(),o.stopPropagation(),!1;break;case n:if(isNaN(h))return o.preventDefault(),o.stopPropagation(),!1;break;case s:break;default:if(h!==t[l])return o.preventDefault(),o.stopPropagation(),!1}}}),r.addEventListener("keyup",o=>{o.keyCode>46&&e.maskAutoFill&&a(r.value.length)}),r.placeholder||(r.placeholder=t),e.maskAutoFill&&a(r.value.length)}function _w(r,e,t,i,n){var s=r.getValue(),a=document.createElement("input");if(a.setAttribute("type",n.search?"search":"text"),a.style.padding="4px",a.style.width="100%",a.style.boxSizing="border-box",n.elementAttributes&&typeof n.elementAttributes=="object")for(let l in n.elementAttributes)l.charAt(0)=="+"?(l=l.slice(1),a.setAttribute(l,a.getAttribute(l)+n.elementAttributes["+"+l])):a.setAttribute(l,n.elementAttributes[l]);a.value=typeof s<"u"?s:"",e(function(){r.getType()==="cell"&&(a.focus({preventScroll:!0}),a.style.height="100%",n.selectContents&&a.select())});function o(l){(s===null||typeof s>"u")&&a.value!==""||a.value!==s?t(a.value)&&(s=a.value):i()}return a.addEventListener("change",o),a.addEventListener("blur",o),a.addEventListener("keydown",function(l){switch(l.keyCode){case 13:o();break;case 27:i();break;case 35:case 36:l.stopPropagation();break}}),n.mask&&Zc(a,n),a}function kw(r,e,t,i,n){var s=r.getValue(),a=n.verticalNavigation||"hybrid",o=String(s!==null&&typeof s<"u"?s:""),l=document.createElement("textarea"),h=0;if(l.style.display="block",l.style.padding="2px",l.style.height="100%",l.style.width="100%",l.style.boxSizing="border-box",l.style.whiteSpace="pre-wrap",l.style.resize="none",n.elementAttributes&&typeof n.elementAttributes=="object")for(let d in n.elementAttributes)d.charAt(0)=="+"?(d=d.slice(1),l.setAttribute(d,l.getAttribute(d)+n.elementAttributes["+"+d])):l.setAttribute(d,n.elementAttributes[d]);l.value=o,e(function(){r.getType()==="cell"&&(l.focus({preventScroll:!0}),l.style.height="100%",l.scrollHeight,l.style.height=l.scrollHeight+"px",r.getRow().normalizeHeight(),n.selectContents&&l.select())});function c(d){(s===null||typeof s>"u")&&l.value!==""||l.value!==s?(t(l.value)&&(s=l.value),setTimeout(function(){r.getRow().normalizeHeight()},300)):i()}return l.addEventListener("change",c),l.addEventListener("blur",c),l.addEventListener("keyup",function(){l.style.height="";var d=l.scrollHeight;l.style.height=d+"px",d!=h&&(h=d,r.getRow().normalizeHeight())}),l.addEventListener("keydown",function(d){switch(d.keyCode){case 13:d.shiftKey&&n.shiftEnterSubmit&&c();break;case 27:i();break;case 38:(a=="editor"||a=="hybrid"&&l.selectionStart)&&(d.stopImmediatePropagation(),d.stopPropagation());break;case 40:(a=="editor"||a=="hybrid"&&l.selectionStart!==l.value.length)&&(d.stopImmediatePropagation(),d.stopPropagation());break;case 35:case 36:d.stopPropagation();break}}),n.mask&&Zc(l,n),l}function Sw(r,e,t,i,n){var s=r.getValue(),a=n.verticalNavigation||"editor",o=document.createElement("input");if(o.setAttribute("type","number"),typeof n.max<"u"&&o.setAttribute("max",n.max),typeof n.min<"u"&&o.setAttribute("min",n.min),typeof n.step<"u"&&o.setAttribute("step",n.step),o.style.padding="4px",o.style.width="100%",o.style.boxSizing="border-box",n.elementAttributes&&typeof n.elementAttributes=="object")for(let c in n.elementAttributes)c.charAt(0)=="+"?(c=c.slice(1),o.setAttribute(c,o.getAttribute(c)+n.elementAttributes["+"+c])):o.setAttribute(c,n.elementAttributes[c]);o.value=s;var l=function(c){h()};e(function(){r.getType()==="cell"&&(o.removeEventListener("blur",l),o.focus({preventScroll:!0}),o.style.height="100%",o.addEventListener("blur",l),n.selectContents&&o.select())});function h(){var c=o.value;!isNaN(c)&&c!==""&&(c=Number(c)),c!==s?t(c)&&(s=c):i()}return o.addEventListener("keydown",function(c){switch(c.keyCode){case 13:h();break;case 27:i();break;case 38:case 40:a=="editor"&&(c.stopImmediatePropagation(),c.stopPropagation());break;case 35:case 36:c.stopPropagation();break}}),n.mask&&Zc(o,n),o}function Tw(r,e,t,i,n){var s=r.getValue(),a=document.createElement("input");if(a.setAttribute("type","range"),typeof n.max<"u"&&a.setAttribute("max",n.max),typeof n.min<"u"&&a.setAttribute("min",n.min),typeof n.step<"u"&&a.setAttribute("step",n.step),a.style.padding="4px",a.style.width="100%",a.style.boxSizing="border-box",n.elementAttributes&&typeof n.elementAttributes=="object")for(let l in n.elementAttributes)l.charAt(0)=="+"?(l=l.slice(1),a.setAttribute(l,a.getAttribute(l)+n.elementAttributes["+"+l])):a.setAttribute(l,n.elementAttributes[l]);a.value=s,e(function(){r.getType()==="cell"&&(a.focus({preventScroll:!0}),a.style.height="100%")});function o(){var l=a.value;!isNaN(l)&&l!==""&&(l=Number(l)),l!=s?t(l)&&(s=l):i()}return a.addEventListener("blur",function(l){o()}),a.addEventListener("keydown",function(l){switch(l.keyCode){case 13:o();break;case 27:i();break}}),a}function Aw(r,e,t,i,n){var s=n.format,a=n.verticalNavigation||"editor",o=s?window.DateTime||luxon.DateTime:null,l=r.getValue(),h=document.createElement("input");function c(p){var f;return o.isDateTime(p)?f=p:s==="iso"?f=o.fromISO(String(p)):f=o.fromFormat(String(p),s),f.toFormat("yyyy-MM-dd")}if(h.type="date",h.style.padding="4px",h.style.width="100%",h.style.boxSizing="border-box",n.max&&h.setAttribute("max",s?c(n.max):n.max),n.min&&h.setAttribute("min",s?c(n.min):n.min),n.elementAttributes&&typeof n.elementAttributes=="object")for(let p in n.elementAttributes)p.charAt(0)=="+"?(p=p.slice(1),h.setAttribute(p,h.getAttribute(p)+n.elementAttributes["+"+p])):h.setAttribute(p,n.elementAttributes[p]);l=typeof l<"u"?l:"",s&&(o?l=c(l):console.error("Editor Error - 'date' editor 'format' param is dependant on luxon.js")),h.value=l,e(function(){r.getType()==="cell"&&(h.focus({preventScroll:!0}),h.style.height="100%",n.selectContents&&h.select())});function d(){var p=h.value,f;if((l===null||typeof l>"u")&&p!==""||p!==l){if(p&&s)switch(f=o.fromFormat(String(p),"yyyy-MM-dd"),s){case!0:p=f;break;case"iso":p=f.toISO();break;default:p=f.toFormat(s)}t(p)&&(l=h.value)}else i()}return h.addEventListener("blur",function(p){(p.relatedTarget||p.rangeParent||p.explicitOriginalTarget!==h)&&d()}),h.addEventListener("keydown",function(p){switch(p.keyCode){case 13:d();break;case 27:i();break;case 35:case 36:p.stopPropagation();break;case 38:case 40:a=="editor"&&(p.stopImmediatePropagation(),p.stopPropagation());break}}),h}function Fw(r,e,t,i,n){var s=n.format,a=n.verticalNavigation||"editor",o=s?window.DateTime||luxon.DateTime:null,l,h=r.getValue(),c=document.createElement("input");if(c.type="time",c.style.padding="4px",c.style.width="100%",c.style.boxSizing="border-box",n.elementAttributes&&typeof n.elementAttributes=="object")for(let p in n.elementAttributes)p.charAt(0)=="+"?(p=p.slice(1),c.setAttribute(p,c.getAttribute(p)+n.elementAttributes["+"+p])):c.setAttribute(p,n.elementAttributes[p]);h=typeof h<"u"?h:"",s&&(o?(o.isDateTime(h)?l=h:s==="iso"?l=o.fromISO(String(h)):l=o.fromFormat(String(h),s),h=l.toFormat("HH:mm")):console.error("Editor Error - 'date' editor 'format' param is dependant on luxon.js")),c.value=h,e(function(){r.getType()=="cell"&&(c.focus({preventScroll:!0}),c.style.height="100%",n.selectContents&&c.select())});function d(){var p=c.value,f;if((h===null||typeof h>"u")&&p!==""||p!==h){if(p&&s)switch(f=o.fromFormat(String(p),"hh:mm"),s){case!0:p=f;break;case"iso":p=f.toISO();break;default:p=f.toFormat(s)}t(p)&&(h=c.value)}else i()}return c.addEventListener("blur",function(p){(p.relatedTarget||p.rangeParent||p.explicitOriginalTarget!==c)&&d()}),c.addEventListener("keydown",function(p){switch(p.keyCode){case 13:d();break;case 27:i();break;case 35:case 36:p.stopPropagation();break;case 38:case 40:a=="editor"&&(p.stopImmediatePropagation(),p.stopPropagation());break}}),c}function Rw(r,e,t,i,n){var s=n.format,a=n.verticalNavigation||"editor",o=s?this.table.dependencyRegistry.lookup(["luxon","DateTime"],"DateTime"):null,l,h=r.getValue(),c=document.createElement("input");if(c.type="datetime-local",c.style.padding="4px",c.style.width="100%",c.style.boxSizing="border-box",n.elementAttributes&&typeof n.elementAttributes=="object")for(let p in n.elementAttributes)p.charAt(0)=="+"?(p=p.slice(1),c.setAttribute(p,c.getAttribute(p)+n.elementAttributes["+"+p])):c.setAttribute(p,n.elementAttributes[p]);h=typeof h<"u"?h:"",s&&(o?(o.isDateTime(h)?l=h:s==="iso"?l=o.fromISO(String(h)):l=o.fromFormat(String(h),s),h=l.toFormat("yyyy-MM-dd")+"T"+l.toFormat("HH:mm")):console.error("Editor Error - 'date' editor 'format' param is dependant on luxon.js")),c.value=h,e(function(){r.getType()==="cell"&&(c.focus({preventScroll:!0}),c.style.height="100%",n.selectContents&&c.select())});function d(){var p=c.value,f;if((h===null||typeof h>"u")&&p!==""||p!==h){if(p&&s)switch(f=o.fromISO(String(p)),s){case!0:p=f;break;case"iso":p=f.toISO();break;default:p=f.toFormat(s)}t(p)&&(h=c.value)}else i()}return c.addEventListener("blur",function(p){(p.relatedTarget||p.rangeParent||p.explicitOriginalTarget!==c)&&d()}),c.addEventListener("keydown",function(p){switch(p.keyCode){case 13:d();break;case 27:i();break;case 35:case 36:p.stopPropagation();break;case 38:case 40:a=="editor"&&(p.stopImmediatePropagation(),p.stopPropagation());break}}),c}let Lw=class{constructor(e,t,i,n,s,a){this.edit=e,this.table=e.table,this.cell=t,this.params=this._initializeParams(a),this.data=[],this.displayItems=[],this.currentItems=[],this.focusedItem=null,this.input=this._createInputElement(),this.listEl=this._createListElement(),this.initialValues=null,this.isFilter=t.getType()==="header",this.filterTimeout=null,this.filtered=!1,this.typing=!1,this.values=[],this.popup=null,this.listIteration=0,this.lastAction="",this.filterTerm="",this.blurable=!0,this.actions={success:n,cancel:s},this._deprecatedOptionsCheck(),this._initializeValue(),i(this._onRendered.bind(this))}_deprecatedOptionsCheck(){}_initializeValue(){var e=this.cell.getValue();typeof e>"u"&&typeof this.params.defaultValue<"u"&&(e=this.params.defaultValue),this.initialValues=this.params.multiselect?e:[e],this.isFilter&&(this.input.value=this.initialValues?this.initialValues.join(","):"",this.headerFilterInitialListGen())}_onRendered(){var e=this.cell.getElement();function t(i){i.stopPropagation()}this.isFilter||(this.input.style.height="100%",this.input.focus({preventScroll:!0})),e.addEventListener("click",t),setTimeout(()=>{e.removeEventListener("click",t)},1e3),this.input.addEventListener("mousedown",this._preventPopupBlur.bind(this))}_createListElement(){var e=document.createElement("div");return e.classList.add("tabulator-edit-list"),e.addEventListener("mousedown",this._preventBlur.bind(this)),e.addEventListener("keydown",this._inputKeyDown.bind(this)),e}_setListWidth(){var e=this.isFilter?this.input:this.cell.getElement();this.listEl.style.minWidth=e.offsetWidth+"px",this.params.maxWidth&&(this.params.maxWidth===!0?this.listEl.style.maxWidth=e.offsetWidth+"px":typeof this.params.maxWidth=="number"?this.listEl.style.maxWidth=this.params.maxWidth+"px":this.listEl.style.maxWidth=this.params.maxWidth)}_createInputElement(){var e=this.params.elementAttributes,t=document.createElement("input");if(t.setAttribute("type",this.params.clearable?"search":"text"),t.style.padding="4px",t.style.width="100%",t.style.boxSizing="border-box",this.params.autocomplete||(t.style.cursor="default",t.style.caretColor="transparent"),e&&typeof e=="object")for(let i in e)i.charAt(0)=="+"?(i=i.slice(1),t.setAttribute(i,t.getAttribute(i)+e["+"+i])):t.setAttribute(i,e[i]);return this.params.mask&&Zc(t,this.params),this._bindInputEvents(t),t}_initializeParams(e){var t=["values","valuesURL","valuesLookup"],i;return e=Object.assign({},e),e.verticalNavigation=e.verticalNavigation||"editor",e.placeholderLoading=typeof e.placeholderLoading>"u"?"Searching ...":e.placeholderLoading,e.placeholderEmpty=typeof e.placeholderEmpty>"u"?"No Results Found":e.placeholderEmpty,e.filterDelay=typeof e.filterDelay>"u"?300:e.filterDelay,e.emptyValue=Object.keys(e).includes("emptyValue")?e.emptyValue:"",i=Object.keys(e).filter(n=>t.includes(n)).length,i?i>1&&console.warn("list editor config error - only one of the values, valuesURL, or valuesLookup options can be set on the same editor"):console.warn("list editor config error - either the values, valuesURL, or valuesLookup option must be set"),e.autocomplete?e.multiselect&&(e.multiselect=!1,console.warn("list editor config error - multiselect option is not available when autocomplete is enabled")):(e.freetext&&(e.freetext=!1,console.warn("list editor config error - freetext option is only available when autocomplete is enabled")),e.filterFunc&&(e.filterFunc=!1,console.warn("list editor config error - filterFunc option is only available when autocomplete is enabled")),e.filterRemote&&(e.filterRemote=!1,console.warn("list editor config error - filterRemote option is only available when autocomplete is enabled")),e.mask&&(e.mask=!1,console.warn("list editor config error - mask option is only available when autocomplete is enabled")),e.allowEmpty&&(e.allowEmpty=!1,console.warn("list editor config error - allowEmpty option is only available when autocomplete is enabled")),e.listOnEmpty&&(e.listOnEmpty=!1,console.warn("list editor config error - listOnEmpty option is only available when autocomplete is enabled"))),e.filterRemote&&!(typeof e.valuesLookup=="function"||e.valuesURL)&&(e.filterRemote=!1,console.warn("list editor config error - filterRemote option should only be used when values list is populated from a remote source")),e}_bindInputEvents(e){e.addEventListener("focus",this._inputFocus.bind(this)),e.addEventListener("click",this._inputClick.bind(this)),e.addEventListener("blur",this._inputBlur.bind(this)),e.addEventListener("keydown",this._inputKeyDown.bind(this)),e.addEventListener("search",this._inputSearch.bind(this)),this.params.autocomplete&&e.addEventListener("keyup",this._inputKeyUp.bind(this))}_inputFocus(e){this.rebuildOptionsList()}_filter(){this.params.filterRemote?(clearTimeout(this.filterTimeout),this.filterTimeout=setTimeout(()=>{this.rebuildOptionsList()},this.params.filterDelay)):this._filterList()}_inputClick(e){e.stopPropagation()}_inputBlur(e){this.blurable&&(this.popup?this.popup.hide():this._resolveValue(!0))}_inputSearch(){this._clearChoices()}_inputKeyDown(e){switch(e.keyCode){case 38:this._keyUp(e);break;case 40:this._keyDown(e);break;case 37:case 39:this._keySide(e);break;case 13:this._keyEnter();break;case 27:this._keyEsc();break;case 36:case 35:this._keyHomeEnd(e);break;case 9:this._keyTab(e);break;default:this._keySelectLetter(e)}}_inputKeyUp(e){switch(e.keyCode){case 38:case 37:case 39:case 40:case 13:case 27:break;default:this._keyAutoCompLetter(e)}}_preventPopupBlur(){this.popup&&this.popup.blockHide(),setTimeout(()=>{this.popup&&this.popup.restoreHide()},10)}_preventBlur(){this.blurable=!1,setTimeout(()=>{this.blurable=!0},10)}_keyTab(e){this.params.autocomplete&&this.lastAction==="typing"?this._resolveValue(!0):this.focusedItem&&this._chooseItem(this.focusedItem,!0)}_keyUp(e){var t=this.displayItems.indexOf(this.focusedItem);(this.params.verticalNavigation=="editor"||this.params.verticalNavigation=="hybrid"&&t)&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),t>0&&this._focusItem(this.displayItems[t-1]))}_keyDown(e){var t=this.displayItems.indexOf(this.focusedItem);(this.params.verticalNavigation=="editor"||this.params.verticalNavigation=="hybrid"&&t<this.displayItems.length-1)&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),t<this.displayItems.length-1&&(t==-1?this._focusItem(this.displayItems[0]):this._focusItem(this.displayItems[t+1])))}_keySide(e){this.params.autocomplete||(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault())}_keyEnter(e){this.params.autocomplete&&this.lastAction==="typing"?this._resolveValue(!0):this.focusedItem&&this._chooseItem(this.focusedItem)}_keyEsc(e){this._cancel()}_keyHomeEnd(e){this.params.autocomplete&&e.stopImmediatePropagation()}_keySelectLetter(e){this.params.autocomplete||(e.preventDefault(),e.keyCode>=38&&e.keyCode<=90&&this._scrollToValue(e.keyCode))}_keyAutoCompLetter(e){this._filter(),this.lastAction="typing",this.typing=!0}_scrollToValue(e){clearTimeout(this.filterTimeout);var t=String.fromCharCode(e).toLowerCase();this.filterTerm+=t.toLowerCase();var i=this.displayItems.find(n=>typeof n.label<"u"&&n.label.toLowerCase().startsWith(this.filterTerm));i&&this._focusItem(i),this.filterTimeout=setTimeout(()=>{this.filterTerm=""},800)}_focusItem(e){this.lastAction="focus",this.focusedItem&&this.focusedItem.element&&this.focusedItem.element.classList.remove("focused"),this.focusedItem=e,e&&e.element&&(e.element.classList.add("focused"),e.element.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}))}headerFilterInitialListGen(){this._generateOptions(!0)}rebuildOptionsList(){this._generateOptions().then(this._sortOptions.bind(this)).then(this._buildList.bind(this)).then(this._showList.bind(this)).catch(e=>{Number.isInteger(e)||console.error("List generation error",e)})}_filterList(){this._buildList(this._filterOptions()),this._showList()}_generateOptions(e){var t=[],i=++this.listIteration;return this.filtered=!1,this.params.values?t=this.params.values:this.params.valuesURL?t=this._ajaxRequest(this.params.valuesURL,this.input.value):typeof this.params.valuesLookup=="function"?t=this.params.valuesLookup(this.cell,this.input.value):this.params.valuesLookup&&(t=this._uniqueColumnValues(this.params.valuesLookupField)),t instanceof Promise?(e||this._addPlaceholder(this.params.placeholderLoading),t.then().then(n=>this.listIteration===i?this._parseList(n):Promise.reject(i))):Promise.resolve(this._parseList(t))}_addPlaceholder(e){var t=document.createElement("div");typeof e=="function"&&(e=e(this.cell.getComponent(),this.listEl)),e&&(this._clearList(),e instanceof HTMLElement?t=e:(t.classList.add("tabulator-edit-list-placeholder"),t.innerHTML=e),this.listEl.appendChild(t),this._showList())}_ajaxRequest(e,t){var i=this.params.filterRemote?{term:t}:{};return e=cg(e,{},i),fetch(e).then(n=>n.ok?n.json().catch(s=>(console.warn("List Ajax Load Error - Invalid JSON returned",s),Promise.reject(s))):(console.error("List Ajax Load Error - Connection Error: "+n.status,n.statusText),Promise.reject(n))).catch(n=>(console.error("List Ajax Load Error - Connection Error: ",n),Promise.reject(n)))}_uniqueColumnValues(e){var t={},i=this.table.getData(this.params.valuesLookup),n;return e?n=this.table.columnManager.getColumnByField(e):n=this.cell.getColumn()._getSelf(),n?i.forEach(s=>{var a=n.getFieldValue(s);this._emptyValueCheck(a)||(this.params.multiselect&&Array.isArray(a)?a.forEach(o=>{this._emptyValueCheck(o)||(t[o]=!0)}):t[a]=!0)}):(console.warn("unable to find matching column to create select lookup list:",e),t=[]),Object.keys(t)}_emptyValueCheck(e){return e===null||typeof e>"u"||e===""}_parseList(e){var t=[];return Array.isArray(e)||(e=Object.entries(e).map(([i,n])=>({label:n,value:i}))),e.forEach(i=>{typeof i!="object"&&(i={label:i,value:i}),this._parseListItem(i,t,0)}),!this.currentItems.length&&this.params.freetext&&(this.input.value=this.initialValues,this.typing=!0,this.lastAction="typing"),this.data=t,t}_parseListItem(e,t,i){var n={};e.options?n=this._parseListGroup(e,i+1):(n={label:e.label,value:e.value,itemParams:e.itemParams,elementAttributes:e.elementAttributes,element:!1,selected:!1,visible:!0,level:i,original:e},this.initialValues&&this.initialValues.indexOf(e.value)>-1&&this._chooseItem(n,!0)),t.push(n)}_parseListGroup(e,t){var i={label:e.label,group:!0,itemParams:e.itemParams,elementAttributes:e.elementAttributes,element:!1,visible:!0,level:t,options:[],original:e};return e.options.forEach(n=>{this._parseListItem(n,i.options,t)}),i}_sortOptions(e){var t;return this.params.sort&&(t=typeof this.params.sort=="function"?this.params.sort:this._defaultSortFunction.bind(this),this._sortGroup(t,e)),e}_sortGroup(e,t){t.sort((i,n)=>e(i.label,n.label,i.value,n.value,i.original,n.original)),t.forEach(i=>{i.group&&this._sortGroup(e,i.options)})}_defaultSortFunction(e,t){var i,n,s,a,o=0,l,h=/(\d+)|(\D+)/g,c=/\d/,d=0;if(this.params.sort==="desc"&&([e,t]=[t,e]),!e&&e!==0)d=!t&&t!==0?0:-1;else if(!t&&t!==0)d=1;else{if(isFinite(e)&&isFinite(t))return e-t;if(i=String(e).toLowerCase(),n=String(t).toLowerCase(),i===n)return 0;if(!(c.test(i)&&c.test(n)))return i>n?1:-1;for(i=i.match(h),n=n.match(h),l=i.length>n.length?n.length:i.length;o<l;)if(s=i[o],a=n[o++],s!==a)return isFinite(s)&&isFinite(a)?(s.charAt(0)==="0"&&(s="."+s),a.charAt(0)==="0"&&(a="."+a),s-a):s>a?1:-1;return i.length>n.length}return d}_filterOptions(){var e=this.params.filterFunc||this._defaultFilterFunc,t=this.input.value;return t?(this.filtered=!0,this.data.forEach(i=>{this._filterItem(e,t,i)})):this.filtered=!1,this.data}_filterItem(e,t,i){var n=!1;return i.group?(i.options.forEach(s=>{this._filterItem(e,t,s)&&(n=!0)}),i.visible=n):i.visible=e(t,i.label,i.value,i.original),i.visible}_defaultFilterFunc(e,t,i,n){return e=String(e).toLowerCase(),t!==null&&typeof t<"u"&&(String(t).toLowerCase().indexOf(e)>-1||String(i).toLowerCase().indexOf(e)>-1)}_clearList(){for(;this.listEl.firstChild;)this.listEl.removeChild(this.listEl.firstChild);this.displayItems=[]}_buildList(e){this._clearList(),e.forEach(t=>{this._buildItem(t)}),this.displayItems.length||this._addPlaceholder(this.params.placeholderEmpty)}_buildItem(e){var t=e.element,i;if(!this.filtered||e.visible){if(!t){if(t=document.createElement("div"),t.tabIndex=0,i=this.params.itemFormatter?this.params.itemFormatter(e.label,e.value,e.original,t):e.label,i instanceof HTMLElement?t.appendChild(i):t.innerHTML=i,e.group?t.classList.add("tabulator-edit-list-group"):t.classList.add("tabulator-edit-list-item"),t.classList.add("tabulator-edit-list-group-level-"+e.level),e.elementAttributes&&typeof e.elementAttributes=="object")for(let n in e.elementAttributes)n.charAt(0)=="+"?(n=n.slice(1),t.setAttribute(n,this.input.getAttribute(n)+e.elementAttributes["+"+n])):t.setAttribute(n,e.elementAttributes[n]);e.group?t.addEventListener("click",this._groupClick.bind(this,e)):t.addEventListener("click",this._itemClick.bind(this,e)),t.addEventListener("mousedown",this._preventBlur.bind(this)),e.element=t}this._styleItem(e),this.listEl.appendChild(t),e.group?e.options.forEach(n=>{this._buildItem(n)}):this.displayItems.push(e)}}_showList(){var e=this.popup&&this.popup.isVisible();if(this.input.parentNode){if(this.params.autocomplete&&this.input.value===""&&!this.params.listOnEmpty){this.popup&&this.popup.hide(!0);return}this._setListWidth(),this.popup||(this.popup=this.edit.popup(this.listEl)),this.popup.show(this.cell.getElement(),"bottom"),e||setTimeout(()=>{this.popup.hideOnBlur(this._resolveValue.bind(this,!0))},10)}}_styleItem(e){e&&e.element&&(e.selected?e.element.classList.add("active"):e.element.classList.remove("active"))}_itemClick(e,t){t.stopPropagation(),this._chooseItem(e)}_groupClick(e,t){t.stopPropagation()}_cancel(){this.popup.hide(!0),this.actions.cancel()}_clearChoices(){this.typing=!0,this.currentItems.forEach(e=>{e.selected=!1,this._styleItem(e)}),this.currentItems=[],this.focusedItem=null}_chooseItem(e,t){var i;this.typing=!1,this.params.multiselect?(i=this.currentItems.indexOf(e),i>-1?(this.currentItems.splice(i,1),e.selected=!1):(this.currentItems.push(e),e.selected=!0),this.input.value=this.currentItems.map(n=>n.label).join(","),this._styleItem(e)):(this.currentItems=[e],e.selected=!0,this.input.value=e.label,this._styleItem(e),t||this._resolveValue()),this._focusItem(e)}_resolveValue(e){var t,i;if(this.popup&&this.popup.hide(!0),this.params.multiselect)t=this.currentItems.map(n=>n.value);else if(e&&this.params.autocomplete&&this.typing)if(this.params.freetext||this.params.allowEmpty&&this.input.value==="")t=this.input.value;else{this.actions.cancel();return}else this.currentItems[0]?t=this.currentItems[0].value:(i=Array.isArray(this.initialValues)?this.initialValues[0]:this.initialValues,i===null||typeof i>"u"||i===""?t=i:t=this.params.emptyValue);t===""&&(t=this.params.emptyValue),this.actions.success(t),this.isFilter&&(this.initialValues=t&&!Array.isArray(t)?[t]:t,this.currentItems=[])}};function Nw(r,e,t,i,n){var s=new Lw(this,r,e,t,i,n);return s.input}function Pw(r,e,t,i,n){var s=this,a=r.getElement(),o=r.getValue(),l=a.getElementsByTagName("svg").length||5,h=a.getElementsByTagName("svg")[0]?a.getElementsByTagName("svg")[0].getAttribute("width"):14,c=[],d=document.createElement("div"),p=document.createElementNS("http://www.w3.org/2000/svg","svg");function f(w){c.forEach(function(E,C){C<w?(s.table.browser=="ie"?E.setAttribute("class","tabulator-star-active"):E.classList.replace("tabulator-star-inactive","tabulator-star-active"),E.innerHTML='<polygon fill="#488CE9" stroke="#014AAE" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>'):(s.table.browser=="ie"?E.setAttribute("class","tabulator-star-inactive"):E.classList.replace("tabulator-star-active","tabulator-star-inactive"),E.innerHTML='<polygon fill="#010155" stroke="#686868" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>')})}function g(w){var E=document.createElement("span"),C=p.cloneNode(!0);c.push(C),E.addEventListener("mouseenter",function(F){F.stopPropagation(),F.stopImmediatePropagation(),f(w)}),E.addEventListener("mousemove",function(F){F.stopPropagation(),F.stopImmediatePropagation()}),E.addEventListener("click",function(F){F.stopPropagation(),F.stopImmediatePropagation(),t(w),a.blur()}),E.appendChild(C),d.appendChild(E)}function m(w){o=w,f(w)}if(a.style.whiteSpace="nowrap",a.style.overflow="hidden",a.style.textOverflow="ellipsis",d.style.verticalAlign="middle",d.style.display="inline-block",d.style.padding="4px",p.setAttribute("width",h),p.setAttribute("height",h),p.setAttribute("viewBox","0 0 512 512"),p.setAttribute("xml:space","preserve"),p.style.padding="0 1px",n.elementAttributes&&typeof n.elementAttributes=="object")for(let w in n.elementAttributes)w.charAt(0)=="+"?(w=w.slice(1),d.setAttribute(w,d.getAttribute(w)+n.elementAttributes["+"+w])):d.setAttribute(w,n.elementAttributes[w]);for(var b=1;b<=l;b++)g(b);return o=Math.min(parseInt(o),l),f(o),d.addEventListener("mousemove",function(w){f(0)}),d.addEventListener("click",function(w){t(0)}),a.addEventListener("blur",function(w){i()}),a.addEventListener("keydown",function(w){switch(w.keyCode){case 39:m(o+1);break;case 37:m(o-1);break;case 13:t(o);break;case 27:i();break}}),d}function Dw(r,e,t,i,n){var s=r.getElement(),a=typeof n.max>"u"?s.getElementsByTagName("div")[0]&&s.getElementsByTagName("div")[0].getAttribute("max")||100:n.max,o=typeof n.min>"u"?s.getElementsByTagName("div")[0]&&s.getElementsByTagName("div")[0].getAttribute("min")||0:n.min,l=(a-o)/100,h=r.getValue()||0,c=document.createElement("div"),d=document.createElement("div"),p,f;function g(){var m=window.getComputedStyle(s,null),b=l*Math.round(d.offsetWidth/((s.clientWidth-parseInt(m.getPropertyValue("padding-left"))-parseInt(m.getPropertyValue("padding-right")))/100))+o;t(b),s.setAttribute("aria-valuenow",b),s.setAttribute("aria-label",h)}if(c.style.position="absolute",c.style.right="0",c.style.top="0",c.style.bottom="0",c.style.width="5px",c.classList.add("tabulator-progress-handle"),d.style.display="inline-block",d.style.position="relative",d.style.height="100%",d.style.backgroundColor="#488CE9",d.style.maxWidth="100%",d.style.minWidth="0%",n.elementAttributes&&typeof n.elementAttributes=="object")for(let m in n.elementAttributes)m.charAt(0)=="+"?(m=m.slice(1),d.setAttribute(m,d.getAttribute(m)+n.elementAttributes["+"+m])):d.setAttribute(m,n.elementAttributes[m]);return s.style.padding="4px 4px",h=Math.min(parseFloat(h),a),h=Math.max(parseFloat(h),o),h=Math.round((h-o)/l),d.style.width=h+"%",s.setAttribute("aria-valuemin",o),s.setAttribute("aria-valuemax",a),d.appendChild(c),c.addEventListener("mousedown",function(m){p=m.screenX,f=d.offsetWidth}),c.addEventListener("mouseover",function(){c.style.cursor="ew-resize"}),s.addEventListener("mousemove",function(m){p&&(d.style.width=f+m.screenX-p+"px")}),s.addEventListener("mouseup",function(m){p&&(m.stopPropagation(),m.stopImmediatePropagation(),p=!1,f=!1,g())}),s.addEventListener("keydown",function(m){switch(m.keyCode){case 39:m.preventDefault(),d.style.width=d.clientWidth+s.clientWidth/100+"px";break;case 37:m.preventDefault(),d.style.width=d.clientWidth-s.clientWidth/100+"px";break;case 9:case 13:g();break;case 27:i();break}}),s.addEventListener("blur",function(){i()}),d}function Mw(r,e,t,i,n){var s=r.getValue(),a=document.createElement("input"),o=n.tristate,l=typeof n.indeterminateValue>"u"?null:n.indeterminateValue,h=!1,c=Object.keys(n).includes("trueValue"),d=Object.keys(n).includes("falseValue");if(a.setAttribute("type","checkbox"),a.style.marginTop="5px",a.style.boxSizing="border-box",n.elementAttributes&&typeof n.elementAttributes=="object")for(let f in n.elementAttributes)f.charAt(0)=="+"?(f=f.slice(1),a.setAttribute(f,a.getAttribute(f)+n.elementAttributes["+"+f])):a.setAttribute(f,n.elementAttributes[f]);a.value=s,o&&(typeof s>"u"||s===l||s==="")&&(h=!0,a.indeterminate=!0),this.table.browser!="firefox"&&this.table.browser!="safari"&&e(function(){r.getType()==="cell"&&a.focus({preventScroll:!0})}),a.checked=c?s===n.trueValue:s===!0||s==="true"||s==="True"||s===1;function p(f){var g=a.checked;return c&&g?g=n.trueValue:d&&!g&&(g=n.falseValue),o?f?h?l:g:a.checked&&!h?(a.checked=!1,a.indeterminate=!0,h=!0,l):(h=!1,g):g}return a.addEventListener("change",function(f){t(p())}),a.addEventListener("blur",function(f){t(p(!0))}),a.addEventListener("keydown",function(f){f.keyCode==13&&t(p()),f.keyCode==27&&i()}),a}function Ow(r,e,t,i,n){var s=r._getSelf().column,a,o,l;function h(c){var d=c.getValue(),p="input";switch(typeof d){case"number":p="number";break;case"boolean":p="tickCross";break;case"string":d.includes(`
`)&&(p="textarea");break}return p}return a=n.editorLookup?n.editorLookup(r):h(r),n.paramsLookup&&(l=typeof n.paramsLookup=="function"?n.paramsLookup(a,r):n.paramsLookup[a]),o=this.table.modules.edit.lookupEditor(a,s),o.call(this,r,e,t,i,l||{})}var Iw={input:_w,textarea:kw,number:Sw,range:Tw,date:Aw,time:Fw,datetime:Rw,list:Nw,star:Pw,progress:Dw,tickCross:Mw,adaptable:Ow};class hd extends Dt{static moduleName="edit";static editors=Iw;constructor(e){super(e),this.currentCell=!1,this.mouseClick=!1,this.recursionBlock=!1,this.invalidEdit=!1,this.editedCells=[],this.convertEmptyValues=!1,this.editors=hd.editors,this.registerTableOption("editTriggerEvent","focus"),this.registerTableOption("editorEmptyValue"),this.registerTableOption("editorEmptyValueFunc",this.emptyValueCheck.bind(this)),this.registerColumnOption("editable"),this.registerColumnOption("editor"),this.registerColumnOption("editorParams"),this.registerColumnOption("editorEmptyValue"),this.registerColumnOption("editorEmptyValueFunc"),this.registerColumnOption("cellEditing"),this.registerColumnOption("cellEdited"),this.registerColumnOption("cellEditCancelled"),this.registerTableFunction("getEditedCells",this.getEditedCells.bind(this)),this.registerTableFunction("clearCellEdited",this.clearCellEdited.bind(this)),this.registerTableFunction("navigatePrev",this.navigatePrev.bind(this)),this.registerTableFunction("navigateNext",this.navigateNext.bind(this)),this.registerTableFunction("navigateLeft",this.navigateLeft.bind(this)),this.registerTableFunction("navigateRight",this.navigateRight.bind(this)),this.registerTableFunction("navigateUp",this.navigateUp.bind(this)),this.registerTableFunction("navigateDown",this.navigateDown.bind(this)),this.registerComponentFunction("cell","isEdited",this.cellIsEdited.bind(this)),this.registerComponentFunction("cell","clearEdited",this.clearEdited.bind(this)),this.registerComponentFunction("cell","edit",this.editCell.bind(this)),this.registerComponentFunction("cell","cancelEdit",this.cellCancelEdit.bind(this)),this.registerComponentFunction("cell","navigatePrev",this.navigatePrev.bind(this)),this.registerComponentFunction("cell","navigateNext",this.navigateNext.bind(this)),this.registerComponentFunction("cell","navigateLeft",this.navigateLeft.bind(this)),this.registerComponentFunction("cell","navigateRight",this.navigateRight.bind(this)),this.registerComponentFunction("cell","navigateUp",this.navigateUp.bind(this)),this.registerComponentFunction("cell","navigateDown",this.navigateDown.bind(this))}initialize(){this.subscribe("cell-init",this.bindEditor.bind(this)),this.subscribe("cell-delete",this.clearEdited.bind(this)),this.subscribe("cell-value-changed",this.updateCellClass.bind(this)),this.subscribe("column-layout",this.initializeColumnCheck.bind(this)),this.subscribe("column-delete",this.columnDeleteCheck.bind(this)),this.subscribe("row-deleting",this.rowDeleteCheck.bind(this)),this.subscribe("row-layout",this.rowEditableCheck.bind(this)),this.subscribe("data-refreshing",this.cancelEdit.bind(this)),this.subscribe("clipboard-paste",this.pasteBlocker.bind(this)),this.subscribe("keybinding-nav-prev",this.navigatePrev.bind(this,void 0)),this.subscribe("keybinding-nav-next",this.keybindingNavigateNext.bind(this)),this.subscribe("keybinding-nav-up",this.navigateUp.bind(this,void 0)),this.subscribe("keybinding-nav-down",this.navigateDown.bind(this,void 0)),Object.keys(this.table.options).includes("editorEmptyValue")&&(this.convertEmptyValues=!0)}pasteBlocker(e){if(this.currentCell)return!0}keybindingNavigateNext(e){var t=this.currentCell,i=this.options("tabEndNewRow");t&&(this.navigateNext(t,e)||i&&(t.getElement().firstChild.blur(),this.invalidEdit||(i===!0?i=this.table.addRow({}):typeof i=="function"?i=this.table.addRow(i(t.row.getComponent())):i=this.table.addRow(Object.assign({},i)),i.then(()=>{setTimeout(()=>{t.getComponent().navigateNext()})}))))}cellIsEdited(e){return!!e.modules.edit&&e.modules.edit.edited}cellCancelEdit(e){e===this.currentCell?this.table.modules.edit.cancelEdit():console.warn("Cancel Editor Error - This cell is not currently being edited ")}updateCellClass(e){this.allowEdit(e)?e.getElement().classList.add("tabulator-editable"):e.getElement().classList.remove("tabulator-editable")}clearCellEdited(e){e||(e=this.table.modules.edit.getEditedCells()),Array.isArray(e)||(e=[e]),e.forEach(t=>{this.table.modules.edit.clearEdited(t._getSelf())})}navigatePrev(e=this.currentCell,t){var i,n;if(e){if(t&&t.preventDefault(),i=this.navigateLeft(),i)return!0;if(n=this.table.rowManager.prevDisplayRow(e.row,!0),n&&(i=this.findPrevEditableCell(n,n.cells.length),i))return i.getComponent().edit(),!0}return!1}navigateNext(e=this.currentCell,t){var i,n;if(e){if(t&&t.preventDefault(),i=this.navigateRight(),i)return!0;if(n=this.table.rowManager.nextDisplayRow(e.row,!0),n&&(i=this.findNextEditableCell(n,-1),i))return i.getComponent().edit(),!0}return!1}navigateLeft(e=this.currentCell,t){var i,n;return e&&(t&&t.preventDefault(),i=e.getIndex(),n=this.findPrevEditableCell(e.row,i),n)?(n.getComponent().edit(),!0):!1}navigateRight(e=this.currentCell,t){var i,n;return e&&(t&&t.preventDefault(),i=e.getIndex(),n=this.findNextEditableCell(e.row,i),n)?(n.getComponent().edit(),!0):!1}navigateUp(e=this.currentCell,t){var i,n;return e&&(t&&t.preventDefault(),i=e.getIndex(),n=this.table.rowManager.prevDisplayRow(e.row,!0),n)?(n.cells[i].getComponent().edit(),!0):!1}navigateDown(e=this.currentCell,t){var i,n;return e&&(t&&t.preventDefault(),i=e.getIndex(),n=this.table.rowManager.nextDisplayRow(e.row,!0),n)?(n.cells[i].getComponent().edit(),!0):!1}findNextEditableCell(e,t){var i=!1;if(t<e.cells.length-1)for(var n=t+1;n<e.cells.length;n++){let s=e.cells[n];if(s.column.modules.edit&&hr.elVisible(s.getElement())&&this.allowEdit(s)){i=s;break}}return i}findPrevEditableCell(e,t){var i=!1;if(t>0)for(var n=t-1;n>=0;n--){let s=e.cells[n];if(s.column.modules.edit&&hr.elVisible(s.getElement())&&this.allowEdit(s)){i=s;break}}return i}initializeColumnCheck(e){typeof e.definition.editor<"u"&&this.initializeColumn(e)}columnDeleteCheck(e){this.currentCell&&this.currentCell.column===e&&this.cancelEdit()}rowDeleteCheck(e){this.currentCell&&this.currentCell.row===e&&this.cancelEdit()}rowEditableCheck(e){e.getCells().forEach(t=>{t.column.modules.edit&&typeof t.column.modules.edit.check=="function"&&this.updateCellClass(t)})}initializeColumn(e){var t=Object.keys(e.definition).includes("editorEmptyValue"),i={editor:!1,blocked:!1,check:e.definition.editable,params:e.definition.editorParams||{},convertEmptyValues:t,editorEmptyValue:e.definition.editorEmptyValue,editorEmptyValueFunc:e.definition.editorEmptyValueFunc};i.editor=this.lookupEditor(e.definition.editor,e),i.editor&&(e.modules.edit=i)}lookupEditor(e,t){var i;switch(typeof e){case"string":this.editors[e]?i=this.editors[e]:console.warn("Editor Error - No such editor found: ",e);break;case"function":i=e;break;case"boolean":e===!0&&(typeof t.definition.formatter!="function"?this.editors[t.definition.formatter]?i=this.editors[t.definition.formatter]:i=this.editors.input:console.warn("Editor Error - Cannot auto lookup editor for a custom formatter: ",t.definition.formatter));break}return i}getCurrentCell(){return this.currentCell?this.currentCell.getComponent():!1}clearEditor(e){var t=this.currentCell,i;if(this.invalidEdit=!1,t){for(this.currentCell=!1,i=t.getElement(),this.dispatch("edit-editor-clear",t,e),i.classList.remove("tabulator-editing");i.firstChild;)i.removeChild(i.firstChild);t.row.getElement().classList.remove("tabulator-editing"),t.table.element.classList.remove("tabulator-editing")}}cancelEdit(){if(this.currentCell){var e=this.currentCell,t=this.currentCell.getComponent();this.clearEditor(!0),e.setValueActual(e.getValue()),e.cellRendered(),(e.column.definition.editor=="textarea"||e.column.definition.variableHeight)&&e.row.normalizeHeight(!0),e.column.definition.cellEditCancelled&&e.column.definition.cellEditCancelled.call(this.table,t),this.dispatch("edit-cancelled",e),this.dispatchExternal("cellEditCancelled",t)}}bindEditor(e){if(e.column.modules.edit){var t=this,i=e.getElement(!0);this.updateCellClass(e),i.setAttribute("tabindex",0),i.addEventListener("mousedown",function(n){n.button===2?n.preventDefault():t.mouseClick=!0}),this.options("editTriggerEvent")==="dblclick"&&i.addEventListener("dblclick",function(n){i.classList.contains("tabulator-editing")||(i.focus({preventScroll:!0}),t.edit(e,n,!1))}),(this.options("editTriggerEvent")==="focus"||this.options("editTriggerEvent")==="click")&&i.addEventListener("click",function(n){i.classList.contains("tabulator-editing")||(i.focus({preventScroll:!0}),t.edit(e,n,!1))}),this.options("editTriggerEvent")==="focus"&&i.addEventListener("focus",function(n){t.recursionBlock||t.edit(e,n,!1)})}}focusCellNoEvent(e,t){this.recursionBlock=!0,t&&this.table.browser==="ie"||e.getElement().focus({preventScroll:!0}),this.recursionBlock=!1}editCell(e,t){this.focusCellNoEvent(e),this.edit(e,!1,t)}focusScrollAdjust(e){if(this.table.rowManager.getRenderMode()=="virtual"){var t=this.table.rowManager.element.scrollTop,i=this.table.rowManager.element.clientHeight+this.table.rowManager.element.scrollTop,n=e.row.getElement();n.offsetTop<t?this.table.rowManager.element.scrollTop-=t-n.offsetTop:n.offsetTop+n.offsetHeight>i&&(this.table.rowManager.element.scrollTop+=n.offsetTop+n.offsetHeight-i);var s=this.table.rowManager.element.scrollLeft,a=this.table.rowManager.element.clientWidth+this.table.rowManager.element.scrollLeft,o=e.getElement();this.table.modExists("frozenColumns")&&(s+=parseInt(this.table.modules.frozenColumns.leftMargin||0),a-=parseInt(this.table.modules.frozenColumns.rightMargin||0)),this.table.options.renderHorizontal==="virtual"&&(s-=parseInt(this.table.columnManager.renderer.vDomPadLeft),a-=parseInt(this.table.columnManager.renderer.vDomPadLeft)),o.offsetLeft<s?this.table.rowManager.element.scrollLeft-=s-o.offsetLeft:o.offsetLeft+o.offsetWidth>a&&(this.table.rowManager.element.scrollLeft+=o.offsetLeft+o.offsetWidth-a)}}allowEdit(e){var t=!!e.column.modules.edit;if(e.column.modules.edit)switch(typeof e.column.modules.edit.check){case"function":e.row.initialized&&(t=e.column.modules.edit.check(e.getComponent()));break;case"string":t=!!e.row.data[e.column.modules.edit.check];break;case"boolean":t=e.column.modules.edit.check;break}return t}edit(e,t,i){var n=this,s=!0,a=function(){},o=e.getElement(),l=!1,h,c,d;if(this.currentCell){!this.invalidEdit&&this.currentCell!==e&&this.cancelEdit();return}function p(w){if(n.currentCell===e&&!l){var E=n.chain("edit-success",[e,w],!0,!0);return E===!0||n.table.options.validationMode==="highlight"?(l=!0,n.clearEditor(),e.modules.edit||(e.modules.edit={}),e.modules.edit.edited=!0,n.editedCells.indexOf(e)==-1&&n.editedCells.push(e),w=n.transformEmptyValues(w,e),e.setValue(w,!0),E===!0):(l=!0,n.invalidEdit=!0,n.focusCellNoEvent(e,!0),a(),setTimeout(()=>{l=!1},10),!1)}}function f(){n.currentCell===e&&!l&&n.cancelEdit()}function g(w){a=w}if(e.column.modules.edit.blocked)return this.mouseClick=!1,this.blur(o),!1;if(t&&t.stopPropagation(),s=this.allowEdit(e),s||i){if(n.cancelEdit(),n.currentCell=e,this.focusScrollAdjust(e),c=e.getComponent(),this.mouseClick&&(this.mouseClick=!1,e.column.definition.cellClick&&e.column.definition.cellClick.call(this.table,t,c)),e.column.definition.cellEditing&&e.column.definition.cellEditing.call(this.table,c),this.dispatch("cell-editing",e),this.dispatchExternal("cellEditing",c),d=typeof e.column.modules.edit.params=="function"?e.column.modules.edit.params(c):e.column.modules.edit.params,h=e.column.modules.edit.editor.call(n,c,g,p,f,d),this.currentCell&&h!==!1)if(h instanceof Node){for(o.classList.add("tabulator-editing"),e.row.getElement().classList.add("tabulator-editing"),e.table.element.classList.add("tabulator-editing");o.firstChild;)o.removeChild(o.firstChild);o.appendChild(h),a();for(var m=o.children,b=0;b<m.length;b++)m[b].addEventListener("click",function(w){w.stopPropagation()})}else return console.warn("Edit Error - Editor should return an instance of Node, the editor returned:",h),this.blur(o),!1;else return this.blur(o),!1;return!0}else return this.mouseClick=!1,this.blur(o),!1}emptyValueCheck(e){return e===""||e===null||typeof e>"u"}transformEmptyValues(e,t){var i=t.column.modules.edit,n=i.convertEmptyValues||this.convertEmptyValues,s;return n&&(s=i.editorEmptyValueFunc||this.options("editorEmptyValueFunc"),s&&s(e)&&(e=i.convertEmptyValues?i.editorEmptyValue:this.options("editorEmptyValue"))),e}blur(e){this.confirm("edit-blur",[e])||e.blur()}getEditedCells(){var e=[];return this.editedCells.forEach(t=>{e.push(t.getComponent())}),e}clearEdited(e){var t;e.modules.edit&&e.modules.edit.edited&&(e.modules.edit.edited=!1,this.dispatch("edit-edited-clear",e)),t=this.editedCells.indexOf(e),t>-1&&this.editedCells.splice(t,1)}}class np{constructor(e,t,i,n){this.type=e,this.columns=t,this.component=i||!1,this.indent=n||0}}class rf{constructor(e,t,i,n,s){this.value=e,this.component=t||!1,this.width=i,this.height=n,this.depth=s}}var Bw={},Hw={visible:function(){return this.rowManager.getVisibleRows(!1,!0)},all:function(){return this.rowManager.rows},selected:function(){return this.modules.selectRow.selectedRows},active:function(){return this.options.pagination?this.rowManager.getDisplayRows(this.rowManager.displayRows.length-2):this.rowManager.getDisplayRows()}};class Tl extends Dt{static moduleName="export";static columnLookups=Bw;static rowLookups=Hw;constructor(e){super(e),this.config={},this.cloneTableStyle=!0,this.colVisProp="",this.colVisPropAttach="",this.registerTableOption("htmlOutputConfig",!1),this.registerColumnOption("htmlOutput"),this.registerColumnOption("titleHtmlOutput")}initialize(){this.registerTableFunction("getHtml",this.getHtml.bind(this))}generateExportList(e,t,i,n){var s,a,o,l;return this.cloneTableStyle=t,this.config=e||{},this.colVisProp=n,this.colVisPropAttach=this.colVisProp.charAt(0).toUpperCase()+this.colVisProp.slice(1),l=Tl.columnLookups[i],l&&(o=l.call(this.table),o=o.filter(h=>this.columnVisCheck(h))),s=this.config.columnHeaders!==!1?this.headersToExportRows(this.generateColumnGroupHeaders(o)):[],o&&(o=o.map(h=>h.getComponent())),a=this.bodyToExportRows(this.rowLookup(i),o),s.concat(a)}generateTable(e,t,i,n){var s=this.generateExportList(e,t,i,n);return this.generateTableElement(s)}rowLookup(e){var t=[],i;return typeof e=="function"?e.call(this.table).forEach(n=>{n=this.table.rowManager.findRow(n),n&&t.push(n)}):(i=Tl.rowLookups[e]||Tl.rowLookups.active,t=i.call(this.table)),Object.assign([],t)}generateColumnGroupHeaders(e){var t=[];return e||(e=this.config.columnGroups!==!1?this.table.columnManager.columns:this.table.columnManager.columnsByIndex),e.forEach(i=>{var n=this.processColumnGroup(i);n&&t.push(n)}),t}processColumnGroup(e){var t=e.columns,i=0,n=e.definition["title"+this.colVisPropAttach]||e.definition.title,s={title:n,column:e,depth:1};if(t.length){if(s.subGroups=[],s.width=0,t.forEach(a=>{var o=this.processColumnGroup(a);o&&(s.width+=o.width,s.subGroups.push(o),o.depth>i&&(i=o.depth))}),s.depth+=i,!s.width)return!1}else if(this.columnVisCheck(e))s.width=1;else return!1;return s}columnVisCheck(e){var t=e.definition[this.colVisProp];return this.config.rowHeaders===!1&&e.isRowHeader?!1:(typeof t=="function"&&(t=t.call(this.table,e.getComponent())),t===!1||t===!0?t:e.visible&&e.field)}headersToExportRows(e){var t=[],i=0,n=[];function s(a,o){var l=i-o;if(typeof t[o]>"u"&&(t[o]=[]),a.height=a.subGroups?1:l-a.depth+1,t[o].push(a),a.height>1)for(let h=1;h<a.height;h++)typeof t[o+h]>"u"&&(t[o+h]=[]),t[o+h].push(!1);if(a.width>1)for(let h=1;h<a.width;h++)t[o].push(!1);a.subGroups&&a.subGroups.forEach(function(h){s(h,o+1)})}return e.forEach(function(a){a.depth>i&&(i=a.depth)}),e.forEach(function(a){s(a,0)}),t.forEach(a=>{var o=[];a.forEach(l=>{if(l){let h=typeof l.title>"u"?"":l.title;o.push(new rf(h,l.column.getComponent(),l.width,l.height,l.depth))}else o.push(null)}),n.push(new np("header",o))}),n}bodyToExportRows(e,t=[]){var i=[];return t.length===0&&this.table.columnManager.columnsByIndex.forEach(n=>{this.columnVisCheck(n)&&t.push(n.getComponent())}),this.config.columnCalcs!==!1&&this.table.modExists("columnCalcs")&&(this.table.modules.columnCalcs.topInitialized&&e.unshift(this.table.modules.columnCalcs.topRow),this.table.modules.columnCalcs.botInitialized&&e.push(this.table.modules.columnCalcs.botRow)),e=e.filter(n=>{switch(n.type){case"group":return this.config.rowGroups!==!1;case"calc":return this.config.columnCalcs!==!1;case"row":return!(this.table.options.dataTree&&this.config.dataTree===!1&&n.modules.dataTree.parent)}return!0}),e.forEach((n,s)=>{var a=n.getData(this.colVisProp),o=[],l=0;switch(n.type){case"group":l=n.level,o.push(new rf(n.key,n.getComponent(),t.length,1));break;case"calc":case"row":t.forEach(h=>{o.push(new rf(h._column.getFieldValue(a),h,1,1))}),this.table.options.dataTree&&this.config.dataTree!==!1&&(l=n.modules.dataTree.index);break}i.push(new np(n.type,o,n.getComponent(),l))}),i}generateTableElement(e){var t=document.createElement("table"),i=document.createElement("thead"),n=document.createElement("tbody"),s=this.lookupTableStyles(),a=this.table.options["rowFormatter"+this.colVisPropAttach],o={};return o.rowFormatter=a!==null?a:this.table.options.rowFormatter,this.table.options.dataTree&&this.config.dataTree!==!1&&this.table.modExists("columnCalcs")&&(o.treeElementField=this.table.modules.dataTree.elementField),o.groupHeader=this.table.options["groupHeader"+this.colVisPropAttach],o.groupHeader&&!Array.isArray(o.groupHeader)&&(o.groupHeader=[o.groupHeader]),t.classList.add("tabulator-print-table"),this.mapElementStyles(this.table.columnManager.getHeadersElement(),i,["border-top","border-left","border-right","border-bottom","background-color","color","font-weight","font-family","font-size"]),e.length>1e3&&console.warn("It may take a long time to render an HTML table with more than 1000 rows"),e.forEach((l,h)=>{let c;switch(l.type){case"header":i.appendChild(this.generateHeaderElement(l,o,s));break;case"group":n.appendChild(this.generateGroupElement(l,o,s));break;case"calc":n.appendChild(this.generateCalcElement(l,o,s));break;case"row":c=this.generateRowElement(l,o,s),this.mapElementStyles(h%2&&s.evenRow?s.evenRow:s.oddRow,c,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),n.appendChild(c);break}}),i.innerHTML&&t.appendChild(i),t.appendChild(n),this.mapElementStyles(this.table.element,t,["border-top","border-left","border-right","border-bottom"]),t}lookupTableStyles(){var e={};return this.cloneTableStyle&&window.getComputedStyle&&(e.oddRow=this.table.element.querySelector(".tabulator-row-odd:not(.tabulator-group):not(.tabulator-calcs)"),e.evenRow=this.table.element.querySelector(".tabulator-row-even:not(.tabulator-group):not(.tabulator-calcs)"),e.calcRow=this.table.element.querySelector(".tabulator-row.tabulator-calcs"),e.firstRow=this.table.element.querySelector(".tabulator-row:not(.tabulator-group):not(.tabulator-calcs)"),e.firstGroup=this.table.element.getElementsByClassName("tabulator-group")[0],e.firstRow&&(e.styleCells=e.firstRow.getElementsByClassName("tabulator-cell"),e.styleRowHeader=e.firstRow.getElementsByClassName("tabulator-row-header")[0],e.firstCell=e.styleCells[0],e.lastCell=e.styleCells[e.styleCells.length-1])),e}generateHeaderElement(e,t,i){var n=document.createElement("tr");return e.columns.forEach(s=>{if(s){var a=document.createElement("th"),o=s.component._column.definition.cssClass?s.component._column.definition.cssClass.split(" "):[];a.colSpan=s.width,a.rowSpan=s.height,a.innerHTML=s.value,this.cloneTableStyle&&(a.style.boxSizing="border-box"),o.forEach(function(l){a.classList.add(l)}),this.mapElementStyles(s.component.getElement(),a,["text-align","border-left","border-right","background-color","color","font-weight","font-family","font-size"]),this.mapElementStyles(s.component._column.contentElement,a,["padding-top","padding-left","padding-right","padding-bottom"]),s.component._column.visible?this.mapElementStyles(s.component.getElement(),a,["width"]):s.component._column.definition.width&&(a.style.width=s.component._column.definition.width+"px"),s.component._column.parent&&s.component._column.parent.isGroup?this.mapElementStyles(s.component._column.parent.groupElement,a,["border-top"]):this.mapElementStyles(s.component.getElement(),a,["border-top"]),s.component._column.isGroup?this.mapElementStyles(s.component.getElement(),a,["border-bottom"]):this.mapElementStyles(this.table.columnManager.getElement(),a,["border-bottom"]),n.appendChild(a)}}),n}generateGroupElement(e,t,i){var n=document.createElement("tr"),s=document.createElement("td"),a=e.columns[0];return n.classList.add("tabulator-print-table-row"),t.groupHeader&&t.groupHeader[e.indent]?a.value=t.groupHeader[e.indent](a.value,e.component._group.getRowCount(),e.component._group.getData(),e.component):t.groupHeader!==!1&&(a.value=e.component._group.generator(a.value,e.component._group.getRowCount(),e.component._group.getData(),e.component)),s.colSpan=a.width,s.innerHTML=a.value,n.classList.add("tabulator-print-table-group"),n.classList.add("tabulator-group-level-"+e.indent),a.component.isVisible()&&n.classList.add("tabulator-group-visible"),this.mapElementStyles(i.firstGroup,n,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),this.mapElementStyles(i.firstGroup,s,["padding-top","padding-left","padding-right","padding-bottom"]),n.appendChild(s),n}generateCalcElement(e,t,i){var n=this.generateRowElement(e,t,i);return n.classList.add("tabulator-print-table-calcs"),this.mapElementStyles(i.calcRow,n,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),n}generateRowElement(e,t,i){var n=document.createElement("tr");if(n.classList.add("tabulator-print-table-row"),e.columns.forEach((s,a)=>{if(s){var o=document.createElement("td"),l=s.component._column,h=this.table,c=h.columnManager.findColumnIndex(l),d=s.value,p,f,g={modules:{},getValue:function(){return d},getField:function(){return l.definition.field},getElement:function(){return o},getType:function(){return"cell"},getColumn:function(){return l.getComponent()},getData:function(){return e.component.getData()},getRow:function(){return e.component},getTable:function(){return h},getComponent:function(){return g},column:l},m=l.definition.cssClass?l.definition.cssClass.split(" "):[];if(m.forEach(function(b){o.classList.add(b)}),this.table.modExists("format")&&this.config.formatCells!==!1)d=this.table.modules.format.formatExportValue(g,this.colVisProp);else switch(typeof d){case"object":d=d!==null?JSON.stringify(d):"";break;case"undefined":d="";break}d instanceof Node?o.appendChild(d):o.innerHTML=d,f=["padding-top","padding-left","padding-right","padding-bottom","border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","text-align"],l.isRowHeader?(p=i.styleRowHeader,f.push("background-color")):p=i.styleCells&&i.styleCells[c]?i.styleCells[c]:i.firstCell,p&&(this.mapElementStyles(p,o,f),l.definition.align&&(o.style.textAlign=l.definition.align)),this.table.options.dataTree&&this.config.dataTree!==!1&&(t.treeElementField&&t.treeElementField==l.field||!t.treeElementField&&a==0)&&(e.component._row.modules.dataTree.controlEl&&o.insertBefore(e.component._row.modules.dataTree.controlEl.cloneNode(!0),o.firstChild),e.component._row.modules.dataTree.branchEl&&o.insertBefore(e.component._row.modules.dataTree.branchEl.cloneNode(!0),o.firstChild)),n.appendChild(o),g.modules.format&&g.modules.format.renderedCallback&&g.modules.format.renderedCallback()}}),t.rowFormatter&&e.type==="row"&&this.config.formatCells!==!1){let s=Object.assign(e.component);s.getElement=function(){return n},t.rowFormatter(e.component)}return n}generateHTMLTable(e){var t=document.createElement("div");return t.appendChild(this.generateTableElement(e)),t.innerHTML}getHtml(e,t,i,n){var s=this.generateExportList(i||this.table.options.htmlOutputConfig,t,e,n||"htmlOutput");return this.generateHTMLTable(s)}mapElementStyles(e,t,i){if(this.cloneTableStyle&&e&&t){var n={"background-color":"backgroundColor",color:"fontColor",width:"width","font-weight":"fontWeight","font-family":"fontFamily","font-size":"fontSize","text-align":"textAlign","border-top":"borderTop","border-left":"borderLeft","border-right":"borderRight","border-bottom":"borderBottom","padding-top":"paddingTop","padding-left":"paddingLeft","padding-right":"paddingRight","padding-bottom":"paddingBottom"};if(window.getComputedStyle){var s=window.getComputedStyle(e);i.forEach(function(a){t.style[n[a]]||(t.style[n[a]]=s.getPropertyValue(a))})}}}}var zw={"=":function(r,e,t,i){return e==r},"<":function(r,e,t,i){return e<r},"<=":function(r,e,t,i){return e<=r},">":function(r,e,t,i){return e>r},">=":function(r,e,t,i){return e>=r},"!=":function(r,e,t,i){return e!=r},regex:function(r,e,t,i){return typeof r=="string"&&(r=new RegExp(r)),r.test(e)},like:function(r,e,t,i){return r===null||typeof r>"u"?e===r:typeof e<"u"&&e!==null?String(e).toLowerCase().indexOf(r.toLowerCase())>-1:!1},keywords:function(r,e,t,i){var n=r.toLowerCase().split(typeof i.separator>"u"?" ":i.separator),s=String(e===null||typeof e>"u"?"":e).toLowerCase(),a=[];return n.forEach(o=>{s.includes(o)&&a.push(!0)}),i.matchAll?a.length===n.length:!!a.length},starts:function(r,e,t,i){return r===null||typeof r>"u"?e===r:typeof e<"u"&&e!==null?String(e).toLowerCase().startsWith(r.toLowerCase()):!1},ends:function(r,e,t,i){return r===null||typeof r>"u"?e===r:typeof e<"u"&&e!==null?String(e).toLowerCase().endsWith(r.toLowerCase()):!1},in:function(r,e,t,i){return Array.isArray(r)?r.length?r.indexOf(e)>-1:!0:(console.warn("Filter Error - filter value is not an array:",r),!1)}};class xa extends Dt{static moduleName="filter";static filters=zw;constructor(e){super(e),this.filterList=[],this.headerFilters={},this.headerFilterColumns=[],this.prevHeaderFilterChangeCheck="",this.prevHeaderFilterChangeCheck="{}",this.changed=!1,this.tableInitialized=!1,this.registerTableOption("filterMode","local"),this.registerTableOption("initialFilter",!1),this.registerTableOption("initialHeaderFilter",!1),this.registerTableOption("headerFilterLiveFilterDelay",300),this.registerTableOption("placeholderHeaderFilter",!1),this.registerColumnOption("headerFilter"),this.registerColumnOption("headerFilterPlaceholder"),this.registerColumnOption("headerFilterParams"),this.registerColumnOption("headerFilterEmptyCheck"),this.registerColumnOption("headerFilterFunc"),this.registerColumnOption("headerFilterFuncParams"),this.registerColumnOption("headerFilterLiveFilter"),this.registerTableFunction("searchRows",this.searchRows.bind(this)),this.registerTableFunction("searchData",this.searchData.bind(this)),this.registerTableFunction("setFilter",this.userSetFilter.bind(this)),this.registerTableFunction("refreshFilter",this.userRefreshFilter.bind(this)),this.registerTableFunction("addFilter",this.userAddFilter.bind(this)),this.registerTableFunction("getFilters",this.getFilters.bind(this)),this.registerTableFunction("setHeaderFilterFocus",this.userSetHeaderFilterFocus.bind(this)),this.registerTableFunction("getHeaderFilterValue",this.userGetHeaderFilterValue.bind(this)),this.registerTableFunction("setHeaderFilterValue",this.userSetHeaderFilterValue.bind(this)),this.registerTableFunction("getHeaderFilters",this.getHeaderFilters.bind(this)),this.registerTableFunction("removeFilter",this.userRemoveFilter.bind(this)),this.registerTableFunction("clearFilter",this.userClearFilter.bind(this)),this.registerTableFunction("clearHeaderFilter",this.userClearHeaderFilter.bind(this)),this.registerComponentFunction("column","headerFilterFocus",this.setHeaderFilterFocus.bind(this)),this.registerComponentFunction("column","reloadHeaderFilter",this.reloadHeaderFilter.bind(this)),this.registerComponentFunction("column","getHeaderFilterValue",this.getHeaderFilterValue.bind(this)),this.registerComponentFunction("column","setHeaderFilterValue",this.setHeaderFilterValue.bind(this))}initialize(){this.subscribe("column-init",this.initializeColumnHeaderFilter.bind(this)),this.subscribe("column-width-fit-before",this.hideHeaderFilterElements.bind(this)),this.subscribe("column-width-fit-after",this.showHeaderFilterElements.bind(this)),this.subscribe("table-built",this.tableBuilt.bind(this)),this.subscribe("placeholder",this.generatePlaceholder.bind(this)),this.table.options.filterMode==="remote"&&this.subscribe("data-params",this.remoteFilterParams.bind(this)),this.registerDataHandler(this.filter.bind(this),10)}tableBuilt(){this.table.options.initialFilter&&this.setFilter(this.table.options.initialFilter),this.table.options.initialHeaderFilter&&this.table.options.initialHeaderFilter.forEach(e=>{var t=this.table.columnManager.findColumn(e.field);if(t)this.setHeaderFilterValue(t,e.value);else return console.warn("Column Filter Error - No matching column found:",e.field),!1}),this.tableInitialized=!0}remoteFilterParams(e,t,i,n){return n.filter=this.getFilters(!0,!0),n}generatePlaceholder(e){if(this.table.options.placeholderHeaderFilter&&Object.keys(this.headerFilters).length)return this.table.options.placeholderHeaderFilter}userSetFilter(e,t,i,n){this.setFilter(e,t,i,n),this.refreshFilter()}userRefreshFilter(){this.refreshFilter()}userAddFilter(e,t,i,n){this.addFilter(e,t,i,n),this.refreshFilter()}userSetHeaderFilterFocus(e){var t=this.table.columnManager.findColumn(e);if(t)this.setHeaderFilterFocus(t);else return console.warn("Column Filter Focus Error - No matching column found:",e),!1}userGetHeaderFilterValue(e){var t=this.table.columnManager.findColumn(e);if(t)return this.getHeaderFilterValue(t);console.warn("Column Filter Error - No matching column found:",e)}userSetHeaderFilterValue(e,t){var i=this.table.columnManager.findColumn(e);if(i)this.setHeaderFilterValue(i,t);else return console.warn("Column Filter Error - No matching column found:",e),!1}userRemoveFilter(e,t,i){this.removeFilter(e,t,i),this.refreshFilter()}userClearFilter(e){this.clearFilter(e),this.refreshFilter()}userClearHeaderFilter(){this.clearHeaderFilter(),this.refreshFilter()}searchRows(e,t,i){return this.search("rows",e,t,i)}searchData(e,t,i){return this.search("data",e,t,i)}initializeColumnHeaderFilter(e){var t=e.definition;t.headerFilter&&this.initializeColumn(e)}initializeColumn(e,t){var i=this,n=e.getField();function s(a){var o=e.modules.filter.tagType=="input"&&e.modules.filter.attrType=="text"||e.modules.filter.tagType=="textarea"?"partial":"match",l="",h="",c;if(typeof e.modules.filter.prevSuccess>"u"||e.modules.filter.prevSuccess!==a){if(e.modules.filter.prevSuccess=a,e.modules.filter.emptyFunc(a))delete i.headerFilters[n];else{switch(e.modules.filter.value=a,typeof e.definition.headerFilterFunc){case"string":xa.filters[e.definition.headerFilterFunc]?(l=e.definition.headerFilterFunc,c=function(d){var p=e.definition.headerFilterFuncParams||{},f=e.getFieldValue(d);return p=typeof p=="function"?p(a,f,d):p,xa.filters[e.definition.headerFilterFunc](a,f,d,p)}):console.warn("Header Filter Error - Matching filter function not found: ",e.definition.headerFilterFunc);break;case"function":c=function(d){var p=e.definition.headerFilterFuncParams||{},f=e.getFieldValue(d);return p=typeof p=="function"?p(a,f,d):p,e.definition.headerFilterFunc(a,f,d,p)},l=c;break}if(!c)switch(o){case"partial":c=function(d){var p=e.getFieldValue(d);return typeof p<"u"&&p!==null?String(p).toLowerCase().indexOf(String(a).toLowerCase())>-1:!1},l="like";break;default:c=function(d){return e.getFieldValue(d)==a},l="="}i.headerFilters[n]={value:a,func:c,type:l}}e.modules.filter.value=a,h=JSON.stringify(i.headerFilters),i.prevHeaderFilterChangeCheck!==h&&(i.prevHeaderFilterChangeCheck=h,i.trackChanges(),i.refreshFilter())}return!0}e.modules.filter={success:s,attrType:!1,tagType:!1,emptyFunc:!1},this.generateHeaderFilterElement(e)}generateHeaderFilterElement(e,t,i){var n=this,s=e.modules.filter.success,a=e.getField(),o,l,h,c,d,p,f,g;e.modules.filter.value=t;function m(){}function b(w){g=w}if(e.modules.filter.headerElement&&e.modules.filter.headerElement.parentNode&&e.contentElement.removeChild(e.modules.filter.headerElement.parentNode),a){switch(e.modules.filter.emptyFunc=e.definition.headerFilterEmptyCheck||function(w){return!w&&w!==0},o=document.createElement("div"),o.classList.add("tabulator-header-filter"),typeof e.definition.headerFilter){case"string":n.table.modules.edit.editors[e.definition.headerFilter]?(l=n.table.modules.edit.editors[e.definition.headerFilter],(e.definition.headerFilter==="tick"||e.definition.headerFilter==="tickCross")&&!e.definition.headerFilterEmptyCheck&&(e.modules.filter.emptyFunc=function(w){return w!==!0&&w!==!1})):console.warn("Filter Error - Cannot build header filter, No such editor found: ",e.definition.editor);break;case"function":l=e.definition.headerFilter;break;case"boolean":e.modules.edit&&e.modules.edit.editor?l=e.modules.edit.editor:e.definition.formatter&&n.table.modules.edit.editors[e.definition.formatter]?(l=n.table.modules.edit.editors[e.definition.formatter],(e.definition.formatter==="tick"||e.definition.formatter==="tickCross")&&!e.definition.headerFilterEmptyCheck&&(e.modules.filter.emptyFunc=function(w){return w!==!0&&w!==!1})):l=n.table.modules.edit.editors.input;break}if(l){if(c={getValue:function(){return typeof t<"u"?t:""},getField:function(){return e.definition.field},getElement:function(){return o},getColumn:function(){return e.getComponent()},getTable:()=>this.table,getType:()=>"header",getRow:function(){return{normalizeHeight:function(){}}}},f=e.definition.headerFilterParams||{},f=typeof f=="function"?f.call(n.table,c):f,h=l.call(this.table.modules.edit,c,b,s,m,f),!h){console.warn("Filter Error - Cannot add filter to "+a+" column, editor returned a value of false");return}if(!(h instanceof Node)){console.warn("Filter Error - Cannot add filter to "+a+" column, editor should return an instance of Node, the editor returned:",h);return}n.langBind("headerFilters|columns|"+e.definition.field,function(w){h.setAttribute("placeholder",typeof w<"u"&&w?w:e.definition.headerFilterPlaceholder||n.langText("headerFilters|default"))}),h.addEventListener("click",function(w){w.stopPropagation(),h.focus()}),h.addEventListener("focus",w=>{var E=this.table.columnManager.contentsElement.scrollLeft,C=this.table.rowManager.element.scrollLeft;E!==C&&(this.table.rowManager.scrollHorizontal(E),this.table.columnManager.scrollHorizontal(E))}),d=!1,p=function(w){d&&clearTimeout(d),d=setTimeout(function(){s(h.value)},n.table.options.headerFilterLiveFilterDelay)},e.modules.filter.headerElement=h,e.modules.filter.attrType=h.hasAttribute("type")?h.getAttribute("type").toLowerCase():"",e.modules.filter.tagType=h.tagName.toLowerCase(),e.definition.headerFilterLiveFilter!==!1&&(e.definition.headerFilter==="autocomplete"||e.definition.headerFilter==="tickCross"||(e.definition.editor==="autocomplete"||e.definition.editor==="tickCross")&&e.definition.headerFilter===!0||(h.addEventListener("keyup",p),h.addEventListener("search",p),e.modules.filter.attrType=="number"&&h.addEventListener("change",function(w){s(h.value)}),e.modules.filter.attrType=="text"&&this.table.browser!=="ie"&&h.setAttribute("type","search")),(e.modules.filter.tagType=="input"||e.modules.filter.tagType=="select"||e.modules.filter.tagType=="textarea")&&h.addEventListener("mousedown",function(w){w.stopPropagation()})),o.appendChild(h),e.contentElement.appendChild(o),i||n.headerFilterColumns.push(e),g&&g()}}else console.warn("Filter Error - Cannot add header filter, column has no field set:",e.definition.title)}hideHeaderFilterElements(){this.headerFilterColumns.forEach(function(e){e.modules.filter&&e.modules.filter.headerElement&&(e.modules.filter.headerElement.style.display="none")})}showHeaderFilterElements(){this.headerFilterColumns.forEach(function(e){e.modules.filter&&e.modules.filter.headerElement&&(e.modules.filter.headerElement.style.display="")})}setHeaderFilterFocus(e){e.modules.filter&&e.modules.filter.headerElement?e.modules.filter.headerElement.focus():console.warn("Column Filter Focus Error - No header filter set on column:",e.getField())}getHeaderFilterValue(e){if(e.modules.filter&&e.modules.filter.headerElement)return e.modules.filter.value;console.warn("Column Filter Error - No header filter set on column:",e.getField())}setHeaderFilterValue(e,t){e&&(e.modules.filter&&e.modules.filter.headerElement?(this.generateHeaderFilterElement(e,t,!0),e.modules.filter.success(t)):console.warn("Column Filter Error - No header filter set on column:",e.getField()))}reloadHeaderFilter(e){e&&(e.modules.filter&&e.modules.filter.headerElement?this.generateHeaderFilterElement(e,e.modules.filter.value,!0):console.warn("Column Filter Error - No header filter set on column:",e.getField()))}refreshFilter(){this.tableInitialized&&(this.table.options.filterMode==="remote"?this.reloadData(null,!1,!1):this.refreshData(!0))}trackChanges(){this.changed=!0,this.dispatch("filter-changed")}hasChanged(){var e=this.changed;return this.changed=!1,e}setFilter(e,t,i,n){this.filterList=[],Array.isArray(e)||(e=[{field:e,type:t,value:i,params:n}]),this.addFilter(e)}addFilter(e,t,i,n){var s=!1;Array.isArray(e)||(e=[{field:e,type:t,value:i,params:n}]),e.forEach(a=>{a=this.findFilter(a),a&&(this.filterList.push(a),s=!0)}),s&&this.trackChanges()}findFilter(e){var t;if(Array.isArray(e))return this.findSubFilters(e);var i=!1;return typeof e.field=="function"?i=function(n){return e.field(n,e.type||{})}:xa.filters[e.type]?(t=this.table.columnManager.getColumnByField(e.field),t?i=function(n){return xa.filters[e.type](e.value,t.getFieldValue(n),n,e.params||{})}:i=function(n){return xa.filters[e.type](e.value,n[e.field],n,e.params||{})}):console.warn("Filter Error - No such filter type found, ignoring: ",e.type),e.func=i,e.func?e:!1}findSubFilters(e){var t=[];return e.forEach(i=>{i=this.findFilter(i),i&&t.push(i)}),t.length?t:!1}getFilters(e,t){var i=[];return e&&(i=this.getHeaderFilters()),t&&i.forEach(function(n){typeof n.type=="function"&&(n.type="function")}),i=i.concat(this.filtersToArray(this.filterList,t)),i}filtersToArray(e,t){var i=[];return e.forEach(n=>{var s;Array.isArray(n)?i.push(this.filtersToArray(n,t)):(s={field:n.field,type:n.type,value:n.value},t&&typeof s.type=="function"&&(s.type="function"),i.push(s))}),i}getHeaderFilters(){var e=[];for(var t in this.headerFilters)e.push({field:t,type:this.headerFilters[t].type,value:this.headerFilters[t].value});return e}removeFilter(e,t,i){Array.isArray(e)||(e=[{field:e,type:t,value:i}]),e.forEach(n=>{var s=-1;typeof n.field=="object"?s=this.filterList.findIndex(a=>n===a):s=this.filterList.findIndex(a=>n.field===a.field&&n.type===a.type&&n.value===a.value),s>-1?this.filterList.splice(s,1):console.warn("Filter Error - No matching filter type found, ignoring: ",n.type)}),this.trackChanges()}clearFilter(e){this.filterList=[],e&&this.clearHeaderFilter(),this.trackChanges()}clearHeaderFilter(){this.headerFilters={},this.prevHeaderFilterChangeCheck="{}",this.headerFilterColumns.forEach(e=>{typeof e.modules.filter.value<"u"&&delete e.modules.filter.value,e.modules.filter.prevSuccess=void 0,this.reloadHeaderFilter(e)}),this.trackChanges()}search(e,t,i,n){var s=[],a=[];return Array.isArray(t)||(t=[{field:t,type:i,value:n}]),t.forEach(o=>{o=this.findFilter(o),o&&a.push(o)}),this.table.rowManager.rows.forEach(o=>{var l=!0;a.forEach(h=>{this.filterRecurse(h,o.getData())||(l=!1)}),l&&s.push(e==="data"?o.getData("data"):o.getComponent())}),s}filter(e,t){var i=[],n=[];return this.subscribedExternal("dataFiltering")&&this.dispatchExternal("dataFiltering",this.getFilters(!0)),this.table.options.filterMode!=="remote"&&(this.filterList.length||Object.keys(this.headerFilters).length)?e.forEach(s=>{this.filterRow(s)&&i.push(s)}):i=e.slice(0),this.subscribedExternal("dataFiltered")&&(i.forEach(s=>{n.push(s.getComponent())}),this.dispatchExternal("dataFiltered",this.getFilters(!0),n)),i}filterRow(e,t){var i=!0,n=e.getData();this.filterList.forEach(a=>{this.filterRecurse(a,n)||(i=!1)});for(var s in this.headerFilters)this.headerFilters[s].func(n)||(i=!1);return i}filterRecurse(e,t){var i=!1;return Array.isArray(e)?e.forEach(n=>{this.filterRecurse(n,t)&&(i=!0)}):i=e.func(t),i}}function jw(r,e,t){return this.emptyToSpace(this.sanitizeHTML(r.getValue()))}function Ww(r,e,t){return r.getValue()}function Uw(r,e,t){return r.getElement().style.whiteSpace="pre-wrap",this.emptyToSpace(this.sanitizeHTML(r.getValue()))}function Vw(r,e,t){var i=parseFloat(r.getValue()),n="",s,a,o,l,h,c=e.decimal||".",d=e.thousand||",",p=e.negativeSign||"-",f=e.symbol||"",g=!!e.symbolAfter,m=typeof e.precision<"u"?e.precision:2;if(isNaN(i))return this.emptyToSpace(this.sanitizeHTML(r.getValue()));if(i<0&&(i=Math.abs(i),n=p),s=m!==!1?i.toFixed(m):i,s=String(s).split("."),a=s[0],o=s.length>1?c+s[1]:"",e.thousand!==!1)for(l=/(\d+)(\d{3})/;l.test(a);)a=a.replace(l,"$1"+d+"$2");return h=a+o,n===!0?(h="("+h+")",g?h+f:f+h):g?n+h+f:n+f+h}function Gw(r,e,t){var i=r.getValue(),n=e.urlPrefix||"",s=e.download,a=i,o=document.createElement("a"),l;function h(c,d){var p=c.shift(),f=d[p];return c.length&&typeof f=="object"?h(c,f):f}if(e.labelField&&(l=r.getData(),a=h(e.labelField.split(this.table.options.nestedFieldSeparator),l)),e.label)switch(typeof e.label){case"string":a=e.label;break;case"function":a=e.label(r);break}if(a){if(e.urlField&&(l=r.getData(),i=hr.retrieveNestedData(this.table.options.nestedFieldSeparator,e.urlField,l)),e.url)switch(typeof e.url){case"string":i=e.url;break;case"function":i=e.url(r);break}return o.setAttribute("href",n+i),e.target&&o.setAttribute("target",e.target),e.download&&(typeof s=="function"?s=s(r):s=s===!0?"":s,o.setAttribute("download",s)),o.innerHTML=this.emptyToSpace(this.sanitizeHTML(a)),o}else return"&nbsp;"}function qw(r,e,t){var i=document.createElement("img"),n=r.getValue();switch(e.urlPrefix&&(n=e.urlPrefix+r.getValue()),e.urlSuffix&&(n=n+e.urlSuffix),i.setAttribute("src",n),typeof e.height){case"number":i.style.height=e.height+"px";break;case"string":i.style.height=e.height;break}switch(typeof e.width){case"number":i.style.width=e.width+"px";break;case"string":i.style.width=e.width;break}return i.addEventListener("load",function(){r.getRow().normalizeHeight()}),i}function Xw(r,e,t){var i=r.getValue(),n=r.getElement(),s=e.allowEmpty,a=e.allowTruthy,o=Object.keys(e).includes("trueValue"),l=typeof e.tickElement<"u"?e.tickElement:'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#2DC214" clip-rule="evenodd" d="M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z" fill-rule="evenodd"/></svg>',h=typeof e.crossElement<"u"?e.crossElement:'<svg enable-background="new 0 0 24 24" height="14" width="14"  viewBox="0 0 24 24" xml:space="preserve" ><path fill="#CE1515" d="M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z"/></svg>';return o&&i===e.trueValue||!o&&(a&&i||i===!0||i==="true"||i==="True"||i===1||i==="1")?(n.setAttribute("aria-checked",!0),l||""):s&&(i==="null"||i===""||i===null||typeof i>"u")?(n.setAttribute("aria-checked","mixed"),""):(n.setAttribute("aria-checked",!1),h||"")}function Kw(r,e,t){var i=this.table.dependencyRegistry.lookup(["luxon","DateTime"],"DateTime"),n=e.inputFormat||"yyyy-MM-dd HH:mm:ss",s=e.outputFormat||"dd/MM/yyyy HH:mm:ss",a=typeof e.invalidPlaceholder<"u"?e.invalidPlaceholder:"",o=r.getValue();if(typeof i<"u"){var l;return i.isDateTime(o)?l=o:n==="iso"?l=i.fromISO(String(o)):l=i.fromFormat(String(o),n),l.isValid?(e.timezone&&(l=l.setZone(e.timezone)),l.toFormat(s)):a===!0||!o?o:typeof a=="function"?a(o):a}else console.error("Format Error - 'datetime' formatter is dependant on luxon.js")}function Yw(r,e,t){var i=this.table.dependencyRegistry.lookup(["luxon","DateTime"],"DateTime"),n=e.inputFormat||"yyyy-MM-dd HH:mm:ss",s=typeof e.invalidPlaceholder<"u"?e.invalidPlaceholder:"",a=typeof e.suffix<"u"?e.suffix:!1,o=typeof e.unit<"u"?e.unit:"days",l=typeof e.humanize<"u"?e.humanize:!1,h=typeof e.date<"u"?e.date:i.now(),c=r.getValue();if(typeof i<"u"){var d;return i.isDateTime(c)?d=c:n==="iso"?d=i.fromISO(String(c)):d=i.fromFormat(String(c),n),d.isValid?l?d.diff(h,o).toHuman()+(a?" "+a:""):parseInt(d.diff(h,o)[o])+(a?" "+a:""):s===!0?c:typeof s=="function"?s(c):s}else console.error("Format Error - 'datetimediff' formatter is dependant on luxon.js")}function $w(r,e,t){var i=r.getValue();return typeof e[i]>"u"?(console.warn("Missing display value for "+i),i):e[i]}function Jw(r,e,t){var i=r.getValue(),n=r.getElement(),s=e&&e.stars?e.stars:5,a=document.createElement("span"),o=document.createElementNS("http://www.w3.org/2000/svg","svg"),l='<polygon fill="#FFEA00" stroke="#C1AB60" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>',h='<polygon fill="#D2D2D2" stroke="#686868" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>';a.style.verticalAlign="middle",o.setAttribute("width","14"),o.setAttribute("height","14"),o.setAttribute("viewBox","0 0 512 512"),o.setAttribute("xml:space","preserve"),o.style.padding="0 1px",i=i&&!isNaN(i)?parseInt(i):0,i=Math.max(0,Math.min(i,s));for(var c=1;c<=s;c++){var d=o.cloneNode(!0);d.innerHTML=c<=i?l:h,a.appendChild(d)}return n.style.whiteSpace="nowrap",n.style.overflow="hidden",n.style.textOverflow="ellipsis",n.setAttribute("aria-label",i),a}function Zw(r,e,t){var i=this.sanitizeHTML(r.getValue())||0,n=document.createElement("span"),s=e&&e.max?e.max:100,a=e&&e.min?e.min:0,o=e&&typeof e.color<"u"?e.color:["red","orange","green"],l="#666666",h,c;if(!(isNaN(i)||typeof r.getValue()>"u")){switch(n.classList.add("tabulator-traffic-light"),c=parseFloat(i)<=s?parseFloat(i):s,c=parseFloat(c)>=a?parseFloat(c):a,h=(s-a)/100,c=Math.round((c-a)/h),typeof o){case"string":l=o;break;case"function":l=o(i);break;case"object":if(Array.isArray(o)){var d=100/o.length,p=Math.floor(c/d);p=Math.min(p,o.length-1),p=Math.max(p,0),l=o[p];break}}return n.style.backgroundColor=l,n}}function Qw(r,e={},t){var i=this.sanitizeHTML(r.getValue())||0,n=r.getElement(),s=e.max?e.max:100,a=e.min?e.min:0,o=e.legendAlign?e.legendAlign:"center",l,h,c,d,p;switch(h=parseFloat(i)<=s?parseFloat(i):s,h=parseFloat(h)>=a?parseFloat(h):a,l=(s-a)/100,h=Math.round((h-a)/l),typeof e.color){case"string":c=e.color;break;case"function":c=e.color(i);break;case"object":if(Array.isArray(e.color)){let b=100/e.color.length,w=Math.floor(h/b);w=Math.min(w,e.color.length-1),w=Math.max(w,0),c=e.color[w];break}default:c="#2DC214"}switch(typeof e.legend){case"string":d=e.legend;break;case"function":d=e.legend(i);break;case"boolean":d=i;break;default:d=!1}switch(typeof e.legendColor){case"string":p=e.legendColor;break;case"function":p=e.legendColor(i);break;case"object":if(Array.isArray(e.legendColor)){let b=100/e.legendColor.length,w=Math.floor(h/b);w=Math.min(w,e.legendColor.length-1),w=Math.max(w,0),p=e.legendColor[w]}break;default:p="#000"}n.style.minWidth="30px",n.style.position="relative",n.setAttribute("aria-label",h);var f=document.createElement("div");f.style.display="inline-block",f.style.width=h+"%",f.style.backgroundColor=c,f.style.height="100%",f.setAttribute("data-max",s),f.setAttribute("data-min",a);var g=document.createElement("div");if(g.style.position="relative",g.style.width="100%",g.style.height="100%",d){var m=document.createElement("div");m.style.position="absolute",m.style.top=0,m.style.left=0,m.style.textAlign=o,m.style.width="100%",m.style.color=p,m.innerHTML=d}return t(function(){if(!(r instanceof ug)){var b=document.createElement("div");b.style.position="absolute",b.style.top="4px",b.style.bottom="4px",b.style.left="4px",b.style.right="4px",n.appendChild(b),n=b}n.appendChild(g),g.appendChild(f),d&&g.appendChild(m)}),""}function ex(r,e,t){return r.getElement().style.backgroundColor=this.sanitizeHTML(r.getValue()),""}function tx(r,e,t){return'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#2DC214" clip-rule="evenodd" d="M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z" fill-rule="evenodd"/></svg>'}function rx(r,e,t){return'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#CE1515" d="M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z"/></svg>'}function ix(r,e,t){var i=r.getValue(),n=e.size||15,s=n+"px",a,o,l=e.hasOwnProperty("onValue")?e.onValue:!0,h=e.hasOwnProperty("offValue")?e.offValue:!1,c=e.onTruthy?i:i===l;return a=document.createElement("div"),a.classList.add("tabulator-toggle"),c?(a.classList.add("tabulator-toggle-on"),a.style.flexDirection="row-reverse",e.onColor&&(a.style.background=e.onColor)):e.offColor&&(a.style.background=e.offColor),a.style.width=2.5*n+"px",a.style.borderRadius=s,e.clickable&&a.addEventListener("click",d=>{r.setValue(c?h:l)}),o=document.createElement("div"),o.classList.add("tabulator-toggle-switch"),o.style.height=s,o.style.width=s,o.style.borderRadius=s,a.appendChild(o),a}function nx(r,e,t){var i=document.createElement("span"),n=r.getRow(),s=r.getTable();return n.watchPosition(a=>{e.relativeToPage&&(a+=s.modules.page.getPageSize()*(s.modules.page.getPage()-1)),i.innerText=a}),i}function sx(r,e,t){return r.getElement().classList.add("tabulator-row-handle"),"<div class='tabulator-row-handle-box'><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div></div>"}function ax(r,e,t){var i,n,s;function a(o){var l=o.getValue(),h="plaintext";switch(typeof l){case"boolean":h="tickCross";break;case"string":l.includes(`
`)&&(h="textarea");break}return h}return i=e.formatterLookup?e.formatterLookup(r):a(r),e.paramsLookup&&(s=typeof e.paramsLookup=="function"?e.paramsLookup(i,r):e.paramsLookup[i]),n=this.table.modules.format.lookupFormatter(i),n.call(this,r,s||{},t)}function ox(r,e,t){var i=e.delimiter||",",n=r.getValue(),s=this.table,a;return e.valueMap&&(typeof e.valueMap=="string"?a=function(o){return o.map(l=>hr.retrieveNestedData(s.options.nestedFieldSeparator,e.valueMap,l))}:a=e.valueMap),Array.isArray(n)?(a&&(n=a(n)),n.join(i)):n}function lx(r,e,t){var i=e.indent||"	",n=typeof e.multiline>"u"?!0:e.multiline,s=e.replacer||null,a=r.getValue();return n&&(r.getElement().style.whiteSpace="pre-wrap"),JSON.stringify(a,s,i)}var hx={plaintext:jw,html:Ww,textarea:Uw,money:Vw,link:Gw,image:qw,tickCross:Xw,datetime:Kw,datetimediff:Yw,lookup:$w,star:Jw,traffic:Zw,progress:Qw,color:ex,buttonTick:tx,buttonCross:rx,toggle:ix,rownum:nx,handle:sx,adaptable:ax,array:ox,json:lx};class To extends Dt{static moduleName="format";static formatters=hx;constructor(e){super(e),this.registerColumnOption("formatter"),this.registerColumnOption("formatterParams"),this.registerColumnOption("formatterPrint"),this.registerColumnOption("formatterPrintParams"),this.registerColumnOption("formatterClipboard"),this.registerColumnOption("formatterClipboardParams"),this.registerColumnOption("formatterHtmlOutput"),this.registerColumnOption("formatterHtmlOutputParams"),this.registerColumnOption("titleFormatter"),this.registerColumnOption("titleFormatterParams")}initialize(){this.subscribe("cell-format",this.formatValue.bind(this)),this.subscribe("cell-rendered",this.cellRendered.bind(this)),this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("column-format",this.formatHeader.bind(this))}initializeColumn(e){e.modules.format=this.lookupTypeFormatter(e,""),typeof e.definition.formatterPrint<"u"&&(e.modules.format.print=this.lookupTypeFormatter(e,"Print")),typeof e.definition.formatterClipboard<"u"&&(e.modules.format.clipboard=this.lookupTypeFormatter(e,"Clipboard")),typeof e.definition.formatterHtmlOutput<"u"&&(e.modules.format.htmlOutput=this.lookupTypeFormatter(e,"HtmlOutput"))}lookupTypeFormatter(e,t){var i={params:e.definition["formatter"+t+"Params"]||{}},n=e.definition["formatter"+t];return i.formatter=this.lookupFormatter(n),i}lookupFormatter(e){var t;switch(typeof e){case"string":To.formatters[e]?t=To.formatters[e]:(console.warn("Formatter Error - No such formatter found: ",e),t=To.formatters.plaintext);break;case"function":t=e;break;default:t=To.formatters.plaintext;break}return t}cellRendered(e){e.modules.format&&e.modules.format.renderedCallback&&!e.modules.format.rendered&&(e.modules.format.renderedCallback(),e.modules.format.rendered=!0)}formatHeader(e,t,i){var n,s,a,o;return e.definition.titleFormatter?(n=this.lookupFormatter(e.definition.titleFormatter),a=l=>{e.titleFormatterRendered=l},o={getValue:function(){return t},getElement:function(){return i},getType:function(){return"header"},getColumn:function(){return e.getComponent()},getTable:()=>this.table},s=e.definition.titleFormatterParams||{},s=typeof s=="function"?s():s,n.call(this,o,s,a)):t}formatValue(e){var t=e.getComponent(),i=typeof e.column.modules.format.params=="function"?e.column.modules.format.params(t):e.column.modules.format.params;function n(s){e.modules.format||(e.modules.format={}),e.modules.format.renderedCallback=s,e.modules.format.rendered=!1}return e.column.modules.format.formatter.call(this,t,i,n)}formatExportValue(e,t){var i=e.column.modules.format[t],n;if(i){let s=function(a){e.modules.format||(e.modules.format={}),e.modules.format.renderedCallback=a,e.modules.format.rendered=!1};return n=typeof i.params=="function"?i.params(e.getComponent()):i.params,i.formatter.call(this,e.getComponent(),n,s)}else return this.formatValue(e)}sanitizeHTML(e){if(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return String(e).replace(/[&<>"'`=/]/g,function(i){return t[i]})}else return e}emptyToSpace(e){return e===null||typeof e>"u"||e===""?"&nbsp;":e}}class cx extends Dt{static moduleName="frozenColumns";constructor(e){super(e),this.leftColumns=[],this.rightColumns=[],this.initializationMode="left",this.active=!1,this.blocked=!0,this.registerColumnOption("frozen")}reset(){this.initializationMode="left",this.leftColumns=[],this.rightColumns=[],this.active=!1}initialize(){this.subscribe("cell-layout",this.layoutCell.bind(this)),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("column-width",this.layout.bind(this)),this.subscribe("row-layout-after",this.layoutRow.bind(this)),this.subscribe("table-layout",this.layout.bind(this)),this.subscribe("columns-loading",this.reset.bind(this)),this.subscribe("column-add",this.reinitializeColumns.bind(this)),this.subscribe("column-deleted",this.reinitializeColumns.bind(this)),this.subscribe("column-hide",this.reinitializeColumns.bind(this)),this.subscribe("column-show",this.reinitializeColumns.bind(this)),this.subscribe("columns-loaded",this.reinitializeColumns.bind(this)),this.subscribe("table-redraw",this.layout.bind(this)),this.subscribe("layout-refreshing",this.blockLayout.bind(this)),this.subscribe("layout-refreshed",this.unblockLayout.bind(this)),this.subscribe("scrollbar-vertical",this.adjustForScrollbar.bind(this))}blockLayout(){this.blocked=!0}unblockLayout(){this.blocked=!1}layoutCell(e){this.layoutElement(e.element,e.column)}reinitializeColumns(){this.reset(),this.table.columnManager.columnsByIndex.forEach(e=>{this.initializeColumn(e)}),this.layout()}initializeColumn(e){var t={margin:0,edge:!1};e.isGroup||(this.frozenCheck(e)?(t.position=this.initializationMode,this.initializationMode=="left"?this.leftColumns.push(e):this.rightColumns.unshift(e),this.active=!0,e.modules.frozen=t):this.initializationMode="right")}frozenCheck(e){return e.parent.isGroup&&e.definition.frozen&&console.warn("Frozen Column Error - Parent column group must be frozen, not individual columns or sub column groups"),e.parent.isGroup?this.frozenCheck(e.parent):e.definition.frozen}layoutCalcRows(){this.table.modExists("columnCalcs")&&(this.table.modules.columnCalcs.topInitialized&&this.table.modules.columnCalcs.topRow&&this.layoutRow(this.table.modules.columnCalcs.topRow),this.table.modules.columnCalcs.botInitialized&&this.table.modules.columnCalcs.botRow&&this.layoutRow(this.table.modules.columnCalcs.botRow),this.table.modExists("groupRows")&&this.layoutGroupCalcs(this.table.modules.groupRows.getGroups()))}layoutGroupCalcs(e){e.forEach(t=>{t.calcs.top&&this.layoutRow(t.calcs.top),t.calcs.bottom&&this.layoutRow(t.calcs.bottom),t.groupList&&t.groupList.length&&this.layoutGroupCalcs(t.groupList)})}layoutColumnPosition(e){var t=[],i=0,n=0;this.leftColumns.forEach((s,a)=>{if(s.modules.frozen.marginValue=i,s.modules.frozen.margin=s.modules.frozen.marginValue+"px",s.visible&&(i+=s.getWidth()),a==this.leftColumns.length-1?s.modules.frozen.edge=!0:s.modules.frozen.edge=!1,s.parent.isGroup){var o=this.getColGroupParentElement(s);t.includes(o)||(this.layoutElement(o,s),t.push(o)),o.classList.toggle("tabulator-frozen-left",s.modules.frozen.edge&&s.modules.frozen.position==="left"),o.classList.toggle("tabulator-frozen-right",s.modules.frozen.edge&&s.modules.frozen.position==="right")}else this.layoutElement(s.getElement(),s);e&&s.cells.forEach(l=>{this.layoutElement(l.getElement(!0),s)})}),this.rightColumns.forEach((s,a)=>{s.modules.frozen.marginValue=n,s.modules.frozen.margin=s.modules.frozen.marginValue+"px",s.visible&&(n+=s.getWidth()),a==this.rightColumns.length-1?s.modules.frozen.edge=!0:s.modules.frozen.edge=!1,s.parent.isGroup?this.layoutElement(this.getColGroupParentElement(s),s):this.layoutElement(s.getElement(),s),e&&s.cells.forEach(o=>{this.layoutElement(o.getElement(!0),s)})})}getColGroupParentElement(e){return e.parent.isGroup?this.getColGroupParentElement(e.parent):e.getElement()}layout(){this.active&&!this.blocked&&(this.layoutColumnPosition(),this.reinitializeRows(),this.layoutCalcRows())}reinitializeRows(){var e=this.table.rowManager.getVisibleRows(!0),t=this.table.rowManager.getRows().filter(i=>!e.includes(i));t.forEach(i=>{i.deinitialize()}),e.forEach(i=>{i.type==="row"&&this.layoutRow(i)})}layoutRow(e){this.table.options.layout==="fitDataFill"&&this.rightColumns.length&&(this.table.rowManager.getTableElement().style.minWidth="calc(100% - "+this.rightMargin+")"),this.leftColumns.forEach(t=>{var i=e.getCell(t);i&&this.layoutElement(i.getElement(!0),t)}),this.rightColumns.forEach(t=>{var i=e.getCell(t);i&&this.layoutElement(i.getElement(!0),t)})}layoutElement(e,t){var i;t.modules.frozen&&e&&(e.style.position="sticky",this.table.rtl?i=t.modules.frozen.position==="left"?"right":"left":i=t.modules.frozen.position,e.style[i]=t.modules.frozen.margin,e.classList.add("tabulator-frozen"),e.classList.toggle("tabulator-frozen-left",t.modules.frozen.edge&&t.modules.frozen.position==="left"),e.classList.toggle("tabulator-frozen-right",t.modules.frozen.edge&&t.modules.frozen.position==="right"))}adjustForScrollbar(e){this.rightColumns.length&&(this.table.columnManager.getContentsElement().style.width="calc(100% - "+e+"px)")}getFrozenColumns(){return this.leftColumns.concat(this.rightColumns)}_calcSpace(e,t){var i=0;for(let n=0;n<t;n++)e[n].visible&&(i+=e[n].getWidth());return i}}class ux extends Dt{static moduleName="frozenRows";constructor(e){super(e),this.topElement=document.createElement("div"),this.rows=[],this.registerComponentFunction("row","freeze",this.freezeRow.bind(this)),this.registerComponentFunction("row","unfreeze",this.unfreezeRow.bind(this)),this.registerComponentFunction("row","isFrozen",this.isRowFrozen.bind(this)),this.registerTableOption("frozenRowsField","id"),this.registerTableOption("frozenRows",!1)}initialize(){var e=document.createDocumentFragment();this.rows=[],this.topElement.classList.add("tabulator-frozen-rows-holder"),e.appendChild(document.createElement("br")),e.appendChild(this.topElement),this.table.columnManager.getContentsElement().insertBefore(e,this.table.columnManager.headersElement.nextSibling),this.subscribe("row-deleting",this.detachRow.bind(this)),this.subscribe("rows-visible",this.visibleRows.bind(this)),this.registerDisplayHandler(this.getRows.bind(this),10),this.table.options.frozenRows&&(this.subscribe("data-processed",this.initializeRows.bind(this)),this.subscribe("row-added",this.initializeRow.bind(this)),this.subscribe("table-redrawing",this.resizeHolderWidth.bind(this)),this.subscribe("column-resized",this.resizeHolderWidth.bind(this)),this.subscribe("column-show",this.resizeHolderWidth.bind(this)),this.subscribe("column-hide",this.resizeHolderWidth.bind(this))),this.resizeHolderWidth()}resizeHolderWidth(){this.topElement.style.minWidth=this.table.columnManager.headersElement.offsetWidth+"px"}initializeRows(){this.table.rowManager.getRows().forEach(e=>{this.initializeRow(e)})}initializeRow(e){var t=this.table.options.frozenRows,i=typeof t;i==="number"?e.getPosition()&&e.getPosition()+this.rows.length<=t&&this.freezeRow(e):i==="function"?t.call(this.table,e.getComponent())&&this.freezeRow(e):Array.isArray(t)&&t.includes(e.data[this.options("frozenRowsField")])&&this.freezeRow(e)}isRowFrozen(e){var t=this.rows.indexOf(e);return t>-1}isFrozen(){return!!this.rows.length}visibleRows(e,t){return this.rows.forEach(i=>{t.push(i)}),t}getRows(e){var t=e.slice(0);return this.rows.forEach(function(i){var n=t.indexOf(i);n>-1&&t.splice(n,1)}),t}freezeRow(e){e.modules.frozen?console.warn("Freeze Error - Row is already frozen"):(e.modules.frozen=!0,this.topElement.appendChild(e.getElement()),e.initialize(),e.normalizeHeight(),this.rows.push(e),this.refreshData(!1,"display"),this.table.rowManager.adjustTableSize(),this.styleRows())}unfreezeRow(e){e.modules.frozen?(e.modules.frozen=!1,this.detachRow(e),this.table.rowManager.adjustTableSize(),this.refreshData(!1,"display"),this.rows.length&&this.styleRows()):console.warn("Freeze Error - Row is already unfrozen")}detachRow(e){var t=this.rows.indexOf(e);if(t>-1){var i=e.getElement();i.parentNode&&i.parentNode.removeChild(i),this.rows.splice(t,1)}}styleRows(e){this.rows.forEach((t,i)=>{this.table.rowManager.styleRow(t,i)})}}class fx{constructor(e){return this._group=e,this.type="GroupComponent",new Proxy(this,{get:function(t,i,n){return typeof t[i]<"u"?t[i]:t._group.groupManager.table.componentFunctionBinder.handle("group",t._group,i)}})}getKey(){return this._group.key}getField(){return this._group.field}getElement(){return this._group.element}getRows(){return this._group.getRows(!0)}getSubGroups(){return this._group.getSubGroups(!0)}getParentGroup(){return this._group.parent?this._group.parent.getComponent():!1}isVisible(){return this._group.visible}show(){this._group.show()}hide(){this._group.hide()}toggle(){this._group.toggleVisibility()}scrollTo(e,t){return this._group.groupManager.table.rowManager.scrollToRow(this._group,e,t)}_getSelf(){return this._group}getTable(){return this._group.groupManager.table}}class Ao{constructor(e,t,i,n,s,a,o){this.groupManager=e,this.parent=t,this.key=n,this.level=i,this.field=s,this.hasSubGroups=i<e.groupIDLookups.length-1,this.addRow=this.hasSubGroups?this._addRowToGroup:this._addRow,this.type="group",this.old=o,this.rows=[],this.groups=[],this.groupList=[],this.generator=a,this.element=!1,this.elementContents=!1,this.height=0,this.outerHeight=0,this.initialized=!1,this.calcs={},this.initialized=!1,this.modules={},this.arrowElement=!1,this.visible=o?o.visible:typeof e.startOpen[i]<"u"?e.startOpen[i]:e.startOpen[0],this.component=null,this.createElements(),this.addBindings(),this.createValueGroups()}wipe(e){e||(this.groupList.length?this.groupList.forEach(function(t){t.wipe()}):this.rows.forEach(t=>{t.modules&&delete t.modules.group})),this.element=!1,this.arrowElement=!1,this.elementContents=!1}createElements(){var e=document.createElement("div");e.classList.add("tabulator-arrow"),this.element=document.createElement("div"),this.element.classList.add("tabulator-row"),this.element.classList.add("tabulator-group"),this.element.classList.add("tabulator-group-level-"+this.level),this.element.setAttribute("role","rowgroup"),this.arrowElement=document.createElement("div"),this.arrowElement.classList.add("tabulator-group-toggle"),this.arrowElement.appendChild(e),this.groupManager.table.options.movableRows!==!1&&this.groupManager.table.modExists("moveRow")&&this.groupManager.table.modules.moveRow.initializeGroupHeader(this)}createValueGroups(){var e=this.level+1;this.groupManager.allowedValues&&this.groupManager.allowedValues[e]&&this.groupManager.allowedValues[e].forEach(t=>{this._createGroup(t,e)})}addBindings(){var e;this.groupManager.table.options.groupToggleElement&&(e=this.groupManager.table.options.groupToggleElement=="arrow"?this.arrowElement:this.element,e.addEventListener("click",t=>{this.groupManager.table.options.groupToggleElement==="arrow"&&(t.stopPropagation(),t.stopImmediatePropagation()),setTimeout(()=>{this.toggleVisibility()})}))}_createGroup(e,t){var i=t+"_"+e,n=new Ao(this.groupManager,this,t,e,this.groupManager.groupIDLookups[t].field,this.groupManager.headerGenerator[t]||this.groupManager.headerGenerator[0],this.old?this.old.groups[i]:!1);this.groups[i]=n,this.groupList.push(n)}_addRowToGroup(e){var t=this.level+1;if(this.hasSubGroups){var i=this.groupManager.groupIDLookups[t].func(e.getData()),n=t+"_"+i;this.groupManager.allowedValues&&this.groupManager.allowedValues[t]?this.groups[n]&&this.groups[n].addRow(e):(this.groups[n]||this._createGroup(i,t),this.groups[n].addRow(e))}}_addRow(e){this.rows.push(e),e.modules.group=this}insertRow(e,t,i){var n=this.conformRowData({});e.updateData(n);var s=this.rows.indexOf(t);s>-1?i?this.rows.splice(s+1,0,e):this.rows.splice(s,0,e):i?this.rows.push(e):this.rows.unshift(e),e.modules.group=this,this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.options.columnCalcs!="table"&&this.groupManager.table.modules.columnCalcs.recalcGroup(this),this.groupManager.updateGroupRows(!0)}scrollHeader(e){this.arrowElement&&(this.arrowElement.style.marginLeft=e,this.groupList.forEach(function(t){t.scrollHeader(e)}))}getRowIndex(e){}conformRowData(e){return this.field?e[this.field]=this.key:console.warn("Data Conforming Error - Cannot conform row data to match new group as groupBy is a function"),this.parent&&(e=this.parent.conformRowData(e)),e}removeRow(e){var t=this.rows.indexOf(e),i=e.getElement();t>-1&&this.rows.splice(t,1),!this.groupManager.table.options.groupValues&&!this.rows.length?(this.parent?this.parent.removeGroup(this):this.groupManager.removeGroup(this),this.groupManager.updateGroupRows(!0)):(i.parentNode&&i.parentNode.removeChild(i),this.groupManager.blockRedraw||(this.generateGroupHeaderContents(),this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.options.columnCalcs!="table"&&this.groupManager.table.modules.columnCalcs.recalcGroup(this)))}removeGroup(e){var t=e.level+"_"+e.key,i;this.groups[t]&&(delete this.groups[t],i=this.groupList.indexOf(e),i>-1&&this.groupList.splice(i,1),this.groupList.length||(this.parent?this.parent.removeGroup(this):this.groupManager.removeGroup(this)))}getHeadersAndRows(){var e=[];return e.push(this),this._visSet(),this.calcs.top&&(this.calcs.top.detachElement(),this.calcs.top.deleteCells()),this.calcs.bottom&&(this.calcs.bottom.detachElement(),this.calcs.bottom.deleteCells()),this.visible?this.groupList.length?this.groupList.forEach(function(t){e=e.concat(t.getHeadersAndRows())}):(this.groupManager.table.options.columnCalcs!="table"&&this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.modules.columnCalcs.hasTopCalcs()&&(this.calcs.top=this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows),e.push(this.calcs.top)),e=e.concat(this.rows),this.groupManager.table.options.columnCalcs!="table"&&this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.modules.columnCalcs.hasBottomCalcs()&&(this.calcs.bottom=this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows),e.push(this.calcs.bottom))):!this.groupList.length&&this.groupManager.table.options.columnCalcs!="table"&&this.groupManager.table.modExists("columnCalcs")&&(this.groupManager.table.modules.columnCalcs.hasTopCalcs()&&this.groupManager.table.options.groupClosedShowCalcs&&(this.calcs.top=this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows),e.push(this.calcs.top)),this.groupManager.table.modules.columnCalcs.hasBottomCalcs()&&this.groupManager.table.options.groupClosedShowCalcs&&(this.calcs.bottom=this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows),e.push(this.calcs.bottom))),e}getData(e,t){var i=[];return this._visSet(),(!e||e&&this.visible)&&this.rows.forEach(n=>{i.push(n.getData(t||"data"))}),i}getRowCount(){var e=0;return this.groupList.length?this.groupList.forEach(t=>{e+=t.getRowCount()}):e=this.rows.length,e}toggleVisibility(){this.visible?this.hide():this.show()}hide(){this.visible=!1,this.groupManager.table.rowManager.getRenderMode()=="basic"&&!this.groupManager.table.options.pagination?(this.element.classList.remove("tabulator-group-visible"),this.groupList.length?this.groupList.forEach(e=>{var t=e.getHeadersAndRows();t.forEach(i=>{i.detachElement()})}):this.rows.forEach(e=>{var t=e.getElement();t.parentNode.removeChild(t)}),this.groupManager.updateGroupRows(!0)):this.groupManager.updateGroupRows(!0),this.groupManager.table.externalEvents.dispatch("groupVisibilityChanged",this.getComponent(),!1)}show(){if(this.visible=!0,this.groupManager.table.rowManager.getRenderMode()=="basic"&&!this.groupManager.table.options.pagination){this.element.classList.add("tabulator-group-visible");var e=this.generateElement();this.groupList.length?this.groupList.forEach(t=>{var i=t.getHeadersAndRows();i.forEach(n=>{var s=n.getElement();e.parentNode.insertBefore(s,e.nextSibling),n.initialize(),e=s})}):this.rows.forEach(t=>{var i=t.getElement();e.parentNode.insertBefore(i,e.nextSibling),t.initialize(),e=i}),this.groupManager.updateGroupRows(!0)}else this.groupManager.updateGroupRows(!0);this.groupManager.table.externalEvents.dispatch("groupVisibilityChanged",this.getComponent(),!0)}_visSet(){var e=[];typeof this.visible=="function"&&(this.rows.forEach(function(t){e.push(t.getData())}),this.visible=this.visible(this.key,this.getRowCount(),e,this.getComponent()))}getRowGroup(e){var t=!1;return this.groupList.length?this.groupList.forEach(function(i){var n=i.getRowGroup(e);n&&(t=n)}):this.rows.find(function(i){return i===e})&&(t=this),t}getSubGroups(e){var t=[];return this.groupList.forEach(function(i){t.push(e?i.getComponent():i)}),t}getRows(e,t){var i=[];return t&&this.groupList.length?this.groupList.forEach(n=>{i=i.concat(n.getRows(e,t))}):this.rows.forEach(function(n){i.push(e?n.getComponent():n)}),i}generateGroupHeaderContents(){var e=[],t=this.getRows(!1,!0);for(t.forEach(function(i){e.push(i.getData())}),this.elementContents=this.generator(this.key,this.getRowCount(),e,this.getComponent());this.element.firstChild;)this.element.removeChild(this.element.firstChild);typeof this.elementContents=="string"?this.element.innerHTML=this.elementContents:this.element.appendChild(this.elementContents),this.element.insertBefore(this.arrowElement,this.element.firstChild)}getPath(e=[]){return e.unshift(this.key),this.parent&&this.parent.getPath(e),e}getElement(){return this.elementContents?this.element:this.generateElement()}generateElement(){this.addBindings=!1,this._visSet(),this.visible?this.element.classList.add("tabulator-group-visible"):this.element.classList.remove("tabulator-group-visible");for(var e=0;e<this.element.childNodes.length;++e)this.element.childNodes[e].parentNode.removeChild(this.element.childNodes[e]);return this.generateGroupHeaderContents(),this.element}detachElement(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}normalizeHeight(){this.setHeight(this.element.clientHeight)}initialize(e){(!this.initialized||e)&&(this.normalizeHeight(),this.initialized=!0)}reinitialize(){this.initialized=!1,this.height=0,hr.elVisible(this.element)&&this.initialize(!0)}setHeight(e){this.height!=e&&(this.height=e,this.outerHeight=this.element.offsetHeight)}getHeight(){return this.outerHeight}getGroup(){return this}reinitializeHeight(){}calcHeight(){}setCellHeight(){}clearCellHeight(){}deinitializeHeight(){}rendered(){}getComponent(){return this.component||(this.component=new fx(this)),this.component}}class dx extends Dt{static moduleName="groupRows";constructor(e){super(e),this.groupIDLookups=!1,this.startOpen=[function(){return!1}],this.headerGenerator=[function(){return""}],this.groupList=[],this.allowedValues=!1,this.groups={},this.displayHandler=this.getRows.bind(this),this.blockRedraw=!1,this.registerTableOption("groupBy",!1),this.registerTableOption("groupStartOpen",!0),this.registerTableOption("groupValues",!1),this.registerTableOption("groupUpdateOnCellEdit",!1),this.registerTableOption("groupHeader",!1),this.registerTableOption("groupHeaderPrint",null),this.registerTableOption("groupHeaderClipboard",null),this.registerTableOption("groupHeaderHtmlOutput",null),this.registerTableOption("groupHeaderDownload",null),this.registerTableOption("groupToggleElement","arrow"),this.registerTableOption("groupClosedShowCalcs",!1),this.registerTableFunction("setGroupBy",this.setGroupBy.bind(this)),this.registerTableFunction("setGroupValues",this.setGroupValues.bind(this)),this.registerTableFunction("setGroupStartOpen",this.setGroupStartOpen.bind(this)),this.registerTableFunction("setGroupHeader",this.setGroupHeader.bind(this)),this.registerTableFunction("getGroups",this.userGetGroups.bind(this)),this.registerTableFunction("getGroupedData",this.userGetGroupedData.bind(this)),this.registerComponentFunction("row","getGroup",this.rowGetGroup.bind(this))}initialize(){this.subscribe("table-destroy",this._blockRedrawing.bind(this)),this.subscribe("rows-wipe",this._blockRedrawing.bind(this)),this.subscribe("rows-wiped",this._restore_redrawing.bind(this)),this.table.options.groupBy&&(this.table.options.groupUpdateOnCellEdit&&(this.subscribe("cell-value-updated",this.cellUpdated.bind(this)),this.subscribe("row-data-changed",this.reassignRowToGroup.bind(this),0)),this.subscribe("table-built",this.configureGroupSetup.bind(this)),this.subscribe("row-deleting",this.rowDeleting.bind(this)),this.subscribe("row-deleted",this.rowsUpdated.bind(this)),this.subscribe("scroll-horizontal",this.scrollHeaders.bind(this)),this.subscribe("rows-wipe",this.wipe.bind(this)),this.subscribe("rows-added",this.rowsUpdated.bind(this)),this.subscribe("row-moving",this.rowMoving.bind(this)),this.subscribe("row-adding-index",this.rowAddingIndex.bind(this)),this.subscribe("rows-sample",this.rowSample.bind(this)),this.subscribe("render-virtual-fill",this.virtualRenderFill.bind(this)),this.registerDisplayHandler(this.displayHandler,20),this.initialized=!0)}_blockRedrawing(){this.blockRedraw=!0}_restore_redrawing(){this.blockRedraw=!1}configureGroupSetup(){if(this.table.options.groupBy){var e=this.table.options.groupBy,t=this.table.options.groupStartOpen,i=this.table.options.groupHeader;if(this.allowedValues=this.table.options.groupValues,Array.isArray(e)&&Array.isArray(i)&&e.length>i.length&&console.warn("Error creating group headers, groupHeader array is shorter than groupBy array"),this.headerGenerator=[function(){return""}],this.startOpen=[function(){return!1}],this.langBind("groups|item",(s,a)=>{this.headerGenerator[0]=(o,l,h)=>(typeof o>"u"?"":o)+"<span>("+l+" "+(l===1?s:a.groups.items)+")</span>"}),this.groupIDLookups=[],e)this.table.modExists("columnCalcs")&&this.table.options.columnCalcs!="table"&&this.table.options.columnCalcs!="both"&&this.table.modules.columnCalcs.removeCalcs();else if(this.table.modExists("columnCalcs")&&this.table.options.columnCalcs!="group"){var n=this.table.columnManager.getRealColumns();n.forEach(s=>{s.definition.topCalc&&this.table.modules.columnCalcs.initializeTopRow(),s.definition.bottomCalc&&this.table.modules.columnCalcs.initializeBottomRow()})}Array.isArray(e)||(e=[e]),e.forEach((s,a)=>{var o,l;typeof s=="function"?o=s:(l=this.table.columnManager.getColumnByField(s),l?o=function(h){return l.getFieldValue(h)}:o=function(h){return h[s]}),this.groupIDLookups.push({field:typeof s=="function"?!1:s,func:o,values:this.allowedValues?this.allowedValues[a]:!1})}),t&&(Array.isArray(t)||(t=[t]),t.forEach(s=>{}),this.startOpen=t),i&&(this.headerGenerator=Array.isArray(i)?i:[i])}else this.groupList=[],this.groups={}}rowSample(e,t){if(this.table.options.groupBy){var i=this.getGroups(!1)[0];t.push(i.getRows(!1)[0])}return t}virtualRenderFill(){var e=this.table.rowManager.tableElement,t=this.table.rowManager.getVisibleRows();if(this.table.options.groupBy)t=t.filter(i=>i.type!=="group"),e.style.minWidth=t.length?"":this.table.columnManager.getWidth()+"px";else return t}rowAddingIndex(e,t,i){if(this.table.options.groupBy){this.assignRowToGroup(e);var n=e.modules.group.rows;return n.length>1&&(!t||t&&n.indexOf(t)==-1?i?n[0]!==e&&(t=n[0],this.table.rowManager.moveRowInArray(e.modules.group.rows,e,t,!i)):n[n.length-1]!==e&&(t=n[n.length-1],this.table.rowManager.moveRowInArray(e.modules.group.rows,e,t,!i)):this.table.rowManager.moveRowInArray(e.modules.group.rows,e,t,!i)),t}}trackChanges(){this.dispatch("group-changed")}setGroupBy(e){this.table.options.groupBy=e,this.initialized||this.initialize(),this.configureGroupSetup(),!e&&this.table.modExists("columnCalcs")&&this.table.options.columnCalcs===!0&&this.table.modules.columnCalcs.reinitializeCalcs(),this.refreshData(),this.trackChanges()}setGroupValues(e){this.table.options.groupValues=e,this.configureGroupSetup(),this.refreshData(),this.trackChanges()}setGroupStartOpen(e){this.table.options.groupStartOpen=e,this.configureGroupSetup(),this.table.options.groupBy?(this.refreshData(),this.trackChanges()):console.warn("Grouping Update - cant refresh view, no groups have been set")}setGroupHeader(e){this.table.options.groupHeader=e,this.configureGroupSetup(),this.table.options.groupBy?(this.refreshData(),this.trackChanges()):console.warn("Grouping Update - cant refresh view, no groups have been set")}userGetGroups(e){return this.getGroups(!0)}userGetGroupedData(){return this.table.options.groupBy?this.getGroupedData():this.getData()}rowGetGroup(e){return e.modules.group?e.modules.group.getComponent():!1}rowMoving(e,t,i){if(this.table.options.groupBy){!i&&t instanceof Ao&&(t=this.table.rowManager.prevDisplayRow(e)||t);var n=t instanceof Ao?t:t.modules.group,s=e instanceof Ao?e:e.modules.group;n===s?this.table.rowManager.moveRowInArray(n.rows,e,t,i):(s&&s.removeRow(e),n.insertRow(e,t,i))}}rowDeleting(e){this.table.options.groupBy&&e.modules.group&&e.modules.group.removeRow(e)}rowsUpdated(e){this.table.options.groupBy&&this.updateGroupRows(!0)}cellUpdated(e){this.table.options.groupBy&&this.reassignRowToGroup(e.row)}getRows(e){return this.table.options.groupBy&&this.groupIDLookups.length?(this.dispatchExternal("dataGrouping"),this.generateGroups(e),this.subscribedExternal("dataGrouped")&&this.dispatchExternal("dataGrouped",this.getGroups(!0)),this.updateGroupRows()):e.slice(0)}getGroups(e){var t=[];return this.groupList.forEach(function(i){t.push(e?i.getComponent():i)}),t}getChildGroups(e){var t=[];return e||(e=this),e.groupList.forEach(i=>{i.groupList.length?t=t.concat(this.getChildGroups(i)):t.push(i)}),t}wipe(){this.table.options.groupBy&&(this.groupList.forEach(function(e){e.wipe()}),this.groupList=[],this.groups={})}pullGroupListData(e){var t=[];return e.forEach(i=>{var n={};n.level=0,n.rowCount=0,n.headerContent="";var s=[];i.hasSubGroups?(s=this.pullGroupListData(i.groupList),n.level=i.level,n.rowCount=s.length-i.groupList.length,n.headerContent=i.generator(i.key,n.rowCount,i.rows,i),t.push(n),t=t.concat(s)):(n.level=i.level,n.headerContent=i.generator(i.key,i.rows.length,i.rows,i),n.rowCount=i.getRows().length,t.push(n),i.getRows().forEach(a=>{t.push(a.getData("data"))}))}),t}getGroupedData(){return this.pullGroupListData(this.groupList)}getRowGroup(e){var t=!1;return this.options("dataTree")&&(e=this.table.modules.dataTree.getTreeParentRoot(e)),this.groupList.forEach(i=>{var n=i.getRowGroup(e);n&&(t=n)}),t}countGroups(){return this.groupList.length}generateGroups(e){var t=this.groups;this.groups={},this.groupList=[],this.allowedValues&&this.allowedValues[0]?(this.allowedValues[0].forEach(i=>{this.createGroup(i,0,t)}),e.forEach(i=>{this.assignRowToExistingGroup(i,t)})):e.forEach(i=>{this.assignRowToGroup(i,t)}),Object.values(t).forEach(i=>{i.wipe(!0)})}createGroup(e,t,i){var n=t+"_"+e,s;i=i||[],s=new Ao(this,!1,t,e,this.groupIDLookups[0].field,this.headerGenerator[0],i[n]),this.groups[n]=s,this.groupList.push(s)}assignRowToExistingGroup(e,t){var i=this.groupIDLookups[0].func(e.getData()),n="0_"+i;this.groups[n]&&this.groups[n].addRow(e)}assignRowToGroup(e,t){var i=this.groupIDLookups[0].func(e.getData()),n=!this.groups["0_"+i];return n&&this.createGroup(i,0,t),this.groups["0_"+i].addRow(e),!n}reassignRowToGroup(e){if(e.type==="row"){var t=e.modules.group,i=t.getPath(),n=this.getExpectedPath(e),s;s=i.length==n.length&&i.every((a,o)=>a===n[o]),s||(t.removeRow(e),this.assignRowToGroup(e,this.groups),this.refreshData(!0))}}getExpectedPath(e){var t=[],i=e.getData();return this.groupIDLookups.forEach(n=>{t.push(n.func(i))}),t}updateGroupRows(e){var t=[];return this.blockRedraw||(this.groupList.forEach(i=>{t=t.concat(i.getHeadersAndRows())}),e&&this.refreshData(!0)),t}scrollHeaders(e){this.table.options.groupBy&&(this.table.options.renderHorizontal==="virtual"&&(e-=this.table.columnManager.renderer.vDomPadLeft),e=e+"px",this.groupList.forEach(t=>{t.scrollHeader(e)}))}removeGroup(e){var t=e.level+"_"+e.key,i;this.groups[t]&&(delete this.groups[t],i=this.groupList.indexOf(e),i>-1&&this.groupList.splice(i,1))}checkBasicModeGroupHeaderWidth(){var e=this.table.rowManager.tableElement,t=!0;this.table.rowManager.getDisplayRows().forEach((i,n)=>{this.table.rowManager.styleRow(i,n),e.appendChild(i.getElement()),i.initialize(!0),i.type!=="group"&&(t=!1)}),t?e.style.minWidth=this.table.columnManager.getWidth()+"px":e.style.minWidth=""}}var px={cellEdit:function(r){r.component.setValueProcessData(r.data.oldValue),r.component.cellRendered()},rowAdd:function(r){r.component.deleteActual(),this.table.rowManager.checkPlaceholder()},rowDelete:function(r){var e=this.table.rowManager.addRowActual(r.data.data,r.data.pos,r.data.index);this.table.options.groupBy&&this.table.modExists("groupRows")&&this.table.modules.groupRows.updateGroupRows(!0),this._rebindRow(r.component,e),this.table.rowManager.checkPlaceholder()},rowMove:function(r){var e=r.data.posFrom-r.data.posTo>0;this.table.rowManager.moveRowActual(r.component,this.table.rowManager.getRowFromPosition(r.data.posFrom),e),this.table.rowManager.regenerateRowPositions(),this.table.rowManager.reRenderInPosition()}},mx={cellEdit:function(r){r.component.setValueProcessData(r.data.newValue),r.component.cellRendered()},rowAdd:function(r){var e=this.table.rowManager.addRowActual(r.data.data,r.data.pos,r.data.index);this.table.options.groupBy&&this.table.modExists("groupRows")&&this.table.modules.groupRows.updateGroupRows(!0),this._rebindRow(r.component,e),this.table.rowManager.checkPlaceholder()},rowDelete:function(r){r.component.deleteActual(),this.table.rowManager.checkPlaceholder()},rowMove:function(r){this.table.rowManager.moveRowActual(r.component,this.table.rowManager.getRowFromPosition(r.data.posTo),r.data.after),this.table.rowManager.regenerateRowPositions(),this.table.rowManager.reRenderInPosition()}},gx={undo:["ctrl + 90","meta + 90"],redo:["ctrl + 89","meta + 89"]},vx={undo:function(r){var e=!1;this.table.options.history&&this.table.modExists("history")&&this.table.modExists("edit")&&(e=this.table.modules.edit.currentCell,e||(r.preventDefault(),this.table.modules.history.undo()))},redo:function(r){var e=!1;this.table.options.history&&this.table.modExists("history")&&this.table.modExists("edit")&&(e=this.table.modules.edit.currentCell,e||(r.preventDefault(),this.table.modules.history.redo()))}},bx={keybindings:{bindings:gx,actions:vx}};class Tc extends Dt{static moduleName="history";static moduleExtensions=bx;static undoers=px;static redoers=mx;constructor(e){super(e),this.history=[],this.index=-1,this.registerTableOption("history",!1)}initialize(){this.table.options.history&&(this.subscribe("cell-value-updated",this.cellUpdated.bind(this)),this.subscribe("cell-delete",this.clearComponentHistory.bind(this)),this.subscribe("row-delete",this.rowDeleted.bind(this)),this.subscribe("rows-wipe",this.clear.bind(this)),this.subscribe("row-added",this.rowAdded.bind(this)),this.subscribe("row-move",this.rowMoved.bind(this))),this.registerTableFunction("undo",this.undo.bind(this)),this.registerTableFunction("redo",this.redo.bind(this)),this.registerTableFunction("getHistoryUndoSize",this.getHistoryUndoSize.bind(this)),this.registerTableFunction("getHistoryRedoSize",this.getHistoryRedoSize.bind(this)),this.registerTableFunction("clearHistory",this.clear.bind(this))}rowMoved(e,t,i){this.action("rowMove",e,{posFrom:e.getPosition(),posTo:t.getPosition(),to:t,after:i})}rowAdded(e,t,i,n){this.action("rowAdd",e,{data:t,pos:i,index:n})}rowDeleted(e){var t,i;this.table.options.groupBy?(i=e.getComponent().getGroup()._getSelf().rows,t=i.indexOf(e),t&&(t=i[t-1])):(t=e.table.rowManager.getRowIndex(e),t&&(t=e.table.rowManager.rows[t-1])),this.action("rowDelete",e,{data:e.getData(),pos:!t,index:t})}cellUpdated(e){this.action("cellEdit",e,{oldValue:e.oldValue,newValue:e.value})}clear(){this.history=[],this.index=-1}action(e,t,i){this.history=this.history.slice(0,this.index+1),this.history.push({type:e,component:t,data:i}),this.index++}getHistoryUndoSize(){return this.index+1}getHistoryRedoSize(){return this.history.length-(this.index+1)}clearComponentHistory(e){var t=this.history.findIndex(function(i){return i.component===e});t>-1&&(this.history.splice(t,1),t<=this.index&&this.index--,this.clearComponentHistory(e))}undo(){if(this.index>-1){let e=this.history[this.index];return Tc.undoers[e.type].call(this,e),this.index--,this.dispatchExternal("historyUndo",e.type,e.component.getComponent(),e.data),!0}else return console.warn(this.options("history")?"History Undo Error - No more history to undo":"History module not enabled"),!1}redo(){if(this.history.length-1>this.index){this.index++;let e=this.history[this.index];return Tc.redoers[e.type].call(this,e),this.dispatchExternal("historyRedo",e.type,e.component.getComponent(),e.data),!0}else return console.warn(this.options("history")?"History Redo Error - No more history to redo":"History module not enabled"),!1}_rebindRow(e,t){this.history.forEach(function(i){if(i.component instanceof wi)i.component===e&&(i.component=t);else if(i.component instanceof ch&&i.component.row===e){var n=i.component.column.getField();n&&(i.component=t.getCell(n))}})}}class wx extends Dt{static moduleName="htmlTableImport";constructor(e){super(e),this.fieldIndex=[],this.hasIndex=!1}initialize(){this.tableElementCheck()}tableElementCheck(){this.table.originalElement&&this.table.originalElement.tagName==="TABLE"&&(this.table.originalElement.childNodes.length?this.parseTable():console.warn("Unable to parse data from empty table tag, Tabulator should be initialized on a div tag unless importing data from a table element."))}parseTable(){var e=this.table.originalElement,t=this.table.options,i=e.getElementsByTagName("th"),n=e.getElementsByTagName("tbody")[0],s=[];this.hasIndex=!1,this.dispatchExternal("htmlImporting"),n=n?n.getElementsByTagName("tr"):[],this._extractOptions(e,t),i.length?this._extractHeaders(i,n):this._generateBlankHeaders(i,n);for(var a=0;a<n.length;a++){var o=n[a],l=o.getElementsByTagName("td"),h={};this.hasIndex||(h[t.index]=a);for(var c=0;c<l.length;c++){var d=l[c];typeof this.fieldIndex[c]<"u"&&(h[this.fieldIndex[c]]=d.innerHTML)}s.push(h)}t.data=s,this.dispatchExternal("htmlImported")}_extractOptions(e,t,i){var n=e.attributes,s=Object.keys(i||t),a={};s.forEach(c=>{a[c.toLowerCase()]=c});for(var o in n){var l=n[o],h;l&&typeof l=="object"&&l.name&&l.name.indexOf("tabulator-")===0&&(h=l.name.replace("tabulator-",""),typeof a[h]<"u"&&(t[a[h]]=this._attribValue(l.value)))}}_attribValue(e){return e==="true"?!0:e==="false"?!1:e}_findCol(e){var t=this.table.options.columns.find(i=>i.title===e);return t||!1}_extractHeaders(e,t){for(var i=0;i<e.length;i++){var n=e[i],s=!1,a=this._findCol(n.textContent),o;a?s=!0:a={title:n.textContent.trim()},a.field||(a.field=n.textContent.trim().toLowerCase().replaceAll(" ","_")),o=n.getAttribute("width"),o&&!a.width&&(a.width=o),this._extractOptions(n,a,this.table.columnManager.optionsList.registeredDefaults),this.fieldIndex[i]=a.field,a.field==this.table.options.index&&(this.hasIndex=!0),s||this.table.options.columns.push(a)}}_generateBlankHeaders(e,t){for(var i=0;i<e.length;i++){var n=e[i],s={title:"",field:"col"+i};this.fieldIndex[i]=s.field;var a=n.getAttribute("width");a&&(s.width=a),this.table.options.columns.push(s)}}}function xx(r){var e=[],t=0,i=0,n=!1;for(let s=0;s<r.length;s++){let a=r[s],o=r[s+1];if(e[t]||(e[t]=[]),e[t][i]||(e[t][i]=""),a=='"'&&n&&o=='"'){e[t][i]+=a,s++;continue}if(a=='"'){n=!n;continue}if(a==","&&!n){i++;continue}if(a=="\r"&&o==`
`&&!n){i=0,t++,s++;continue}if((a=="\r"||a==`
`)&&!n){i=0,t++;continue}e[t][i]+=a}return e}function yx(r){try{return JSON.parse(r)}catch(e){return console.warn("JSON Import Error - File contents is invalid JSON",e),Promise.reject()}}function Ex(r){return r}function Cx(r){var e=this.dependencyRegistry.lookup("XLSX"),t=e.read(r),i=t.Sheets[t.SheetNames[0]];return e.utils.sheet_to_json(i,{header:1})}var _x={csv:xx,json:yx,array:Ex,xlsx:Cx};class cd extends Dt{static moduleName="import";static importers=_x;constructor(e){super(e),this.registerTableOption("importFormat"),this.registerTableOption("importReader","text"),this.registerTableOption("importHeaderTransform"),this.registerTableOption("importValueTransform"),this.registerTableOption("importDataValidator"),this.registerTableOption("importFileValidator")}initialize(){this.registerTableFunction("import",this.importFromFile.bind(this)),this.table.options.importFormat&&(this.subscribe("data-loading",this.loadDataCheck.bind(this),10),this.subscribe("data-load",this.loadData.bind(this),10))}loadDataCheck(e){return this.table.options.importFormat&&(typeof e=="string"||Array.isArray(e)&&e.length&&Array.isArray(e))}loadData(e,t,i,n,s){return this.importData(this.lookupImporter(),e).then(this.structureData.bind(this)).catch(a=>(console.error("Import Error:",a||"Unable to import data"),Promise.reject(a)))}lookupImporter(e){var t;return e||(e=this.table.options.importFormat),typeof e=="string"?t=cd.importers[e]:t=e,t||console.error("Import Error - Importer not found:",e),t}importFromFile(e,t,i){var n=this.lookupImporter(e);if(n)return this.pickFile(t,i).then(this.importData.bind(this,n)).then(this.structureData.bind(this)).then(this.mutateData.bind(this)).then(this.validateData.bind(this)).then(this.setData.bind(this)).catch(s=>(this.dispatch("import-error",s),this.dispatchExternal("importError",s),console.error("Import Error:",s||"Unable to import file"),this.table.dataLoader.alertError(),setTimeout(()=>{this.table.dataLoader.clearAlert()},3e3),Promise.reject(s)))}pickFile(e,t){return new Promise((i,n)=>{var s=document.createElement("input");s.type="file",s.accept=e,s.addEventListener("change",a=>{var o=s.files[0],l=new FileReader,h=this.validateFile(o);if(h===!0){switch(this.dispatch("import-importing",s.files),this.dispatchExternal("importImporting",s.files),t||this.table.options.importReader){case"buffer":l.readAsArrayBuffer(o);break;case"binary":l.readAsBinaryString(o);break;case"url":l.readAsDataURL(o);break;case"text":default:l.readAsText(o)}l.onload=c=>{i(l.result)},l.onerror=c=>{console.warn("File Load Error - Unable to read file"),n(c)}}else n(h)}),this.dispatch("import-choose"),this.dispatchExternal("importChoose"),s.click()})}importData(e,t){var i;return this.table.dataLoader.alertLoader(),new Promise((n,s)=>{setTimeout(()=>{i=e.call(this.table,t),i instanceof Promise||i?n(i):s()},10)})}structureData(e){var t=[];return Array.isArray(e)&&e.length&&Array.isArray(e[0])?(this.table.options.autoColumns?t=this.structureArrayToObject(e):t=this.structureArrayToColumns(e),t):e}mutateData(e){var t=[];return Array.isArray(e)?e.forEach(i=>{t.push(this.table.modules.mutator.transformRow(i,"import"))}):t=e,t}transformHeader(e){var t=[];if(this.table.options.importHeaderTransform)e.forEach(i=>{t.push(this.table.options.importHeaderTransform.call(this.table,i,e))});else return e;return t}transformData(e){var t=[];if(this.table.options.importValueTransform)e.forEach(i=>{t.push(this.table.options.importValueTransform.call(this.table,i,e))});else return e;return t}structureArrayToObject(e){var t=this.transformHeader(e.shift()),i=e.map(n=>{var s={};return n=this.transformData(n),t.forEach((a,o)=>{s[a]=n[o]}),s});return i}structureArrayToColumns(e){var t=[],i=this.transformHeader(e[0]),n=this.table.getColumns();return n[0]&&i[0]&&n[0].getDefinition().title===i[0]&&e.shift(),e.forEach(s=>{var a={};s=this.transformData(s),s.forEach((o,l)=>{var h=n[l];h&&(a[h.getField()]=o)}),t.push(a)}),t}validateFile(e){return this.table.options.importFileValidator?this.table.options.importFileValidator.call(this.table,e):!0}validateData(e){var t;return this.table.options.importDataValidator?(t=this.table.options.importDataValidator.call(this.table,e),t===!0?e:Promise.reject(t)):e}setData(e){return this.dispatch("import-imported",e),this.dispatchExternal("importImported",e),this.table.dataLoader.clearAlert(),this.table.setData(e)}}class kx extends Dt{static moduleName="interaction";constructor(e){super(e),this.eventMap={rowClick:"row-click",rowDblClick:"row-dblclick",rowContext:"row-contextmenu",rowMouseEnter:"row-mouseenter",rowMouseLeave:"row-mouseleave",rowMouseOver:"row-mouseover",rowMouseOut:"row-mouseout",rowMouseMove:"row-mousemove",rowMouseDown:"row-mousedown",rowMouseUp:"row-mouseup",rowTap:"row",rowDblTap:"row",rowTapHold:"row",cellClick:"cell-click",cellDblClick:"cell-dblclick",cellContext:"cell-contextmenu",cellMouseEnter:"cell-mouseenter",cellMouseLeave:"cell-mouseleave",cellMouseOver:"cell-mouseover",cellMouseOut:"cell-mouseout",cellMouseMove:"cell-mousemove",cellMouseDown:"cell-mousedown",cellMouseUp:"cell-mouseup",cellTap:"cell",cellDblTap:"cell",cellTapHold:"cell",headerClick:"column-click",headerDblClick:"column-dblclick",headerContext:"column-contextmenu",headerMouseEnter:"column-mouseenter",headerMouseLeave:"column-mouseleave",headerMouseOver:"column-mouseover",headerMouseOut:"column-mouseout",headerMouseMove:"column-mousemove",headerMouseDown:"column-mousedown",headerMouseUp:"column-mouseup",headerTap:"column",headerDblTap:"column",headerTapHold:"column",groupClick:"group-click",groupDblClick:"group-dblclick",groupContext:"group-contextmenu",groupMouseEnter:"group-mouseenter",groupMouseLeave:"group-mouseleave",groupMouseOver:"group-mouseover",groupMouseOut:"group-mouseout",groupMouseMove:"group-mousemove",groupMouseDown:"group-mousedown",groupMouseUp:"group-mouseup",groupTap:"group",groupDblTap:"group",groupTapHold:"group"},this.subscribers={},this.touchSubscribers={},this.columnSubscribers={},this.touchWatchers={row:{tap:null,tapDbl:null,tapHold:null},cell:{tap:null,tapDbl:null,tapHold:null},column:{tap:null,tapDbl:null,tapHold:null},group:{tap:null,tapDbl:null,tapHold:null}},this.registerColumnOption("headerClick"),this.registerColumnOption("headerDblClick"),this.registerColumnOption("headerContext"),this.registerColumnOption("headerMouseEnter"),this.registerColumnOption("headerMouseLeave"),this.registerColumnOption("headerMouseOver"),this.registerColumnOption("headerMouseOut"),this.registerColumnOption("headerMouseMove"),this.registerColumnOption("headerMouseDown"),this.registerColumnOption("headerMouseUp"),this.registerColumnOption("headerTap"),this.registerColumnOption("headerDblTap"),this.registerColumnOption("headerTapHold"),this.registerColumnOption("cellClick"),this.registerColumnOption("cellDblClick"),this.registerColumnOption("cellContext"),this.registerColumnOption("cellMouseEnter"),this.registerColumnOption("cellMouseLeave"),this.registerColumnOption("cellMouseOver"),this.registerColumnOption("cellMouseOut"),this.registerColumnOption("cellMouseMove"),this.registerColumnOption("cellMouseDown"),this.registerColumnOption("cellMouseUp"),this.registerColumnOption("cellTap"),this.registerColumnOption("cellDblTap"),this.registerColumnOption("cellTapHold")}initialize(){this.initializeExternalEvents(),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("cell-dblclick",this.cellContentsSelectionFixer.bind(this)),this.subscribe("scroll-horizontal",this.clearTouchWatchers.bind(this)),this.subscribe("scroll-vertical",this.clearTouchWatchers.bind(this))}clearTouchWatchers(){var e=Object.values(this.touchWatchers);e.forEach(t=>{for(let i in t)t[i]=null})}cellContentsSelectionFixer(e,t){var i;if(!(this.table.modExists("edit")&&this.table.modules.edit.currentCell===t)){e.preventDefault();try{document.selection?(i=document.body.createTextRange(),i.moveToElementText(t.getElement()),i.select()):window.getSelection&&(i=document.createRange(),i.selectNode(t.getElement()),window.getSelection().removeAllRanges(),window.getSelection().addRange(i))}catch{}}}initializeExternalEvents(){for(let e in this.eventMap)this.subscriptionChangeExternal(e,this.subscriptionChanged.bind(this,e))}subscriptionChanged(e,t){t?this.subscribers[e]||(this.eventMap[e].includes("-")?(this.subscribers[e]=this.handle.bind(this,e),this.subscribe(this.eventMap[e],this.subscribers[e])):this.subscribeTouchEvents(e)):this.eventMap[e].includes("-")?this.subscribers[e]&&!this.columnSubscribers[e]&&!this.subscribedExternal(e)&&(this.unsubscribe(this.eventMap[e],this.subscribers[e]),delete this.subscribers[e]):this.unsubscribeTouchEvents(e)}subscribeTouchEvents(e){var t=this.eventMap[e];this.touchSubscribers[t+"-touchstart"]||(this.touchSubscribers[t+"-touchstart"]=this.handleTouch.bind(this,t,"start"),this.touchSubscribers[t+"-touchend"]=this.handleTouch.bind(this,t,"end"),this.subscribe(t+"-touchstart",this.touchSubscribers[t+"-touchstart"]),this.subscribe(t+"-touchend",this.touchSubscribers[t+"-touchend"])),this.subscribers[e]=!0}unsubscribeTouchEvents(e){var t=!0,i=this.eventMap[e];if(this.subscribers[e]&&!this.subscribedExternal(e)){delete this.subscribers[e];for(let n in this.eventMap)this.eventMap[n]===i&&this.subscribers[n]&&(t=!1);t&&(this.unsubscribe(i+"-touchstart",this.touchSubscribers[i+"-touchstart"]),this.unsubscribe(i+"-touchend",this.touchSubscribers[i+"-touchend"]),delete this.touchSubscribers[i+"-touchstart"],delete this.touchSubscribers[i+"-touchend"])}}initializeColumn(e){var t=e.definition;for(let i in this.eventMap)t[i]&&(this.subscriptionChanged(i,!0),this.columnSubscribers[i]||(this.columnSubscribers[i]=[]),this.columnSubscribers[i].push(e))}handle(e,t,i){this.dispatchEvent(e,t,i)}handleTouch(e,t,i,n){var s=this.touchWatchers[e];switch(e==="column"&&(e="header"),t){case"start":s.tap=!0,clearTimeout(s.tapHold),s.tapHold=setTimeout(()=>{clearTimeout(s.tapHold),s.tapHold=null,s.tap=null,clearTimeout(s.tapDbl),s.tapDbl=null,this.dispatchEvent(e+"TapHold",i,n)},1e3);break;case"end":s.tap&&(s.tap=null,this.dispatchEvent(e+"Tap",i,n)),s.tapDbl?(clearTimeout(s.tapDbl),s.tapDbl=null,this.dispatchEvent(e+"DblTap",i,n)):s.tapDbl=setTimeout(()=>{clearTimeout(s.tapDbl),s.tapDbl=null},300),clearTimeout(s.tapHold),s.tapHold=null;break}}dispatchEvent(e,t,i){var n=i.getComponent(),s;this.columnSubscribers[e]&&(i instanceof ch?s=i.column.definition[e]:i instanceof rs&&(s=i.definition[e]),s&&s(t,n)),this.dispatchExternal(e,t,n)}}var Sx={navPrev:"shift + 9",navNext:9,navUp:38,navDown:40,navLeft:37,navRight:39,scrollPageUp:33,scrollPageDown:34,scrollToStart:36,scrollToEnd:35},Tx={keyBlock:function(r){r.stopPropagation(),r.preventDefault()},scrollPageUp:function(r){var e=this.table.rowManager,t=e.scrollTop-e.element.clientHeight;r.preventDefault(),e.displayRowsCount&&(t>=0?e.element.scrollTop=t:e.scrollToRow(e.getDisplayRows()[0])),this.table.element.focus()},scrollPageDown:function(r){var e=this.table.rowManager,t=e.scrollTop+e.element.clientHeight,i=e.element.scrollHeight;r.preventDefault(),e.displayRowsCount&&(t<=i?e.element.scrollTop=t:e.scrollToRow(e.getDisplayRows()[e.displayRowsCount-1])),this.table.element.focus()},scrollToStart:function(r){var e=this.table.rowManager;r.preventDefault(),e.displayRowsCount&&e.scrollToRow(e.getDisplayRows()[0]),this.table.element.focus()},scrollToEnd:function(r){var e=this.table.rowManager;r.preventDefault(),e.displayRowsCount&&e.scrollToRow(e.getDisplayRows()[e.displayRowsCount-1]),this.table.element.focus()},navPrev:function(r){this.dispatch("keybinding-nav-prev",r)},navNext:function(r){this.dispatch("keybinding-nav-next",r)},navLeft:function(r){this.dispatch("keybinding-nav-left",r)},navRight:function(r){this.dispatch("keybinding-nav-right",r)},navUp:function(r){this.dispatch("keybinding-nav-up",r)},navDown:function(r){this.dispatch("keybinding-nav-down",r)}};class Al extends Dt{static moduleName="keybindings";static bindings=Sx;static actions=Tx;constructor(e){super(e),this.watchKeys=null,this.pressedKeys=null,this.keyupBinding=!1,this.keydownBinding=!1,this.registerTableOption("keybindings",{}),this.registerTableOption("tabEndNewRow",!1)}initialize(){var e=this.table.options.keybindings,t={};this.watchKeys={},this.pressedKeys=[],e!==!1&&(Object.assign(t,Al.bindings),Object.assign(t,e),this.mapBindings(t),this.bindEvents()),this.subscribe("table-destroy",this.clearBindings.bind(this))}mapBindings(e){for(let t in e)Al.actions[t]?e[t]&&(typeof e[t]!="object"&&(e[t]=[e[t]]),e[t].forEach(i=>{var n=Array.isArray(i)?i:[i];n.forEach(s=>{this.mapBinding(t,s)})})):console.warn("Key Binding Error - no such action:",t)}mapBinding(e,t){var i={action:Al.actions[e],keys:[],ctrl:!1,shift:!1,meta:!1},n=t.toString().toLowerCase().split(" ").join("").split("+");n.forEach(s=>{switch(s){case"ctrl":i.ctrl=!0;break;case"shift":i.shift=!0;break;case"meta":i.meta=!0;break;default:s=isNaN(s)?s.toUpperCase().charCodeAt(0):parseInt(s),i.keys.push(s),this.watchKeys[s]||(this.watchKeys[s]=[]),this.watchKeys[s].push(i)}})}bindEvents(){var e=this;this.keyupBinding=function(t){var i=t.keyCode,n=e.watchKeys[i];n&&(e.pressedKeys.push(i),n.forEach(function(s){e.checkBinding(t,s)}))},this.keydownBinding=function(t){var i=t.keyCode,n=e.watchKeys[i];if(n){var s=e.pressedKeys.indexOf(i);s>-1&&e.pressedKeys.splice(s,1)}},this.table.element.addEventListener("keydown",this.keyupBinding),this.table.element.addEventListener("keyup",this.keydownBinding)}clearBindings(){this.keyupBinding&&this.table.element.removeEventListener("keydown",this.keyupBinding),this.keydownBinding&&this.table.element.removeEventListener("keyup",this.keydownBinding)}checkBinding(e,t){var i=!0;return e.ctrlKey==t.ctrl&&e.shiftKey==t.shift&&e.metaKey==t.meta?(t.keys.forEach(n=>{var s=this.pressedKeys.indexOf(n);s==-1&&(i=!1)}),i&&t.action.call(this,e),!0):!1}}class Ax extends Dt{static moduleName="menu";constructor(e){super(e),this.menuContainer=null,this.nestedMenuBlock=!1,this.currentComponent=null,this.rootPopup=null,this.columnSubscribers={},this.registerTableOption("rowContextMenu",!1),this.registerTableOption("rowClickMenu",!1),this.registerTableOption("rowDblClickMenu",!1),this.registerTableOption("groupContextMenu",!1),this.registerTableOption("groupClickMenu",!1),this.registerTableOption("groupDblClickMenu",!1),this.registerColumnOption("headerContextMenu"),this.registerColumnOption("headerClickMenu"),this.registerColumnOption("headerDblClickMenu"),this.registerColumnOption("headerMenu"),this.registerColumnOption("headerMenuIcon"),this.registerColumnOption("contextMenu"),this.registerColumnOption("clickMenu"),this.registerColumnOption("dblClickMenu")}initialize(){this.deprecatedOptionsCheck(),this.initializeRowWatchers(),this.initializeGroupWatchers(),this.subscribe("column-init",this.initializeColumn.bind(this))}deprecatedOptionsCheck(){}initializeRowWatchers(){this.table.options.rowContextMenu&&(this.subscribe("row-contextmenu",this.loadMenuEvent.bind(this,this.table.options.rowContextMenu)),this.table.on("rowTapHold",this.loadMenuEvent.bind(this,this.table.options.rowContextMenu))),this.table.options.rowClickMenu&&this.subscribe("row-click",this.loadMenuEvent.bind(this,this.table.options.rowClickMenu)),this.table.options.rowDblClickMenu&&this.subscribe("row-dblclick",this.loadMenuEvent.bind(this,this.table.options.rowDblClickMenu))}initializeGroupWatchers(){this.table.options.groupContextMenu&&(this.subscribe("group-contextmenu",this.loadMenuEvent.bind(this,this.table.options.groupContextMenu)),this.table.on("groupTapHold",this.loadMenuEvent.bind(this,this.table.options.groupContextMenu))),this.table.options.groupClickMenu&&this.subscribe("group-click",this.loadMenuEvent.bind(this,this.table.options.groupClickMenu)),this.table.options.groupDblClickMenu&&this.subscribe("group-dblclick",this.loadMenuEvent.bind(this,this.table.options.groupDblClickMenu))}initializeColumn(e){var t=e.definition;t.headerContextMenu&&!this.columnSubscribers.headerContextMenu&&(this.columnSubscribers.headerContextMenu=this.loadMenuTableColumnEvent.bind(this,"headerContextMenu"),this.subscribe("column-contextmenu",this.columnSubscribers.headerContextMenu),this.table.on("headerTapHold",this.loadMenuTableColumnEvent.bind(this,"headerContextMenu"))),t.headerClickMenu&&!this.columnSubscribers.headerClickMenu&&(this.columnSubscribers.headerClickMenu=this.loadMenuTableColumnEvent.bind(this,"headerClickMenu"),this.subscribe("column-click",this.columnSubscribers.headerClickMenu)),t.headerDblClickMenu&&!this.columnSubscribers.headerDblClickMenu&&(this.columnSubscribers.headerDblClickMenu=this.loadMenuTableColumnEvent.bind(this,"headerDblClickMenu"),this.subscribe("column-dblclick",this.columnSubscribers.headerDblClickMenu)),t.headerMenu&&this.initializeColumnHeaderMenu(e),t.contextMenu&&!this.columnSubscribers.contextMenu&&(this.columnSubscribers.contextMenu=this.loadMenuTableCellEvent.bind(this,"contextMenu"),this.subscribe("cell-contextmenu",this.columnSubscribers.contextMenu),this.table.on("cellTapHold",this.loadMenuTableCellEvent.bind(this,"contextMenu"))),t.clickMenu&&!this.columnSubscribers.clickMenu&&(this.columnSubscribers.clickMenu=this.loadMenuTableCellEvent.bind(this,"clickMenu"),this.subscribe("cell-click",this.columnSubscribers.clickMenu)),t.dblClickMenu&&!this.columnSubscribers.dblClickMenu&&(this.columnSubscribers.dblClickMenu=this.loadMenuTableCellEvent.bind(this,"dblClickMenu"),this.subscribe("cell-dblclick",this.columnSubscribers.dblClickMenu))}initializeColumnHeaderMenu(e){var t=e.definition.headerMenuIcon,i;i=document.createElement("span"),i.classList.add("tabulator-header-popup-button"),t?(typeof t=="function"&&(t=t(e.getComponent())),t instanceof HTMLElement?i.appendChild(t):i.innerHTML=t):i.innerHTML="&vellip;",i.addEventListener("click",n=>{n.stopPropagation(),n.preventDefault(),this.loadMenuEvent(e.definition.headerMenu,n,e)}),e.titleElement.insertBefore(i,e.titleElement.firstChild)}loadMenuTableCellEvent(e,t,i){i._cell&&(i=i._cell),i.column.definition[e]&&this.loadMenuEvent(i.column.definition[e],t,i)}loadMenuTableColumnEvent(e,t,i){i._column&&(i=i._column),i.definition[e]&&this.loadMenuEvent(i.definition[e],t,i)}loadMenuEvent(e,t,i){i._group?i=i._group:i._row&&(i=i._row),e=typeof e=="function"?e.call(this.table,t,i.getComponent()):e,this.loadMenu(t,i,e)}loadMenu(e,t,i,n,s){var a=!(e instanceof MouseEvent),o=document.createElement("div"),l;if(o.classList.add("tabulator-menu"),a||e.preventDefault(),!(!i||!i.length)){if(n)l=s.child(o);else{if(this.nestedMenuBlock){if(this.rootPopup)return}else this.nestedMenuBlock=setTimeout(()=>{this.nestedMenuBlock=!1},100);this.rootPopup&&this.rootPopup.hide(),this.rootPopup=l=this.popup(o)}i.forEach(h=>{var c=document.createElement("div"),d=h.label,p=h.disabled;h.separator?c.classList.add("tabulator-menu-separator"):(c.classList.add("tabulator-menu-item"),typeof d=="function"&&(d=d.call(this.table,t.getComponent())),d instanceof Node?c.appendChild(d):c.innerHTML=d,typeof p=="function"&&(p=p.call(this.table,t.getComponent())),p?(c.classList.add("tabulator-menu-item-disabled"),c.addEventListener("click",f=>{f.stopPropagation()})):h.menu&&h.menu.length?c.addEventListener("click",f=>{f.stopPropagation(),this.loadMenu(f,t,h.menu,c,l)}):h.action&&c.addEventListener("click",f=>{h.action(f,t.getComponent())}),h.menu&&h.menu.length&&c.classList.add("tabulator-menu-item-submenu")),o.appendChild(c)}),o.addEventListener("click",h=>{this.rootPopup&&this.rootPopup.hide()}),l.show(n||e),l===this.rootPopup&&(this.rootPopup.hideOnBlur(()=>{this.rootPopup=null,this.currentComponent&&(this.dispatch("menu-closed",i,l),this.dispatchExternal("menuClosed",this.currentComponent.getComponent()),this.currentComponent=null)}),this.currentComponent=t,this.dispatch("menu-opened",i,l),this.dispatchExternal("menuOpened",t.getComponent()))}}}class Fx extends Dt{static moduleName="moveColumn";constructor(e){super(e),this.placeholderElement=this.createPlaceholderElement(),this.hoverElement=!1,this.checkTimeout=!1,this.checkPeriod=250,this.moving=!1,this.toCol=!1,this.toColAfter=!1,this.startX=0,this.autoScrollMargin=40,this.autoScrollStep=5,this.autoScrollTimeout=!1,this.touchMove=!1,this.moveHover=this.moveHover.bind(this),this.endMove=this.endMove.bind(this),this.registerTableOption("movableColumns",!1)}createPlaceholderElement(){var e=document.createElement("div");return e.classList.add("tabulator-col"),e.classList.add("tabulator-col-placeholder"),e}initialize(){this.table.options.movableColumns&&(this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("alert-show",this.abortMove.bind(this)))}abortMove(){clearTimeout(this.checkTimeout)}initializeColumn(e){var t=this,i={},n;!e.modules.frozen&&!e.isGroup&&!e.isRowHeader&&(n=e.getElement(),i.mousemove=(function(s){e.parent===t.moving.parent&&((t.touchMove?s.touches[0].pageX:s.pageX)-hr.elOffset(n).left+t.table.columnManager.contentsElement.scrollLeft>e.getWidth()/2?(t.toCol!==e||!t.toColAfter)&&(n.parentNode.insertBefore(t.placeholderElement,n.nextSibling),t.moveColumn(e,!0)):(t.toCol!==e||t.toColAfter)&&(n.parentNode.insertBefore(t.placeholderElement,n),t.moveColumn(e,!1)))}).bind(t),n.addEventListener("mousedown",function(s){t.touchMove=!1,s.which===1&&(t.checkTimeout=setTimeout(function(){t.startMove(s,e)},t.checkPeriod))}),n.addEventListener("mouseup",function(s){s.which===1&&t.checkTimeout&&clearTimeout(t.checkTimeout)}),t.bindTouchEvents(e)),e.modules.moveColumn=i}bindTouchEvents(e){var t=e.getElement(),i=!1,n,s,a,o,l,h;t.addEventListener("touchstart",c=>{this.checkTimeout=setTimeout(()=>{this.touchMove=!0,n=e.nextColumn(),a=n?n.getWidth()/2:0,s=e.prevColumn(),o=s?s.getWidth()/2:0,l=0,h=0,i=!1,this.startMove(c,e)},this.checkPeriod)},{passive:!0}),t.addEventListener("touchmove",c=>{var d,p;this.moving&&(this.moveHover(c),i||(i=c.touches[0].pageX),d=c.touches[0].pageX-i,d>0?n&&d-l>a&&(p=n,p!==e&&(i=c.touches[0].pageX,p.getElement().parentNode.insertBefore(this.placeholderElement,p.getElement().nextSibling),this.moveColumn(p,!0))):s&&-d-h>o&&(p=s,p!==e&&(i=c.touches[0].pageX,p.getElement().parentNode.insertBefore(this.placeholderElement,p.getElement()),this.moveColumn(p,!1))),p&&(n=p.nextColumn(),l=a,a=n?n.getWidth()/2:0,s=p.prevColumn(),h=o,o=s?s.getWidth()/2:0))},{passive:!0}),t.addEventListener("touchend",c=>{this.checkTimeout&&clearTimeout(this.checkTimeout),this.moving&&this.endMove(c)})}startMove(e,t){var i=t.getElement(),n=this.table.columnManager.getContentsElement(),s=this.table.columnManager.getHeadersElement();this.table.modules.selectRange&&this.table.modules.selectRange.columnSelection&&this.table.modules.selectRange.mousedown&&this.table.modules.selectRange.selecting==="column"||(this.moving=t,this.startX=(this.touchMove?e.touches[0].pageX:e.pageX)-hr.elOffset(i).left,this.table.element.classList.add("tabulator-block-select"),this.placeholderElement.style.width=t.getWidth()+"px",this.placeholderElement.style.height=t.getHeight()+"px",i.parentNode.insertBefore(this.placeholderElement,i),i.parentNode.removeChild(i),this.hoverElement=i.cloneNode(!0),this.hoverElement.classList.add("tabulator-moving"),n.appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.bottom=n.clientHeight-s.offsetHeight+"px",this.touchMove||(this._bindMouseMove(),document.body.addEventListener("mousemove",this.moveHover),document.body.addEventListener("mouseup",this.endMove)),this.moveHover(e),this.dispatch("column-moving",e,this.moving))}_bindMouseMove(){this.table.columnManager.columnsByIndex.forEach(function(e){e.modules.moveColumn.mousemove&&e.getElement().addEventListener("mousemove",e.modules.moveColumn.mousemove)})}_unbindMouseMove(){this.table.columnManager.columnsByIndex.forEach(function(e){e.modules.moveColumn.mousemove&&e.getElement().removeEventListener("mousemove",e.modules.moveColumn.mousemove)})}moveColumn(e,t){var i=this.moving.getCells();this.toCol=e,this.toColAfter=t,t?e.getCells().forEach(function(n,s){var a=n.getElement(!0);a.parentNode&&i[s]&&a.parentNode.insertBefore(i[s].getElement(),a.nextSibling)}):e.getCells().forEach(function(n,s){var a=n.getElement(!0);a.parentNode&&i[s]&&a.parentNode.insertBefore(i[s].getElement(),a)})}endMove(e){(e.which===1||this.touchMove)&&(this._unbindMouseMove(),this.placeholderElement.parentNode.insertBefore(this.moving.getElement(),this.placeholderElement.nextSibling),this.placeholderElement.parentNode.removeChild(this.placeholderElement),this.hoverElement.parentNode.removeChild(this.hoverElement),this.table.element.classList.remove("tabulator-block-select"),this.toCol&&this.table.columnManager.moveColumnActual(this.moving,this.toCol,this.toColAfter),this.moving=!1,this.toCol=!1,this.toColAfter=!1,this.touchMove||(document.body.removeEventListener("mousemove",this.moveHover),document.body.removeEventListener("mouseup",this.endMove)))}moveHover(e){var t=this.table.columnManager.getContentsElement(),i=t.scrollLeft,n=(this.touchMove?e.touches[0].pageX:e.pageX)-hr.elOffset(t).left+i,s;this.hoverElement.style.left=n-this.startX+"px",n-i<this.autoScrollMargin&&(this.autoScrollTimeout||(this.autoScrollTimeout=setTimeout(()=>{s=Math.max(0,i-5),this.table.rowManager.getElement().scrollLeft=s,this.autoScrollTimeout=!1},1))),i+t.clientWidth-n<this.autoScrollMargin&&(this.autoScrollTimeout||(this.autoScrollTimeout=setTimeout(()=>{s=Math.min(t.clientWidth,i+5),this.table.rowManager.getElement().scrollLeft=s,this.autoScrollTimeout=!1},1)))}}var Rx={delete:function(r,e,t){r.delete()}},Lx={insert:function(r,e,t){return this.table.addRow(r.getData(),void 0,e),!0},add:function(r,e,t){return this.table.addRow(r.getData()),!0},update:function(r,e,t){return e?(e.update(r.getData()),!0):!1},replace:function(r,e,t){return e?(this.table.addRow(r.getData(),void 0,e),e.delete(),!0):!1}};class Ac extends Dt{static moduleName="moveRow";static senders=Rx;static receivers=Lx;constructor(e){super(e),this.placeholderElement=this.createPlaceholderElement(),this.hoverElement=!1,this.checkTimeout=!1,this.checkPeriod=150,this.moving=!1,this.toRow=!1,this.toRowAfter=!1,this.hasHandle=!1,this.startY=0,this.startX=0,this.moveHover=this.moveHover.bind(this),this.endMove=this.endMove.bind(this),this.tableRowDropEvent=!1,this.touchMove=!1,this.connection=!1,this.connectionSelectorsTables=!1,this.connectionSelectorsElements=!1,this.connectionElements=[],this.connections=[],this.connectedTable=!1,this.connectedRow=!1,this.registerTableOption("movableRows",!1),this.registerTableOption("movableRowsConnectedTables",!1),this.registerTableOption("movableRowsConnectedElements",!1),this.registerTableOption("movableRowsSender",!1),this.registerTableOption("movableRowsReceiver","insert"),this.registerColumnOption("rowHandle")}createPlaceholderElement(){var e=document.createElement("div");return e.classList.add("tabulator-row"),e.classList.add("tabulator-row-placeholder"),e}initialize(){this.table.options.movableRows&&(this.connectionSelectorsTables=this.table.options.movableRowsConnectedTables,this.connectionSelectorsElements=this.table.options.movableRowsConnectedElements,this.connection=this.connectionSelectorsTables||this.connectionSelectorsElements,this.subscribe("cell-init",this.initializeCell.bind(this)),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("row-init",this.initializeRow.bind(this)))}initializeGroupHeader(e){var t=this,i={};i.mouseup=(function(n){t.tableRowDrop(n,e)}).bind(t),i.mousemove=(function(n){var s;n.pageY-hr.elOffset(e.element).top+t.table.rowManager.element.scrollTop>e.getHeight()/2?(t.toRow!==e||!t.toRowAfter)&&(s=e.getElement(),s.parentNode.insertBefore(t.placeholderElement,s.nextSibling),t.moveRow(e,!0)):(t.toRow!==e||t.toRowAfter)&&(s=e.getElement(),s.previousSibling&&(s.parentNode.insertBefore(t.placeholderElement,s),t.moveRow(e,!1)))}).bind(t),e.modules.moveRow=i}initializeRow(e){var t=this,i={},n;i.mouseup=(function(s){t.tableRowDrop(s,e)}).bind(t),i.mousemove=(function(s){var a=e.getElement();s.pageY-hr.elOffset(a).top+t.table.rowManager.element.scrollTop>e.getHeight()/2?(t.toRow!==e||!t.toRowAfter)&&(a.parentNode.insertBefore(t.placeholderElement,a.nextSibling),t.moveRow(e,!0)):(t.toRow!==e||t.toRowAfter)&&(a.parentNode.insertBefore(t.placeholderElement,a),t.moveRow(e,!1))}).bind(t),this.hasHandle||(n=e.getElement(),n.addEventListener("mousedown",function(s){s.which===1&&(t.checkTimeout=setTimeout(function(){t.startMove(s,e)},t.checkPeriod))}),n.addEventListener("mouseup",function(s){s.which===1&&t.checkTimeout&&clearTimeout(t.checkTimeout)}),this.bindTouchEvents(e,e.getElement())),e.modules.moveRow=i}initializeColumn(e){e.definition.rowHandle&&this.table.options.movableRows!==!1&&(this.hasHandle=!0)}initializeCell(e){if(e.column.definition.rowHandle&&this.table.options.movableRows!==!1){var t=this,i=e.getElement(!0);i.addEventListener("mousedown",function(n){n.which===1&&(t.checkTimeout=setTimeout(function(){t.startMove(n,e.row)},t.checkPeriod))}),i.addEventListener("mouseup",function(n){n.which===1&&t.checkTimeout&&clearTimeout(t.checkTimeout)}),this.bindTouchEvents(e.row,i)}}bindTouchEvents(e,t){var i=!1,n,s,a,o,l,h;t.addEventListener("touchstart",c=>{this.checkTimeout=setTimeout(()=>{this.touchMove=!0,n=e.nextRow(),a=n?n.getHeight()/2:0,s=e.prevRow(),o=s?s.getHeight()/2:0,l=0,h=0,i=!1,this.startMove(c,e)},this.checkPeriod)},{passive:!0}),this.moving,this.toRow,this.toRowAfter,t.addEventListener("touchmove",c=>{var d,p;this.moving&&(c.preventDefault(),this.moveHover(c),i||(i=c.touches[0].pageY),d=c.touches[0].pageY-i,d>0?n&&d-l>a&&(p=n,p!==e&&(i=c.touches[0].pageY,p.getElement().parentNode.insertBefore(this.placeholderElement,p.getElement().nextSibling),this.moveRow(p,!0))):s&&-d-h>o&&(p=s,p!==e&&(i=c.touches[0].pageY,p.getElement().parentNode.insertBefore(this.placeholderElement,p.getElement()),this.moveRow(p,!1))),p&&(n=p.nextRow(),l=a,a=n?n.getHeight()/2:0,s=p.prevRow(),h=o,o=s?s.getHeight()/2:0))}),t.addEventListener("touchend",c=>{this.checkTimeout&&clearTimeout(this.checkTimeout),this.moving&&(this.endMove(c),this.touchMove=!1)})}_bindMouseMove(){this.table.rowManager.getDisplayRows().forEach(e=>{(e.type==="row"||e.type==="group")&&e.modules.moveRow&&e.modules.moveRow.mousemove&&e.getElement().addEventListener("mousemove",e.modules.moveRow.mousemove)})}_unbindMouseMove(){this.table.rowManager.getDisplayRows().forEach(e=>{(e.type==="row"||e.type==="group")&&e.modules.moveRow&&e.modules.moveRow.mousemove&&e.getElement().removeEventListener("mousemove",e.modules.moveRow.mousemove)})}startMove(e,t){var i=t.getElement();this.setStartPosition(e,t),this.moving=t,this.table.element.classList.add("tabulator-block-select"),this.placeholderElement.style.width=t.getWidth()+"px",this.placeholderElement.style.height=t.getHeight()+"px",this.connection?(this.table.element.classList.add("tabulator-movingrow-sending"),this.connectToTables(t)):(i.parentNode.insertBefore(this.placeholderElement,i),i.parentNode.removeChild(i)),this.hoverElement=i.cloneNode(!0),this.hoverElement.classList.add("tabulator-moving"),this.connection?(document.body.appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.top="0",this.hoverElement.style.width=this.table.element.clientWidth+"px",this.hoverElement.style.whiteSpace="nowrap",this.hoverElement.style.overflow="hidden",this.hoverElement.style.pointerEvents="none"):(this.table.rowManager.getTableElement().appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.top="0",this._bindMouseMove()),document.body.addEventListener("mousemove",this.moveHover),document.body.addEventListener("mouseup",this.endMove),this.dispatchExternal("rowMoving",t.getComponent()),this.moveHover(e)}setStartPosition(e,t){var i=this.touchMove?e.touches[0].pageX:e.pageX,n=this.touchMove?e.touches[0].pageY:e.pageY,s,a;s=t.getElement(),this.connection?(a=s.getBoundingClientRect(),this.startX=a.left-i+window.pageXOffset,this.startY=a.top-n+window.pageYOffset):this.startY=n-s.getBoundingClientRect().top}endMove(e){(!e||e.which===1||this.touchMove)&&(this._unbindMouseMove(),this.connection||(this.placeholderElement.parentNode.insertBefore(this.moving.getElement(),this.placeholderElement.nextSibling),this.placeholderElement.parentNode.removeChild(this.placeholderElement)),this.hoverElement.parentNode.removeChild(this.hoverElement),this.table.element.classList.remove("tabulator-block-select"),this.toRow?this.table.rowManager.moveRow(this.moving,this.toRow,this.toRowAfter):this.dispatchExternal("rowMoveCancelled",this.moving.getComponent()),this.moving=!1,this.toRow=!1,this.toRowAfter=!1,document.body.removeEventListener("mousemove",this.moveHover),document.body.removeEventListener("mouseup",this.endMove),this.connection&&(this.table.element.classList.remove("tabulator-movingrow-sending"),this.disconnectFromTables()))}moveRow(e,t){this.toRow=e,this.toRowAfter=t}moveHover(e){this.connection?this.moveHoverConnections.call(this,e):this.moveHoverTable.call(this,e)}moveHoverTable(e){var t=this.table.rowManager.getElement(),i=t.scrollTop,n=(this.touchMove?e.touches[0].pageY:e.pageY)-t.getBoundingClientRect().top+i;this.hoverElement.style.top=Math.min(n-this.startY,this.table.rowManager.element.scrollHeight-this.hoverElement.offsetHeight)+"px"}moveHoverConnections(e){this.hoverElement.style.left=this.startX+(this.touchMove?e.touches[0].pageX:e.pageX)+"px",this.hoverElement.style.top=this.startY+(this.touchMove?e.touches[0].pageY:e.pageY)+"px"}elementRowDrop(e,t,i){this.dispatchExternal("movableRowsElementDrop",e,t,i?i.getComponent():!1)}connectToTables(e){var t;this.connectionSelectorsTables&&(t=this.commsConnections(this.connectionSelectorsTables),this.dispatchExternal("movableRowsSendingStart",t),this.commsSend(this.connectionSelectorsTables,"moveRow","connect",{row:e})),this.connectionSelectorsElements&&(this.connectionElements=[],Array.isArray(this.connectionSelectorsElements)||(this.connectionSelectorsElements=[this.connectionSelectorsElements]),this.connectionSelectorsElements.forEach(i=>{typeof i=="string"?this.connectionElements=this.connectionElements.concat(Array.prototype.slice.call(document.querySelectorAll(i))):this.connectionElements.push(i)}),this.connectionElements.forEach(i=>{var n=s=>{this.elementRowDrop(s,i,this.moving)};i.addEventListener("mouseup",n),i.tabulatorElementDropEvent=n,i.classList.add("tabulator-movingrow-receiving")}))}disconnectFromTables(){var e;this.connectionSelectorsTables&&(e=this.commsConnections(this.connectionSelectorsTables),this.dispatchExternal("movableRowsSendingStop",e),this.commsSend(this.connectionSelectorsTables,"moveRow","disconnect")),this.connectionElements.forEach(t=>{t.classList.remove("tabulator-movingrow-receiving"),t.removeEventListener("mouseup",t.tabulatorElementDropEvent),delete t.tabulatorElementDropEvent})}connect(e,t){return this.connectedTable?(console.warn("Move Row Error - Table cannot accept connection, already connected to table:",this.connectedTable),!1):(this.connectedTable=e,this.connectedRow=t,this.table.element.classList.add("tabulator-movingrow-receiving"),this.table.rowManager.getDisplayRows().forEach(i=>{i.type==="row"&&i.modules.moveRow&&i.modules.moveRow.mouseup&&i.getElement().addEventListener("mouseup",i.modules.moveRow.mouseup)}),this.tableRowDropEvent=this.tableRowDrop.bind(this),this.table.element.addEventListener("mouseup",this.tableRowDropEvent),this.dispatchExternal("movableRowsReceivingStart",t,e),!0)}disconnect(e){e===this.connectedTable?(this.connectedTable=!1,this.connectedRow=!1,this.table.element.classList.remove("tabulator-movingrow-receiving"),this.table.rowManager.getDisplayRows().forEach(t=>{t.type==="row"&&t.modules.moveRow&&t.modules.moveRow.mouseup&&t.getElement().removeEventListener("mouseup",t.modules.moveRow.mouseup)}),this.table.element.removeEventListener("mouseup",this.tableRowDropEvent),this.dispatchExternal("movableRowsReceivingStop",e)):console.warn("Move Row Error - trying to disconnect from non connected table")}dropComplete(e,t,i){var n=!1;if(i){switch(typeof this.table.options.movableRowsSender){case"string":n=Ac.senders[this.table.options.movableRowsSender];break;case"function":n=this.table.options.movableRowsSender;break}n?n.call(this,this.moving?this.moving.getComponent():void 0,t?t.getComponent():void 0,e):this.table.options.movableRowsSender&&console.warn("Mover Row Error - no matching sender found:",this.table.options.movableRowsSender),this.dispatchExternal("movableRowsSent",this.moving.getComponent(),t?t.getComponent():void 0,e)}else this.dispatchExternal("movableRowsSentFailed",this.moving.getComponent(),t?t.getComponent():void 0,e);this.endMove()}tableRowDrop(e,t){var i=!1,n=!1;switch(e.stopImmediatePropagation(),typeof this.table.options.movableRowsReceiver){case"string":i=Ac.receivers[this.table.options.movableRowsReceiver];break;case"function":i=this.table.options.movableRowsReceiver;break}i?n=i.call(this,this.connectedRow.getComponent(),t?t.getComponent():void 0,this.connectedTable):console.warn("Mover Row Error - no matching receiver found:",this.table.options.movableRowsReceiver),n?this.dispatchExternal("movableRowsReceived",this.connectedRow.getComponent(),t?t.getComponent():void 0,this.connectedTable):this.dispatchExternal("movableRowsReceivedFailed",this.connectedRow.getComponent(),t?t.getComponent():void 0,this.connectedTable),this.commsSend(this.connectedTable,"moveRow","dropcomplete",{row:t,success:n})}commsReceived(e,t,i){switch(t){case"connect":return this.connect(e,i.row);case"disconnect":return this.disconnect(e);case"dropcomplete":return this.dropComplete(e,i.row,i.success)}}}var Nx={};class Fc extends Dt{static moduleName="mutator";static mutators=Nx;constructor(e){super(e),this.allowedTypes=["","data","edit","clipboard","import"],this.enabled=!0,this.registerColumnOption("mutator"),this.registerColumnOption("mutatorParams"),this.registerColumnOption("mutatorData"),this.registerColumnOption("mutatorDataParams"),this.registerColumnOption("mutatorEdit"),this.registerColumnOption("mutatorEditParams"),this.registerColumnOption("mutatorClipboard"),this.registerColumnOption("mutatorClipboardParams"),this.registerColumnOption("mutatorImport"),this.registerColumnOption("mutatorImportParams"),this.registerColumnOption("mutateLink")}initialize(){this.subscribe("cell-value-changing",this.transformCell.bind(this)),this.subscribe("cell-value-changed",this.mutateLink.bind(this)),this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("row-data-init-before",this.rowDataChanged.bind(this)),this.subscribe("row-data-changing",this.rowDataChanged.bind(this))}rowDataChanged(e,t,i){return this.transformRow(t,"data",i)}initializeColumn(e){var t=!1,i={};this.allowedTypes.forEach(n=>{var s="mutator"+(n.charAt(0).toUpperCase()+n.slice(1)),a;e.definition[s]&&(a=this.lookupMutator(e.definition[s]),a&&(t=!0,i[s]={mutator:a,params:e.definition[s+"Params"]||{}}))}),t&&(e.modules.mutate=i)}lookupMutator(e){var t=!1;switch(typeof e){case"string":Fc.mutators[e]?t=Fc.mutators[e]:console.warn("Mutator Error - No such mutator found, ignoring: ",e);break;case"function":t=e;break}return t}transformRow(e,t,i){var n="mutator"+(t.charAt(0).toUpperCase()+t.slice(1)),s;return this.enabled&&this.table.columnManager.traverse(a=>{var o,l,h;a.modules.mutate&&(o=a.modules.mutate[n]||a.modules.mutate.mutator||!1,o&&(s=a.getFieldValue(typeof i<"u"?i:e),(t=="data"&&!i||typeof s<"u")&&(h=a.getComponent(),l=typeof o.params=="function"?o.params(s,e,t,h):o.params,a.setFieldValue(e,o.mutator(s,e,t,l,h)))))}),e}transformCell(e,t){if(e.column.modules.mutate){var i=e.column.modules.mutate.mutatorEdit||e.column.modules.mutate.mutator||!1,n={};if(i)return n=Object.assign(n,e.row.getData()),e.column.setFieldValue(n,t),i.mutator(t,n,"edit",i.params,e.getComponent())}return t}mutateLink(e){var t=e.column.definition.mutateLink;t&&(Array.isArray(t)||(t=[t]),t.forEach(i=>{var n=e.row.getCell(i);n&&n.setValue(n.getValue(),!0,!0)}))}enable(){this.enabled=!0}disable(){this.enabled=!1}}function Px(r,e,t,i,n){var s=document.createElement("span"),a=document.createElement("span"),o=document.createElement("span"),l=document.createElement("span"),h=document.createElement("span"),c=document.createElement("span");return this.table.modules.localize.langBind("pagination|counter|showing",d=>{a.innerHTML=d}),this.table.modules.localize.langBind("pagination|counter|of",d=>{l.innerHTML=d}),this.table.modules.localize.langBind("pagination|counter|rows",d=>{c.innerHTML=d}),i?(o.innerHTML=" "+e+"-"+Math.min(e+r-1,i)+" ",h.innerHTML=" "+i+" ",s.appendChild(a),s.appendChild(o),s.appendChild(l),s.appendChild(h),s.appendChild(c)):(o.innerHTML=" 0 ",s.appendChild(a),s.appendChild(o),s.appendChild(c)),s}function Dx(r,e,t,i,n){var s=document.createElement("span"),a=document.createElement("span"),o=document.createElement("span"),l=document.createElement("span"),h=document.createElement("span"),c=document.createElement("span");return this.table.modules.localize.langBind("pagination|counter|showing",d=>{a.innerHTML=d}),o.innerHTML=" "+t+" ",this.table.modules.localize.langBind("pagination|counter|of",d=>{l.innerHTML=d}),h.innerHTML=" "+n+" ",this.table.modules.localize.langBind("pagination|counter|pages",d=>{c.innerHTML=d}),s.appendChild(a),s.appendChild(o),s.appendChild(l),s.appendChild(h),s.appendChild(c),s}var Mx={rows:Px,pages:Dx};class ud extends Dt{static moduleName="page";static pageCounters=Mx;constructor(e){super(e),this.mode="local",this.progressiveLoad=!1,this.element=null,this.pageCounterElement=null,this.pageCounter=null,this.size=0,this.page=1,this.count=5,this.max=1,this.remoteRowCountEstimate=null,this.initialLoad=!0,this.dataChanging=!1,this.pageSizes=[],this.registerTableOption("pagination",!1),this.registerTableOption("paginationMode","local"),this.registerTableOption("paginationSize",!1),this.registerTableOption("paginationInitialPage",1),this.registerTableOption("paginationCounter",!1),this.registerTableOption("paginationCounterElement",!1),this.registerTableOption("paginationButtonCount",5),this.registerTableOption("paginationSizeSelector",!1),this.registerTableOption("paginationElement",!1),this.registerTableOption("paginationAddRow","page"),this.registerTableOption("paginationOutOfRange",!1),this.registerTableOption("progressiveLoad",!1),this.registerTableOption("progressiveLoadDelay",0),this.registerTableOption("progressiveLoadScrollMargin",0),this.registerTableFunction("setMaxPage",this.setMaxPage.bind(this)),this.registerTableFunction("setPage",this.setPage.bind(this)),this.registerTableFunction("setPageToRow",this.userSetPageToRow.bind(this)),this.registerTableFunction("setPageSize",this.userSetPageSize.bind(this)),this.registerTableFunction("getPageSize",this.getPageSize.bind(this)),this.registerTableFunction("previousPage",this.previousPage.bind(this)),this.registerTableFunction("nextPage",this.nextPage.bind(this)),this.registerTableFunction("getPage",this.getPage.bind(this)),this.registerTableFunction("getPageMax",this.getPageMax.bind(this)),this.registerComponentFunction("row","pageTo",this.setPageToRow.bind(this))}initialize(){this.table.options.pagination?(this.subscribe("row-deleted",this.rowsUpdated.bind(this)),this.subscribe("row-added",this.rowsUpdated.bind(this)),this.subscribe("data-processed",this.initialLoadComplete.bind(this)),this.subscribe("table-built",this.calculatePageSizes.bind(this)),this.subscribe("footer-redraw",this.footerRedraw.bind(this)),this.table.options.paginationAddRow=="page"&&this.subscribe("row-adding-position",this.rowAddingPosition.bind(this)),this.table.options.paginationMode==="remote"&&(this.subscribe("data-params",this.remotePageParams.bind(this)),this.subscribe("data-loaded",this._parseRemoteData.bind(this))),this.table.options.progressiveLoad&&console.error("Progressive Load Error - Pagination and progressive load cannot be used at the same time"),this.registerDisplayHandler(this.restOnRenderBefore.bind(this),40),this.registerDisplayHandler(this.getRows.bind(this),50),this.createElements(),this.initializePageCounter(),this.initializePaginator()):this.table.options.progressiveLoad&&(this.subscribe("data-params",this.remotePageParams.bind(this)),this.subscribe("data-loaded",this._parseRemoteData.bind(this)),this.subscribe("table-built",this.calculatePageSizes.bind(this)),this.subscribe("data-processed",this.initialLoadComplete.bind(this)),this.initializeProgressive(this.table.options.progressiveLoad),this.table.options.progressiveLoad==="scroll"&&this.subscribe("scroll-vertical",this.scrollVertical.bind(this)))}rowAddingPosition(e,t){var i=this.table.rowManager,n=i.getDisplayRows(),s;return t?n.length?s=n[0]:i.activeRows.length&&(s=i.activeRows[i.activeRows.length-1],t=!1):n.length&&(s=n[n.length-1],t=!(n.length<this.size)),{index:s,top:t}}calculatePageSizes(){var e,t;this.table.options.paginationSize?this.size=this.table.options.paginationSize:(e=document.createElement("div"),e.classList.add("tabulator-row"),e.style.visibility="hidden",t=document.createElement("div"),t.classList.add("tabulator-cell"),t.innerHTML="Page Row Test",e.appendChild(t),this.table.rowManager.getTableElement().appendChild(e),this.size=Math.floor(this.table.rowManager.getElement().clientHeight/e.offsetHeight),this.table.rowManager.getTableElement().removeChild(e)),this.dispatchExternal("pageSizeChanged",this.size),this.generatePageSizeSelectList()}initialLoadComplete(){this.initialLoad=!1}remotePageParams(e,t,i,n){return this.initialLoad||(this.progressiveLoad&&!i||!this.progressiveLoad&&!this.dataChanging)&&this.reset(!0),n.page=this.page,this.size&&(n.size=this.size),n}userSetPageToRow(e){return this.table.options.pagination&&(e=this.table.rowManager.findRow(e),e)?this.setPageToRow(e):Promise.reject()}userSetPageSize(e){return this.table.options.pagination?(this.setPageSize(e),this.setPage(1)):!1}scrollVertical(e,t){var i,n,s;!t&&!this.table.dataLoader.loading&&(i=this.table.rowManager.getElement(),n=i.scrollHeight-i.clientHeight-e,s=this.table.options.progressiveLoadScrollMargin||i.clientHeight*2,n<s&&this.nextPage().catch(()=>{}))}restOnRenderBefore(e,t){return t||this.mode==="local"&&this.reset(),e}rowsUpdated(){this.refreshData(!0,"all")}createElements(){var e;this.element=document.createElement("span"),this.element.classList.add("tabulator-paginator"),this.pagesElement=document.createElement("span"),this.pagesElement.classList.add("tabulator-pages"),e=document.createElement("button"),e.classList.add("tabulator-page"),e.setAttribute("type","button"),e.setAttribute("role","button"),e.setAttribute("aria-label",""),e.setAttribute("title",""),this.firstBut=e.cloneNode(!0),this.firstBut.setAttribute("data-page","first"),this.prevBut=e.cloneNode(!0),this.prevBut.setAttribute("data-page","prev"),this.nextBut=e.cloneNode(!0),this.nextBut.setAttribute("data-page","next"),this.lastBut=e.cloneNode(!0),this.lastBut.setAttribute("data-page","last"),this.table.options.paginationSizeSelector&&(this.pageSizeSelect=document.createElement("select"),this.pageSizeSelect.classList.add("tabulator-page-size"))}generatePageSizeSelectList(){var e=[];if(this.pageSizeSelect){if(Array.isArray(this.table.options.paginationSizeSelector))e=this.table.options.paginationSizeSelector,this.pageSizes=e,this.pageSizes.indexOf(this.size)==-1&&e.unshift(this.size);else if(this.pageSizes.indexOf(this.size)==-1){e=[];for(let t=1;t<5;t++)e.push(this.size*t);this.pageSizes=e}else e=this.pageSizes;for(;this.pageSizeSelect.firstChild;)this.pageSizeSelect.removeChild(this.pageSizeSelect.firstChild);e.forEach(t=>{var i=document.createElement("option");i.value=t,t===!0?this.langBind("pagination|all",function(n){i.innerHTML=n}):i.innerHTML=t,this.pageSizeSelect.appendChild(i)}),this.pageSizeSelect.value=this.size}}initializePageCounter(){var e=this.table.options.paginationCounter,t=null;e&&(typeof e=="function"?t=e:t=ud.pageCounters[e],t?(this.pageCounter=t,this.pageCounterElement=document.createElement("span"),this.pageCounterElement.classList.add("tabulator-page-counter")):console.warn("Pagination Error - No such page counter found: ",e))}initializePaginator(e){var t,i;e||(this.langBind("pagination|first",n=>{this.firstBut.innerHTML=n}),this.langBind("pagination|first_title",n=>{this.firstBut.setAttribute("aria-label",n),this.firstBut.setAttribute("title",n)}),this.langBind("pagination|prev",n=>{this.prevBut.innerHTML=n}),this.langBind("pagination|prev_title",n=>{this.prevBut.setAttribute("aria-label",n),this.prevBut.setAttribute("title",n)}),this.langBind("pagination|next",n=>{this.nextBut.innerHTML=n}),this.langBind("pagination|next_title",n=>{this.nextBut.setAttribute("aria-label",n),this.nextBut.setAttribute("title",n)}),this.langBind("pagination|last",n=>{this.lastBut.innerHTML=n}),this.langBind("pagination|last_title",n=>{this.lastBut.setAttribute("aria-label",n),this.lastBut.setAttribute("title",n)}),this.firstBut.addEventListener("click",()=>{this.setPage(1)}),this.prevBut.addEventListener("click",()=>{this.previousPage()}),this.nextBut.addEventListener("click",()=>{this.nextPage()}),this.lastBut.addEventListener("click",()=>{this.setPage(this.max)}),this.table.options.paginationElement&&(this.element=this.table.options.paginationElement),this.pageSizeSelect&&(t=document.createElement("label"),this.langBind("pagination|page_size",n=>{this.pageSizeSelect.setAttribute("aria-label",n),this.pageSizeSelect.setAttribute("title",n),t.innerHTML=n}),this.element.appendChild(t),this.element.appendChild(this.pageSizeSelect),this.pageSizeSelect.addEventListener("change",n=>{this.setPageSize(this.pageSizeSelect.value=="true"?!0:this.pageSizeSelect.value),this.setPage(1)})),this.element.appendChild(this.firstBut),this.element.appendChild(this.prevBut),this.element.appendChild(this.pagesElement),this.element.appendChild(this.nextBut),this.element.appendChild(this.lastBut),this.table.options.paginationElement||(this.table.options.paginationCounter&&(this.table.options.paginationCounterElement?this.table.options.paginationCounterElement instanceof HTMLElement?this.table.options.paginationCounterElement.appendChild(this.pageCounterElement):typeof this.table.options.paginationCounterElement=="string"&&(i=document.querySelector(this.table.options.paginationCounterElement),i?i.appendChild(this.pageCounterElement):console.warn("Pagination Error - Unable to find element matching paginationCounterElement selector:",this.table.options.paginationCounterElement)):this.footerAppend(this.pageCounterElement)),this.footerAppend(this.element)),this.page=this.table.options.paginationInitialPage,this.count=this.table.options.paginationButtonCount),this.mode=this.table.options.paginationMode}initializeProgressive(e){this.initializePaginator(!0),this.mode="progressive_"+e,this.progressiveLoad=!0}trackChanges(){this.dispatch("page-changed")}setMaxRows(e){e?this.max=this.size===!0?1:Math.ceil(e/this.size):this.max=1,this.page>this.max&&(this.page=this.max)}reset(e){this.initialLoad||(this.mode=="local"||e)&&(this.page=1,this.trackChanges())}setMaxPage(e){e=parseInt(e),this.max=e||1,this.page>this.max&&(this.page=this.max,this.trigger())}setPage(e){switch(e){case"first":return this.setPage(1);case"prev":return this.previousPage();case"next":return this.nextPage();case"last":return this.setPage(this.max)}return e=parseInt(e),e>0&&e<=this.max||this.mode!=="local"?(this.page=e,this.trackChanges(),this.trigger()):(console.warn("Pagination Error - Requested page is out of range of 1 - "+this.max+":",e),Promise.reject())}setPageToRow(e){var t=this.displayRows(-1),i=t.indexOf(e);if(i>-1){var n=this.size===!0?1:Math.ceil((i+1)/this.size);return this.setPage(n)}else return console.warn("Pagination Error - Requested row is not visible"),Promise.reject()}setPageSize(e){e!==!0&&(e=parseInt(e)),e>0&&(this.size=e,this.dispatchExternal("pageSizeChanged",e)),this.pageSizeSelect&&this.generatePageSizeSelectList(),this.trackChanges()}_setPageCounter(e,t,i){var n;if(this.pageCounter)switch(this.mode==="remote"&&(t=this.size,i=(this.page-1)*this.size+1,e=this.remoteRowCountEstimate),n=this.pageCounter.call(this,t,i,this.page,e,this.max),typeof n){case"object":if(n instanceof Node){for(;this.pageCounterElement.firstChild;)this.pageCounterElement.removeChild(this.pageCounterElement.firstChild);this.pageCounterElement.appendChild(n)}else this.pageCounterElement.innerHTML="",n!=null&&console.warn("Page Counter Error - Page Counter has returned a type of object, the only valid page counter object return is an instance of Node, the page counter returned:",n);break;case"undefined":this.pageCounterElement.innerHTML="";break;default:this.pageCounterElement.innerHTML=n}}_setPageButtons(){let e=Math.floor((this.count-1)/2),t=Math.ceil((this.count-1)/2),i=this.max-this.page+e+1<this.count?this.max-this.count+1:Math.max(this.page-e,1),n=this.page<=t?Math.min(this.count,this.max):Math.min(this.page+t,this.max);for(;this.pagesElement.firstChild;)this.pagesElement.removeChild(this.pagesElement.firstChild);this.page==1?(this.firstBut.disabled=!0,this.prevBut.disabled=!0):(this.firstBut.disabled=!1,this.prevBut.disabled=!1),this.page==this.max?(this.lastBut.disabled=!0,this.nextBut.disabled=!0):(this.lastBut.disabled=!1,this.nextBut.disabled=!1);for(let s=i;s<=n;s++)s>0&&s<=this.max&&this.pagesElement.appendChild(this._generatePageButton(s));this.footerRedraw()}_generatePageButton(e){var t=document.createElement("button");return t.classList.add("tabulator-page"),e==this.page&&t.classList.add("active"),t.setAttribute("type","button"),t.setAttribute("role","button"),this.langBind("pagination|page_title",i=>{t.setAttribute("aria-label",i+" "+e),t.setAttribute("title",i+" "+e)}),t.setAttribute("data-page",e),t.textContent=e,t.addEventListener("click",i=>{this.setPage(e)}),t}previousPage(){return this.page>1?(this.page--,this.trackChanges(),this.trigger()):(console.warn("Pagination Error - Previous page would be less than page 1:",0),Promise.reject())}nextPage(){return this.page<this.max?(this.page++,this.trackChanges(),this.trigger()):(this.progressiveLoad||console.warn("Pagination Error - Next page would be greater than maximum page of "+this.max+":",this.max+1),Promise.reject())}getPage(){return this.page}getPageMax(){return this.max}getPageSize(e){return this.size}getMode(){return this.mode}getRows(e){var t=0,i,n,s,a,o=e.filter(l=>l.type==="row");if(this.mode=="local"){i=[],this.setMaxRows(e.length),this.size===!0?(n=0,s=e.length):(n=this.size*(this.page-1),s=n+parseInt(this.size)),this._setPageButtons();for(let l=n;l<s;l++){let h=e[l];h&&(i.push(h),h.type==="row"&&(a||(a=h),t++))}return this._setPageCounter(o.length,t,a?o.indexOf(a)+1:0),i}else return this._setPageButtons(),this._setPageCounter(o.length),e.slice(0)}trigger(){var e;switch(this.mode){case"local":return e=this.table.rowManager.scrollLeft,this.refreshData(),this.table.rowManager.scrollHorizontal(e),this.dispatchExternal("pageLoaded",this.getPage()),Promise.resolve();case"remote":return this.dataChanging=!0,this.reloadData(null).finally(()=>{this.dataChanging=!1});case"progressive_load":case"progressive_scroll":return this.reloadData(null,!0);default:return console.warn("Pagination Error - no such pagination mode:",this.mode),Promise.reject()}}_parseRemoteData(e){var t,i;if(typeof e.last_page>"u"&&console.warn("Remote Pagination Error - Server response missing '"+(this.options("dataReceiveParams").last_page||"last_page")+"' property"),e.data)if(this.max=parseInt(e.last_page)||1,this.remoteRowCountEstimate=typeof e.last_row<"u"?e.last_row:e.last_page*this.size-(this.page==e.last_page?this.size-e.data.length:0),this.progressiveLoad){switch(this.mode){case"progressive_load":this.page==1?this.table.rowManager.setData(e.data,!1,this.page==1):this.table.rowManager.addRows(e.data),this.page<this.max&&setTimeout(()=>{this.nextPage()},this.table.options.progressiveLoadDelay);break;case"progressive_scroll":e=this.page===1?e.data:this.table.rowManager.getData().concat(e.data),this.table.rowManager.setData(e,this.page!==1,this.page==1),t=this.table.options.progressiveLoadScrollMargin||this.table.rowManager.element.clientHeight*2,this.table.rowManager.element.scrollHeight<=this.table.rowManager.element.clientHeight+t&&this.page<this.max&&setTimeout(()=>{this.nextPage()});break}return!1}else{if(this.page>this.max&&(console.warn("Remote Pagination Error - Server returned last page value lower than the current page"),i=this.options("paginationOutOfRange"),i))return this.setPage(typeof i=="function"?i.call(this,this.page,this.max):i);this.dispatchExternal("pageLoaded",this.getPage())}else console.warn("Remote Pagination Error - Server response missing '"+(this.options("dataReceiveParams").data||"data")+"' property");return e.data}footerRedraw(){var e=this.table.footerManager.containerElement;Math.ceil(e.clientWidth)-e.scrollWidth<0?this.pagesElement.style.display="none":(this.pagesElement.style.display="",Math.ceil(e.clientWidth)-e.scrollWidth<0&&(this.pagesElement.style.display="none"))}}var Ox={local:function(r,e){var t=localStorage.getItem(r+"-"+e);return t?JSON.parse(t):!1},cookie:function(r,e){var t=document.cookie,i=r+"-"+e,n=t.indexOf(i+"="),s,a;return n>-1&&(t=t.slice(n),s=t.indexOf(";"),s>-1&&(t=t.slice(0,s)),a=t.replace(i+"=","")),a?JSON.parse(a):!1}},Ix={local:function(r,e,t){localStorage.setItem(r+"-"+e,JSON.stringify(t))},cookie:function(r,e,t){var i=new Date;i.setDate(i.getDate()+1e4),document.cookie=r+"-"+e+"="+JSON.stringify(t)+"; expires="+i.toUTCString()}};class ts extends Dt{static moduleName="persistence";static moduleInitOrder=-10;static readers=Ox;static writers=Ix;constructor(e){super(e),this.mode="",this.id="",this.defWatcherBlock=!1,this.config={},this.readFunc=!1,this.writeFunc=!1,this.registerTableOption("persistence",!1),this.registerTableOption("persistenceID",""),this.registerTableOption("persistenceMode",!0),this.registerTableOption("persistenceReaderFunc",!1),this.registerTableOption("persistenceWriterFunc",!1)}localStorageTest(){var e="_tabulator_test";try{return window.localStorage.setItem(e,e),window.localStorage.removeItem(e),!0}catch{return!1}}initialize(){if(this.table.options.persistence){var e=this.table.options.persistenceMode,t=this.table.options.persistenceID,i;this.mode=e!==!0?e:this.localStorageTest()?"local":"cookie",this.table.options.persistenceReaderFunc?typeof this.table.options.persistenceReaderFunc=="function"?this.readFunc=this.table.options.persistenceReaderFunc:ts.readers[this.table.options.persistenceReaderFunc]?this.readFunc=ts.readers[this.table.options.persistenceReaderFunc]:console.warn("Persistence Read Error - invalid reader set",this.table.options.persistenceReaderFunc):ts.readers[this.mode]?this.readFunc=ts.readers[this.mode]:console.warn("Persistence Read Error - invalid reader set",this.mode),this.table.options.persistenceWriterFunc?typeof this.table.options.persistenceWriterFunc=="function"?this.writeFunc=this.table.options.persistenceWriterFunc:ts.writers[this.table.options.persistenceWriterFunc]?this.writeFunc=ts.writers[this.table.options.persistenceWriterFunc]:console.warn("Persistence Write Error - invalid reader set",this.table.options.persistenceWriterFunc):ts.writers[this.mode]?this.writeFunc=ts.writers[this.mode]:console.warn("Persistence Write Error - invalid writer set",this.mode),this.id="tabulator-"+(t||this.table.element.getAttribute("id")||""),this.config={sort:this.table.options.persistence===!0||this.table.options.persistence.sort,filter:this.table.options.persistence===!0||this.table.options.persistence.filter,headerFilter:this.table.options.persistence===!0||this.table.options.persistence.headerFilter,group:this.table.options.persistence===!0||this.table.options.persistence.group,page:this.table.options.persistence===!0||this.table.options.persistence.page,columns:this.table.options.persistence===!0?["title","width","visible"]:this.table.options.persistence.columns},this.config.page&&(i=this.retrieveData("page"),i&&(typeof i.paginationSize<"u"&&(this.config.page===!0||this.config.page.size)&&(this.table.options.paginationSize=i.paginationSize),typeof i.paginationInitialPage<"u"&&(this.config.page===!0||this.config.page.page)&&(this.table.options.paginationInitialPage=i.paginationInitialPage))),this.config.group&&(i=this.retrieveData("group"),i&&(typeof i.groupBy<"u"&&(this.config.group===!0||this.config.group.groupBy)&&(this.table.options.groupBy=i.groupBy),typeof i.groupStartOpen<"u"&&(this.config.group===!0||this.config.group.groupStartOpen)&&(this.table.options.groupStartOpen=i.groupStartOpen),typeof i.groupHeader<"u"&&(this.config.group===!0||this.config.group.groupHeader)&&(this.table.options.groupHeader=i.groupHeader))),this.config.columns&&(this.table.options.columns=this.load("columns",this.table.options.columns),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("column-show",this.save.bind(this,"columns")),this.subscribe("column-hide",this.save.bind(this,"columns")),this.subscribe("column-moved",this.save.bind(this,"columns"))),this.subscribe("table-built",this.tableBuilt.bind(this),0),this.subscribe("table-redraw",this.tableRedraw.bind(this)),this.subscribe("filter-changed",this.eventSave.bind(this,"filter")),this.subscribe("filter-changed",this.eventSave.bind(this,"headerFilter")),this.subscribe("sort-changed",this.eventSave.bind(this,"sort")),this.subscribe("group-changed",this.eventSave.bind(this,"group")),this.subscribe("page-changed",this.eventSave.bind(this,"page")),this.subscribe("column-resized",this.eventSave.bind(this,"columns")),this.subscribe("column-width",this.eventSave.bind(this,"columns")),this.subscribe("layout-refreshed",this.eventSave.bind(this,"columns"))}this.registerTableFunction("getColumnLayout",this.getColumnLayout.bind(this)),this.registerTableFunction("setColumnLayout",this.setColumnLayout.bind(this))}eventSave(e){this.config[e]&&this.save(e)}tableBuilt(){var e,t,i;this.config.sort&&(e=this.load("sort"),e&&(this.table.options.initialSort=e)),this.config.filter&&(t=this.load("filter"),t&&(this.table.options.initialFilter=t)),this.config.headerFilter&&(i=this.load("headerFilter"),i&&(this.table.options.initialHeaderFilter=i))}tableRedraw(e){e&&this.config.columns&&this.save("columns")}getColumnLayout(){return this.parseColumns(this.table.columnManager.getColumns())}setColumnLayout(e){return this.table.columnManager.setColumns(this.mergeDefinition(this.table.options.columns,e,!0)),!0}initializeColumn(e){var t,i;this.config.columns&&(this.defWatcherBlock=!0,t=e.getDefinition(),i=this.config.columns===!0?Object.keys(t):this.config.columns,i.forEach(n=>{var s=Object.getOwnPropertyDescriptor(t,n),a=t[n];s&&Object.defineProperty(t,n,{set:o=>{a=o,this.defWatcherBlock||this.save("columns"),s.set&&s.set(o)},get:()=>(s.get&&s.get(),a)})}),this.defWatcherBlock=!1)}load(e,t){var i=this.retrieveData(e);return t&&(i=i?this.mergeDefinition(t,i):t),i}retrieveData(e){return this.readFunc?this.readFunc(this.id,e):!1}mergeDefinition(e,t,i){var n=[];return t=t||[],t.forEach((s,a)=>{var o=this._findColumn(e,s),l;o&&(i?l=Object.keys(s):this.config.columns===!0||this.config.columns==null?(l=Object.keys(o),l.push("width")):l=this.config.columns,l.forEach(h=>{h!=="columns"&&typeof s[h]<"u"&&(o[h]=s[h])}),o.columns&&(o.columns=this.mergeDefinition(o.columns,s.columns)),n.push(o))}),e.forEach((s,a)=>{var o=this._findColumn(t,s);o||(n.length>a?n.splice(a,0,s):n.push(s))}),n}_findColumn(e,t){var i=t.columns?"group":t.field?"field":"object";return e.find(function(n){switch(i){case"group":return n.title===t.title&&n.columns.length===t.columns.length;case"field":return n.field===t.field;case"object":return n===t}})}save(e){var t={};switch(e){case"columns":t=this.parseColumns(this.table.columnManager.getColumns());break;case"filter":t=this.table.modules.filter.getFilters();break;case"headerFilter":t=this.table.modules.filter.getHeaderFilters();break;case"sort":t=this.validateSorters(this.table.modules.sort.getSort());break;case"group":t=this.getGroupConfig();break;case"page":t=this.getPageConfig();break}this.writeFunc&&this.writeFunc(this.id,e,t)}validateSorters(e){return e.forEach(function(t){t.column=t.field,delete t.field}),e}getGroupConfig(){var e={};return this.config.group&&((this.config.group===!0||this.config.group.groupBy)&&(e.groupBy=this.table.options.groupBy),(this.config.group===!0||this.config.group.groupStartOpen)&&(e.groupStartOpen=this.table.options.groupStartOpen),(this.config.group===!0||this.config.group.groupHeader)&&(e.groupHeader=this.table.options.groupHeader)),e}getPageConfig(){var e={};return this.config.page&&((this.config.page===!0||this.config.page.size)&&(e.paginationSize=this.table.modules.page.getPageSize()),(this.config.page===!0||this.config.page.page)&&(e.paginationInitialPage=this.table.modules.page.getPage())),e}parseColumns(e){var t=[],i=["headerContextMenu","headerMenu","contextMenu","clickMenu"];return e.forEach(n=>{var s={},a=n.getDefinition(),o;n.isGroup?(s.title=a.title,s.columns=this.parseColumns(n.getColumns())):(s.field=n.getField(),this.config.columns===!0||this.config.columns==null?(o=Object.keys(a),o.push("width"),o.push("visible")):o=this.config.columns,o.forEach(l=>{switch(l){case"width":s.width=n.getWidth();break;case"visible":s.visible=n.visible;break;default:typeof a[l]!="function"&&i.indexOf(l)===-1&&(s[l]=a[l])}})),t.push(s)}),t}}class Bx extends Dt{static moduleName="popup";constructor(e){super(e),this.columnSubscribers={},this.registerTableOption("rowContextPopup",!1),this.registerTableOption("rowClickPopup",!1),this.registerTableOption("rowDblClickPopup",!1),this.registerTableOption("groupContextPopup",!1),this.registerTableOption("groupClickPopup",!1),this.registerTableOption("groupDblClickPopup",!1),this.registerColumnOption("headerContextPopup"),this.registerColumnOption("headerClickPopup"),this.registerColumnOption("headerDblClickPopup"),this.registerColumnOption("headerPopup"),this.registerColumnOption("headerPopupIcon"),this.registerColumnOption("contextPopup"),this.registerColumnOption("clickPopup"),this.registerColumnOption("dblClickPopup"),this.registerComponentFunction("cell","popup",this._componentPopupCall.bind(this)),this.registerComponentFunction("column","popup",this._componentPopupCall.bind(this)),this.registerComponentFunction("row","popup",this._componentPopupCall.bind(this)),this.registerComponentFunction("group","popup",this._componentPopupCall.bind(this))}initialize(){this.initializeRowWatchers(),this.initializeGroupWatchers(),this.subscribe("column-init",this.initializeColumn.bind(this))}_componentPopupCall(e,t,i){this.loadPopupEvent(t,null,e,i)}initializeRowWatchers(){this.table.options.rowContextPopup&&(this.subscribe("row-contextmenu",this.loadPopupEvent.bind(this,this.table.options.rowContextPopup)),this.table.on("rowTapHold",this.loadPopupEvent.bind(this,this.table.options.rowContextPopup))),this.table.options.rowClickPopup&&this.subscribe("row-click",this.loadPopupEvent.bind(this,this.table.options.rowClickPopup)),this.table.options.rowDblClickPopup&&this.subscribe("row-dblclick",this.loadPopupEvent.bind(this,this.table.options.rowDblClickPopup))}initializeGroupWatchers(){this.table.options.groupContextPopup&&(this.subscribe("group-contextmenu",this.loadPopupEvent.bind(this,this.table.options.groupContextPopup)),this.table.on("groupTapHold",this.loadPopupEvent.bind(this,this.table.options.groupContextPopup))),this.table.options.groupClickPopup&&this.subscribe("group-click",this.loadPopupEvent.bind(this,this.table.options.groupClickPopup)),this.table.options.groupDblClickPopup&&this.subscribe("group-dblclick",this.loadPopupEvent.bind(this,this.table.options.groupDblClickPopup))}initializeColumn(e){var t=e.definition;t.headerContextPopup&&!this.columnSubscribers.headerContextPopup&&(this.columnSubscribers.headerContextPopup=this.loadPopupTableColumnEvent.bind(this,"headerContextPopup"),this.subscribe("column-contextmenu",this.columnSubscribers.headerContextPopup),this.table.on("headerTapHold",this.loadPopupTableColumnEvent.bind(this,"headerContextPopup"))),t.headerClickPopup&&!this.columnSubscribers.headerClickPopup&&(this.columnSubscribers.headerClickPopup=this.loadPopupTableColumnEvent.bind(this,"headerClickPopup"),this.subscribe("column-click",this.columnSubscribers.headerClickPopup)),t.headerDblClickPopup&&!this.columnSubscribers.headerDblClickPopup&&(this.columnSubscribers.headerDblClickPopup=this.loadPopupTableColumnEvent.bind(this,"headerDblClickPopup"),this.subscribe("column-dblclick",this.columnSubscribers.headerDblClickPopup)),t.headerPopup&&this.initializeColumnHeaderPopup(e),t.contextPopup&&!this.columnSubscribers.contextPopup&&(this.columnSubscribers.contextPopup=this.loadPopupTableCellEvent.bind(this,"contextPopup"),this.subscribe("cell-contextmenu",this.columnSubscribers.contextPopup),this.table.on("cellTapHold",this.loadPopupTableCellEvent.bind(this,"contextPopup"))),t.clickPopup&&!this.columnSubscribers.clickPopup&&(this.columnSubscribers.clickPopup=this.loadPopupTableCellEvent.bind(this,"clickPopup"),this.subscribe("cell-click",this.columnSubscribers.clickPopup)),t.dblClickPopup&&!this.columnSubscribers.dblClickPopup&&(this.columnSubscribers.dblClickPopup=this.loadPopupTableCellEvent.bind(this,"dblClickPopup"),this.subscribe("cell-click",this.columnSubscribers.dblClickPopup))}initializeColumnHeaderPopup(e){var t=e.definition.headerPopupIcon,i;i=document.createElement("span"),i.classList.add("tabulator-header-popup-button"),t?(typeof t=="function"&&(t=t(e.getComponent())),t instanceof HTMLElement?i.appendChild(t):i.innerHTML=t):i.innerHTML="&vellip;",i.addEventListener("click",n=>{n.stopPropagation(),n.preventDefault(),this.loadPopupEvent(e.definition.headerPopup,n,e)}),e.titleElement.insertBefore(i,e.titleElement.firstChild)}loadPopupTableCellEvent(e,t,i){i._cell&&(i=i._cell),i.column.definition[e]&&this.loadPopupEvent(i.column.definition[e],t,i)}loadPopupTableColumnEvent(e,t,i){i._column&&(i=i._column),i.definition[e]&&this.loadPopupEvent(i.definition[e],t,i)}loadPopupEvent(e,t,i,n){var s;function a(o){s=o}i._group?i=i._group:i._row&&(i=i._row),e=typeof e=="function"?e.call(this.table,t,i.getComponent(),a):e,this.loadPopup(t,i,e,s,n)}loadPopup(e,t,i,n,s){var a=!(e instanceof MouseEvent),o,l;i instanceof HTMLElement?o=i:(o=document.createElement("div"),o.innerHTML=i),o.classList.add("tabulator-popup"),o.addEventListener("click",h=>{h.stopPropagation()}),a||e.preventDefault(),l=this.popup(o),typeof n=="function"&&l.renderCallback(n),e?l.show(e):l.show(t.getElement(),s||"center"),l.hideOnBlur(()=>{this.dispatchExternal("popupClosed",t.getComponent())}),this.dispatchExternal("popupOpened",t.getComponent())}}class Hx extends Dt{static moduleName="print";constructor(e){super(e),this.element=!1,this.manualBlock=!1,this.beforeprintEventHandler=null,this.afterprintEventHandler=null,this.registerTableOption("printAsHtml",!1),this.registerTableOption("printFormatter",!1),this.registerTableOption("printHeader",!1),this.registerTableOption("printFooter",!1),this.registerTableOption("printStyled",!0),this.registerTableOption("printRowRange","visible"),this.registerTableOption("printConfig",{}),this.registerColumnOption("print"),this.registerColumnOption("titlePrint")}initialize(){this.table.options.printAsHtml&&(this.beforeprintEventHandler=this.replaceTable.bind(this),this.afterprintEventHandler=this.cleanup.bind(this),window.addEventListener("beforeprint",this.beforeprintEventHandler),window.addEventListener("afterprint",this.afterprintEventHandler),this.subscribe("table-destroy",this.destroy.bind(this))),this.registerTableFunction("print",this.printFullscreen.bind(this))}destroy(){this.table.options.printAsHtml&&(window.removeEventListener("beforeprint",this.beforeprintEventHandler),window.removeEventListener("afterprint",this.afterprintEventHandler))}replaceTable(){this.manualBlock||(this.element=document.createElement("div"),this.element.classList.add("tabulator-print-table"),this.element.appendChild(this.table.modules.export.generateTable(this.table.options.printConfig,this.table.options.printStyled,this.table.options.printRowRange,"print")),this.table.element.style.display="none",this.table.element.parentNode.insertBefore(this.element,this.table.element))}cleanup(){document.body.classList.remove("tabulator-print-fullscreen-hide"),this.element&&this.element.parentNode&&(this.element.parentNode.removeChild(this.element),this.table.element.style.display="")}printFullscreen(e,t,i){var n=window.scrollX,s=window.scrollY,a=document.createElement("div"),o=document.createElement("div"),l=this.table.modules.export.generateTable(typeof i<"u"?i:this.table.options.printConfig,typeof t<"u"?t:this.table.options.printStyled,e||this.table.options.printRowRange,"print"),h,c;this.manualBlock=!0,this.element=document.createElement("div"),this.element.classList.add("tabulator-print-fullscreen"),this.table.options.printHeader&&(a.classList.add("tabulator-print-header"),h=typeof this.table.options.printHeader=="function"?this.table.options.printHeader.call(this.table):this.table.options.printHeader,typeof h=="string"?a.innerHTML=h:a.appendChild(h),this.element.appendChild(a)),this.element.appendChild(l),this.table.options.printFooter&&(o.classList.add("tabulator-print-footer"),c=typeof this.table.options.printFooter=="function"?this.table.options.printFooter.call(this.table):this.table.options.printFooter,typeof c=="string"?o.innerHTML=c:o.appendChild(c),this.element.appendChild(o)),document.body.classList.add("tabulator-print-fullscreen-hide"),document.body.appendChild(this.element),this.table.options.printFormatter&&this.table.options.printFormatter(this.element,l),window.print(),this.cleanup(),window.scrollTo(n,s),this.manualBlock=!1}}class zx extends Dt{static moduleName="reactiveData";constructor(e){super(e),this.data=!1,this.blocked=!1,this.origFuncs={},this.currentVersion=0,this.registerTableOption("reactiveData",!1)}initialize(){this.table.options.reactiveData&&(this.subscribe("cell-value-save-before",this.block.bind(this,"cellsave")),this.subscribe("cell-value-save-after",this.unblock.bind(this,"cellsave")),this.subscribe("row-data-save-before",this.block.bind(this,"rowsave")),this.subscribe("row-data-save-after",this.unblock.bind(this,"rowsave")),this.subscribe("row-data-init-after",this.watchRow.bind(this)),this.subscribe("data-processing",this.watchData.bind(this)),this.subscribe("table-destroy",this.unwatchData.bind(this)))}watchData(e){var t=this,i;this.currentVersion++,i=this.currentVersion,this.unwatchData(),this.data=e,this.origFuncs.push=e.push,Object.defineProperty(this.data,"push",{enumerable:!1,configurable:!0,value:function(){var n=Array.from(arguments),s;return!t.blocked&&i===t.currentVersion&&(t.block("data-push"),n.forEach(a=>{t.table.rowManager.addRowActual(a,!1)}),s=t.origFuncs.push.apply(e,arguments),t.unblock("data-push")),s}}),this.origFuncs.unshift=e.unshift,Object.defineProperty(this.data,"unshift",{enumerable:!1,configurable:!0,value:function(){var n=Array.from(arguments),s;return!t.blocked&&i===t.currentVersion&&(t.block("data-unshift"),n.forEach(a=>{t.table.rowManager.addRowActual(a,!0)}),s=t.origFuncs.unshift.apply(e,arguments),t.unblock("data-unshift")),s}}),this.origFuncs.shift=e.shift,Object.defineProperty(this.data,"shift",{enumerable:!1,configurable:!0,value:function(){var n,s;return!t.blocked&&i===t.currentVersion&&(t.block("data-shift"),t.data.length&&(n=t.table.rowManager.getRowFromDataObject(t.data[0]),n&&n.deleteActual()),s=t.origFuncs.shift.call(e),t.unblock("data-shift")),s}}),this.origFuncs.pop=e.pop,Object.defineProperty(this.data,"pop",{enumerable:!1,configurable:!0,value:function(){var n,s;return!t.blocked&&i===t.currentVersion&&(t.block("data-pop"),t.data.length&&(n=t.table.rowManager.getRowFromDataObject(t.data[t.data.length-1]),n&&n.deleteActual()),s=t.origFuncs.pop.call(e),t.unblock("data-pop")),s}}),this.origFuncs.splice=e.splice,Object.defineProperty(this.data,"splice",{enumerable:!1,configurable:!0,value:function(){var n=Array.from(arguments),s=n[0]<0?e.length+n[0]:n[0],a=n[1],o=n[2]?n.slice(2):!1,l,h;if(!t.blocked&&i===t.currentVersion){if(t.block("data-splice"),o&&(l=e[s]?t.table.rowManager.getRowFromDataObject(e[s]):!1,l?o.forEach(d=>{t.table.rowManager.addRowActual(d,!0,l,!0)}):(o=o.slice().reverse(),o.forEach(d=>{t.table.rowManager.addRowActual(d,!0,!1,!0)}))),a!==0){var c=e.slice(s,typeof n[1]>"u"?n[1]:s+a);c.forEach((d,p)=>{var f=t.table.rowManager.getRowFromDataObject(d);f&&f.deleteActual(p!==c.length-1)})}(o||a!==0)&&t.table.rowManager.reRenderInPosition(),h=t.origFuncs.splice.apply(e,arguments),t.unblock("data-splice")}return h}})}unwatchData(){if(this.data!==!1)for(var e in this.origFuncs)Object.defineProperty(this.data,e,{enumerable:!0,configurable:!0,writable:!0,value:this.origFuncs.key})}watchRow(e){var t=e.getData();for(var i in t)this.watchKey(e,t,i);this.table.options.dataTree&&this.watchTreeChildren(e)}watchTreeChildren(e){var t=this,i=e.getData()[this.table.options.dataTreeChildField],n={};i&&(n.push=i.push,Object.defineProperty(i,"push",{enumerable:!1,configurable:!0,value:()=>{if(!t.blocked){t.block("tree-push");var s=n.push.apply(i,arguments);this.rebuildTree(e),t.unblock("tree-push")}return s}}),n.unshift=i.unshift,Object.defineProperty(i,"unshift",{enumerable:!1,configurable:!0,value:()=>{if(!t.blocked){t.block("tree-unshift");var s=n.unshift.apply(i,arguments);this.rebuildTree(e),t.unblock("tree-unshift")}return s}}),n.shift=i.shift,Object.defineProperty(i,"shift",{enumerable:!1,configurable:!0,value:()=>{if(!t.blocked){t.block("tree-shift");var s=n.shift.call(i);this.rebuildTree(e),t.unblock("tree-shift")}return s}}),n.pop=i.pop,Object.defineProperty(i,"pop",{enumerable:!1,configurable:!0,value:()=>{if(!t.blocked){t.block("tree-pop");var s=n.pop.call(i);this.rebuildTree(e),t.unblock("tree-pop")}return s}}),n.splice=i.splice,Object.defineProperty(i,"splice",{enumerable:!1,configurable:!0,value:()=>{if(!t.blocked){t.block("tree-splice");var s=n.splice.apply(i,arguments);this.rebuildTree(e),t.unblock("tree-splice")}return s}}))}rebuildTree(e){this.table.modules.dataTree.initializeRow(e),this.table.modules.dataTree.layoutRow(e),this.table.rowManager.refreshActiveData("tree",!1,!0)}watchKey(e,t,i){var n=this,s=Object.getOwnPropertyDescriptor(t,i),a=t[i],o=this.currentVersion;Object.defineProperty(t,i,{set:l=>{if(a=l,!n.blocked&&o===n.currentVersion){n.block("key");var h={};h[i]=l,e.updateData(h),n.unblock("key")}s.set&&s.set(l)},get:()=>(s.get&&s.get(),a)})}unwatchRow(e){var t=e.getData();for(var i in t)Object.defineProperty(t,i,{value:t[i]})}block(e){this.blocked||(this.blocked=e)}unblock(e){this.blocked===e&&(this.blocked=!1)}}class jx extends Dt{static moduleName="resizeColumns";constructor(e){super(e),this.startColumn=!1,this.startX=!1,this.startWidth=!1,this.latestX=!1,this.handle=null,this.initialNextColumn=null,this.nextColumn=null,this.initialized=!1,this.registerColumnOption("resizable",!0),this.registerTableOption("resizableColumnFit",!1),this.registerTableOption("resizableColumnGuide",!1)}initialize(){this.subscribe("column-rendered",this.layoutColumnHeader.bind(this))}initializeEventWatchers(){this.initialized||(this.subscribe("cell-rendered",this.layoutCellHandles.bind(this)),this.subscribe("cell-delete",this.deInitializeComponent.bind(this)),this.subscribe("cell-height",this.resizeHandle.bind(this)),this.subscribe("column-moved",this.columnLayoutUpdated.bind(this)),this.subscribe("column-hide",this.deInitializeColumn.bind(this)),this.subscribe("column-show",this.columnLayoutUpdated.bind(this)),this.subscribe("column-width",this.columnWidthUpdated.bind(this)),this.subscribe("column-delete",this.deInitializeComponent.bind(this)),this.subscribe("column-height",this.resizeHandle.bind(this)),this.initialized=!0)}layoutCellHandles(e){e.row.type==="row"&&(this.deInitializeComponent(e),this.initializeColumn("cell",e,e.column,e.element))}layoutColumnHeader(e){e.definition.resizable&&(this.initializeEventWatchers(),this.deInitializeComponent(e),this.initializeColumn("header",e,e,e.element))}columnLayoutUpdated(e){var t=e.prevColumn();this.reinitializeColumn(e),t&&this.reinitializeColumn(t)}columnWidthUpdated(e){e.modules.frozen&&(this.table.modules.frozenColumns.leftColumns.includes(e)?this.table.modules.frozenColumns.leftColumns.forEach(t=>{this.reinitializeColumn(t)}):this.table.modules.frozenColumns.rightColumns.includes(e)&&this.table.modules.frozenColumns.rightColumns.forEach(t=>{this.reinitializeColumn(t)}))}frozenColumnOffset(e){var t=!1;return e.modules.frozen&&(t=e.modules.frozen.marginValue,e.modules.frozen.position==="left"?t+=e.getWidth()-3:t&&(t-=3)),t!==!1?t+"px":!1}reinitializeColumn(e){var t=this.frozenColumnOffset(e);e.cells.forEach(i=>{i.modules.resize&&i.modules.resize.handleEl&&(t&&(i.modules.resize.handleEl.style[e.modules.frozen.position]=t,i.modules.resize.handleEl.style["z-index"]=11),i.element.after(i.modules.resize.handleEl))}),e.modules.resize&&e.modules.resize.handleEl&&(t&&(e.modules.resize.handleEl.style[e.modules.frozen.position]=t),e.element.after(e.modules.resize.handleEl))}initializeColumn(e,t,i,n){var s=this,a=!1,o=i.definition.resizable,l={},h=i.getLastColumn();if(e==="header"&&(a=i.definition.formatter=="textarea"||i.definition.variableHeight,l={variableHeight:a}),(o===!0||o==e)&&this._checkResizability(h)){var c=document.createElement("span");c.className="tabulator-col-resize-handle",c.addEventListener("click",function(p){p.stopPropagation()});var d=function(p){s.startColumn=i,s.initialNextColumn=s.nextColumn=h.nextColumn(),s._mouseDown(p,h,c)};c.addEventListener("mousedown",d),c.addEventListener("touchstart",d,{passive:!0}),c.addEventListener("dblclick",p=>{var f=h.getWidth();p.stopPropagation(),h.reinitializeWidth(!0),f!==h.getWidth()&&(s.dispatch("column-resized",h),s.dispatchExternal("columnResized",h.getComponent()))}),i.modules.frozen&&(c.style.position="sticky",c.style[i.modules.frozen.position]=this.frozenColumnOffset(i)),l.handleEl=c,n.parentNode&&i.visible&&n.after(c)}t.modules.resize=l}deInitializeColumn(e){this.deInitializeComponent(e),e.cells.forEach(t=>{this.deInitializeComponent(t)})}deInitializeComponent(e){var t;e.modules.resize&&(t=e.modules.resize.handleEl,t&&t.parentElement&&t.parentElement.removeChild(t))}resizeHandle(e,t){e.modules.resize&&e.modules.resize.handleEl&&(e.modules.resize.handleEl.style.height=t)}resize(e,t){var i=typeof e.clientX>"u"?e.touches[0].clientX:e.clientX,n=i-this.startX,s=i-this.latestX,a,o;if(this.latestX=i,this.table.rtl&&(n=-n,s=-s),a=t.width==t.minWidth||t.width==t.maxWidth,t.setWidth(this.startWidth+n),o=t.width==t.minWidth||t.width==t.maxWidth,s<0&&(this.nextColumn=this.initialNextColumn),this.table.options.resizableColumnFit&&this.nextColumn&&!(a&&o)){let l=this.nextColumn.getWidth();s>0&&l<=this.nextColumn.minWidth&&(this.nextColumn=this.nextColumn.nextColumn()),this.nextColumn&&this.nextColumn.setWidth(this.nextColumn.getWidth()-s)}this.table.columnManager.rerenderColumns(!0),!this.table.browserSlow&&t.modules.resize&&t.modules.resize.variableHeight&&t.checkCellHeights()}calcGuidePosition(e,t,i){var n=typeof e.clientX>"u"?e.touches[0].clientX:e.clientX,s=i.getBoundingClientRect().x-this.table.element.getBoundingClientRect().x,a=this.table.element.getBoundingClientRect().x,o=t.element.getBoundingClientRect().left-a,l=n-this.startX,h=Math.max(s+l,o+t.minWidth);return t.maxWidth&&(h=Math.min(h,o+t.maxWidth)),h}_checkResizability(e){return e.definition.resizable}_mouseDown(e,t,i){var n=this,s;this.dispatchExternal("columnResizing",t.getComponent()),n.table.options.resizableColumnGuide&&(s=document.createElement("span"),s.classList.add("tabulator-col-resize-guide"),n.table.element.appendChild(s),setTimeout(()=>{s.style.left=n.calcGuidePosition(e,t,i)+"px"})),n.table.element.classList.add("tabulator-block-select");function a(l){n.table.options.resizableColumnGuide?s.style.left=n.calcGuidePosition(l,t,i)+"px":n.resize(l,t)}function o(l){n.table.options.resizableColumnGuide&&(n.resize(l,t),s.remove()),n.startColumn.modules.edit&&(n.startColumn.modules.edit.blocked=!1),n.table.browserSlow&&t.modules.resize&&t.modules.resize.variableHeight&&t.checkCellHeights(),document.body.removeEventListener("mouseup",o),document.body.removeEventListener("mousemove",a),i.removeEventListener("touchmove",a),i.removeEventListener("touchend",o),n.table.element.classList.remove("tabulator-block-select"),n.startWidth!==t.getWidth()&&(n.table.columnManager.verticalAlignHeaders(),n.dispatch("column-resized",t),n.dispatchExternal("columnResized",t.getComponent()))}e.stopPropagation(),n.startColumn.modules.edit&&(n.startColumn.modules.edit.blocked=!0),n.startX=typeof e.clientX>"u"?e.touches[0].clientX:e.clientX,n.latestX=n.startX,n.startWidth=t.getWidth(),document.body.addEventListener("mousemove",a),document.body.addEventListener("mouseup",o),i.addEventListener("touchmove",a,{passive:!0}),i.addEventListener("touchend",o)}}class Wx extends Dt{static moduleName="resizeRows";constructor(e){super(e),this.startColumn=!1,this.startY=!1,this.startHeight=!1,this.handle=null,this.prevHandle=null,this.registerTableOption("resizableRows",!1),this.registerTableOption("resizableRowGuide",!1)}initialize(){this.table.options.resizableRows&&this.subscribe("row-layout-after",this.initializeRow.bind(this))}initializeRow(e){var t=this,i=e.getElement(),n=document.createElement("div");n.className="tabulator-row-resize-handle";var s=document.createElement("div");s.className="tabulator-row-resize-handle prev",n.addEventListener("click",function(l){l.stopPropagation()});var a=function(l){t.startRow=e,t._mouseDown(l,e,n)};n.addEventListener("mousedown",a),n.addEventListener("touchstart",a,{passive:!0}),s.addEventListener("click",function(l){l.stopPropagation()});var o=function(l){var h=t.table.rowManager.prevDisplayRow(e);h&&(t.startRow=h,t._mouseDown(l,h,s))};s.addEventListener("mousedown",o),s.addEventListener("touchstart",o,{passive:!0}),i.appendChild(n),i.appendChild(s)}resize(e,t){t.setHeight(this.startHeight+((typeof e.screenY>"u"?e.touches[0].screenY:e.screenY)-this.startY))}calcGuidePosition(e,t,i){var n=typeof e.screenY>"u"?e.touches[0].screenY:e.screenY,s=i.getBoundingClientRect().y-this.table.element.getBoundingClientRect().y,a=this.table.element.getBoundingClientRect().y,o=t.element.getBoundingClientRect().top-a,l=n-this.startY;return Math.max(s+l,o)}_mouseDown(e,t,i){var n=this,s;n.dispatchExternal("rowResizing",t.getComponent()),n.table.options.resizableRowGuide&&(s=document.createElement("span"),s.classList.add("tabulator-row-resize-guide"),n.table.element.appendChild(s),setTimeout(()=>{s.style.top=n.calcGuidePosition(e,t,i)+"px"})),n.table.element.classList.add("tabulator-block-select");function a(l){n.table.options.resizableRowGuide?s.style.top=n.calcGuidePosition(l,t,i)+"px":n.resize(l,t)}function o(l){n.table.options.resizableRowGuide&&(n.resize(l,t),s.remove()),document.body.removeEventListener("mouseup",a),document.body.removeEventListener("mousemove",a),i.removeEventListener("touchmove",a),i.removeEventListener("touchend",o),n.table.element.classList.remove("tabulator-block-select"),n.dispatchExternal("rowResized",t.getComponent())}e.stopPropagation(),n.startY=typeof e.screenY>"u"?e.touches[0].screenY:e.screenY,n.startHeight=t.getHeight(),document.body.addEventListener("mousemove",a),document.body.addEventListener("mouseup",o),i.addEventListener("touchmove",a,{passive:!0}),i.addEventListener("touchend",o)}}class Ux extends Dt{static moduleName="resizeTable";constructor(e){super(e),this.binding=!1,this.visibilityObserver=!1,this.resizeObserver=!1,this.containerObserver=!1,this.tableHeight=0,this.tableWidth=0,this.containerHeight=0,this.containerWidth=0,this.autoResize=!1,this.visible=!1,this.initialized=!1,this.initialRedraw=!1,this.registerTableOption("autoResize",!0)}initialize(){if(this.table.options.autoResize){var e=this.table,t;this.tableHeight=e.element.clientHeight,this.tableWidth=e.element.clientWidth,e.element.parentNode&&(this.containerHeight=e.element.parentNode.clientHeight,this.containerWidth=e.element.parentNode.clientWidth),typeof IntersectionObserver<"u"&&typeof ResizeObserver<"u"&&e.rowManager.getRenderMode()==="virtual"?(this.initializeVisibilityObserver(),this.autoResize=!0,this.resizeObserver=new ResizeObserver(i=>{if(!e.browserMobile||e.browserMobile&&(!e.modules.edit||e.modules.edit&&!e.modules.edit.currentCell)){var n=Math.floor(i[0].contentRect.height),s=Math.floor(i[0].contentRect.width);(this.tableHeight!=n||this.tableWidth!=s)&&(this.tableHeight=n,this.tableWidth=s,e.element.parentNode&&(this.containerHeight=e.element.parentNode.clientHeight,this.containerWidth=e.element.parentNode.clientWidth),this.redrawTable())}}),this.resizeObserver.observe(e.element),t=window.getComputedStyle(e.element),this.table.element.parentNode&&!this.table.rowManager.fixedHeight&&(t.getPropertyValue("max-height")||t.getPropertyValue("min-height"))&&(this.containerObserver=new ResizeObserver(i=>{if(!e.browserMobile||e.browserMobile&&(!e.modules.edit||e.modules.edit&&!e.modules.edit.currentCell)){var n=Math.floor(i[0].contentRect.height),s=Math.floor(i[0].contentRect.width);(this.containerHeight!=n||this.containerWidth!=s)&&(this.containerHeight=n,this.containerWidth=s,this.tableHeight=e.element.clientHeight,this.tableWidth=e.element.clientWidth),this.redrawTable()}}),this.containerObserver.observe(this.table.element.parentNode)),this.subscribe("table-resize",this.tableResized.bind(this))):(this.binding=function(){(!e.browserMobile||e.browserMobile&&(!e.modules.edit||e.modules.edit&&!e.modules.edit.currentCell))&&(e.columnManager.rerenderColumns(!0),e.redraw())},window.addEventListener("resize",this.binding)),this.subscribe("table-destroy",this.clearBindings.bind(this))}}initializeVisibilityObserver(){this.visibilityObserver=new IntersectionObserver(e=>{this.visible=e[0].isIntersecting,this.initialized?this.visible&&(this.redrawTable(this.initialRedraw),this.initialRedraw=!1):(this.initialized=!0,this.initialRedraw=!this.visible)}),this.visibilityObserver.observe(this.table.element)}redrawTable(e){this.initialized&&this.visible&&(this.table.columnManager.rerenderColumns(!0),this.table.redraw(e))}tableResized(){this.table.rowManager.redraw()}clearBindings(){this.binding&&window.removeEventListener("resize",this.binding),this.resizeObserver&&this.resizeObserver.unobserve(this.table.element),this.visibilityObserver&&this.visibilityObserver.unobserve(this.table.element),this.containerObserver&&this.containerObserver.unobserve(this.table.element.parentNode)}}function Vx(r,e,t){var i=document.createElement("div"),n=r.getRow()._row.modules.responsiveLayout;i.classList.add("tabulator-responsive-collapse-toggle"),i.innerHTML=`<svg class='tabulator-responsive-collapse-toggle-open' viewbox="0 0 24 24">
  <line x1="7" y1="12" x2="17" y2="12" fill="none" stroke-width="3" stroke-linecap="round" />
  <line y1="7" x1="12" y2="17" x2="12" fill="none" stroke-width="3" stroke-linecap="round" />
</svg>

<svg class='tabulator-responsive-collapse-toggle-close' viewbox="0 0 24 24">
  <line x1="7" y1="12" x2="17" y2="12"  fill="none" stroke-width="3" stroke-linecap="round" />
</svg>`,r.getElement().classList.add("tabulator-row-handle");function s(a){var o=n.element;n.open=a,o&&(n.open?(i.classList.add("open"),o.style.display=""):(i.classList.remove("open"),o.style.display="none"))}return i.addEventListener("click",function(a){a.stopImmediatePropagation(),s(!n.open),r.getTable().rowManager.adjustTableSize()}),s(n.open),i}var Gx={format:{formatters:{responsiveCollapse:Vx}}};class qx extends Dt{static moduleName="responsiveLayout";static moduleExtensions=Gx;constructor(e){super(e),this.columns=[],this.hiddenColumns=[],this.mode="",this.index=0,this.collapseFormatter=[],this.collapseStartOpen=!0,this.collapseHandleColumn=!1,this.registerTableOption("responsiveLayout",!1),this.registerTableOption("responsiveLayoutCollapseStartOpen",!0),this.registerTableOption("responsiveLayoutCollapseUseFormatters",!0),this.registerTableOption("responsiveLayoutCollapseFormatter",!1),this.registerColumnOption("responsive")}initialize(){this.table.options.responsiveLayout&&(this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("column-show",this.updateColumnVisibility.bind(this)),this.subscribe("column-hide",this.updateColumnVisibility.bind(this)),this.subscribe("columns-loaded",this.initializeResponsivity.bind(this)),this.subscribe("column-moved",this.initializeResponsivity.bind(this)),this.subscribe("column-add",this.initializeResponsivity.bind(this)),this.subscribe("column-delete",this.initializeResponsivity.bind(this)),this.subscribe("table-redrawing",this.tableRedraw.bind(this)),this.table.options.responsiveLayout==="collapse"&&(this.subscribe("row-data-changed",this.generateCollapsedRowContent.bind(this)),this.subscribe("row-init",this.initializeRow.bind(this)),this.subscribe("row-layout",this.layoutRow.bind(this))))}tableRedraw(e){["fitColumns","fitDataStretch"].indexOf(this.layoutMode())===-1&&(e||this.update())}initializeResponsivity(){var e=[];this.mode=this.table.options.responsiveLayout,this.collapseFormatter=this.table.options.responsiveLayoutCollapseFormatter||this.formatCollapsedData,this.collapseStartOpen=this.table.options.responsiveLayoutCollapseStartOpen,this.hiddenColumns=[],this.collapseFormatter&&(this.collapseFormatter=this.collapseFormatter.bind(this.table)),this.table.columnManager.columnsByIndex.forEach((t,i)=>{t.modules.responsive&&t.modules.responsive.order&&t.modules.responsive.visible&&(t.modules.responsive.index=i,e.push(t),!t.visible&&this.mode==="collapse"&&this.hiddenColumns.push(t))}),e=e.reverse(),e=e.sort((t,i)=>{var n=i.modules.responsive.order-t.modules.responsive.order;return n||i.modules.responsive.index-t.modules.responsive.index}),this.columns=e,this.mode==="collapse"&&this.generateCollapsedContent();for(let t of this.table.columnManager.columnsByIndex)if(t.definition.formatter=="responsiveCollapse"){this.collapseHandleColumn=t;break}this.collapseHandleColumn&&(this.hiddenColumns.length?this.collapseHandleColumn.show():this.collapseHandleColumn.hide())}initializeColumn(e){var t=e.getDefinition();e.modules.responsive={order:typeof t.responsive>"u"?1:t.responsive,visible:t.visible!==!1}}initializeRow(e){var t;e.type!=="calc"&&(t=document.createElement("div"),t.classList.add("tabulator-responsive-collapse"),e.modules.responsiveLayout={element:t,open:this.collapseStartOpen},this.collapseStartOpen||(t.style.display="none"))}layoutRow(e){var t=e.getElement();e.modules.responsiveLayout&&(t.appendChild(e.modules.responsiveLayout.element),this.generateCollapsedRowContent(e))}updateColumnVisibility(e,t){!t&&e.modules.responsive&&(e.modules.responsive.visible=e.visible,this.initializeResponsivity())}hideColumn(e){var t=this.hiddenColumns.length;e.hide(!1,!0),this.mode==="collapse"&&(this.hiddenColumns.unshift(e),this.generateCollapsedContent(),this.collapseHandleColumn&&!t&&this.collapseHandleColumn.show())}showColumn(e){var t;e.show(!1,!0),e.setWidth(e.getWidth()),this.mode==="collapse"&&(t=this.hiddenColumns.indexOf(e),t>-1&&this.hiddenColumns.splice(t,1),this.generateCollapsedContent(),this.collapseHandleColumn&&!this.hiddenColumns.length&&this.collapseHandleColumn.hide())}update(){for(var e=!0;e;){let t=this.table.modules.layout.getMode()=="fitColumns"?this.table.columnManager.getFlexBaseWidth():this.table.columnManager.getWidth(),i=(this.table.options.headerVisible?this.table.columnManager.element.clientWidth:this.table.element.clientWidth)-t;if(i<0){let n=this.columns[this.index];n?(this.hideColumn(n),this.index++):e=!1}else{let n=this.columns[this.index-1];n&&i>0&&i>=n.getWidth()?(this.showColumn(n),this.index--):e=!1}this.table.rowManager.activeRowsCount||this.table.rowManager.renderEmptyScroll()}}generateCollapsedContent(){var e=this.table.rowManager.getDisplayRows();e.forEach(t=>{this.generateCollapsedRowContent(t)})}generateCollapsedRowContent(e){var t,i;if(e.modules.responsiveLayout){for(t=e.modules.responsiveLayout.element;t.firstChild;)t.removeChild(t.firstChild);i=this.collapseFormatter(this.generateCollapsedRowData(e)),i&&t.appendChild(i),e.calcHeight(!0)}}generateCollapsedRowData(e){var t=e.getData(),i=[],n;return this.hiddenColumns.forEach(s=>{var a=s.getFieldValue(t);if(s.definition.title&&s.field)if(s.modules.format&&this.table.options.responsiveLayoutCollapseUseFormatters){let o=function(l){l()};n={value:!1,data:{},getValue:function(){return a},getData:function(){return t},getType:function(){return"cell"},getElement:function(){return document.createElement("div")},getRow:function(){return e.getComponent()},getColumn:function(){return s.getComponent()},getTable:()=>this.table},i.push({field:s.field,title:s.definition.title,value:s.modules.format.formatter.call(this.table.modules.format,n,s.modules.format.params,o)})}else i.push({field:s.field,title:s.definition.title,value:a})}),i}formatCollapsedData(e){var t=document.createElement("table");return e.forEach(i=>{var n=document.createElement("tr"),s=document.createElement("td"),a=document.createElement("td"),o,l=document.createElement("strong");s.appendChild(l),this.modules.localize.bind("columns|"+i.field,function(h){l.innerHTML=h||i.title}),i.value instanceof Node?(o=document.createElement("div"),o.appendChild(i.value),a.appendChild(o)):a.innerHTML=i.value,n.appendChild(s),n.appendChild(a),t.appendChild(n)}),Object.keys(e).length?t:""}}function Xx(r,e,t){var i=document.createElement("input"),n=!1;if(i.type="checkbox",i.setAttribute("aria-label","Select Row"),this.table.modExists("selectRow",!0))if(i.addEventListener("click",a=>{a.stopPropagation()}),typeof r.getRow=="function"){var s=r.getRow();s instanceof Jc?(i.addEventListener("change",a=>{this.table.options.selectableRowsRangeMode==="click"&&n?n=!1:s.toggleSelect()}),this.table.options.selectableRowsRangeMode==="click"&&i.addEventListener("click",a=>{n=!0,this.table.modules.selectRow.handleComplexRowClick(s._row,a)}),i.checked=s.isSelected&&s.isSelected(),this.table.modules.selectRow.registerRowSelectCheckbox(s,i)):i=""}else i.addEventListener("change",a=>{this.table.modules.selectRow.selectedRows.length?this.table.deselectRow():this.table.selectRow(e.rowRange)}),this.table.modules.selectRow.registerHeaderSelectCheckbox(i);return i}var Kx={format:{formatters:{rowSelection:Xx}}};class Yx extends Dt{static moduleName="selectRow";static moduleExtensions=Kx;constructor(e){super(e),this.selecting=!1,this.lastClickedRow=!1,this.selectPrev=[],this.selectedRows=[],this.headerCheckboxElement=null,this.registerTableOption("selectableRows","highlight"),this.registerTableOption("selectableRowsRangeMode","drag"),this.registerTableOption("selectableRowsRollingSelection",!0),this.registerTableOption("selectableRowsPersistence",!0),this.registerTableOption("selectableRowsCheck",function(t,i){return!0}),this.registerTableFunction("selectRow",this.selectRows.bind(this)),this.registerTableFunction("deselectRow",this.deselectRows.bind(this)),this.registerTableFunction("toggleSelectRow",this.toggleRow.bind(this)),this.registerTableFunction("getSelectedRows",this.getSelectedRows.bind(this)),this.registerTableFunction("getSelectedData",this.getSelectedData.bind(this)),this.registerComponentFunction("row","select",this.selectRows.bind(this)),this.registerComponentFunction("row","deselect",this.deselectRows.bind(this)),this.registerComponentFunction("row","toggleSelect",this.toggleRow.bind(this)),this.registerComponentFunction("row","isSelected",this.isRowSelected.bind(this))}initialize(){this.deprecatedOptionsCheck(),this.table.options.selectableRows==="highlight"&&this.table.options.selectableRange&&(this.table.options.selectableRows=!1),this.table.options.selectableRows!==!1&&(this.subscribe("row-init",this.initializeRow.bind(this)),this.subscribe("row-deleting",this.rowDeleted.bind(this)),this.subscribe("rows-wipe",this.clearSelectionData.bind(this)),this.subscribe("rows-retrieve",this.rowRetrieve.bind(this)),this.table.options.selectableRows&&!this.table.options.selectableRowsPersistence&&this.subscribe("data-refreshing",this.deselectRows.bind(this)))}deprecatedOptionsCheck(){}rowRetrieve(e,t){return e==="selected"?this.selectedRows:t}rowDeleted(e){this._deselectRow(e,!0)}clearSelectionData(e){var t=this.selectedRows.length;this.selecting=!1,this.lastClickedRow=!1,this.selectPrev=[],this.selectedRows=[],t&&e!==!0&&this._rowSelectionChanged()}initializeRow(e){var t=this,i=t.checkRowSelectability(e),n=e.getElement(),s=function(){setTimeout(function(){t.selecting=!1},50),document.body.removeEventListener("mouseup",s)};e.modules.select={selected:!1},n.classList.toggle("tabulator-selectable",i),n.classList.toggle("tabulator-unselectable",!i),t.checkRowSelectability(e)&&t.table.options.selectableRows&&t.table.options.selectableRows!="highlight"&&(t.table.options.selectableRowsRangeMode==="click"?n.addEventListener("click",this.handleComplexRowClick.bind(this,e)):(n.addEventListener("click",function(a){(!t.table.modExists("edit")||!t.table.modules.edit.getCurrentCell())&&t.table._clearSelection(),t.selecting||t.toggleRow(e)}),n.addEventListener("mousedown",function(a){if(a.shiftKey)return t.table._clearSelection(),t.selecting=!0,t.selectPrev=[],document.body.addEventListener("mouseup",s),document.body.addEventListener("keyup",s),t.toggleRow(e),!1}),n.addEventListener("mouseenter",function(a){t.selecting&&(t.table._clearSelection(),t.toggleRow(e),t.selectPrev[1]==e&&t.toggleRow(t.selectPrev[0]))}),n.addEventListener("mouseout",function(a){t.selecting&&(t.table._clearSelection(),t.selectPrev.unshift(e))})))}handleComplexRowClick(e,t){if(t.shiftKey){this.table._clearSelection(),this.lastClickedRow=this.lastClickedRow||e;var i=this.table.rowManager.getDisplayRowIndex(this.lastClickedRow),n=this.table.rowManager.getDisplayRowIndex(e),s=i<=n?i:n,a=i>=n?i:n,o=this.table.rowManager.getDisplayRows().slice(0),l=o.splice(s,a-s+1);t.ctrlKey||t.metaKey?(l.forEach(h=>{h!==this.lastClickedRow&&(this.table.options.selectableRows!==!0&&!this.isRowSelected(e)?this.selectedRows.length<this.table.options.selectableRows&&this.toggleRow(h):this.toggleRow(h))}),this.lastClickedRow=e):(this.deselectRows(void 0,!0),this.table.options.selectableRows!==!0&&l.length>this.table.options.selectableRows&&(l=l.slice(0,this.table.options.selectableRows)),this.selectRows(l)),this.table._clearSelection()}else t.ctrlKey||t.metaKey?(this.toggleRow(e),this.lastClickedRow=e):(this.deselectRows(void 0,!0),this.selectRows(e),this.lastClickedRow=e)}checkRowSelectability(e){return e&&e.type==="row"?this.table.options.selectableRowsCheck.call(this.table,e.getComponent()):!1}toggleRow(e){this.checkRowSelectability(e)&&(e.modules.select&&e.modules.select.selected?this._deselectRow(e):this._selectRow(e))}selectRows(e){var t=[],i,n;switch(typeof e){case"undefined":i=this.table.rowManager.rows;break;case"number":i=this.table.rowManager.findRow(e);break;case"string":i=this.table.rowManager.findRow(e),i||(i=this.table.rowManager.getRows(e));break;default:i=e;break}Array.isArray(i)?i.length&&(i.forEach(s=>{n=this._selectRow(s,!0,!0),n&&t.push(n)}),this._rowSelectionChanged(!1,t)):i&&this._selectRow(i,!1,!0)}_selectRow(e,t,i){if(!isNaN(this.table.options.selectableRows)&&this.table.options.selectableRows!==!0&&!i&&this.selectedRows.length>=this.table.options.selectableRows)if(this.table.options.selectableRowsRollingSelection)this._deselectRow(this.selectedRows[0]);else return!1;var n=this.table.rowManager.findRow(e);if(n){if(this.selectedRows.indexOf(n)==-1)return n.getElement().classList.add("tabulator-selected"),n.modules.select||(n.modules.select={}),n.modules.select.selected=!0,n.modules.select.checkboxEl&&(n.modules.select.checkboxEl.checked=!0),this.selectedRows.push(n),this.table.options.dataTreeSelectPropagate&&this.childRowSelection(n,!0),this.dispatchExternal("rowSelected",n.getComponent()),this._rowSelectionChanged(t,n),n}else t||console.warn("Selection Error - No such row found, ignoring selection:"+e)}isRowSelected(e){return this.selectedRows.indexOf(e)!==-1}deselectRows(e,t){var i=[],n,s;switch(typeof e){case"undefined":n=Object.assign([],this.selectedRows);break;case"number":n=this.table.rowManager.findRow(e);break;case"string":n=this.table.rowManager.findRow(e),n||(n=this.table.rowManager.getRows(e));break;default:n=e;break}Array.isArray(n)?n.length&&(n.forEach(a=>{s=this._deselectRow(a,!0,!0),s&&i.push(s)}),this._rowSelectionChanged(t,[],i)):n&&this._deselectRow(n,t,!0)}_deselectRow(e,t){var i=this,n=i.table.rowManager.findRow(e),s,a;if(n){if(s=i.selectedRows.findIndex(function(o){return o==n}),s>-1)return a=n.getElement(),a&&a.classList.remove("tabulator-selected"),n.modules.select||(n.modules.select={}),n.modules.select.selected=!1,n.modules.select.checkboxEl&&(n.modules.select.checkboxEl.checked=!1),i.selectedRows.splice(s,1),this.table.options.dataTreeSelectPropagate&&this.childRowSelection(n,!1),this.dispatchExternal("rowDeselected",n.getComponent()),i._rowSelectionChanged(t,void 0,n),n}else t||console.warn("Deselection Error - No such row found, ignoring selection:"+e)}getSelectedData(){var e=[];return this.selectedRows.forEach(function(t){e.push(t.getData())}),e}getSelectedRows(){var e=[];return this.selectedRows.forEach(function(t){e.push(t.getComponent())}),e}_rowSelectionChanged(e,t=[],i=[]){this.headerCheckboxElement&&(this.selectedRows.length===0?(this.headerCheckboxElement.checked=!1,this.headerCheckboxElement.indeterminate=!1):this.table.rowManager.rows.length===this.selectedRows.length?(this.headerCheckboxElement.checked=!0,this.headerCheckboxElement.indeterminate=!1):(this.headerCheckboxElement.indeterminate=!0,this.headerCheckboxElement.checked=!1)),e||(Array.isArray(t)||(t=[t]),t=t.map(n=>n.getComponent()),Array.isArray(i)||(i=[i]),i=i.map(n=>n.getComponent()),this.dispatchExternal("rowSelectionChanged",this.getSelectedData(),this.getSelectedRows(),t,i))}registerRowSelectCheckbox(e,t){e._row.modules.select||(e._row.modules.select={}),e._row.modules.select.checkboxEl=t}registerHeaderSelectCheckbox(e){this.headerCheckboxElement=e}childRowSelection(e,t){var i=this.table.modules.dataTree.getChildren(e,!0,!0);if(t)for(let n of i)this._selectRow(n,!0);else for(let n of i)this._deselectRow(n,!0)}}class $x{constructor(e){return this._range=e,new Proxy(this,{get:function(t,i,n){return typeof t[i]<"u"?t[i]:t._range.table.componentFunctionBinder.handle("range",t._range,i)}})}getElement(){return this._range.element}getData(){return this._range.getData()}getCells(){return this._range.getCells(!0,!0)}getStructuredCells(){return this._range.getStructuredCells()}getRows(){return this._range.getRows().map(e=>e.getComponent())}getColumns(){return this._range.getColumns().map(e=>e.getComponent())}getBounds(){return this._range.getBounds()}getTopEdge(){return this._range.top}getBottomEdge(){return this._range.bottom}getLeftEdge(){return this._range.left}getRightEdge(){return this._range.right}setBounds(e,t){this._range.destroyedGuard("setBounds")&&this._range.setBounds(e&&e._cell,t&&t._cell)}setStartBound(e){this._range.destroyedGuard("setStartBound")&&(this._range.setEndBound(e&&e._cell),this._range.rangeManager.layoutElement())}setEndBound(e){this._range.destroyedGuard("setEndBound")&&(this._range.setEndBound(e&&e._cell),this._range.rangeManager.layoutElement())}clearValues(){this._range.destroyedGuard("clearValues")&&this._range.clearValues()}remove(){this._range.destroyedGuard("remove")&&this._range.destroy(!0)}}class Jx extends hi{constructor(e,t,i,n){super(e),this.rangeManager=t,this.element=null,this.initialized=!1,this.initializing={start:!1,end:!1},this.destroyed=!1,this.top=0,this.bottom=0,this.left=0,this.right=0,this.table=e,this.start={row:0,col:0},this.end={row:0,col:0},this.rangeManager.rowHeader&&(this.left=1,this.right=1,this.start.col=1,this.end.col=1),this.initElement(),setTimeout(()=>{this.initBounds(i,n)})}initElement(){this.element=document.createElement("div"),this.element.classList.add("tabulator-range")}initBounds(e,t){this._updateMinMax(),e&&this.setBounds(e,t||e)}setStart(e,t){(this.start.row!==e||this.start.col!==t)&&(this.start.row=e,this.start.col=t,this.initializing.start=!0,this._updateMinMax())}setEnd(e,t){(this.end.row!==e||this.end.col!==t)&&(this.end.row=e,this.end.col=t,this.initializing.end=!0,this._updateMinMax())}setBounds(e,t,i){e&&this.setStartBound(e),this.setEndBound(t||e),this.rangeManager.layoutElement(i)}setStartBound(e){var t,i;e.type==="column"?this.rangeManager.columnSelection&&this.setStart(0,e.getPosition()-1):(t=e.row.position-1,i=e.column.getPosition()-1,e.column===this.rangeManager.rowHeader?this.setStart(t,1):this.setStart(t,i))}setEndBound(e){var t=this._getTableRows().length,i,n,s;e.type==="column"?this.rangeManager.columnSelection&&(this.rangeManager.selecting==="column"?this.setEnd(t-1,e.getPosition()-1):this.rangeManager.selecting==="cell"&&this.setEnd(0,e.getPosition()-1)):(i=e.row.position-1,n=e.column.getPosition()-1,s=e.column===this.rangeManager.rowHeader,this.rangeManager.selecting==="row"?this.setEnd(i,this._getTableColumns().length-1):this.rangeManager.selecting!=="row"&&s?this.setEnd(i,0):this.rangeManager.selecting==="column"?this.setEnd(t-1,n):this.setEnd(i,n))}_updateMinMax(){this.top=Math.min(this.start.row,this.end.row),this.bottom=Math.max(this.start.row,this.end.row),this.left=Math.min(this.start.col,this.end.col),this.right=Math.max(this.start.col,this.end.col),this.initialized?this.dispatchExternal("rangeChanged",this.getComponent()):this.initializing.start&&this.initializing.end&&(this.initialized=!0,this.dispatchExternal("rangeAdded",this.getComponent()))}_getTableColumns(){return this.table.columnManager.getVisibleColumnsByIndex()}_getTableRows(){return this.table.rowManager.getDisplayRows().filter(e=>e.type==="row")}layout(){var e=this.table.rowManager.renderer.vDomTop,t=this.table.rowManager.renderer.vDomBottom,i=this.table.columnManager.renderer.leftCol,n=this.table.columnManager.renderer.rightCol,s,a,o,l,h,c,d,p,f,g;this.table.options.renderHorizontal==="virtual"&&this.rangeManager.rowHeader&&(n+=1),e==null&&(e=0),t==null&&(t=1/0),i==null&&(i=0),n==null&&(n=1/0),this.overlaps(i,e,n,t)&&(s=Math.max(this.top,e),a=Math.min(this.bottom,t),o=Math.max(this.left,i),l=Math.min(this.right,n),h=this.rangeManager.getCell(s,o),c=this.rangeManager.getCell(a,l),d=h.getElement(),p=c.getElement(),f=h.row.getElement(),g=c.row.getElement(),this.element.classList.add("tabulator-range-active"),this.table.rtl?(this.element.style.right=f.offsetWidth-d.offsetLeft-d.offsetWidth+"px",this.element.style.width=d.offsetLeft+d.offsetWidth-p.offsetLeft+"px"):(this.element.style.left=f.offsetLeft+d.offsetLeft+"px",this.element.style.width=p.offsetLeft+p.offsetWidth-d.offsetLeft+"px"),this.element.style.top=f.offsetTop+"px",this.element.style.height=g.offsetTop+g.offsetHeight-f.offsetTop+"px")}atTopLeft(e){return e.row.position-1===this.top&&e.column.getPosition()-1===this.left}atBottomRight(e){return e.row.position-1===this.bottom&&e.column.getPosition()-1===this.right}occupies(e){return this.occupiesRow(e.row)&&this.occupiesColumn(e.column)}occupiesRow(e){return this.top<=e.position-1&&e.position-1<=this.bottom}occupiesColumn(e){return this.left<=e.getPosition()-1&&e.getPosition()-1<=this.right}overlaps(e,t,i,n){return!(this.left>i||e>this.right||this.top>n||t>this.bottom)}getData(){var e=[],t=this.getRows(),i=this.getColumns();return t.forEach(n=>{var s=n.getData(),a={};i.forEach(o=>{a[o.field]=s[o.field]}),e.push(a)}),e}getCells(e,t){var i=[],n=this.getRows(),s=this.getColumns();return e?i=n.map(a=>{var o=[];return a.getCells().forEach(l=>{s.includes(l.column)&&o.push(t?l.getComponent():l)}),o}):n.forEach(a=>{a.getCells().forEach(o=>{s.includes(o.column)&&i.push(t?o.getComponent():o)})}),i}getStructuredCells(){return this.getCells(!0,!0)}getRows(){return this._getTableRows().slice(this.top,this.bottom+1)}getColumns(){return this._getTableColumns().slice(this.left,this.right+1)}clearValues(){var e=this.getCells(),t=this.table.options.selectableRangeClearCellsValue;this.table.blockRedraw(),e.forEach(i=>{i.setValue(t)}),this.table.restoreRedraw()}getBounds(e){var t=this.getCells(!1,e),i={start:null,end:null};return t.length?(i.start=t[0],i.end=t[t.length-1]):console.warn("No bounds defined on range"),i}getComponent(){return this.component||(this.component=new $x(this)),this.component}destroy(e){this.destroyed=!0,this.element.remove(),e&&this.rangeManager.rangeRemoved(this),this.initialized&&this.dispatchExternal("rangeRemoved",this.getComponent())}destroyedGuard(e){return this.destroyed&&console.warn("You cannot call the "+e+" function on a destroyed range"),!this.destroyed}}var Zx={rangeJumpUp:["ctrl + 38","meta + 38"],rangeJumpDown:["ctrl + 40","meta + 40"],rangeJumpLeft:["ctrl + 37","meta + 37"],rangeJumpRight:["ctrl + 39","meta + 39"],rangeExpandUp:"shift + 38",rangeExpandDown:"shift + 40",rangeExpandLeft:"shift + 37",rangeExpandRight:"shift + 39",rangeExpandJumpUp:["ctrl + shift + 38","meta + shift + 38"],rangeExpandJumpDown:["ctrl + shift + 40","meta + shift + 40"],rangeExpandJumpLeft:["ctrl + shift + 37","meta + shift + 37"],rangeExpandJumpRight:["ctrl + shift + 39","meta + shift + 39"]},Qx={rangeJumpLeft:function(r){this.dispatch("keybinding-nav-range",r,"left",!0,!1)},rangeJumpRight:function(r){this.dispatch("keybinding-nav-range",r,"right",!0,!1)},rangeJumpUp:function(r){this.dispatch("keybinding-nav-range",r,"up",!0,!1)},rangeJumpDown:function(r){this.dispatch("keybinding-nav-range",r,"down",!0,!1)},rangeExpandLeft:function(r){this.dispatch("keybinding-nav-range",r,"left",!1,!0)},rangeExpandRight:function(r){this.dispatch("keybinding-nav-range",r,"right",!1,!0)},rangeExpandUp:function(r){this.dispatch("keybinding-nav-range",r,"up",!1,!0)},rangeExpandDown:function(r){this.dispatch("keybinding-nav-range",r,"down",!1,!0)},rangeExpandJumpLeft:function(r){this.dispatch("keybinding-nav-range",r,"left",!0,!0)},rangeExpandJumpRight:function(r){this.dispatch("keybinding-nav-range",r,"right",!0,!0)},rangeExpandJumpUp:function(r){this.dispatch("keybinding-nav-range",r,"up",!0,!0)},rangeExpandJumpDown:function(r){this.dispatch("keybinding-nav-range",r,"down",!0,!0)}},e5={range:function(r){var e=[],t=this.table.modules.selectRange.activeRange,i=!1,n,s,a,o,l;return l=r.length,t&&(n=t.getBounds(),s=n.start,n.start===n.end&&(i=!0),s&&(e=this.table.rowManager.activeRows.slice(),a=e.indexOf(s.row),i?o=r.length:o=e.indexOf(n.end.row)-a+1,a>-1&&(this.table.blockRedraw(),e=e.slice(a,a+o),e.forEach((h,c)=>{h.updateData(r[c%l])}),this.table.restoreRedraw()))),e}},t5={range:function(r){var e=[],t=[],i=this.table.modules.selectRange.activeRange,n=!1,s,a,o,l,h;return i&&(s=i.getBounds(),a=s.start,s.start===s.end&&(n=!0),a&&(r=r.split(`
`),r.forEach(function(c){e.push(c.split("	"))}),e.length&&(l=this.table.columnManager.getVisibleColumnsByIndex(),h=l.indexOf(a.column),h>-1)))?(n?o=e[0].length:o=l.indexOf(s.end.column)-h+1,l=l.slice(h,h+o),e.forEach(c=>{var d={},p=c.length;l.forEach(function(f,g){d[f.field]=c[g%p]}),t.push(d)}),t):!1}},r5={range:function(){var r=this.modules.selectRange.selectedColumns();return this.columnManager.rowHeader&&r.unshift(this.columnManager.rowHeader),r}},i5={range:function(){return this.modules.selectRange.selectedRows()}},n5={keybindings:{bindings:Zx,actions:Qx},clipboard:{pasteActions:e5,pasteParsers:t5},export:{columnLookups:r5,rowLookups:i5}};class s5 extends Dt{static moduleName="selectRange";static moduleInitOrder=1;static moduleExtensions=n5;constructor(e){super(e),this.selecting="cell",this.mousedown=!1,this.ranges=[],this.overlay=null,this.rowHeader=null,this.layoutChangeTimeout=null,this.columnSelection=!1,this.rowSelection=!1,this.maxRanges=0,this.activeRange=!1,this.blockKeydown=!1,this.keyDownEvent=this._handleKeyDown.bind(this),this.mouseUpEvent=this._handleMouseUp.bind(this),this.registerTableOption("selectableRange",!1),this.registerTableOption("selectableRangeColumns",!1),this.registerTableOption("selectableRangeRows",!1),this.registerTableOption("selectableRangeClearCells",!1),this.registerTableOption("selectableRangeClearCellsValue",void 0),this.registerTableOption("selectableRangeAutoFocus",!0),this.registerTableFunction("getRangesData",this.getRangesData.bind(this)),this.registerTableFunction("getRanges",this.getRanges.bind(this)),this.registerTableFunction("addRange",this.addRangeFromComponent.bind(this)),this.registerComponentFunction("cell","getRanges",this.cellGetRanges.bind(this)),this.registerComponentFunction("row","getRanges",this.rowGetRanges.bind(this)),this.registerComponentFunction("column","getRanges",this.colGetRanges.bind(this))}initialize(){this.options("selectableRange")&&(this.options("selectableRows")?console.warn("SelectRange functionality cannot be used in conjunction with row selection"):(this.maxRanges=this.options("selectableRange"),this.initializeTable(),this.initializeWatchers()),this.options("columns").findIndex(e=>e.frozen)>0&&console.warn("Having frozen column in arbitrary position with selectRange option may result in unpredictable behavior."),this.options("columns").filter(e=>e.frozen)>1&&console.warn("Having multiple frozen columns with selectRange option may result in unpredictable behavior."))}initializeTable(){this.overlay=document.createElement("div"),this.overlay.classList.add("tabulator-range-overlay"),this.rangeContainer=document.createElement("div"),this.rangeContainer.classList.add("tabulator-range-container"),this.activeRangeCellElement=document.createElement("div"),this.activeRangeCellElement.classList.add("tabulator-range-cell-active"),this.overlay.appendChild(this.rangeContainer),this.overlay.appendChild(this.activeRangeCellElement),this.table.rowManager.element.addEventListener("keydown",this.keyDownEvent),this.resetRanges(),this.table.rowManager.element.appendChild(this.overlay),this.table.columnManager.element.setAttribute("tabindex",0),this.table.element.classList.add("tabulator-ranges")}initializeWatchers(){this.columnSelection=this.options("selectableRangeColumns"),this.rowSelection=this.options("selectableRangeRows"),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("column-mousedown",this.handleColumnMouseDown.bind(this)),this.subscribe("column-mousemove",this.handleColumnMouseMove.bind(this)),this.subscribe("column-resized",this.handleColumnResized.bind(this)),this.subscribe("column-moving",this.handleColumnMoving.bind(this)),this.subscribe("column-moved",this.handleColumnMoved.bind(this)),this.subscribe("column-width",this.layoutChange.bind(this)),this.subscribe("column-height",this.layoutChange.bind(this)),this.subscribe("column-resized",this.layoutChange.bind(this)),this.subscribe("columns-loaded",this.updateHeaderColumn.bind(this)),this.subscribe("cell-height",this.layoutChange.bind(this)),this.subscribe("cell-rendered",this.renderCell.bind(this)),this.subscribe("cell-mousedown",this.handleCellMouseDown.bind(this)),this.subscribe("cell-mousemove",this.handleCellMouseMove.bind(this)),this.subscribe("cell-click",this.handleCellClick.bind(this)),this.subscribe("cell-editing",this.handleEditingCell.bind(this)),this.subscribe("page-changed",this.redraw.bind(this)),this.subscribe("scroll-vertical",this.layoutChange.bind(this)),this.subscribe("scroll-horizontal",this.layoutChange.bind(this)),this.subscribe("data-destroy",this.tableDestroyed.bind(this)),this.subscribe("data-processed",this.resetRanges.bind(this)),this.subscribe("table-layout",this.layoutElement.bind(this)),this.subscribe("table-redraw",this.redraw.bind(this)),this.subscribe("table-destroy",this.tableDestroyed.bind(this)),this.subscribe("edit-editor-clear",this.finishEditingCell.bind(this)),this.subscribe("edit-blur",this.restoreFocus.bind(this)),this.subscribe("keybinding-nav-prev",this.keyNavigate.bind(this,"left")),this.subscribe("keybinding-nav-next",this.keyNavigate.bind(this,"right")),this.subscribe("keybinding-nav-left",this.keyNavigate.bind(this,"left")),this.subscribe("keybinding-nav-right",this.keyNavigate.bind(this,"right")),this.subscribe("keybinding-nav-up",this.keyNavigate.bind(this,"up")),this.subscribe("keybinding-nav-down",this.keyNavigate.bind(this,"down")),this.subscribe("keybinding-nav-range",this.keyNavigateRange.bind(this))}initializeColumn(e){this.columnSelection&&e.definition.headerSort&&this.options("headerSortClickElement")!=="icon"&&console.warn("Using column headerSort with selectableRangeColumns option may result in unpredictable behavior. Consider using headerSortClickElement: 'icon'."),e.modules.edit}updateHeaderColumn(){var e;this.rowSelection&&(this.rowHeader=this.table.columnManager.getVisibleColumnsByIndex()[0],this.rowHeader&&(this.rowHeader.definition.cssClass=this.rowHeader.definition.cssClass+" tabulator-range-row-header",this.rowHeader.definition.headerSort&&console.warn("Using column headerSort with selectableRangeRows option may result in unpredictable behavior"),this.rowHeader.definition.editor&&console.warn("Using column editor with selectableRangeRows option may result in unpredictable behavior"))),this.table.modules.frozenColumns&&this.table.modules.frozenColumns.active&&(e=this.table.modules.frozenColumns.getFrozenColumns(),(e.length>1||e.length===1&&e[0]!==this.rowHeader)&&console.warn("Using frozen columns that are not the range header in combination with the selectRange option may result in unpredictable behavior"))}getRanges(){return this.ranges.map(e=>e.getComponent())}getRangesData(){return this.ranges.map(e=>e.getData())}addRangeFromComponent(e,t){return e=e?e._cell:null,t=t?t._cell:null,this.addRange(e,t)}cellGetRanges(e){var t=[];return e.column===this.rowHeader?t=this.ranges.filter(i=>i.occupiesRow(e.row)):t=this.ranges.filter(i=>i.occupies(e)),t.map(i=>i.getComponent())}rowGetRanges(e){var t=this.ranges.filter(i=>i.occupiesRow(e));return t.map(i=>i.getComponent())}colGetRanges(e){var t=this.ranges.filter(i=>i.occupiesColumn(e));return t.map(i=>i.getComponent())}_handleMouseUp(e){this.mousedown=!1,document.removeEventListener("mouseup",this.mouseUpEvent)}_handleKeyDown(e){if(!this.blockKeydown&&(!this.table.modules.edit||this.table.modules.edit&&!this.table.modules.edit.currentCell)){if(e.key==="Enter"){if(this.table.modules.edit&&this.table.modules.edit.currentCell)return;this.table.modules.edit.editCell(this.getActiveCell()),e.preventDefault()}(e.key==="Backspace"||e.key==="Delete")&&this.options("selectableRangeClearCells")&&this.activeRange&&this.activeRange.clearValues()}}initializeFocus(e){var t;this.restoreFocus();try{document.selection?(t=document.body.createTextRange(),t.moveToElementText(e.getElement()),t.select()):window.getSelection&&(t=document.createRange(),t.selectNode(e.getElement()),window.getSelection().removeAllRanges(),window.getSelection().addRange(t))}catch{}}restoreFocus(e){return this.table.rowManager.element.focus(),!0}handleColumnResized(e){var t;this.selecting!=="column"&&this.selecting!=="all"||(t=this.ranges.some(i=>i.occupiesColumn(e)),t&&this.ranges.forEach(i=>{var n=i.getColumns(!0);n.forEach(s=>{s!==e&&s.setWidth(e.width)})}))}handleColumnMoving(e,t){this.resetRanges().setBounds(t),this.overlay.style.visibility="hidden"}handleColumnMoved(e,t,i){this.activeRange.setBounds(e),this.layoutElement()}handleColumnMouseDown(e,t){e.button===2&&(this.selecting==="column"||this.selecting==="all")&&this.activeRange.occupiesColumn(t)||this.table.options.movableColumns&&this.selecting==="column"&&this.activeRange.occupiesColumn(t)||(this.mousedown=!0,document.addEventListener("mouseup",this.mouseUpEvent),this.newSelection(e,t))}handleColumnMouseMove(e,t){t===this.rowHeader||!this.mousedown||this.selecting==="all"||this.activeRange.setBounds(!1,t,!0)}renderCell(e){var t=e.getElement(),i=this.ranges.findIndex(n=>n.occupies(e));t.classList.toggle("tabulator-range-selected",i!==-1),t.classList.toggle("tabulator-range-only-cell-selected",this.ranges.length===1&&this.ranges[0].atTopLeft(e)&&this.ranges[0].atBottomRight(e)),t.dataset.range=i}handleCellMouseDown(e,t){e.button===2&&(this.activeRange.occupies(t)||(this.selecting==="row"||this.selecting==="all")&&this.activeRange.occupiesRow(t.row))||(this.mousedown=!0,document.addEventListener("mouseup",this.mouseUpEvent),this.newSelection(e,t))}handleCellMouseMove(e,t){!this.mousedown||this.selecting==="all"||this.activeRange.setBounds(!1,t,!0)}handleCellClick(e,t){this.initializeFocus(t)}handleEditingCell(e){this.activeRange&&this.activeRange.setBounds(e)}finishEditingCell(){this.blockKeydown=!0,this.table.rowManager.element.focus(),setTimeout(()=>{this.blockKeydown=!1},10)}keyNavigate(e,t){this.navigate(!1,!1,e),t.preventDefault()}keyNavigateRange(e,t,i,n){this.navigate(i,n,t),e.preventDefault()}navigate(e,t,i){var n=!1,s,a,o,l,h,c,d,p,f,g,m;if(this.table.modules.edit&&this.table.modules.edit.currentCell)return!1;if(this.ranges.length>1&&(this.ranges=this.ranges.filter(b=>b===this.activeRange?(b.setEnd(b.start.row,b.start.col),!0):(b.destroy(),!1))),s=this.activeRange,o={top:s.top,bottom:s.bottom,left:s.left,right:s.right},a=t?s.end:s.start,l=a.row,h=a.col,e)switch(i){case"left":h=this.findJumpCellLeft(s.start.row,a.col);break;case"right":h=this.findJumpCellRight(s.start.row,a.col);break;case"up":l=this.findJumpCellUp(a.row,s.start.col);break;case"down":l=this.findJumpCellDown(a.row,s.start.col);break}else{if(t&&(this.selecting==="row"&&(i==="left"||i==="right")||this.selecting==="column"&&(i==="up"||i==="down")))return;switch(i){case"left":h=Math.max(h-1,0);break;case"right":h=Math.min(h+1,this.getTableColumns().length-1);break;case"up":l=Math.max(l-1,0);break;case"down":l=Math.min(l+1,this.getTableRows().length-1);break}}if(this.rowHeader&&h===0&&(h=1),t||s.setStart(l,h),s.setEnd(l,h),t||(this.selecting="cell"),n=o.top!==s.top||o.bottom!==s.bottom||o.left!==s.left||o.right!==s.right,n)return c=this.getRowByRangePos(s.end.row),d=this.getColumnByRangePos(s.end.col),p=c.getElement().getBoundingClientRect(),g=d.getElement().getBoundingClientRect(),f=this.table.rowManager.getElement().getBoundingClientRect(),m=this.table.columnManager.getElement().getBoundingClientRect(),p.top>=f.top&&p.bottom<=f.bottom||(c.getElement().parentNode&&d.getElement().parentNode?this.autoScroll(s,c.getElement(),d.getElement()):c.getComponent().scrollTo(void 0,!1)),g.left>=m.left+this.getRowHeaderWidth()&&g.right<=m.right||(c.getElement().parentNode&&d.getElement().parentNode?this.autoScroll(s,c.getElement(),d.getElement()):d.getComponent().scrollTo(void 0,!1)),this.layoutElement(),!0}rangeRemoved(e){this.ranges=this.ranges.filter(t=>t!==e),this.activeRange===e&&(this.ranges.length?this.activeRange=this.ranges[this.ranges.length-1]:this.addRange()),this.layoutElement()}findJumpRow(e,t,i,n,s){return i&&(t=t.reverse()),this.findJumpItem(n,s,t,function(a){return a.getData()[e.getField()]})}findJumpCol(e,t,i,n,s){return i&&(t=t.reverse()),this.findJumpItem(n,s,t,function(a){return e.getData()[a.getField()]})}findJumpItem(e,t,i,n){var s;for(let a of i){let o=n(a);if(e){if(s=a,o)break}else if(t){if(s=a,o)break}else if(o)s=a;else break}return s}findJumpCellLeft(e,t){var i=this.getRowByRangePos(e),n=this.getTableColumns(),s=this.isEmpty(i.getData()[n[t].getField()]),a=n[t-1]?this.isEmpty(i.getData()[n[t-1].getField()]):!1,o=this.rowHeader?n.slice(1,t):n.slice(0,t),l=this.findJumpCol(i,o,!0,s,a);return l?l.getPosition()-1:t}findJumpCellRight(e,t){var i=this.getRowByRangePos(e),n=this.getTableColumns(),s=this.isEmpty(i.getData()[n[t].getField()]),a=n[t+1]?this.isEmpty(i.getData()[n[t+1].getField()]):!1,o=this.findJumpCol(i,n.slice(t+1,n.length),!1,s,a);return o?o.getPosition()-1:t}findJumpCellUp(e,t){var i=this.getColumnByRangePos(t),n=this.getTableRows(),s=this.isEmpty(n[e].getData()[i.getField()]),a=n[e-1]?this.isEmpty(n[e-1].getData()[i.getField()]):!1,o=this.findJumpRow(i,n.slice(0,e),!0,s,a);return o?o.position-1:e}findJumpCellDown(e,t){var i=this.getColumnByRangePos(t),n=this.getTableRows(),s=this.isEmpty(n[e].getData()[i.getField()]),a=n[e+1]?this.isEmpty(n[e+1].getData()[i.getField()]):!1,o=this.findJumpRow(i,n.slice(e+1,n.length),!1,s,a);return o?o.position-1:e}newSelection(e,t){var i;if(t.type==="column"){if(!this.columnSelection)return;if(t===this.rowHeader){i=this.resetRanges(),this.selecting="all";var n,s=this.getCell(-1,-1);this.rowHeader?n=this.getCell(0,1):n=this.getCell(0,0),i.setBounds(n,s);return}else this.selecting="column"}else t.column===this.rowHeader?this.selecting="row":this.selecting="cell";e.shiftKey?this.activeRange.setBounds(!1,t):e.ctrlKey?this.addRange().setBounds(t):this.resetRanges().setBounds(t)}autoScroll(e,t,i){var n=this.table.rowManager.element,s,a,o,l;typeof t>"u"&&(t=this.getRowByRangePos(e.end.row).getElement()),typeof i>"u"&&(i=this.getColumnByRangePos(e.end.col).getElement()),s={left:i.offsetLeft,right:i.offsetLeft+i.offsetWidth,top:t.offsetTop,bottom:t.offsetTop+t.offsetHeight},a={left:n.scrollLeft+this.getRowHeaderWidth(),right:Math.ceil(n.scrollLeft+n.clientWidth),top:n.scrollTop,bottom:n.scrollTop+n.offsetHeight-this.table.rowManager.scrollbarWidth},o=a.left<s.left&&s.left<a.right&&a.left<s.right&&s.right<a.right,l=a.top<s.top&&s.top<a.bottom&&a.top<s.bottom&&s.bottom<a.bottom,o||(s.left<a.left?n.scrollLeft=s.left-this.getRowHeaderWidth():s.right>a.right&&(n.scrollLeft=Math.min(s.right-n.clientWidth,s.left-this.getRowHeaderWidth()))),l||(s.top<a.top?n.scrollTop=s.top:s.bottom>a.bottom&&(n.scrollTop=s.bottom-n.clientHeight))}layoutChange(){this.overlay.style.visibility="hidden",clearTimeout(this.layoutChangeTimeout),this.layoutChangeTimeout=setTimeout(this.layoutRanges.bind(this),200)}redraw(e){e&&(this.selecting="cell",this.resetRanges(),this.layoutElement())}layoutElement(e){var t;e?t=this.table.rowManager.getVisibleRows(!0):t=this.table.rowManager.getRows(),t.forEach(i=>{i.type==="row"&&(this.layoutRow(i),i.cells.forEach(n=>this.renderCell(n)))}),this.getTableColumns().forEach(i=>{this.layoutColumn(i)}),this.layoutRanges()}layoutRow(e){var t=e.getElement(),i=!1,n=this.ranges.some(s=>s.occupiesRow(e));this.selecting==="row"?i=n:this.selecting==="all"&&(i=!0),t.classList.toggle("tabulator-range-selected",i),t.classList.toggle("tabulator-range-highlight",n)}layoutColumn(e){var t=e.getElement(),i=!1,n=this.ranges.some(s=>s.occupiesColumn(e));this.selecting==="column"?i=n:this.selecting==="all"&&(i=!0),t.classList.toggle("tabulator-range-selected",i),t.classList.toggle("tabulator-range-highlight",n)}layoutRanges(){var e,t,i;this.table.initialized&&(e=this.getActiveCell(),e&&(t=e.getElement(),i=e.row.getElement(),this.table.rtl?this.activeRangeCellElement.style.right=i.offsetWidth-t.offsetLeft-t.offsetWidth+"px":this.activeRangeCellElement.style.left=i.offsetLeft+t.offsetLeft+"px",this.activeRangeCellElement.style.top=i.offsetTop+"px",this.activeRangeCellElement.style.width=t.offsetWidth+"px",this.activeRangeCellElement.style.height=i.offsetHeight+"px",this.ranges.forEach(n=>n.layout()),this.overlay.style.visibility="visible"))}getCell(e,t){var i;return t<0&&(t=this.getTableColumns().length+t,t<0)?null:(e<0&&(e=this.getTableRows().length+e),i=this.table.rowManager.getRowFromPosition(e+1),i?i.getCells(!1,!0).filter(n=>n.column.visible)[t]:null)}getActiveCell(){return this.getCell(this.activeRange.start.row,this.activeRange.start.col)}getRowByRangePos(e){return this.getTableRows()[e]}getColumnByRangePos(e){return this.getTableColumns()[e]}getTableRows(){return this.table.rowManager.getDisplayRows().filter(e=>e.type==="row")}getTableColumns(){return this.table.columnManager.getVisibleColumnsByIndex()}addRange(e,t){var i;return this.maxRanges!==!0&&this.ranges.length>=this.maxRanges&&this.ranges.shift().destroy(),i=new Jx(this.table,this,e,t),this.activeRange=i,this.ranges.push(i),this.rangeContainer.appendChild(i.element),i}resetRanges(){var e,t,i;return this.ranges.forEach(n=>n.destroy()),this.ranges=[],e=this.addRange(),this.table.rowManager.activeRows.length&&(i=this.table.rowManager.activeRows[0].cells.filter(n=>n.column.visible),t=i[this.rowHeader?1:0],t&&(e.setBounds(t),this.options("selectableRangeAutoFocus")&&this.initializeFocus(t))),e}tableDestroyed(){document.removeEventListener("mouseup",this.mouseUpEvent),this.table.rowManager.element.removeEventListener("keydown",this.keyDownEvent)}selectedRows(e){return e?this.activeRange.getRows().map(t=>t.getComponent()):this.activeRange.getRows()}selectedColumns(e){return e?this.activeRange.getColumns().map(t=>t.getComponent()):this.activeRange.getColumns()}getRowHeaderWidth(){return this.rowHeader?this.rowHeader.getElement().offsetWidth:0}isEmpty(e){return e==null||e===""}}function a5(r,e,t,i,n,s,a){var o=a.alignEmptyValues,l=a.decimalSeparator,h=a.thousandSeparator,c=0;if(r=String(r),e=String(e),h&&(r=r.split(h).join(""),e=e.split(h).join("")),l&&(r=r.split(l).join("."),e=e.split(l).join(".")),r=parseFloat(r),e=parseFloat(e),isNaN(r))c=isNaN(e)?0:-1;else if(isNaN(e))c=1;else return r-e;return(o==="top"&&s==="desc"||o==="bottom"&&s==="asc")&&(c*=-1),c}function o5(r,e,t,i,n,s,a){var o=a.alignEmptyValues,l=0,h;if(!r)l=e?-1:0;else if(!e)l=1;else{switch(typeof a.locale){case"boolean":a.locale&&(h=this.langLocale());break;case"string":h=a.locale;break}return String(r).toLowerCase().localeCompare(String(e).toLowerCase(),h)}return(o==="top"&&s==="desc"||o==="bottom"&&s==="asc")&&(l*=-1),l}function fd(r,e,t,i,n,s,a){var o=this.table.dependencyRegistry.lookup(["luxon","DateTime"],"DateTime"),l=a.format||"dd/MM/yyyy HH:mm:ss",h=a.alignEmptyValues,c=0;if(typeof o<"u"){if(o.isDateTime(r)||(l==="iso"?r=o.fromISO(String(r)):r=o.fromFormat(String(r),l)),o.isDateTime(e)||(l==="iso"?e=o.fromISO(String(e)):e=o.fromFormat(String(e),l)),!r.isValid)c=e.isValid?-1:0;else if(!e.isValid)c=1;else return r-e;return(h==="top"&&s==="desc"||h==="bottom"&&s==="asc")&&(c*=-1),c}else console.error("Sort Error - 'datetime' sorter is dependant on luxon.js")}function l5(r,e,t,i,n,s,a){return a.format||(a.format="dd/MM/yyyy"),fd.call(this,r,e,t,i,n,s,a)}function h5(r,e,t,i,n,s,a){return a.format||(a.format="HH:mm"),fd.call(this,r,e,t,i,n,s,a)}function c5(r,e,t,i,n,s,a){var o=r===!0||r==="true"||r==="True"||r===1?1:0,l=e===!0||e==="true"||e==="True"||e===1?1:0;return o-l}function u5(r,e,t,i,n,s,a){var o=a.type||"length",l=a.alignEmptyValues,h=0,c=this.table,d;a.valueMap&&(typeof a.valueMap=="string"?d=function(f){return f.map(g=>hr.retrieveNestedData(c.options.nestedFieldSeparator,a.valueMap,g))}:d=a.valueMap);function p(f){var g;switch(d&&(f=d(f)),o){case"length":g=f.length;break;case"sum":g=f.reduce(function(m,b){return m+b});break;case"max":g=Math.max.apply(null,f);break;case"min":g=Math.min.apply(null,f);break;case"avg":g=f.reduce(function(m,b){return m+b})/f.length;break;case"string":g=f.join("");break}return g}if(!Array.isArray(r))h=Array.isArray(e)?-1:0;else if(!Array.isArray(e))h=1;else return o==="string"?String(p(r)).toLowerCase().localeCompare(String(p(e)).toLowerCase()):p(e)-p(r);return(l==="top"&&s==="desc"||l==="bottom"&&s==="asc")&&(h*=-1),h}function f5(r,e,t,i,n,s,a){var o=typeof r>"u"?0:1,l=typeof e>"u"?0:1;return o-l}function d5(r,e,t,i,n,s,a){var o,l,h,c,d=0,p,f=/(\d+)|(\D+)/g,g=/\d/,m=a.alignEmptyValues,b=0;if(!r&&r!==0)b=!e&&e!==0?0:-1;else if(!e&&e!==0)b=1;else{if(isFinite(r)&&isFinite(e))return r-e;if(o=String(r).toLowerCase(),l=String(e).toLowerCase(),o===l)return 0;if(!(g.test(o)&&g.test(l)))return o>l?1:-1;for(o=o.match(f),l=l.match(f),p=o.length>l.length?l.length:o.length;d<p;)if(h=o[d],c=l[d++],h!==c)return isFinite(h)&&isFinite(c)?(h.charAt(0)==="0"&&(h="."+h),c.charAt(0)==="0"&&(c="."+c),h-c):h>c?1:-1;return o.length>l.length}return(m==="top"&&s==="desc"||m==="bottom"&&s==="asc")&&(b*=-1),b}var p5={number:a5,string:o5,date:l5,time:h5,datetime:fd,boolean:c5,array:u5,exists:f5,alphanum:d5};class Fl extends Dt{static moduleName="sort";static sorters=p5;constructor(e){super(e),this.sortList=[],this.changed=!1,this.registerTableOption("sortMode","local"),this.registerTableOption("initialSort",!1),this.registerTableOption("columnHeaderSortMulti",!0),this.registerTableOption("sortOrderReverse",!1),this.registerTableOption("headerSortElement","<div class='tabulator-arrow'></div>"),this.registerTableOption("headerSortClickElement","header"),this.registerColumnOption("sorter"),this.registerColumnOption("sorterParams"),this.registerColumnOption("headerSort",!0),this.registerColumnOption("headerSortStartingDir"),this.registerColumnOption("headerSortTristate")}initialize(){this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("table-built",this.tableBuilt.bind(this)),this.registerDataHandler(this.sort.bind(this),20),this.registerTableFunction("setSort",this.userSetSort.bind(this)),this.registerTableFunction("getSorters",this.getSort.bind(this)),this.registerTableFunction("clearSort",this.clearSort.bind(this)),this.table.options.sortMode==="remote"&&this.subscribe("data-params",this.remoteSortParams.bind(this))}tableBuilt(){this.table.options.initialSort&&this.setSort(this.table.options.initialSort)}remoteSortParams(e,t,i,n){var s=this.getSort();return s.forEach(a=>{delete a.column}),n.sort=s,n}userSetSort(e,t){this.setSort(e,t),this.refreshSort()}clearSort(){this.clear(),this.refreshSort()}initializeColumn(e){var t=!1,i,n;switch(typeof e.definition.sorter){case"string":Fl.sorters[e.definition.sorter]?t=Fl.sorters[e.definition.sorter]:console.warn("Sort Error - No such sorter found: ",e.definition.sorter);break;case"function":t=e.definition.sorter;break}if(e.modules.sort={sorter:t,dir:"none",params:e.definition.sorterParams||{},startingDir:e.definition.headerSortStartingDir||"asc",tristate:e.definition.headerSortTristate},e.definition.headerSort!==!1){switch(i=e.getElement(),i.classList.add("tabulator-sortable"),n=document.createElement("div"),n.classList.add("tabulator-col-sorter"),this.table.options.headerSortClickElement){case"icon":n.classList.add("tabulator-col-sorter-element");break;case"header":i.classList.add("tabulator-col-sorter-element");break;default:i.classList.add("tabulator-col-sorter-element");break}switch(this.table.options.headerSortElement){case"function":break;case"object":n.appendChild(this.table.options.headerSortElement);break;default:n.innerHTML=this.table.options.headerSortElement}e.titleHolderElement.appendChild(n),e.modules.sort.element=n,this.setColumnHeaderSortIcon(e,"none"),this.table.options.headerSortClickElement==="icon"&&n.addEventListener("mousedown",s=>{s.stopPropagation()}),(this.table.options.headerSortClickElement==="icon"?n:i).addEventListener("click",s=>{var a="",o=[],l=!1;if(e.modules.sort){if(e.modules.sort.tristate)e.modules.sort.dir=="none"?a=e.modules.sort.startingDir:e.modules.sort.dir==e.modules.sort.startingDir?a=e.modules.sort.dir=="asc"?"desc":"asc":a="none";else switch(e.modules.sort.dir){case"asc":a="desc";break;case"desc":a="asc";break;default:a=e.modules.sort.startingDir}this.table.options.columnHeaderSortMulti&&(s.shiftKey||s.ctrlKey)?(o=this.getSort(),l=o.findIndex(h=>h.field===e.getField()),l>-1?(o[l].dir=a,l=o.splice(l,1)[0],a!="none"&&o.push(l)):a!="none"&&o.push({column:e,dir:a}),this.setSort(o)):a=="none"?this.clear():this.setSort(e,a),this.refreshSort()}})}}refreshSort(){this.table.options.sortMode==="remote"?this.reloadData(null,!1,!1):this.refreshData(!0)}hasChanged(){var e=this.changed;return this.changed=!1,e}getSort(){var e=this,t=[];return e.sortList.forEach(function(i){i.column&&t.push({column:i.column.getComponent(),field:i.column.getField(),dir:i.dir})}),t}setSort(e,t){var i=this,n=[];Array.isArray(e)||(e=[{column:e,dir:t}]),e.forEach(function(s){var a;a=i.table.columnManager.findColumn(s.column),a?(s.column=a,n.push(s),i.changed=!0):console.warn("Sort Warning - Sort field does not exist and is being ignored: ",s.column)}),i.sortList=n,this.dispatch("sort-changed")}clear(){this.setSort([])}findSorter(e){var t=this.table.rowManager.activeRows[0],i="string",n,s;if(t&&(t=t.getData(),n=e.getField(),n))switch(s=e.getFieldValue(t),typeof s){case"undefined":i="string";break;case"boolean":i="boolean";break;default:!isNaN(s)&&s!==""?i="number":s.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i)&&(i="alphanum");break}return Fl.sorters[i]}sort(e,t){var i=this,n=this.table.options.sortOrderReverse?i.sortList.slice().reverse():i.sortList,s=[],a=[];return this.subscribedExternal("dataSorting")&&this.dispatchExternal("dataSorting",i.getSort()),t||i.clearColumnHeaders(),this.table.options.sortMode!=="remote"?(n.forEach(function(o,l){var h;o.column&&(h=o.column.modules.sort,h&&(h.sorter||(h.sorter=i.findSorter(o.column)),o.params=typeof h.params=="function"?h.params(o.column.getComponent(),o.dir):h.params,s.push(o)),t||i.setColumnHeader(o.column,o.dir))}),s.length&&i._sortItems(e,s)):t||n.forEach(function(o,l){i.setColumnHeader(o.column,o.dir)}),this.subscribedExternal("dataSorted")&&(e.forEach(o=>{a.push(o.getComponent())}),this.dispatchExternal("dataSorted",i.getSort(),a)),e}clearColumnHeaders(){this.table.columnManager.getRealColumns().forEach(e=>{e.modules.sort&&(e.modules.sort.dir="none",e.getElement().setAttribute("aria-sort","none"),this.setColumnHeaderSortIcon(e,"none"))})}setColumnHeader(e,t){e.modules.sort.dir=t,e.getElement().setAttribute("aria-sort",t==="asc"?"ascending":"descending"),this.setColumnHeaderSortIcon(e,t)}setColumnHeaderSortIcon(e,t){var i=e.modules.sort.element,n;if(e.definition.headerSort&&typeof this.table.options.headerSortElement=="function"){for(;i.firstChild;)i.removeChild(i.firstChild);n=this.table.options.headerSortElement.call(this.table,e.getComponent(),t),typeof n=="object"?i.appendChild(n):i.innerHTML=n}}_sortItems(e,t){var i=t.length-1;e.sort((n,s)=>{for(var a,o=i;o>=0;o--){let l=t[o];if(a=this._sortRow(n,s,l.column,l.dir,l.params),a!==0)break}return a})}_sortRow(e,t,i,n,s){var a,o,l=n=="asc"?e:t,h=n=="asc"?t:e;return e=i.getFieldValue(l.getData()),t=i.getFieldValue(h.getData()),e=typeof e<"u"?e:"",t=typeof t<"u"?t:"",a=l.getComponent(),o=h.getComponent(),i.modules.sort.sorter.call(this,e,t,a,o,i.getComponent(),n,s)}}class m5{constructor(e,t){this.columnCount=e,this.rowCount=t,this.columnString=[],this.columns=[],this.rows=[]}genColumns(e){var t=Math.max(this.columnCount,Math.max(...e.map(i=>i.length)));this.columnString=[],this.columns=[];for(let i=1;i<=t;i++)this.incrementChar(this.columnString.length-1),this.columns.push(this.columnString.join(""));return this.columns}genRows(e){var t=Math.max(this.rowCount,e.length);this.rows=[];for(let i=1;i<=t;i++)this.rows.push(i);return this.rows}incrementChar(e){let t=this.columnString[e];t?t!=="Z"?this.columnString[e]=String.fromCharCode(this.columnString[e].charCodeAt(0)+1):(this.columnString[e]="A",e?this.incrementChar(e-1):this.columnString.push("A")):this.columnString.push("A")}setRowCount(e){this.rowCount=e}setColumnCount(e){this.columnCount=e}}class pg{constructor(e){return this._sheet=e,new Proxy(this,{get:function(t,i,n){return typeof t[i]<"u"?t[i]:t._sheet.table.componentFunctionBinder.handle("sheet",t._sheet,i)}})}getTitle(){return this._sheet.title}getKey(){return this._sheet.key}getDefinition(){return this._sheet.getDefinition()}getData(){return this._sheet.getData()}setData(e){return this._sheet.setData(e)}clear(){return this._sheet.clear()}remove(){return this._sheet.remove()}active(){return this._sheet.active()}setTitle(e){return this._sheet.setTitle(e)}setRows(e){return this._sheet.setRows(e)}setColumns(e){return this._sheet.setColumns(e)}}class sp extends hi{constructor(e,t){super(e.table),this.spreadsheetManager=e,this.definition=t,this.title=this.definition.title||"",this.key=this.definition.key||this.definition.title,this.rowCount=this.definition.rows,this.columnCount=this.definition.columns,this.data=this.definition.data||[],this.element=null,this.isActive=!1,this.grid=new m5(this.columnCount,this.rowCount),this.defaultColumnDefinition={width:100,headerHozAlign:"center",headerSort:!1},this.columnDefinition=Object.assign(this.defaultColumnDefinition,this.options("spreadsheetColumnDefinition")),this.columnDefs=[],this.rowDefs=[],this.columnFields=[],this.columns=[],this.rows=[],this.scrollTop=null,this.scrollLeft=null,this.initialize(),this.dispatchExternal("sheetAdded",this.getComponent())}initialize(){this.initializeElement(),this.initializeColumns(),this.initializeRows()}reinitialize(){this.initializeColumns(),this.initializeRows()}initializeElement(){this.element=document.createElement("div"),this.element.classList.add("tabulator-spreadsheet-tab"),this.element.innerText=this.title,this.element.addEventListener("click",()=>{this.spreadsheetManager.loadSheet(this)})}initializeColumns(){this.grid.setColumnCount(this.columnCount),this.columnFields=this.grid.genColumns(this.data),this.columnDefs=[],this.columnFields.forEach(e=>{var t=Object.assign({},this.columnDefinition);t.field=e,t.title=e,this.columnDefs.push(t)})}initializeRows(){var e;this.grid.setRowCount(this.rowCount),e=this.grid.genRows(this.data),this.rowDefs=[],e.forEach((t,i)=>{var n={_id:t},s=this.data[i];s&&s.forEach((a,o)=>{var l=this.columnFields[o];l&&(n[l]=a)}),this.rowDefs.push(n)})}unload(){this.isActive=!1,this.scrollTop=this.table.rowManager.scrollTop,this.scrollLeft=this.table.rowManager.scrollLeft,this.data=this.getData(!0),this.element.classList.remove("tabulator-spreadsheet-tab-active")}load(){var e=!this.isActive;this.isActive=!0,this.table.blockRedraw(),this.table.setData([]),this.table.setColumns(this.columnDefs),this.table.setData(this.rowDefs),this.table.restoreRedraw(),e&&this.scrollTop!==null&&(this.table.rowManager.element.scrollLeft=this.scrollLeft,this.table.rowManager.element.scrollTop=this.scrollTop),this.element.classList.add("tabulator-spreadsheet-tab-active"),this.dispatchExternal("sheetLoaded",this.getComponent())}getComponent(){return new pg(this)}getDefinition(){return{title:this.title,key:this.key,rows:this.rowCount,columns:this.columnCount,data:this.getData()}}getData(e){var t=[],i,n,s;return this.rowDefs.forEach(a=>{var o=[];this.columnFields.forEach(l=>{o.push(a[l])}),t.push(o)}),!e&&!this.options("spreadsheetOutputFull")&&(i=t.map(a=>a.findLastIndex(o=>typeof o<"u")+1),n=Math.max(...i),s=i.findLastIndex(a=>a>0)+1,t=t.slice(0,s),t=t.map(a=>a.slice(0,n))),t}setData(e){this.data=e,this.reinitialize(),this.dispatchExternal("sheetUpdated",this.getComponent()),this.isActive&&this.load()}clear(){this.setData([])}setTitle(e){this.title=e,this.element.innerText=e,this.dispatchExternal("sheetUpdated",this.getComponent())}setRows(e){this.rowCount=e,this.initializeRows(),this.dispatchExternal("sheetUpdated",this.getComponent()),this.isActive&&this.load()}setColumns(e){this.columnCount=e,this.reinitialize(),this.dispatchExternal("sheetUpdated",this.getComponent()),this.isActive&&this.load()}remove(){this.spreadsheetManager.removeSheet(this)}destroy(){this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.dispatchExternal("sheetRemoved",this.getComponent())}active(){this.spreadsheetManager.loadSheet(this)}}class g5 extends Dt{static moduleName="spreadsheet";constructor(e){super(e),this.sheets=[],this.element=null,this.registerTableOption("spreadsheet",!1),this.registerTableOption("spreadsheetRows",50),this.registerTableOption("spreadsheetColumns",50),this.registerTableOption("spreadsheetColumnDefinition",{}),this.registerTableOption("spreadsheetOutputFull",!1),this.registerTableOption("spreadsheetData",!1),this.registerTableOption("spreadsheetSheets",!1),this.registerTableOption("spreadsheetSheetTabs",!1),this.registerTableOption("spreadsheetSheetTabsElement",!1),this.registerTableFunction("setSheets",this.setSheets.bind(this)),this.registerTableFunction("addSheet",this.addSheet.bind(this)),this.registerTableFunction("getSheets",this.getSheets.bind(this)),this.registerTableFunction("getSheetDefinitions",this.getSheetDefinitions.bind(this)),this.registerTableFunction("setSheetData",this.setSheetData.bind(this)),this.registerTableFunction("getSheet",this.getSheet.bind(this)),this.registerTableFunction("getSheetData",this.getSheetData.bind(this)),this.registerTableFunction("clearSheet",this.clearSheet.bind(this)),this.registerTableFunction("removeSheet",this.removeSheetFunc.bind(this)),this.registerTableFunction("activeSheet",this.activeSheetFunc.bind(this))}initialize(){this.options("spreadsheet")&&(this.subscribe("table-initialized",this.tableInitialized.bind(this)),this.subscribe("data-loaded",this.loadRemoteData.bind(this)),this.table.options.index="_id",this.options("spreadsheetData")&&this.options("spreadsheetSheets")&&(console.warn("You cannot use spreadsheetData and spreadsheetSheets at the same time, ignoring spreadsheetData"),this.table.options.spreadsheetData=!1),this.compatibilityCheck(),this.options("spreadsheetSheetTabs")&&this.initializeTabset())}compatibilityCheck(){this.options("data")&&console.warn("Do not use the data option when working with spreadsheets, use either spreadsheetData or spreadsheetSheets to pass data into the table"),this.options("pagination")&&console.warn("The spreadsheet module is not compatible with the pagination module"),this.options("groupBy")&&console.warn("The spreadsheet module is not compatible with the row grouping module"),this.options("responsiveCollapse")&&console.warn("The spreadsheet module is not compatible with the responsive collapse module")}initializeTabset(){this.element=document.createElement("div"),this.element.classList.add("tabulator-spreadsheet-tabs");var e=this.options("spreadsheetSheetTabsElement");e&&!(e instanceof HTMLElement)&&(e=document.querySelector(e),e||console.warn("Unable to find element matching spreadsheetSheetTabsElement selector:",this.options("spreadsheetSheetTabsElement"))),e?e.appendChild(this.element):this.footerAppend(this.element)}tableInitialized(){this.sheets.length?this.loadSheet(this.sheets[0]):this.options("spreadsheetSheets")?this.loadSheets(this.options("spreadsheetSheets")):this.options("spreadsheetData")&&this.loadData(this.options("spreadsheetData"))}loadRemoteData(e,t,i){return console.log("data",e,t,i),Array.isArray(e)?(this.table.dataLoader.clearAlert(),this.dispatchExternal("dataLoaded",e),!e.length||Array.isArray(e[0])?this.loadData(e):this.loadSheets(e)):console.error(`Spreadsheet Loading Error - Unable to process remote data due to invalid data type 
Expecting: array 
Received: `,typeof e,`
Data:     `,e),!1}loadData(e){var t={data:e};this.loadSheet(this.newSheet(t))}destroySheets(){this.sheets.forEach(e=>{e.destroy()}),this.sheets=[],this.activeSheet=null}loadSheets(e){Array.isArray(e)||(e=[]),this.destroySheets(),e.forEach(t=>{this.newSheet(t)}),this.loadSheet(this.sheets[0])}loadSheet(e){this.activeSheet!==e&&(this.activeSheet&&this.activeSheet.unload(),this.activeSheet=e,e.load())}newSheet(e={}){var t;return e.rows||(e.rows=this.options("spreadsheetRows")),e.columns||(e.columns=this.options("spreadsheetColumns")),t=new sp(this,e),this.sheets.push(t),this.element&&this.element.appendChild(t.element),t}removeSheet(e){var t=this.sheets.indexOf(e),i;this.sheets.length>1?t>-1&&(this.sheets.splice(t,1),e.destroy(),this.activeSheet===e&&(i=this.sheets[t-1]||this.sheets[0],i?this.loadSheet(i):this.activeSheet=null)):console.warn("Unable to remove sheet, at least one sheet must be active")}lookupSheet(e){return e?e instanceof sp?e:e instanceof pg?e._sheet:this.sheets.find(t=>t.key===e)||!1:this.activeSheet}setSheets(e){return this.loadSheets(e),this.getSheets()}addSheet(e){return this.newSheet(e).getComponent()}getSheetDefinitions(){return this.sheets.map(e=>e.getDefinition())}getSheets(){return this.sheets.map(e=>e.getComponent())}getSheet(e){var t=this.lookupSheet(e);return t?t.getComponent():!1}setSheetData(e,t){e&&!t&&(t=e,e=!1);var i=this.lookupSheet(e);return i?i.setData(t):!1}getSheetData(e){var t=this.lookupSheet(e);return t?t.getData():!1}clearSheet(e){var t=this.lookupSheet(e);return t?t.clear():!1}removeSheetFunc(e){var t=this.lookupSheet(e);t&&this.removeSheet(t)}activeSheetFunc(e){var t=this.lookupSheet(e);return t?this.loadSheet(t):!1}}class v5 extends Dt{static moduleName="tooltip";constructor(e){super(e),this.tooltipSubscriber=null,this.headerSubscriber=null,this.timeout=null,this.popupInstance=null,this.registerTableOption("tooltipDelay",300),this.registerColumnOption("tooltip"),this.registerColumnOption("headerTooltip")}initialize(){this.deprecatedOptionsCheck(),this.subscribe("column-init",this.initializeColumn.bind(this))}deprecatedOptionsCheck(){}initializeColumn(e){e.definition.headerTooltip&&!this.headerSubscriber&&(this.headerSubscriber=!0,this.subscribe("column-mousemove",this.mousemoveCheck.bind(this,"headerTooltip")),this.subscribe("column-mouseout",this.mouseoutCheck.bind(this,"headerTooltip"))),e.definition.tooltip&&!this.tooltipSubscriber&&(this.tooltipSubscriber=!0,this.subscribe("cell-mousemove",this.mousemoveCheck.bind(this,"tooltip")),this.subscribe("cell-mouseout",this.mouseoutCheck.bind(this,"tooltip")))}mousemoveCheck(e,t,i){var n=e==="tooltip"?i.column.definition.tooltip:i.definition.headerTooltip;n&&(this.clearPopup(),this.timeout=setTimeout(this.loadTooltip.bind(this,t,i,n),this.table.options.tooltipDelay))}mouseoutCheck(e,t,i){this.popupInstance||this.clearPopup()}clearPopup(e,t,i){clearTimeout(this.timeout),this.timeout=null,this.popupInstance&&this.popupInstance.hide()}loadTooltip(e,t,i){var n,s,a;function o(l){s=l}typeof i=="function"&&(i=i(e,t.getComponent(),o)),i instanceof HTMLElement?n=i:(n=document.createElement("div"),i===!0&&(t instanceof ch?i=t.value:t.definition.field?this.langBind("columns|"+t.definition.field,l=>{n.innerHTML=i=l||t.definition.title}):i=t.definition.title),n.innerHTML=i),(i||i===0||i===!1)&&(n.classList.add("tabulator-tooltip"),n.addEventListener("mousemove",l=>l.preventDefault()),this.popupInstance=this.popup(n),typeof s=="function"&&this.popupInstance.renderCallback(s),a=this.popupInstance.containerEventCoords(e),this.popupInstance.show(a.x+15,a.y+15).hideOnBlur(()=>{this.dispatchExternal("TooltipClosed",t.getComponent()),this.popupInstance=null}),this.dispatchExternal("TooltipOpened",t.getComponent()))}}var b5={integer:function(r,e,t){return e===""||e===null||typeof e>"u"?!0:(e=Number(e),!isNaN(e)&&isFinite(e)&&Math.floor(e)===e)},float:function(r,e,t){return e===""||e===null||typeof e>"u"?!0:(e=Number(e),!isNaN(e)&&isFinite(e)&&e%1!==0)},numeric:function(r,e,t){return e===""||e===null||typeof e>"u"?!0:!isNaN(e)},string:function(r,e,t){return e===""||e===null||typeof e>"u"?!0:isNaN(e)},alphanumeric:function(r,e,t){if(e===""||e===null||typeof e>"u")return!0;var i=new RegExp(/^[a-z0-9]+$/i);return i.test(e)},max:function(r,e,t){return e===""||e===null||typeof e>"u"?!0:parseFloat(e)<=t},min:function(r,e,t){return e===""||e===null||typeof e>"u"?!0:parseFloat(e)>=t},starts:function(r,e,t){return e===""||e===null||typeof e>"u"?!0:String(e).toLowerCase().startsWith(String(t).toLowerCase())},ends:function(r,e,t){return e===""||e===null||typeof e>"u"?!0:String(e).toLowerCase().endsWith(String(t).toLowerCase())},minLength:function(r,e,t){return e===""||e===null||typeof e>"u"?!0:String(e).length>=t},maxLength:function(r,e,t){return e===""||e===null||typeof e>"u"?!0:String(e).length<=t},in:function(r,e,t){return e===""||e===null||typeof e>"u"?!0:(typeof t=="string"&&(t=t.split("|")),t.indexOf(e)>-1)},regex:function(r,e,t){if(e===""||e===null||typeof e>"u")return!0;var i=new RegExp(t);return i.test(e)},unique:function(r,e,t){if(e===""||e===null||typeof e>"u")return!0;var i=!0,n=r.getData(),s=r.getColumn()._getSelf();return this.table.rowManager.rows.forEach(function(a){var o=a.getData();o!==n&&e==s.getFieldValue(o)&&(i=!1)}),i},required:function(r,e,t){return e!==""&&e!==null&&typeof e<"u"}};class dd extends Dt{static moduleName="validate";static validators=b5;constructor(e){super(e),this.invalidCells=[],this.registerTableOption("validationMode","blocking"),this.registerColumnOption("validator"),this.registerTableFunction("getInvalidCells",this.getInvalidCells.bind(this)),this.registerTableFunction("clearCellValidation",this.userClearCellValidation.bind(this)),this.registerTableFunction("validate",this.userValidate.bind(this)),this.registerComponentFunction("cell","isValid",this.cellIsValid.bind(this)),this.registerComponentFunction("cell","clearValidation",this.clearValidation.bind(this)),this.registerComponentFunction("cell","validate",this.cellValidate.bind(this)),this.registerComponentFunction("column","validate",this.columnValidate.bind(this)),this.registerComponentFunction("row","validate",this.rowValidate.bind(this))}initialize(){this.subscribe("cell-delete",this.clearValidation.bind(this)),this.subscribe("column-layout",this.initializeColumnCheck.bind(this)),this.subscribe("edit-success",this.editValidate.bind(this)),this.subscribe("edit-editor-clear",this.editorClear.bind(this)),this.subscribe("edit-edited-clear",this.editedClear.bind(this))}editValidate(e,t,i){var n=this.table.options.validationMode!=="manual"?this.validate(e.column.modules.validate,e,t):!0;return n!==!0&&setTimeout(()=>{e.getElement().classList.add("tabulator-validation-fail"),this.dispatchExternal("validationFailed",e.getComponent(),t,n)}),n}editorClear(e,t){t&&e.column.modules.validate&&this.cellValidate(e),e.getElement().classList.remove("tabulator-validation-fail")}editedClear(e){e.modules.validate&&(e.modules.validate.invalid=!1)}cellIsValid(e){return e.modules.validate&&e.modules.validate.invalid||!0}cellValidate(e){return this.validate(e.column.modules.validate,e,e.getValue())}columnValidate(e){var t=[];return e.cells.forEach(i=>{this.cellValidate(i)!==!0&&t.push(i.getComponent())}),t.length?t:!0}rowValidate(e){var t=[];return e.cells.forEach(i=>{this.cellValidate(i)!==!0&&t.push(i.getComponent())}),t.length?t:!0}userClearCellValidation(e){e||(e=this.getInvalidCells()),Array.isArray(e)||(e=[e]),e.forEach(t=>{this.clearValidation(t._getSelf())})}userValidate(e){var t=[];return this.table.rowManager.rows.forEach(i=>{i=i.getComponent();var n=i.validate();n!==!0&&(t=t.concat(n))}),t.length?t:!0}initializeColumnCheck(e){typeof e.definition.validator<"u"&&this.initializeColumn(e)}initializeColumn(e){var t=this,i=[],n;e.definition.validator&&(Array.isArray(e.definition.validator)?e.definition.validator.forEach(s=>{n=t._extractValidator(s),n&&i.push(n)}):(n=this._extractValidator(e.definition.validator),n&&i.push(n)),e.modules.validate=i.length?i:!1)}_extractValidator(e){var t,i,n;switch(typeof e){case"string":return n=e.indexOf(":"),n>-1?(t=e.substring(0,n),i=e.substring(n+1)):t=e,this._buildValidator(t,i);case"function":return this._buildValidator(e);case"object":return this._buildValidator(e.type,e.parameters)}}_buildValidator(e,t){var i=typeof e=="function"?e:dd.validators[e];return i?{type:typeof e=="function"?"function":e,func:i,params:t}:(console.warn("Validator Setup Error - No matching validator found:",e),!1)}validate(e,t,i){var n=this,s=[],a=this.invalidCells.indexOf(t);return e&&e.forEach(o=>{o.func.call(n,t.getComponent(),i,o.params)||s.push({type:o.type,parameters:o.params})}),t.modules.validate||(t.modules.validate={}),s.length?(t.modules.validate.invalid=s,this.table.options.validationMode!=="manual"&&t.getElement().classList.add("tabulator-validation-fail"),a==-1&&this.invalidCells.push(t)):(t.modules.validate.invalid=!1,t.getElement().classList.remove("tabulator-validation-fail"),a>-1&&this.invalidCells.splice(a,1)),s.length?s:!0}getInvalidCells(){var e=[];return this.invalidCells.forEach(t=>{e.push(t.getComponent())}),e}clearValidation(e){var t;e.modules.validate&&e.modules.validate.invalid&&(e.getElement().classList.remove("tabulator-validation-fail"),e.modules.validate.invalid=!1,t=this.invalidCells.indexOf(e),t>-1&&this.invalidCells.splice(t,1))}}var nf=Object.freeze({__proto__:null,AccessorModule:_c,AjaxModule:ko,ClipboardModule:kc,ColumnCalcsModule:So,DataTreeModule:gw,DownloadModule:Sc,EditModule:hd,ExportModule:Tl,FilterModule:xa,FormatModule:To,FrozenColumnsModule:cx,FrozenRowsModule:ux,GroupRowsModule:dx,HistoryModule:Tc,HtmlTableImportModule:wx,ImportModule:cd,InteractionModule:kx,KeybindingsModule:Al,MenuModule:Ax,MoveColumnsModule:Fx,MoveRowsModule:Ac,MutatorModule:Fc,PageModule:ud,PersistenceModule:ts,PopupModule:Bx,PrintModule:Hx,ReactiveDataModule:zx,ResizeColumnsModule:jx,ResizeRowsModule:Wx,ResizeTableModule:Ux,ResponsiveLayoutModule:qx,SelectRangeModule:s5,SelectRowModule:Yx,SortModule:Fl,SpreadsheetModule:g5,TooltipModule:v5,ValidateModule:dd}),w5={debugEventsExternal:!1,debugEventsInternal:!1,debugInvalidOptions:!0,debugInvalidComponentFuncs:!0,debugInitialization:!0,debugDeprecation:!0,height:!1,minHeight:!1,maxHeight:!1,columnHeaderVertAlign:"top",popupContainer:!1,columns:[],columnDefaults:{},rowHeader:!1,data:!1,autoColumns:!1,autoColumnsDefinitions:!1,nestedFieldSeparator:".",footerElement:!1,index:"id",textDirection:"auto",addRowPos:"bottom",headerVisible:!0,renderVertical:"virtual",renderHorizontal:"basic",renderVerticalBuffer:0,scrollToRowPosition:"top",scrollToRowIfVisible:!0,scrollToColumnPosition:"left",scrollToColumnIfVisible:!0,rowFormatter:!1,rowFormatterPrint:null,rowFormatterClipboard:null,rowFormatterHtmlOutput:null,rowHeight:null,placeholder:!1,dataLoader:!0,dataLoaderLoading:!1,dataLoaderError:!1,dataLoaderErrorTimeout:3e3,dataSendParams:{},dataReceiveParams:{},dependencies:{}};class mg{constructor(e,t,i={}){this.table=e,this.msgType=t,this.registeredDefaults=Object.assign({},i)}register(e,t){this.registeredDefaults[e]=t}generate(e,t={}){var i=Object.assign({},this.registeredDefaults),n=this.table.options.debugInvalidOptions||t.debugInvalidOptions===!0;Object.assign(i,e);for(let s in t)i.hasOwnProperty(s)||(n&&console.warn("Invalid "+this.msgType+" option:",s),i[s]=t.key);for(let s in i)s in t?i[s]=t[s]:Array.isArray(i[s])?i[s]=Object.assign([],i[s]):typeof i[s]=="object"&&i[s]!==null?i[s]=Object.assign({},i[s]):typeof i[s]>"u"&&delete i[s];return i}}class Qc extends hi{constructor(e){super(e),this.elementVertical=e.rowManager.element,this.elementHorizontal=e.columnManager.element,this.tableElement=e.rowManager.tableElement,this.verticalFillMode="fit"}initialize(){}clearRows(){}clearColumns(){}reinitializeColumnWidths(e){}renderRows(){}renderColumns(){}rerenderRows(e){e&&e()}rerenderColumns(e,t){}renderRowCells(e){}rerenderRowCells(e,t){}scrollColumns(e,t){}scrollRows(e,t){}resize(){}scrollToRow(e){}scrollToRowNearestTop(e){}visibleRows(e){return[]}rows(){return this.table.rowManager.getDisplayRows()}styleRow(e,t){var i=e.getElement();t%2?(i.classList.add("tabulator-row-even"),i.classList.remove("tabulator-row-odd")):(i.classList.add("tabulator-row-odd"),i.classList.remove("tabulator-row-even"))}clear(){this.clearRows(),this.clearColumns()}render(){this.renderRows(),this.renderColumns()}rerender(e){this.rerenderRows(),this.rerenderColumns()}scrollToRowPosition(e,t,i){var n=this.rows().indexOf(e),s=e.getElement(),a=0;return new Promise((o,l)=>{if(n>-1){if(typeof i>"u"&&(i=this.table.options.scrollToRowIfVisible),!i&&hr.elVisible(s)&&(a=hr.elOffset(s).top-hr.elOffset(this.elementVertical).top,a>0&&a<this.elementVertical.clientHeight-s.offsetHeight))return o(),!1;switch(typeof t>"u"&&(t=this.table.options.scrollToRowPosition),t==="nearest"&&(t=this.scrollToRowNearestTop(e)?"top":"bottom"),this.scrollToRow(e),t){case"middle":case"center":this.elementVertical.scrollHeight-this.elementVertical.scrollTop==this.elementVertical.clientHeight?this.elementVertical.scrollTop=this.elementVertical.scrollTop+(s.offsetTop-this.elementVertical.scrollTop)-(this.elementVertical.scrollHeight-s.offsetTop)/2:this.elementVertical.scrollTop=this.elementVertical.scrollTop-this.elementVertical.clientHeight/2;break;case"bottom":this.elementVertical.scrollHeight-this.elementVertical.scrollTop==this.elementVertical.clientHeight?this.elementVertical.scrollTop=this.elementVertical.scrollTop-(this.elementVertical.scrollHeight-s.offsetTop)+s.offsetHeight:this.elementVertical.scrollTop=this.elementVertical.scrollTop-this.elementVertical.clientHeight+s.offsetHeight;break;case"top":this.elementVertical.scrollTop=s.offsetTop;break}o()}else console.warn("Scroll Error - Row not visible"),l("Scroll Error - Row not visible")})}}class x5 extends Qc{constructor(e){super(e)}renderRowCells(e,t){const i=document.createDocumentFragment();e.cells.forEach(n=>{i.appendChild(n.getElement())}),e.element.appendChild(i),t||e.cells.forEach(n=>{n.cellRendered()})}reinitializeColumnWidths(e){e.forEach(function(t){t.reinitializeWidth()})}}class y5 extends Qc{constructor(e){super(e),this.leftCol=0,this.rightCol=0,this.scrollLeft=0,this.vDomScrollPosLeft=0,this.vDomScrollPosRight=0,this.vDomPadLeft=0,this.vDomPadRight=0,this.fitDataColAvg=0,this.windowBuffer=200,this.visibleRows=null,this.initialized=!1,this.isFitData=!1,this.columns=[]}initialize(){this.compatibilityCheck(),this.layoutCheck(),this.vertScrollListen()}compatibilityCheck(){this.options("layout")=="fitDataTable"&&console.warn("Horizontal Virtual DOM is not compatible with fitDataTable layout mode"),this.options("responsiveLayout")&&console.warn("Horizontal Virtual DOM is not compatible with responsive columns"),this.options("rtl")&&console.warn("Horizontal Virtual DOM is not currently compatible with RTL text direction")}layoutCheck(){this.isFitData=this.options("layout").startsWith("fitData")}vertScrollListen(){this.subscribe("scroll-vertical",this.clearVisRowCache.bind(this)),this.subscribe("data-refreshed",this.clearVisRowCache.bind(this))}clearVisRowCache(){this.visibleRows=null}renderColumns(e,t){this.dataChange()}scrollColumns(e,t){this.scrollLeft!=e&&(this.scrollLeft=e,this.scroll(e-(this.vDomScrollPosLeft+this.windowBuffer)))}calcWindowBuffer(){var e=this.elementVertical.clientWidth;this.table.columnManager.columnsByIndex.forEach(t=>{if(t.visible){var i=t.getWidth();i>e&&(e=i)}}),this.windowBuffer=e*2}rerenderColumns(e,t){var i={cols:this.columns,leftCol:this.leftCol,rightCol:this.rightCol},n=0;e&&!this.initialized||(this.clear(),this.calcWindowBuffer(),this.scrollLeft=this.elementVertical.scrollLeft,this.vDomScrollPosLeft=this.scrollLeft-this.windowBuffer,this.vDomScrollPosRight=this.scrollLeft+this.elementVertical.clientWidth+this.windowBuffer,this.table.columnManager.columnsByIndex.forEach(s=>{var a={},o;s.visible&&(s.modules.frozen||(o=s.getWidth(),a.leftPos=n,a.rightPos=n+o,a.width=o,this.isFitData&&(a.fitDataCheck=s.modules.vdomHoz?s.modules.vdomHoz.fitDataCheck:!0),n+o>this.vDomScrollPosLeft&&n<this.vDomScrollPosRight?(this.leftCol==-1&&(this.leftCol=this.columns.length,this.vDomPadLeft=n),this.rightCol=this.columns.length):this.leftCol!==-1&&(this.vDomPadRight+=o),this.columns.push(s),s.modules.vdomHoz=a,n+=o))}),this.tableElement.style.paddingLeft=this.vDomPadLeft+"px",this.tableElement.style.paddingRight=this.vDomPadRight+"px",this.initialized=!0,t||(!e||this.reinitChanged(i))&&this.reinitializeRows(),this.elementVertical.scrollLeft=this.scrollLeft)}renderRowCells(e){if(this.initialized)this.initializeRow(e);else{const t=document.createDocumentFragment();e.cells.forEach(i=>{t.appendChild(i.getElement())}),e.element.appendChild(t),e.cells.forEach(i=>{i.cellRendered()})}}rerenderRowCells(e,t){this.reinitializeRow(e,t)}reinitializeColumnWidths(e){for(let t=this.leftCol;t<=this.rightCol;t++){let i=this.columns[t];i&&i.reinitializeWidth()}}deinitialize(){this.initialized=!1}clear(){this.columns=[],this.leftCol=-1,this.rightCol=0,this.vDomScrollPosLeft=0,this.vDomScrollPosRight=0,this.vDomPadLeft=0,this.vDomPadRight=0}dataChange(){var e=!1,t,i;if(this.isFitData){if(this.table.columnManager.columnsByIndex.forEach(n=>{!n.definition.width&&n.visible&&(e=!0)}),e&&this.table.rowManager.getDisplayRows().length&&(this.vDomScrollPosRight=this.scrollLeft+this.elementVertical.clientWidth+this.windowBuffer,t=this.chain("rows-sample",[1],[],()=>this.table.rowManager.getDisplayRows())[0],t)){i=t.getElement(),t.generateCells(),this.tableElement.appendChild(i);for(let n=0;n<t.cells.length;n++){let s=t.cells[n];i.appendChild(s.getElement()),s.column.reinitializeWidth()}i.parentNode.removeChild(i),this.rerenderColumns(!1,!0)}}else this.options("layout")==="fitColumns"&&(this.layoutRefresh(),this.rerenderColumns(!1,!0))}reinitChanged(e){var t=!0;return e.cols.length!==this.columns.length||e.leftCol!==this.leftCol||e.rightCol!==this.rightCol?!0:(e.cols.forEach((i,n)=>{i!==this.columns[n]&&(t=!1)}),!t)}reinitializeRows(){var e=this.getVisibleRows(),t=this.table.rowManager.getRows().filter(i=>!e.includes(i));e.forEach(i=>{this.reinitializeRow(i,!0)}),t.forEach(i=>{i.deinitialize()})}getVisibleRows(){return this.visibleRows||(this.visibleRows=this.table.rowManager.getVisibleRows()),this.visibleRows}scroll(e){this.vDomScrollPosLeft+=e,this.vDomScrollPosRight+=e,Math.abs(e)>this.windowBuffer/2?this.rerenderColumns():e>0?(this.addColRight(),this.removeColLeft()):(this.addColLeft(),this.removeColRight())}colPositionAdjust(e,t,i){for(let n=e;n<t;n++){let s=this.columns[n];s.modules.vdomHoz.leftPos+=i,s.modules.vdomHoz.rightPos+=i}}addColRight(){for(var e=!1,t=!0;t;){let i=this.columns[this.rightCol+1];i&&i.modules.vdomHoz.leftPos<=this.vDomScrollPosRight?(e=!0,this.getVisibleRows().forEach(n=>{if(n.type!=="group"){var s=n.getCell(i);n.getElement().insertBefore(s.getElement(),n.getCell(this.columns[this.rightCol]).getElement().nextSibling),s.cellRendered()}}),this.fitDataColActualWidthCheck(i),this.rightCol++,this.getVisibleRows().forEach(n=>{n.type!=="group"&&(n.modules.vdomHoz.rightCol=this.rightCol)}),this.rightCol>=this.columns.length-1?this.vDomPadRight=0:this.vDomPadRight-=i.getWidth()):t=!1}e&&(this.tableElement.style.paddingRight=this.vDomPadRight+"px")}addColLeft(){for(var e=!1,t=!0;t;){let i=this.columns[this.leftCol-1];if(i)if(i.modules.vdomHoz.rightPos>=this.vDomScrollPosLeft){e=!0,this.getVisibleRows().forEach(s=>{if(s.type!=="group"){var a=s.getCell(i);s.getElement().insertBefore(a.getElement(),s.getCell(this.columns[this.leftCol]).getElement()),a.cellRendered()}}),this.leftCol--,this.getVisibleRows().forEach(s=>{s.type!=="group"&&(s.modules.vdomHoz.leftCol=this.leftCol)}),this.leftCol<=0?this.vDomPadLeft=0:this.vDomPadLeft-=i.getWidth();let n=this.fitDataColActualWidthCheck(i);n&&(this.scrollLeft=this.elementVertical.scrollLeft=this.elementVertical.scrollLeft+n,this.vDomPadRight-=n)}else t=!1;else t=!1}e&&(this.tableElement.style.paddingLeft=this.vDomPadLeft+"px")}removeColRight(){for(var e=!1,t=!0;t;){let i=this.columns[this.rightCol];i&&i.modules.vdomHoz.leftPos>this.vDomScrollPosRight?(e=!0,this.getVisibleRows().forEach(n=>{if(n.type!=="group"){var s=n.getCell(i);try{n.getElement().removeChild(s.getElement())}catch(a){console.warn("Could not removeColRight",a.message)}}}),this.vDomPadRight+=i.getWidth(),this.rightCol--,this.getVisibleRows().forEach(n=>{n.type!=="group"&&(n.modules.vdomHoz.rightCol=this.rightCol)})):t=!1}e&&(this.tableElement.style.paddingRight=this.vDomPadRight+"px")}removeColLeft(){for(var e=!1,t=!0;t;){let i=this.columns[this.leftCol];i&&i.modules.vdomHoz.rightPos<this.vDomScrollPosLeft?(e=!0,this.getVisibleRows().forEach(n=>{if(n.type!=="group"){var s=n.getCell(i);try{n.getElement().removeChild(s.getElement())}catch(a){console.warn("Could not removeColLeft",a.message)}}}),this.vDomPadLeft+=i.getWidth(),this.leftCol++,this.getVisibleRows().forEach(n=>{n.type!=="group"&&(n.modules.vdomHoz.leftCol=this.leftCol)})):t=!1}e&&(this.tableElement.style.paddingLeft=this.vDomPadLeft+"px")}fitDataColActualWidthCheck(e){var t,i;return e.modules.vdomHoz.fitDataCheck&&(e.reinitializeWidth(),t=e.getWidth(),i=t-e.modules.vdomHoz.width,i&&(e.modules.vdomHoz.rightPos+=i,e.modules.vdomHoz.width=t,this.colPositionAdjust(this.columns.indexOf(e)+1,this.columns.length,i)),e.modules.vdomHoz.fitDataCheck=!1),i}initializeRow(e){if(e.type!=="group"){e.modules.vdomHoz={leftCol:this.leftCol,rightCol:this.rightCol},this.table.modules.frozenColumns&&this.table.modules.frozenColumns.leftColumns.forEach(t=>{this.appendCell(e,t)});for(let t=this.leftCol;t<=this.rightCol;t++)this.appendCell(e,this.columns[t]);this.table.modules.frozenColumns&&this.table.modules.frozenColumns.rightColumns.forEach(t=>{this.appendCell(e,t)})}}appendCell(e,t){if(t&&t.visible){let i=e.getCell(t);e.getElement().appendChild(i.getElement()),i.cellRendered()}}reinitializeRow(e,t){if(e.type!=="group"&&(t||!e.modules.vdomHoz||e.modules.vdomHoz.leftCol!==this.leftCol||e.modules.vdomHoz.rightCol!==this.rightCol)){for(var i=e.getElement();i.firstChild;)i.removeChild(i.firstChild);this.initializeRow(e)}}}class E5 extends hi{constructor(e){super(e),this.blockHozScrollEvent=!1,this.headersElement=null,this.contentsElement=null,this.rowHeader=null,this.element=null,this.columns=[],this.columnsByIndex=[],this.columnsByField={},this.scrollLeft=0,this.optionsList=new mg(this.table,"column definition",dg),this.redrawBlock=!1,this.redrawBlockUpdate=null,this.renderer=null}initialize(){this.initializeRenderer(),this.headersElement=this.createHeadersElement(),this.contentsElement=this.createHeaderContentsElement(),this.element=this.createHeaderElement(),this.contentsElement.insertBefore(this.headersElement,this.contentsElement.firstChild),this.element.insertBefore(this.contentsElement,this.element.firstChild),this.initializeScrollWheelWatcher(),this.subscribe("scroll-horizontal",this.scrollHorizontal.bind(this)),this.subscribe("scrollbar-vertical",this.padVerticalScrollbar.bind(this))}padVerticalScrollbar(e){this.table.rtl?this.headersElement.style.marginLeft=e+"px":this.headersElement.style.marginRight=e+"px"}initializeRenderer(){var e,t={virtual:y5,basic:x5};typeof this.table.options.renderHorizontal=="string"?e=t[this.table.options.renderHorizontal]:e=this.table.options.renderHorizontal,e?(this.renderer=new e(this.table,this.element,this.tableElement),this.renderer.initialize()):console.error("Unable to find matching renderer:",this.table.options.renderHorizontal)}createHeadersElement(){var e=document.createElement("div");return e.classList.add("tabulator-headers"),e.setAttribute("role","row"),e}createHeaderContentsElement(){var e=document.createElement("div");return e.classList.add("tabulator-header-contents"),e.setAttribute("role","rowgroup"),e}createHeaderElement(){var e=document.createElement("div");return e.classList.add("tabulator-header"),e.setAttribute("role","rowgroup"),this.table.options.headerVisible||e.classList.add("tabulator-header-hidden"),e}getElement(){return this.element}getContentsElement(){return this.contentsElement}getHeadersElement(){return this.headersElement}scrollHorizontal(e){this.contentsElement.scrollLeft=e,this.scrollLeft=e,this.renderer.scrollColumns(e)}initializeScrollWheelWatcher(){this.contentsElement.addEventListener("wheel",e=>{var t;e.deltaX&&(t=this.contentsElement.scrollLeft+e.deltaX,this.table.rowManager.scrollHorizontal(t),this.table.columnManager.scrollHorizontal(t))})}generateColumnsFromRowData(e){var t=[],i={},n=this.table.options.autoColumns==="full"?e:[e[0]],s=this.table.options.autoColumnsDefinitions;if(e&&e.length){if(n.forEach(a=>{Object.keys(a).forEach((o,l)=>{let h=a[o],c;i[o]?i[o]!==!0&&typeof h<"u"&&(i[o].sorter=this.calculateSorterFromValue(h),i[o]=!0):(c={field:o,title:o,sorter:this.calculateSorterFromValue(h)},t.splice(l,0,c),i[o]=typeof h>"u"?c:!0)})}),s)switch(typeof s){case"function":this.table.options.columns=s.call(this.table,t);break;case"object":Array.isArray(s)?t.forEach(a=>{var o=s.find(l=>l.field===a.field);o&&Object.assign(a,o)}):t.forEach(a=>{s[a.field]&&Object.assign(a,s[a.field])}),this.table.options.columns=t;break}else this.table.options.columns=t;this.setColumns(this.table.options.columns)}}calculateSorterFromValue(e){var t;switch(typeof e){case"undefined":t="string";break;case"boolean":t="boolean";break;case"number":t="number";break;case"object":Array.isArray(e)?t="array":t="string";break;default:!isNaN(e)&&e!==""?t="number":e.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i)?t="alphanum":t="string";break}return t}setColumns(e,t){for(;this.headersElement.firstChild;)this.headersElement.removeChild(this.headersElement.firstChild);this.columns=[],this.columnsByIndex=[],this.columnsByField={},this.dispatch("columns-loading"),this.dispatchExternal("columnsLoading"),this.table.options.rowHeader&&(this.rowHeader=new rs(this.table.options.rowHeader===!0?{}:this.table.options.rowHeader,this,!0),this.columns.push(this.rowHeader),this.headersElement.appendChild(this.rowHeader.getElement()),this.rowHeader.columnRendered()),e.forEach((i,n)=>{this._addColumn(i)}),this._reIndexColumns(),this.dispatch("columns-loaded"),this.subscribedExternal("columnsLoaded")&&this.dispatchExternal("columnsLoaded",this.getComponents()),this.rerenderColumns(!1,!0),this.redraw(!0)}_addColumn(e,t,i){var n=new rs(e,this),s=n.getElement(),a=i&&this.findColumnIndex(i);if(t&&this.rowHeader&&(!i||i===this.rowHeader)&&(t=!1,i=this.rowHeader,a=0),i&&a>-1){var o=i.getTopColumn(),l=this.columns.indexOf(o),h=o.getElement();t?(this.columns.splice(l,0,n),h.parentNode.insertBefore(s,h)):(this.columns.splice(l+1,0,n),h.parentNode.insertBefore(s,h.nextSibling))}else t?(this.columns.unshift(n),this.headersElement.insertBefore(n.getElement(),this.headersElement.firstChild)):(this.columns.push(n),this.headersElement.appendChild(n.getElement()));return n.columnRendered(),n}registerColumnField(e){e.definition.field&&(this.columnsByField[e.definition.field]=e)}registerColumnPosition(e){this.columnsByIndex.push(e)}_reIndexColumns(){this.columnsByIndex=[],this.columns.forEach(function(e){e.reRegisterPosition()})}verticalAlignHeaders(){var e=0;this.redrawBlock||(this.headersElement.style.height="",this.columns.forEach(t=>{t.clearVerticalAlign()}),this.columns.forEach(t=>{var i=t.getHeight();i>e&&(e=i)}),this.headersElement.style.height=e+"px",this.columns.forEach(t=>{t.verticalAlign(this.table.options.columnHeaderVertAlign,e)}),this.table.rowManager.adjustTableSize())}findColumn(e){var t;if(typeof e=="object"){if(e instanceof rs)return e;if(e instanceof fg)return e._getSelf()||!1;if(typeof HTMLElement<"u"&&e instanceof HTMLElement)return t=[],this.columns.forEach(n=>{t.push(n),t=t.concat(n.getColumns(!0))}),t.find(n=>n.element===e)||!1}else return this.columnsByField[e]||!1;return!1}getColumnByField(e){return this.columnsByField[e]}getColumnsByFieldRoot(e){var t=[];return Object.keys(this.columnsByField).forEach(i=>{var n=this.table.options.nestedFieldSeparator?i.split(this.table.options.nestedFieldSeparator)[0]:i;n===e&&t.push(this.columnsByField[i])}),t}getColumnByIndex(e){return this.columnsByIndex[e]}getFirstVisibleColumn(){var e=this.columnsByIndex.findIndex(t=>t.visible);return e>-1?this.columnsByIndex[e]:!1}getVisibleColumnsByIndex(){return this.columnsByIndex.filter(e=>e.visible)}getColumns(){return this.columns}findColumnIndex(e){return this.columnsByIndex.findIndex(t=>e===t)}getRealColumns(){return this.columnsByIndex}traverse(e){this.columnsByIndex.forEach((t,i)=>{e(t,i)})}getDefinitions(e){var t=[];return this.columnsByIndex.forEach(i=>{(!e||e&&i.visible)&&t.push(i.getDefinition())}),t}getDefinitionTree(){var e=[];return this.columns.forEach(t=>{e.push(t.getDefinition(!0))}),e}getComponents(e){var t=[],i=e?this.columns:this.columnsByIndex;return i.forEach(n=>{t.push(n.getComponent())}),t}getWidth(){var e=0;return this.columnsByIndex.forEach(t=>{t.visible&&(e+=t.getWidth())}),e}moveColumn(e,t,i){t.element.parentNode.insertBefore(e.element,t.element),i&&t.element.parentNode.insertBefore(t.element,e.element),this.moveColumnActual(e,t,i),this.verticalAlignHeaders(),this.table.rowManager.reinitialize()}moveColumnActual(e,t,i){e.parent.isGroup?this._moveColumnInArray(e.parent.columns,e,t,i):this._moveColumnInArray(this.columns,e,t,i),this._moveColumnInArray(this.columnsByIndex,e,t,i,!0),this.rerenderColumns(!0),this.dispatch("column-moved",e,t,i),this.subscribedExternal("columnMoved")&&this.dispatchExternal("columnMoved",e.getComponent(),this.table.columnManager.getComponents())}_moveColumnInArray(e,t,i,n,s){var a=e.indexOf(t),o,l=[];a>-1&&(e.splice(a,1),o=e.indexOf(i),o>-1?n&&(o=o+1):o=a,e.splice(o,0,t),s&&(l=this.chain("column-moving-rows",[t,i,n],null,[])||[],l=l.concat(this.table.rowManager.rows),l.forEach(function(h){if(h.cells.length){var c=h.cells.splice(a,1)[0];h.cells.splice(o,0,c)}})))}scrollToColumn(e,t,i){var n=0,s=e.getLeftOffset(),a=0,o=e.getElement();return new Promise((l,h)=>{if(typeof t>"u"&&(t=this.table.options.scrollToColumnPosition),typeof i>"u"&&(i=this.table.options.scrollToColumnIfVisible),e.visible){switch(t){case"middle":case"center":a=-this.element.clientWidth/2;break;case"right":a=o.clientWidth-this.headersElement.clientWidth;break}if(!i&&s>0&&s+o.offsetWidth<this.element.clientWidth)return!1;n=s+a,n=Math.max(Math.min(n,this.table.rowManager.element.scrollWidth-this.table.rowManager.element.clientWidth),0),this.table.rowManager.scrollHorizontal(n),this.scrollHorizontal(n),l()}else console.warn("Scroll Error - Column not visible"),h("Scroll Error - Column not visible")})}generateCells(e){var t=[];return this.columnsByIndex.forEach(i=>{t.push(i.generateCell(e))}),t}getFlexBaseWidth(){var e=this.table.element.clientWidth,t=0;return this.table.rowManager.element.scrollHeight>this.table.rowManager.element.clientHeight&&(e-=this.table.rowManager.element.offsetWidth-this.table.rowManager.element.clientWidth),this.columnsByIndex.forEach(function(i){var n,s,a;i.visible&&(n=i.definition.width||0,s=parseInt(i.minWidth),typeof n=="string"?n.indexOf("%")>-1?a=e/100*parseInt(n):a=parseInt(n):a=n,t+=a>s?a:s)}),t}addColumn(e,t,i){return new Promise((n,s)=>{var a=this._addColumn(e,t,i);this._reIndexColumns(),this.dispatch("column-add",e,t,i),this.layoutMode()!="fitColumns"&&a.reinitializeWidth(),this.redraw(!0),this.table.rowManager.reinitialize(),this.rerenderColumns(),n(a)})}deregisterColumn(e){var t=e.getField(),i;t&&delete this.columnsByField[t],i=this.columnsByIndex.indexOf(e),i>-1&&this.columnsByIndex.splice(i,1),i=this.columns.indexOf(e),i>-1&&this.columns.splice(i,1),this.verticalAlignHeaders(),this.redraw()}rerenderColumns(e,t){this.redrawBlock?(e===!1||e===!0&&this.redrawBlockUpdate===null)&&(this.redrawBlockUpdate=e):this.renderer.rerenderColumns(e,t)}blockRedraw(){this.redrawBlock=!0,this.redrawBlockUpdate=null}restoreRedraw(){this.redrawBlock=!1,this.verticalAlignHeaders(),this.renderer.rerenderColumns(this.redrawBlockUpdate)}redraw(e){hr.elVisible(this.element)&&this.verticalAlignHeaders(),e&&(this.table.rowManager.resetScroll(),this.table.rowManager.reinitialize()),this.confirm("table-redrawing",e)||this.layoutRefresh(e),this.dispatch("table-redraw",e),this.table.footerManager.redraw()}}class C5 extends Qc{constructor(e){super(e),this.verticalFillMode="fill",this.scrollTop=0,this.scrollLeft=0,this.scrollTop=0,this.scrollLeft=0}clearRows(){for(var e=this.tableElement;e.firstChild;)e.removeChild(e.firstChild);e.scrollTop=0,e.scrollLeft=0,e.style.minWidth="",e.style.minHeight="",e.style.display="",e.style.visibility=""}renderRows(){var e=this.tableElement,t=!0,i=document.createDocumentFragment(),n=this.rows();n.forEach((s,a)=>{this.styleRow(s,a),s.initialize(!1,!0),s.type!=="group"&&(t=!1),i.appendChild(s.getElement())}),e.appendChild(i),n.forEach(s=>{s.rendered(),s.heightInitialized||s.calcHeight(!0)}),n.forEach(s=>{s.heightInitialized||s.setCellHeight()}),t?e.style.minWidth=this.table.columnManager.getWidth()+"px":e.style.minWidth=""}rerenderRows(e){this.clearRows(),e&&e(),this.renderRows(),this.rows().length||this.table.rowManager.tableEmpty()}scrollToRowNearestTop(e){var t=hr.elOffset(e.getElement()).top;return!(Math.abs(this.elementVertical.scrollTop-t)>Math.abs(this.elementVertical.scrollTop+this.elementVertical.clientHeight-t))}scrollToRow(e){var t=e.getElement();this.elementVertical.scrollTop=hr.elOffset(t).top-hr.elOffset(this.elementVertical).top+this.elementVertical.scrollTop}visibleRows(e){return this.rows()}}class _5 extends Qc{constructor(e){super(e),this.verticalFillMode="fill",this.scrollTop=0,this.scrollLeft=0,this.vDomRowHeight=20,this.vDomTop=0,this.vDomBottom=0,this.vDomScrollPosTop=0,this.vDomScrollPosBottom=0,this.vDomTopPad=0,this.vDomBottomPad=0,this.vDomMaxRenderChain=90,this.vDomWindowBuffer=0,this.vDomWindowMinTotalRows=20,this.vDomWindowMinMarginRows=5,this.vDomTopNewRows=[],this.vDomBottomNewRows=[]}clearRows(){for(var e=this.tableElement;e.firstChild;)e.removeChild(e.firstChild);e.style.paddingTop="",e.style.paddingBottom="",e.style.minHeight="",e.style.display="",e.style.visibility="",this.elementVertical.scrollTop=0,this.elementVertical.scrollLeft=0,this.scrollTop=0,this.scrollLeft=0,this.vDomTop=0,this.vDomBottom=0,this.vDomTopPad=0,this.vDomBottomPad=0,this.vDomScrollPosTop=0,this.vDomScrollPosBottom=0}renderRows(){this._virtualRenderFill()}rerenderRows(e){for(var t=this.elementVertical.scrollTop,i=!1,n=!1,s=this.table.rowManager.scrollLeft,a=this.rows(),o=this.vDomTop;o<=this.vDomBottom;o++)if(a[o]){var l=t-a[o].getElement().offsetTop;if(n===!1||Math.abs(l)<n)n=l,i=o;else break}a.forEach(h=>{h.deinitializeHeight()}),e&&e(),this.rows().length?this._virtualRenderFill(i===!1?this.rows.length-1:i,!0,n||0):(this.clear(),this.table.rowManager.tableEmpty()),this.scrollColumns(s)}scrollColumns(e){this.table.rowManager.scrollHorizontal(e)}scrollRows(e,t){var i=e-this.vDomScrollPosTop,n=e-this.vDomScrollPosBottom,s=this.vDomWindowBuffer*2,a=this.rows();if(this.scrollTop=e,-i>s||n>s){var o=this.table.rowManager.scrollLeft;this._virtualRenderFill(Math.floor(this.elementVertical.scrollTop/this.elementVertical.scrollHeight*a.length)),this.scrollColumns(o)}else t?(i<0&&this._addTopRow(a,-i),n<0&&(this.vDomScrollHeight-this.scrollTop>this.vDomWindowBuffer?this._removeBottomRow(a,-n):this.vDomScrollPosBottom=this.scrollTop)):(n>=0&&this._addBottomRow(a,n),i>=0&&(this.scrollTop>this.vDomWindowBuffer?this._removeTopRow(a,i):this.vDomScrollPosTop=this.scrollTop))}resize(){this.vDomWindowBuffer=this.table.options.renderVerticalBuffer||this.elementVertical.clientHeight}scrollToRowNearestTop(e){var t=this.rows().indexOf(e);return!(Math.abs(this.vDomTop-t)>Math.abs(this.vDomBottom-t))}scrollToRow(e){var t=this.rows().indexOf(e);t>-1&&this._virtualRenderFill(t,!0)}visibleRows(e){var t=this.elementVertical.scrollTop,i=this.elementVertical.clientHeight+t,n=!1,s=0,a=0,o=this.rows();if(e)s=this.vDomTop,a=this.vDomBottom;else for(var l=this.vDomTop;l<=this.vDomBottom;l++)if(o[l])if(n)if(i-o[l].getElement().offsetTop>=0)a=l;else break;else if(t-o[l].getElement().offsetTop>=0)s=l;else if(n=!0,i-o[l].getElement().offsetTop>=0)a=l;else break;return o.slice(s,a+1)}_virtualRenderFill(e,t,i){var n=this.tableElement,s=this.elementVertical,a=0,o=0,l=0,h=0,c=0,d=0,p=this.rows(),f=p.length,g=0,m,b,w=[],E=0,C=0,F=this.table.rowManager.fixedHeight,L=this.elementVertical.clientHeight,D=this.table.options.rowHeight,S=!0;if(e=e||0,i=i||0,!e)this.clear();else{for(;n.firstChild;)n.removeChild(n.firstChild);h=(f-e+1)*this.vDomRowHeight,h<L&&(e-=Math.ceil((L-h)/this.vDomRowHeight),e<0&&(e=0)),a=Math.min(Math.max(Math.floor(this.vDomWindowBuffer/this.vDomRowHeight),this.vDomWindowMinMarginRows),e),e-=a}if(f&&hr.elVisible(this.elementVertical)){for(this.vDomTop=e,this.vDomBottom=e-1,F||this.table.options.maxHeight?(D&&(C=L/D+this.vDomWindowBuffer/D),C=Math.max(this.vDomWindowMinTotalRows,Math.ceil(C))):C=f;(C==f||o<=L+this.vDomWindowBuffer||E<this.vDomWindowMinTotalRows)&&this.vDomBottom<f-1;){for(w=[],b=document.createDocumentFragment(),d=0;d<C&&this.vDomBottom<f-1;)g=this.vDomBottom+1,m=p[g],this.styleRow(m,g),m.initialize(!1,!0),!m.heightInitialized&&!this.table.options.rowHeight&&m.clearCellHeight(),b.appendChild(m.getElement()),w.push(m),this.vDomBottom++,d++;if(!w.length)break;n.appendChild(b),w.forEach(A=>{A.rendered(),A.heightInitialized||A.calcHeight(!0)}),w.forEach(A=>{A.heightInitialized||A.setCellHeight()}),w.forEach(A=>{l=A.getHeight(),E<a?c+=l:o+=l,l>this.vDomWindowBuffer&&(this.vDomWindowBuffer=l*2),E++}),S=this.table.rowManager.adjustTableSize(),L=this.elementVertical.clientHeight,S&&(F||this.table.options.maxHeight)&&(D=o/E,C=Math.max(this.vDomWindowMinTotalRows,Math.ceil(L/D+this.vDomWindowBuffer/D)))}e?(this.vDomTopPad=t?this.vDomRowHeight*this.vDomTop+i:this.scrollTop-c,this.vDomBottomPad=this.vDomBottom==f-1?0:Math.max(this.vDomScrollHeight-this.vDomTopPad-o-c,0)):(this.vDomTopPad=0,this.vDomRowHeight=Math.floor((o+c)/E),this.vDomBottomPad=this.vDomRowHeight*(f-this.vDomBottom-1),this.vDomScrollHeight=c+o+this.vDomBottomPad-L),n.style.paddingTop=this.vDomTopPad+"px",n.style.paddingBottom=this.vDomBottomPad+"px",t&&(this.scrollTop=this.vDomTopPad+c+i-(this.elementVertical.scrollWidth>this.elementVertical.clientWidth?this.elementVertical.offsetHeight-L:0)),this.scrollTop=Math.min(this.scrollTop,this.elementVertical.scrollHeight-L),this.elementVertical.scrollWidth>this.elementVertical.clientWidth&&t&&(this.scrollTop+=this.elementVertical.offsetHeight-L),this.vDomScrollPosTop=this.scrollTop,this.vDomScrollPosBottom=this.scrollTop,s.scrollTop=this.scrollTop,this.dispatch("render-virtual-fill")}}_addTopRow(e,t){for(var i=this.tableElement,n=[],s=0,a=this.vDomTop-1,o=0,l=!0;l;)if(this.vDomTop){let h=e[a],c,d;h&&o<this.vDomMaxRenderChain?(c=h.getHeight()||this.vDomRowHeight,d=h.initialized,t>=c?(this.styleRow(h,a),i.insertBefore(h.getElement(),i.firstChild),(!h.initialized||!h.heightInitialized)&&n.push(h),h.initialize(),d||(c=h.getElement().offsetHeight,c>this.vDomWindowBuffer&&(this.vDomWindowBuffer=c*2)),t-=c,s+=c,this.vDomTop--,a--,o++):l=!1):l=!1}else l=!1;for(let h of n)h.clearCellHeight();this._quickNormalizeRowHeight(n),s&&(this.vDomTopPad-=s,this.vDomTopPad<0&&(this.vDomTopPad=a*this.vDomRowHeight),a<1&&(this.vDomTopPad=0),i.style.paddingTop=this.vDomTopPad+"px",this.vDomScrollPosTop-=s)}_removeTopRow(e,t){for(var i=[],n=0,s=0,a=!0;a;){let o=e[this.vDomTop],l;o&&s<this.vDomMaxRenderChain?(l=o.getHeight()||this.vDomRowHeight,t>=l?(this.vDomTop++,t-=l,n+=l,i.push(o),s++):a=!1):a=!1}for(let o of i){let l=o.getElement();l.parentNode&&l.parentNode.removeChild(l)}n&&(this.vDomTopPad+=n,this.tableElement.style.paddingTop=this.vDomTopPad+"px",this.vDomScrollPosTop+=this.vDomTop?n:n+this.vDomWindowBuffer)}_addBottomRow(e,t){for(var i=this.tableElement,n=[],s=0,a=this.vDomBottom+1,o=0,l=!0;l;){let h=e[a],c,d;h&&o<this.vDomMaxRenderChain?(c=h.getHeight()||this.vDomRowHeight,d=h.initialized,t>=c?(this.styleRow(h,a),i.appendChild(h.getElement()),(!h.initialized||!h.heightInitialized)&&n.push(h),h.initialize(),d||(c=h.getElement().offsetHeight,c>this.vDomWindowBuffer&&(this.vDomWindowBuffer=c*2)),t-=c,s+=c,this.vDomBottom++,a++,o++):l=!1):l=!1}for(let h of n)h.clearCellHeight();this._quickNormalizeRowHeight(n),s&&(this.vDomBottomPad-=s,(this.vDomBottomPad<0||a==e.length-1)&&(this.vDomBottomPad=0),i.style.paddingBottom=this.vDomBottomPad+"px",this.vDomScrollPosBottom+=s)}_removeBottomRow(e,t){for(var i=[],n=0,s=0,a=!0;a;){let o=e[this.vDomBottom],l;o&&s<this.vDomMaxRenderChain?(l=o.getHeight()||this.vDomRowHeight,t>=l?(this.vDomBottom--,t-=l,n+=l,i.push(o),s++):a=!1):a=!1}for(let o of i){let l=o.getElement();l.parentNode&&l.parentNode.removeChild(l)}n&&(this.vDomBottomPad+=n,this.vDomBottomPad<0&&(this.vDomBottomPad=0),this.tableElement.style.paddingBottom=this.vDomBottomPad+"px",this.vDomScrollPosBottom-=n)}_quickNormalizeRowHeight(e){for(let t of e)t.calcHeight();for(let t of e)t.setCellHeight()}}class k5 extends hi{constructor(e){super(e),this.element=this.createHolderElement(),this.tableElement=this.createTableElement(),this.heightFixer=this.createTableElement(),this.placeholder=null,this.placeholderContents=null,this.firstRender=!1,this.renderMode="virtual",this.fixedHeight=!1,this.rows=[],this.activeRowsPipeline=[],this.activeRows=[],this.activeRowsCount=0,this.displayRows=[],this.displayRowsCount=0,this.scrollTop=0,this.scrollLeft=0,this.redrawBlock=!1,this.redrawBlockRestoreConfig=!1,this.redrawBlockRenderInPosition=!1,this.dataPipeline=[],this.displayPipeline=[],this.scrollbarWidth=0,this.renderer=null}createHolderElement(){var e=document.createElement("div");return e.classList.add("tabulator-tableholder"),e.setAttribute("tabindex",0),e}createTableElement(){var e=document.createElement("div");return e.classList.add("tabulator-table"),e.setAttribute("role","rowgroup"),e}initializePlaceholder(){var e=this.table.options.placeholder;if(typeof e=="function"&&(e=e.call(this.table)),e=this.chain("placeholder",[e],e,e)||e,e){let t=document.createElement("div");if(t.classList.add("tabulator-placeholder"),typeof e=="string"){let i=document.createElement("div");i.classList.add("tabulator-placeholder-contents"),i.innerHTML=e,t.appendChild(i),this.placeholderContents=i}else typeof HTMLElement<"u"&&e instanceof HTMLElement?(t.appendChild(e),this.placeholderContents=e):(console.warn("Invalid placeholder provided, must be string or HTML Element",e),this.el=null);this.placeholder=t}}getElement(){return this.element}getTableElement(){return this.tableElement}initialize(){this.initializePlaceholder(),this.initializeRenderer(),this.element.appendChild(this.tableElement),this.firstRender=!0,this.element.addEventListener("scroll",()=>{var e=this.element.scrollLeft,t=this.scrollLeft>e,i=this.element.scrollTop,n=this.scrollTop>i;this.scrollLeft!=e&&(this.scrollLeft=e,this.dispatch("scroll-horizontal",e,t),this.dispatchExternal("scrollHorizontal",e,t),this._positionPlaceholder()),this.scrollTop!=i&&(this.scrollTop=i,this.renderer.scrollRows(i,n),this.dispatch("scroll-vertical",i,n),this.dispatchExternal("scrollVertical",i,n))})}findRow(e){if(typeof e=="object"){if(e instanceof wi)return e;if(e instanceof Jc)return e._getSelf()||!1;if(typeof HTMLElement<"u"&&e instanceof HTMLElement)return this.rows.find(i=>i.getElement()===e)||!1;if(e===null)return!1}else return typeof e>"u"?!1:this.rows.find(i=>i.data[this.table.options.index]==e)||!1;return!1}getRowFromDataObject(e){var t=this.rows.find(i=>i.data===e);return t||!1}getRowFromPosition(e){return this.getDisplayRows().find(t=>t.type==="row"&&t.getPosition()===e&&t.isDisplayed())}scrollToRow(e,t,i){return this.renderer.scrollToRowPosition(e,t,i)}setData(e,t,i){return new Promise((n,s)=>{t&&this.getDisplayRows().length?this.table.options.pagination?this._setDataActual(e,!0):this.reRenderInPosition(()=>{this._setDataActual(e)}):(this.table.options.autoColumns&&i&&this.table.initialized&&this.table.columnManager.generateColumnsFromRowData(e),this.resetScroll(),this._setDataActual(e)),n()})}_setDataActual(e,t){this.dispatchExternal("dataProcessing",e),this._wipeElements(),Array.isArray(e)?(this.dispatch("data-processing",e),e.forEach((i,n)=>{if(i&&typeof i=="object"){var s=new wi(i,this);this.rows.push(s)}else console.warn("Data Loading Warning - Invalid row data detected and ignored, expecting object but received:",i)}),this.refreshActiveData(!1,!1,t),this.dispatch("data-processed",e),this.dispatchExternal("dataProcessed",e)):console.error(`Data Loading Error - Unable to process data due to invalid data type 
Expecting: array 
Received: `,typeof e,`
Data:     `,e)}_wipeElements(){this.dispatch("rows-wipe"),this.destroy(),this.adjustTableSize(),this.dispatch("rows-wiped")}destroy(){this.rows.forEach(e=>{e.wipe()}),this.rows=[],this.activeRows=[],this.activeRowsPipeline=[],this.activeRowsCount=0,this.displayRows=[],this.displayRowsCount=0}deleteRow(e,t){var i=this.rows.indexOf(e),n=this.activeRows.indexOf(e);n>-1&&this.activeRows.splice(n,1),i>-1&&this.rows.splice(i,1),this.setActiveRows(this.activeRows),this.displayRowIterator(s=>{var a=s.indexOf(e);a>-1&&s.splice(a,1)}),t||this.reRenderInPosition(),this.regenerateRowPositions(),this.dispatchExternal("rowDeleted",e.getComponent()),this.displayRowsCount||this.tableEmpty(),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.getData())}addRow(e,t,i,n){var s=this.addRowActual(e,t,i,n);return s}addRows(e,t,i,n){var s=[];return new Promise((a,o)=>{t=this.findAddRowPos(t),Array.isArray(e)||(e=[e]),(typeof i>"u"&&t||typeof i<"u"&&!t)&&e.reverse(),e.forEach((l,h)=>{var c=this.addRow(l,t,i,!0);s.push(c),this.dispatch("row-added",c,l,t,i)}),this.refreshActiveData(n?"displayPipeline":!1,!1,!0),this.regenerateRowPositions(),this.displayRowsCount&&this._clearPlaceholder(),a(s)})}findAddRowPos(e){return typeof e>"u"&&(e=this.table.options.addRowPos),e==="pos"&&(e=!0),e==="bottom"&&(e=!1),e}addRowActual(e,t,i,n){var s=e instanceof wi?e:new wi(e||{},this),a=this.findAddRowPos(t),o=-1,l,h;return i||(h=this.chain("row-adding-position",[s,a],null,{index:i,top:a}),i=h.index,a=h.top),typeof i<"u"&&(i=this.findRow(i)),i=this.chain("row-adding-index",[s,i,a],null,i),i&&(o=this.rows.indexOf(i)),i&&o>-1?(l=this.activeRows.indexOf(i),this.displayRowIterator(function(c){var d=c.indexOf(i);d>-1&&c.splice(a?d:d+1,0,s)}),l>-1&&this.activeRows.splice(a?l:l+1,0,s),this.rows.splice(a?o:o+1,0,s)):a?(this.displayRowIterator(function(c){c.unshift(s)}),this.activeRows.unshift(s),this.rows.unshift(s)):(this.displayRowIterator(function(c){c.push(s)}),this.activeRows.push(s),this.rows.push(s)),this.setActiveRows(this.activeRows),this.dispatchExternal("rowAdded",s.getComponent()),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.table.rowManager.getData()),n||this.reRenderInPosition(),s}moveRow(e,t,i){this.dispatch("row-move",e,t,i),this.moveRowActual(e,t,i),this.regenerateRowPositions(),this.dispatch("row-moved",e,t,i),this.dispatchExternal("rowMoved",e.getComponent())}moveRowActual(e,t,i){this.moveRowInArray(this.rows,e,t,i),this.moveRowInArray(this.activeRows,e,t,i),this.displayRowIterator(n=>{this.moveRowInArray(n,e,t,i)}),this.dispatch("row-moving",e,t,i)}moveRowInArray(e,t,i,n){var s,a,o,l;if(t!==i&&(s=e.indexOf(t),s>-1&&(e.splice(s,1),a=e.indexOf(i),a>-1?n?e.splice(a+1,0,t):e.splice(a,0,t):e.splice(s,0,t)),e===this.getDisplayRows())){o=s<a?s:a,l=a>s?a:s+1;for(let h=o;h<=l;h++)e[h]&&this.styleRow(e[h],h)}}clearData(){this.setData([])}getRowIndex(e){return this.findRowIndex(e,this.rows)}getDisplayRowIndex(e){var t=this.getDisplayRows().indexOf(e);return t>-1?t:!1}nextDisplayRow(e,t){var i=this.getDisplayRowIndex(e),n=!1;return i!==!1&&i<this.displayRowsCount-1&&(n=this.getDisplayRows()[i+1]),n&&(!(n instanceof wi)||n.type!="row")?this.nextDisplayRow(n,t):n}prevDisplayRow(e,t){var i=this.getDisplayRowIndex(e),n=!1;return i&&(n=this.getDisplayRows()[i-1]),t&&n&&(!(n instanceof wi)||n.type!="row")?this.prevDisplayRow(n,t):n}findRowIndex(e,t){var i;return e=this.findRow(e),e&&(i=t.indexOf(e),i>-1)?i:!1}getData(e,t){var i=[],n=this.getRows(e);return n.forEach(function(s){s.type=="row"&&i.push(s.getData(t||"data"))}),i}getComponents(e){var t=[],i=this.getRows(e);return i.forEach(function(n){t.push(n.getComponent())}),t}getDataCount(e){var t=this.getRows(e);return t.length}scrollHorizontal(e){this.scrollLeft=e,this.element.scrollLeft=e,this.dispatch("scroll-horizontal",e)}registerDataPipelineHandler(e,t){typeof t<"u"?(this.dataPipeline.push({handler:e,priority:t}),this.dataPipeline.sort((i,n)=>i.priority-n.priority)):console.error("Data pipeline handlers must have a priority in order to be registered")}registerDisplayPipelineHandler(e,t){typeof t<"u"?(this.displayPipeline.push({handler:e,priority:t}),this.displayPipeline.sort((i,n)=>i.priority-n.priority)):console.error("Display pipeline handlers must have a priority in order to be registered")}refreshActiveData(e,t,i){var n=this.table,s="",a=0,o=["all","dataPipeline","display","displayPipeline","end"];if(!this.table.destroyed){if(typeof e=="function")if(a=this.dataPipeline.findIndex(l=>l.handler===e),a>-1)s="dataPipeline",t&&(a==this.dataPipeline.length-1?s="display":a++);else if(a=this.displayPipeline.findIndex(l=>l.handler===e),a>-1)s="displayPipeline",t&&(a==this.displayPipeline.length-1?s="end":a++);else{console.error("Unable to refresh data, invalid handler provided",e);return}else s=e||"all",a=0;if(this.redrawBlock){(!this.redrawBlockRestoreConfig||this.redrawBlockRestoreConfig&&(this.redrawBlockRestoreConfig.stage===s&&a<this.redrawBlockRestoreConfig.index||o.indexOf(s)<o.indexOf(this.redrawBlockRestoreConfig.stage)))&&(this.redrawBlockRestoreConfig={handler:e,skipStage:t,renderInPosition:i,stage:s,index:a});return}else hr.elVisible(this.element)?i?this.reRenderInPosition(this.refreshPipelines.bind(this,e,s,a,i)):(this.refreshPipelines(e,s,a,i),e||this.table.columnManager.renderer.renderColumns(),this.renderTable(),n.options.layoutColumnsOnNewData&&this.table.columnManager.redraw(!0)):this.refreshPipelines(e,s,a,i),this.dispatch("data-refreshed")}}refreshPipelines(e,t,i,n){switch(this.dispatch("data-refreshing"),(!e||!this.activeRowsPipeline[0])&&(this.activeRowsPipeline[0]=this.rows.slice(0)),t){case"all":case"dataPipeline":for(let s=i;s<this.dataPipeline.length;s++){let a=this.dataPipeline[s].handler(this.activeRowsPipeline[s].slice(0));this.activeRowsPipeline[s+1]=a||this.activeRowsPipeline[s].slice(0)}this.setActiveRows(this.activeRowsPipeline[this.dataPipeline.length]);case"display":i=0,this.resetDisplayRows();case"displayPipeline":for(let s=i;s<this.displayPipeline.length;s++){let a=this.displayPipeline[s].handler((s?this.getDisplayRows(s-1):this.activeRows).slice(0),n);this.setDisplayRows(a||this.getDisplayRows(s-1).slice(0),s)}case"end":this.regenerateRowPositions()}this.getDisplayRows().length&&this._clearPlaceholder()}regenerateRowPositions(){var e=this.getDisplayRows(),t=1;e.forEach(i=>{i.type==="row"&&(i.setPosition(t),t++)})}setActiveRows(e){this.activeRows=this.activeRows=Object.assign([],e),this.activeRowsCount=this.activeRows.length}resetDisplayRows(){this.displayRows=[],this.displayRows.push(this.activeRows.slice(0)),this.displayRowsCount=this.displayRows[0].length}setDisplayRows(e,t){this.displayRows[t]=e,t==this.displayRows.length-1&&(this.displayRowsCount=this.displayRows[this.displayRows.length-1].length)}getDisplayRows(e){return typeof e>"u"?this.displayRows.length?this.displayRows[this.displayRows.length-1]:[]:this.displayRows[e]||[]}getVisibleRows(e,t){var i=Object.assign([],this.renderer.visibleRows(!t));return e&&(i=this.chain("rows-visible",[t],i,i)),i}displayRowIterator(e){this.activeRowsPipeline.forEach(e),this.displayRows.forEach(e),this.displayRowsCount=this.displayRows[this.displayRows.length-1].length}getRows(e){var t=[];switch(e){case"active":t=this.activeRows;break;case"display":t=this.table.rowManager.getDisplayRows();break;case"visible":t=this.getVisibleRows(!1,!0);break;default:t=this.chain("rows-retrieve",e,null,this.rows)||this.rows}return t}reRenderInPosition(e){this.redrawBlock?e?e():this.redrawBlockRenderInPosition=!0:(this.dispatchExternal("renderStarted"),this.renderer.rerenderRows(e),this.fixedHeight||this.adjustTableSize(),this.scrollBarCheck(),this.dispatchExternal("renderComplete"))}scrollBarCheck(){var e=0;this.element.scrollHeight>this.element.clientHeight&&(e=this.element.offsetWidth-this.element.clientWidth),e!==this.scrollbarWidth&&(this.scrollbarWidth=e,this.dispatch("scrollbar-vertical",e))}initializeRenderer(){var e,t={virtual:_5,basic:C5};typeof this.table.options.renderVertical=="string"?e=t[this.table.options.renderVertical]:e=this.table.options.renderVertical,e?(this.renderMode=this.table.options.renderVertical,this.renderer=new e(this.table,this.element,this.tableElement),this.renderer.initialize(),(this.table.element.clientHeight||this.table.options.height)&&!(this.table.options.minHeight&&this.table.options.maxHeight)?this.fixedHeight=!0:this.fixedHeight=!1):console.error("Unable to find matching renderer:",this.table.options.renderVertical)}getRenderMode(){return this.renderMode}renderTable(){this.dispatchExternal("renderStarted"),this.element.scrollTop=0,this._clearTable(),this.displayRowsCount?(this.renderer.renderRows(),this.firstRender&&(this.firstRender=!1,this.fixedHeight||this.adjustTableSize(),this.layoutRefresh(!0))):this.renderEmptyScroll(),this.fixedHeight||this.adjustTableSize(),this.dispatch("table-layout"),this.displayRowsCount||this._showPlaceholder(),this.scrollBarCheck(),this.dispatchExternal("renderComplete")}renderEmptyScroll(){this.placeholder?this.tableElement.style.display="none":this.tableElement.style.minWidth=this.table.columnManager.getWidth()+"px"}_clearTable(){this._clearPlaceholder(),this.scrollTop=0,this.scrollLeft=0,this.renderer.clearRows()}tableEmpty(){this.renderEmptyScroll(),this._showPlaceholder()}checkPlaceholder(){this.displayRowsCount?this._clearPlaceholder():this.tableEmpty()}_showPlaceholder(){this.placeholder&&(this.placeholder&&this.placeholder.parentNode&&this.placeholder.parentNode.removeChild(this.placeholder),this.initializePlaceholder(),this.placeholder.setAttribute("tabulator-render-mode",this.renderMode),this.getElement().appendChild(this.placeholder),this._positionPlaceholder(),this.adjustTableSize())}_clearPlaceholder(){this.placeholder&&this.placeholder.parentNode&&this.placeholder.parentNode.removeChild(this.placeholder),this.tableElement.style.minWidth="",this.tableElement.style.display=""}_positionPlaceholder(){this.placeholder&&this.placeholder.parentNode&&(this.placeholder.style.width=this.table.columnManager.getWidth()+"px",this.placeholderContents.style.width=this.table.rowManager.element.clientWidth+"px",this.placeholderContents.style.marginLeft=this.scrollLeft+"px")}styleRow(e,t){var i=e.getElement();t%2?(i.classList.add("tabulator-row-even"),i.classList.remove("tabulator-row-odd")):(i.classList.add("tabulator-row-odd"),i.classList.remove("tabulator-row-even"))}normalizeHeight(e){this.activeRows.forEach(function(t){t.normalizeHeight(e)})}adjustTableSize(){let e=this.element.clientHeight,t,i=!1;if(this.renderer.verticalFillMode==="fill"){let n=Math.floor(this.table.columnManager.getElement().getBoundingClientRect().height+(this.table.footerManager&&this.table.footerManager.active&&!this.table.footerManager.external?this.table.footerManager.getElement().getBoundingClientRect().height:0));if(this.fixedHeight){t=isNaN(this.table.options.minHeight)?this.table.options.minHeight:this.table.options.minHeight+"px";const s="calc(100% - "+n+"px)";this.element.style.minHeight=t||"calc(100% - "+n+"px)",this.element.style.height=s,this.element.style.maxHeight=s}else this.element.style.height="",this.element.style.height=this.table.element.clientHeight-n+"px",this.element.scrollTop=this.scrollTop;this.renderer.resize(),!this.fixedHeight&&e!=this.element.clientHeight&&(i=!0,this.subscribed("table-resize")?this.dispatch("table-resize"):this.redraw()),this.scrollBarCheck()}return this._positionPlaceholder(),i}reinitialize(){this.rows.forEach(function(e){e.reinitialize(!0)})}blockRedraw(){this.redrawBlock=!0,this.redrawBlockRestoreConfig=!1}restoreRedraw(){this.redrawBlock=!1,this.redrawBlockRestoreConfig?(this.refreshActiveData(this.redrawBlockRestoreConfig.handler,this.redrawBlockRestoreConfig.skipStage,this.redrawBlockRestoreConfig.renderInPosition),this.redrawBlockRestoreConfig=!1):this.redrawBlockRenderInPosition&&this.reRenderInPosition(),this.redrawBlockRenderInPosition=!1}redraw(e){this.adjustTableSize(),this.table.tableWidth=this.table.element.clientWidth,e?this.renderTable():(this.reRenderInPosition(),this.scrollHorizontal(this.scrollLeft))}resetScroll(){if(this.element.scrollLeft=0,this.element.scrollTop=0,this.table.browser==="ie"){var e=document.createEvent("Event");e.initEvent("scroll",!1,!0),this.element.dispatchEvent(e)}else this.element.dispatchEvent(new Event("scroll"))}}class S5 extends hi{constructor(e){super(e),this.active=!1,this.element=this.createElement(),this.containerElement=this.createContainerElement(),this.external=!1}initialize(){this.initializeElement()}createElement(){var e=document.createElement("div");return e.classList.add("tabulator-footer"),e}createContainerElement(){var e=document.createElement("div");return e.classList.add("tabulator-footer-contents"),this.element.appendChild(e),e}initializeElement(){if(this.table.options.footerElement)switch(typeof this.table.options.footerElement){case"string":this.table.options.footerElement[0]==="<"?this.containerElement.innerHTML=this.table.options.footerElement:(this.external=!0,this.containerElement=document.querySelector(this.table.options.footerElement));break;default:this.element=this.table.options.footerElement;break}}getElement(){return this.element}append(e){this.activate(),this.containerElement.appendChild(e),this.table.rowManager.adjustTableSize()}prepend(e){this.activate(),this.element.insertBefore(e,this.element.firstChild),this.table.rowManager.adjustTableSize()}remove(e){e.parentNode.removeChild(e),this.deactivate()}deactivate(e){(!this.element.firstChild||e)&&(this.external||this.element.parentNode.removeChild(this.element),this.active=!1)}activate(){this.active||(this.active=!0,this.external||(this.table.element.appendChild(this.getElement()),this.table.element.style.display=""))}redraw(){this.dispatch("footer-redraw")}}class T5 extends hi{constructor(e){super(e),this.el=null,this.abortClasses=["tabulator-headers","tabulator-table"],this.previousTargets={},this.listeners=["click","dblclick","contextmenu","mouseenter","mouseleave","mouseover","mouseout","mousemove","mouseup","mousedown","touchstart","touchend"],this.componentMap={"tabulator-cell":"cell","tabulator-row":"row","tabulator-group":"group","tabulator-col":"column"},this.pseudoTrackers={row:{subscriber:null,target:null},cell:{subscriber:null,target:null},group:{subscriber:null,target:null},column:{subscriber:null,target:null}},this.pseudoTracking=!1}initialize(){this.el=this.table.element,this.buildListenerMap(),this.bindSubscriptionWatchers()}buildListenerMap(){var e={};this.listeners.forEach(t=>{e[t]={handler:null,components:[]}}),this.listeners=e}bindPseudoEvents(){Object.keys(this.pseudoTrackers).forEach(e=>{this.pseudoTrackers[e].subscriber=this.pseudoMouseEnter.bind(this,e),this.subscribe(e+"-mouseover",this.pseudoTrackers[e].subscriber)}),this.pseudoTracking=!0}pseudoMouseEnter(e,t,i){this.pseudoTrackers[e].target!==i&&(this.pseudoTrackers[e].target&&this.dispatch(e+"-mouseleave",t,this.pseudoTrackers[e].target),this.pseudoMouseLeave(e,t),this.pseudoTrackers[e].target=i,this.dispatch(e+"-mouseenter",t,i))}pseudoMouseLeave(e,t){var i=Object.keys(this.pseudoTrackers),n={row:["cell"],cell:["row"]};i=i.filter(s=>{var a=n[e];return s!==e&&(!a||a&&!a.includes(s))}),i.forEach(s=>{var a=this.pseudoTrackers[s].target;this.pseudoTrackers[s].target&&(this.dispatch(s+"-mouseleave",t,a),this.pseudoTrackers[s].target=null)})}bindSubscriptionWatchers(){var e=Object.keys(this.listeners),t=Object.values(this.componentMap);for(let i of t)for(let n of e){let s=i+"-"+n;this.subscriptionChange(s,this.subscriptionChanged.bind(this,i,n))}this.subscribe("table-destroy",this.clearWatchers.bind(this))}subscriptionChanged(e,t,i){var n=this.listeners[t].components,s=n.indexOf(e),a=!1;i?s===-1&&(n.push(e),a=!0):this.subscribed(e+"-"+t)||s>-1&&(n.splice(s,1),a=!0),(t==="mouseenter"||t==="mouseleave")&&!this.pseudoTracking&&this.bindPseudoEvents(),a&&this.updateEventListeners()}updateEventListeners(){for(let e in this.listeners){let t=this.listeners[e];t.components.length?t.handler||(t.handler=this.track.bind(this,e),this.el.addEventListener(e,t.handler)):t.handler&&(this.el.removeEventListener(e,t.handler),t.handler=null)}}track(e,t){var i=t.composedPath&&t.composedPath()||t.path,n=this.findTargets(i);n=this.bindComponents(e,n),this.triggerEvents(e,t,n),this.pseudoTracking&&(e=="mouseover"||e=="mouseleave")&&!Object.keys(n).length&&this.pseudoMouseLeave("none",t)}findTargets(e){var t={};let i=Object.keys(this.componentMap);for(let n of e){let s=n.classList?[...n.classList]:[];if(s.filter(l=>this.abortClasses.includes(l)).length)break;let o=s.filter(l=>i.includes(l));for(let l of o)t[this.componentMap[l]]||(t[this.componentMap[l]]=n)}return t.group&&t.group===t.row&&delete t.row,t}bindComponents(e,t){var i=Object.keys(t).reverse(),n=this.listeners[e],s={},a={},o={};for(let l of i){let h,c=t[l],d=this.previousTargets[l];if(d&&d.target===c)h=d.component;else switch(l){case"row":case"group":(n.components.includes("row")||n.components.includes("cell")||n.components.includes("group"))&&(h=this.table.rowManager.getVisibleRows(!0).find(f=>f.getElement()===c),t.row&&t.row.parentNode&&t.row.parentNode.closest(".tabulator-row")&&(t[l]=!1));break;case"column":n.components.includes("column")&&(h=this.table.columnManager.findColumn(c));break;case"cell":n.components.includes("cell")&&(s.row instanceof wi?h=s.row.findCell(c):t.row&&console.warn("Event Target Lookup Error - The row this cell is attached to cannot be found, has the table been reinitialized without being destroyed first?"));break}h&&(s[l]=h,o[l]={target:c,component:h})}return this.previousTargets=o,Object.keys(t).forEach(l=>{let h=s[l];a[l]=h}),a}triggerEvents(e,t,i){var n=this.listeners[e];for(let s in i)i[s]&&n.components.includes(s)&&this.dispatch(s+"-"+e,t,i[s])}clearWatchers(){for(let e in this.listeners){let t=this.listeners[e];t.handler&&(this.el.removeEventListener(e,t.handler),t.handler=null)}}}class A5{constructor(e){this.table=e,this.bindings={}}bind(e,t,i){this.bindings[e]||(this.bindings[e]={}),this.bindings[e][t]?console.warn("Unable to bind component handler, a matching function name is already bound",e,t,i):this.bindings[e][t]=i}handle(e,t,i){if(this.bindings[e]&&this.bindings[e][i]&&typeof this.bindings[e][i].bind=="function")return this.bindings[e][i].bind(null,t);i!=="then"&&typeof i=="string"&&!i.startsWith("_")&&this.table.options.debugInvalidComponentFuncs&&console.error("The "+e+" component does not have a "+i+" function, have you checked that you have the correct Tabulator module installed?")}}class F5 extends hi{constructor(e){super(e),this.requestOrder=0,this.loading=!1}initialize(){}load(e,t,i,n,s,a){var o=++this.requestOrder;if(this.table.destroyed)return Promise.resolve();if(this.dispatchExternal("dataLoading",e),e&&(e.indexOf("{")==0||e.indexOf("[")==0)&&(e=JSON.parse(e)),this.confirm("data-loading",[e,t,i,s])){this.loading=!0,s||this.alertLoader(),t=this.chain("data-params",[e,i,s],t||{},t||{}),t=this.mapParams(t,this.table.options.dataSendParams);var l=this.chain("data-load",[e,t,i,s],!1,Promise.resolve([]));return l.then(h=>{if(this.table.destroyed)console.warn("Data Load Response Blocked - Table has been destroyed");else{!Array.isArray(h)&&typeof h=="object"&&(h=this.mapParams(h,this.objectInvert(this.table.options.dataReceiveParams)));var c=this.chain("data-loaded",[h],null,h);o==this.requestOrder?(this.clearAlert(),c!==!1&&(this.dispatchExternal("dataLoaded",c),this.table.rowManager.setData(c,n,typeof a>"u"?!n:a))):console.warn("Data Load Response Blocked - An active data load request was blocked by an attempt to change table data while the request was being made")}}).catch(h=>{console.error("Data Load Error: ",h),this.dispatchExternal("dataLoadError",h),s||this.alertError(),setTimeout(()=>{this.clearAlert()},this.table.options.dataLoaderErrorTimeout)}).finally(()=>{this.loading=!1})}else return this.dispatchExternal("dataLoaded",e),e||(e=[]),this.table.rowManager.setData(e,n,typeof a>"u"?!n:a),Promise.resolve()}mapParams(e,t){var i={};for(let n in e)i[t.hasOwnProperty(n)?t[n]:n]=e[n];return i}objectInvert(e){var t={};for(let i in e)t[e[i]]=i;return t}blockActiveLoad(){this.requestOrder++}alertLoader(){var e=typeof this.table.options.dataLoader=="function"?this.table.options.dataLoader():this.table.options.dataLoader;e&&this.table.alertManager.alert(this.table.options.dataLoaderLoading||this.langText("data|loading"))}alertError(){this.table.alertManager.alert(this.table.options.dataLoaderError||this.langText("data|error"),"error")}clearAlert(){this.table.alertManager.clear()}}class R5{constructor(e,t,i){this.table=e,this.events={},this.optionsList=t||{},this.subscriptionNotifiers={},this.dispatch=i?this._debugDispatch.bind(this):this._dispatch.bind(this),this.debug=i}subscriptionChange(e,t){this.subscriptionNotifiers[e]||(this.subscriptionNotifiers[e]=[]),this.subscriptionNotifiers[e].push(t),this.subscribed(e)&&this._notifySubscriptionChange(e,!0)}subscribe(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t),this._notifySubscriptionChange(e,!0)}unsubscribe(e,t){var i;if(this.events[e])if(t)if(i=this.events[e].findIndex(n=>n===t),i>-1)this.events[e].splice(i,1);else{console.warn("Cannot remove event, no matching event found:",e,t);return}else delete this.events[e];else{console.warn("Cannot remove event, no events set on:",e);return}this._notifySubscriptionChange(e,!1)}subscribed(e){return this.events[e]&&this.events[e].length}_notifySubscriptionChange(e,t){var i=this.subscriptionNotifiers[e];i&&i.forEach(n=>{n(t)})}_dispatch(){var e=Array.from(arguments),t=e.shift(),i;return this.events[t]&&this.events[t].forEach((n,s)=>{let a=n.apply(this.table,e);s||(i=a)}),i}_debugDispatch(){var e=Array.from(arguments),t=e[0];return e[0]="ExternalEvent:"+e[0],(this.debug===!0||this.debug.includes(t))&&console.log(...e),this._dispatch(...arguments)}}class L5{constructor(e){this.events={},this.subscriptionNotifiers={},this.dispatch=e?this._debugDispatch.bind(this):this._dispatch.bind(this),this.chain=e?this._debugChain.bind(this):this._chain.bind(this),this.confirm=e?this._debugConfirm.bind(this):this._confirm.bind(this),this.debug=e}subscriptionChange(e,t){this.subscriptionNotifiers[e]||(this.subscriptionNotifiers[e]=[]),this.subscriptionNotifiers[e].push(t),this.subscribed(e)&&this._notifySubscriptionChange(e,!0)}subscribe(e,t,i=1e4){this.events[e]||(this.events[e]=[]),this.events[e].push({callback:t,priority:i}),this.events[e].sort((n,s)=>n.priority-s.priority),this._notifySubscriptionChange(e,!0)}unsubscribe(e,t){var i;if(this.events[e]){if(t)if(i=this.events[e].findIndex(n=>n.callback===t),i>-1)this.events[e].splice(i,1);else{console.warn("Cannot remove event, no matching event found:",e,t);return}}else{console.warn("Cannot remove event, no events set on:",e);return}this._notifySubscriptionChange(e,!1)}subscribed(e){return this.events[e]&&this.events[e].length}_chain(e,t,i,n){var s=i;return Array.isArray(t)||(t=[t]),this.subscribed(e)?(this.events[e].forEach((a,o)=>{s=a.callback.apply(this,t.concat([s]))}),s):typeof n=="function"?n():n}_confirm(e,t){var i=!1;return Array.isArray(t)||(t=[t]),this.subscribed(e)&&this.events[e].forEach((n,s)=>{n.callback.apply(this,t)&&(i=!0)}),i}_notifySubscriptionChange(e,t){var i=this.subscriptionNotifiers[e];i&&i.forEach(n=>{n(t)})}_dispatch(){var e=Array.from(arguments),t=e.shift();this.events[t]&&this.events[t].forEach(i=>{i.callback.apply(this,e)})}_debugDispatch(){var e=Array.from(arguments),t=e[0];return e[0]="InternalEvent:"+t,(this.debug===!0||this.debug.includes(t))&&console.log(...e),this._dispatch(...arguments)}_debugChain(){var e=Array.from(arguments),t=e[0];return e[0]="InternalEvent:"+t,(this.debug===!0||this.debug.includes(t))&&console.log(...e),this._chain(...arguments)}_debugConfirm(){var e=Array.from(arguments),t=e[0];return e[0]="InternalEvent:"+t,(this.debug===!0||this.debug.includes(t))&&console.log(...e),this._confirm(...arguments)}}class N5 extends hi{constructor(e){super(e)}_warnUser(){this.options("debugDeprecation")&&console.warn(...arguments)}check(e,t,i){var n="";return typeof this.options(e)<"u"?(n="Deprecated Setup Option - Use of the %c"+e+"%c option is now deprecated",t?(n=n+", Please use the %c"+t+"%c option instead",this._warnUser(n,"font-weight: bold;","font-weight: normal;","font-weight: bold;","font-weight: normal;"),i&&(this.table.options[t]=this.table.options[e])):this._warnUser(n,"font-weight: bold;","font-weight: normal;"),!1):!0}checkMsg(e,t){return typeof this.options(e)<"u"?(this._warnUser("%cDeprecated Setup Option - Use of the %c"+e+" %c option is now deprecated, "+t,"font-weight: normal;","font-weight: bold;","font-weight: normal;"),!1):!0}msg(e){this._warnUser(e)}}class P5 extends hi{constructor(e){super(e),this.deps={},this.props={}}initialize(){this.deps=Object.assign({},this.options("dependencies"))}lookup(e,t,i){if(Array.isArray(e)){for(const s of e){var n=this.lookup(s,t,!0);if(n)break}if(n)return n;this.error(e)}else return t?this.lookupProp(e,t,i):this.lookupKey(e,i)}lookupProp(e,t,i){var n;if(this.props[e]&&this.props[e][t])return this.props[e][t];if(n=this.lookupKey(e,i),n)return this.props[e]||(this.props[e]={}),this.props[e][t]=n[t]||n,this.props[e][t]}lookupKey(e,t){var i;return this.deps[e]?i=this.deps[e]:window[e]?(this.deps[e]=window[e],i=this.deps[e]):t||this.error(e),i}error(e){console.error("Unable to find dependency",e,"Please check documentation and ensure you have imported the required library into your project")}}function D5(r,e){e&&this.table.columnManager.renderer.reinitializeColumnWidths(r),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()}function ap(r,e){r.forEach(function(t){t.reinitializeWidth()}),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()}function M5(r,e){var t=0,i=this.table.rowManager.element.clientWidth,n=0,s=!1;r.forEach((a,o)=>{a.widthFixed||a.reinitializeWidth(),(this.table.options.responsiveLayout?a.modules.responsive.visible:a.visible)&&(s=a),a.visible&&(t+=a.getWidth())}),s?(n=i-t+s.getWidth(),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&(s.setWidth(0),this.table.modules.responsiveLayout.update()),n>0?s.setWidth(n):s.reinitializeWidth()):this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()}function O5(r,e){var t=this.table.rowManager.element.getBoundingClientRect().width,i=0,n=0,s=0,a=0,o=[],l=[],h=0,c=0,d=0;function p(g){var m;return typeof g=="string"?g.indexOf("%")>-1?m=t/100*parseInt(g):m=parseInt(g):m=g,m}function f(g,m,b,w){var E=[],C=0,F=0,L=0,D=s,S=0,A=0,O=[];function U(k){return b*(k.column.definition.widthGrow||1)}function R(k){return p(k.width)-b*(k.column.definition.widthShrink||0)}return g.forEach(function(k,M){var V=w?R(k):U(k);k.column.minWidth>=V?E.push(k):k.column.maxWidth&&k.column.maxWidth<V?(k.width=k.column.maxWidth,m-=k.column.maxWidth,D-=w?k.column.definition.widthShrink||1:k.column.definition.widthGrow||1,D&&(b=Math.floor(m/D))):(O.push(k),A+=w?k.column.definition.widthShrink||1:k.column.definition.widthGrow||1)}),E.length?(E.forEach(function(k){C+=w?k.width-k.column.minWidth:k.column.minWidth,k.width=k.column.minWidth}),F=m-C,L=A?Math.floor(F/A):F,S=f(O,F,L,w)):(S=A?m-Math.floor(m/A)*A:m,O.forEach(function(k){k.width=w?R(k):U(k)})),S}this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update(),this.table.rowManager.element.scrollHeight>this.table.rowManager.element.clientHeight&&(t-=this.table.rowManager.element.offsetWidth-this.table.rowManager.element.clientWidth),r.forEach(function(g){var m,b,w;g.visible&&(m=g.definition.width,b=parseInt(g.minWidth),m?(w=p(m),i+=w>b?w:b,g.definition.widthShrink&&(l.push({column:g,width:w>b?w:b}),h+=g.definition.widthShrink)):(o.push({column:g,width:0}),s+=g.definition.widthGrow||1))}),n=t-i,a=Math.floor(n/s),d=f(o,n,a,!1),o.length&&d>0&&(o[o.length-1].width+=d),o.forEach(function(g){n-=g.width}),c=Math.abs(d)+n,c>0&&h&&(d=f(l,c,Math.floor(c/h),!0)),d&&l.length&&(l[l.length-1].width-=d),o.forEach(function(g){g.column.setWidth(g.width)}),l.forEach(function(g){g.column.setWidth(g.width)})}var I5={fitData:D5,fitDataFill:ap,fitDataTable:ap,fitDataStretch:M5,fitColumns:O5};class Rc extends Dt{static moduleName="layout";static modes=I5;constructor(e){super(e,"layout"),this.mode=null,this.registerTableOption("layout","fitData"),this.registerTableOption("layoutColumnsOnNewData",!1),this.registerColumnOption("widthGrow"),this.registerColumnOption("widthShrink")}initialize(){var e=this.table.options.layout;Rc.modes[e]?this.mode=e:(console.warn("Layout Error - invalid mode set, defaulting to 'fitData' : "+e),this.mode="fitData"),this.table.element.setAttribute("tabulator-layout",this.mode),this.subscribe("column-init",this.initializeColumn.bind(this))}initializeColumn(e){e.definition.widthGrow&&(e.definition.widthGrow=Number(e.definition.widthGrow)),e.definition.widthShrink&&(e.definition.widthShrink=Number(e.definition.widthShrink))}getMode(){return this.mode}layout(e){var t=this.table.columnManager.columnsByIndex.find(i=>i.definition.variableHeight||i.definition.formatter==="textarea");this.dispatch("layout-refreshing"),Rc.modes[this.mode].call(this,this.table.columnManager.columnsByIndex,e),t&&this.table.rowManager.normalizeHeight(!0),this.dispatch("layout-refreshed")}}var B5={default:{groups:{item:"item",items:"items"},columns:{},data:{loading:"Loading",error:"Error"},pagination:{page_size:"Page Size",page_title:"Show Page",first:"First",first_title:"First Page",last:"Last",last_title:"Last Page",prev:"Prev",prev_title:"Prev Page",next:"Next",next_title:"Next Page",all:"All",counter:{showing:"Showing",of:"of",rows:"rows",pages:"pages"}},headerFilters:{default:"filter column...",columns:{}}}};class pd extends Dt{static moduleName="localize";static langs=B5;constructor(e){super(e),this.locale="default",this.lang=!1,this.bindings={},this.langList={},this.registerTableOption("locale",!1),this.registerTableOption("langs",{})}initialize(){this.langList=hr.deepClone(pd.langs),this.table.options.columnDefaults.headerFilterPlaceholder!==!1&&this.setHeaderFilterPlaceholder(this.table.options.columnDefaults.headerFilterPlaceholder);for(let e in this.table.options.langs)this.installLang(e,this.table.options.langs[e]);this.setLocale(this.table.options.locale),this.registerTableFunction("setLocale",this.setLocale.bind(this)),this.registerTableFunction("getLocale",this.getLocale.bind(this)),this.registerTableFunction("getLang",this.getLang.bind(this))}setHeaderFilterPlaceholder(e){this.langList.default.headerFilters.default=e}installLang(e,t){this.langList[e]?this._setLangProp(this.langList[e],t):this.langList[e]=t}_setLangProp(e,t){for(let i in t)e[i]&&typeof e[i]=="object"?this._setLangProp(e[i],t[i]):e[i]=t[i]}setLocale(e){e=e||"default";function t(i,n){for(var s in i)typeof i[s]=="object"?(n[s]||(n[s]={}),t(i[s],n[s])):n[s]=i[s]}if(e===!0&&navigator.language&&(e=navigator.language.toLowerCase()),e&&!this.langList[e]){let i=e.split("-")[0];this.langList[i]?(console.warn("Localization Error - Exact matching locale not found, using closest match: ",e,i),e=i):(console.warn("Localization Error - Matching locale not found, using default: ",e),e="default")}this.locale=e,this.lang=hr.deepClone(this.langList.default||{}),e!="default"&&t(this.langList[e],this.lang),this.dispatchExternal("localized",this.locale,this.lang),this._executeBindings()}getLocale(e){return this.locale}getLang(e){return e?this.langList[e]:this.lang}getText(e,t){var i=t?e+"|"+t:e,n=i.split("|"),s=this._getLangElement(n,this.locale);return s||""}_getLangElement(e,t){var i=this.lang;return e.forEach(function(n){var s;i&&(s=i[n],typeof s<"u"?i=s:i=!1)}),i}bind(e,t){this.bindings[e]||(this.bindings[e]=[]),this.bindings[e].push(t),t(this.getText(e),this.lang)}_executeBindings(){for(let e in this.bindings)this.bindings[e].forEach(t=>{t(this.getText(e),this.lang)})}}class H5 extends Dt{static moduleName="comms";constructor(e){super(e)}initialize(){this.registerTableFunction("tableComms",this.receive.bind(this))}getConnections(e){var t=[],i;return i=this.table.constructor.registry.lookupTable(e),i.forEach(n=>{this.table!==n&&t.push(n)}),t}send(e,t,i,n){var s=this.getConnections(e);s.forEach(a=>{a.tableComms(this.table.element,t,i,n)}),!s.length&&e&&console.warn("Table Connection Error - No tables matching selector found",e)}receive(e,t,i,n){if(this.table.modExists(t))return this.table.modules[t].commsReceived(e,i,n);console.warn("Inter-table Comms Error - no such module:",t)}}var z5=Object.freeze({__proto__:null,CommsModule:H5,LayoutModule:Rc,LocalizeModule:pd});class vn{static registry={tables:[],register(e){vn.registry.tables.push(e)},deregister(e){var t=vn.registry.tables.indexOf(e);t>-1&&vn.registry.tables.splice(t,1)},lookupTable(e,t){var i=[],n,s;if(typeof e=="string"){if(n=document.querySelectorAll(e),n.length)for(var a=0;a<n.length;a++)s=vn.registry.matchElement(n[a]),s&&i.push(s)}else typeof HTMLElement<"u"&&e instanceof HTMLElement||e instanceof vn?(s=vn.registry.matchElement(e),s&&i.push(s)):Array.isArray(e)?e.forEach(function(o){i=i.concat(vn.registry.lookupTable(o))}):t||console.warn("Table Connection Error - Invalid Selector",e);return i},matchElement(e){return vn.registry.tables.find(function(t){return e instanceof vn?t===e:t.element===e})}};static findTable(e){var t=vn.registry.lookupTable(e,!0);return Array.isArray(t)&&!t.length?!1:t}}class wr extends vn{static moduleBindings={};static moduleExtensions={};static modulesRegistered=!1;static defaultModules=!1;constructor(){super()}static initializeModuleBinder(e){wr.modulesRegistered||(wr.modulesRegistered=!0,wr._registerModules(z5,!0),e&&wr._registerModules(e))}static _extendModule(e,t,i){if(wr.moduleBindings[e]){var n=wr.moduleBindings[e][t];if(n)if(typeof i=="object")for(let s in i)n[s]=i[s];else console.warn("Module Error - Invalid value type, it must be an object");else console.warn("Module Error - property does not exist:",t)}else console.warn("Module Error - module does not exist:",e)}static _registerModules(e,t){var i=Object.values(e);t&&i.forEach(n=>{n.prototype.moduleCore=!0}),wr._registerModule(i)}static _registerModule(e){Array.isArray(e)||(e=[e]),e.forEach(t=>{wr._registerModuleBinding(t),wr._registerModuleExtensions(t)})}static _registerModuleBinding(e){e.moduleName?wr.moduleBindings[e.moduleName]=e:console.error("Unable to bind module, no moduleName defined",e.moduleName)}static _registerModuleExtensions(e){var t=e.moduleExtensions;if(e.moduleExtensions)for(let i in t){let n=t[i];if(wr.moduleBindings[i])for(let s in n)wr._extendModule(i,s,n[s]);else{wr.moduleExtensions[i]||(wr.moduleExtensions[i]={});for(let s in n)wr.moduleExtensions[i][s]||(wr.moduleExtensions[i][s]={}),Object.assign(wr.moduleExtensions[i][s],n[s])}}wr._extendModuleFromQueue(e)}static _extendModuleFromQueue(e){var t=wr.moduleExtensions[e.moduleName];if(t)for(let i in t)wr._extendModule(e.moduleName,i,t[i])}_bindModules(){var e=[],t=[],i=[];this.modules={};for(var n in wr.moduleBindings){let s=wr.moduleBindings[n],a=new s(this);this.modules[n]=a,s.prototype.moduleCore?this.modulesCore.push(a):s.moduleInitOrder?s.moduleInitOrder<0?e.push(a):t.push(a):i.push(a)}e.sort((s,a)=>s.moduleInitOrder>a.moduleInitOrder?1:-1),t.sort((s,a)=>s.moduleInitOrder>a.moduleInitOrder?1:-1),this.modulesRegular=e.concat(i.concat(t))}}class j5 extends hi{constructor(e){super(e),this.element=this._createAlertElement(),this.msgElement=this._createMsgElement(),this.type=null,this.element.appendChild(this.msgElement)}_createAlertElement(){var e=document.createElement("div");return e.classList.add("tabulator-alert"),e}_createMsgElement(){var e=document.createElement("div");return e.classList.add("tabulator-alert-msg"),e.setAttribute("role","alert"),e}_typeClass(){return"tabulator-alert-state-"+this.type}alert(e,t="msg"){if(e){for(this.clear(),this.dispatch("alert-show",t),this.type=t;this.msgElement.firstChild;)this.msgElement.removeChild(this.msgElement.firstChild);this.msgElement.classList.add(this._typeClass()),typeof e=="function"&&(e=e()),e instanceof HTMLElement?this.msgElement.appendChild(e):this.msgElement.innerHTML=e,this.table.element.appendChild(this.element)}}clear(){this.dispatch("alert-hide",this.type),this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.msgElement.classList.remove(this._typeClass())}}class Ys extends wr{static defaultOptions=w5;static extendModule(){Ys.initializeModuleBinder(),Ys._extendModule(...arguments)}static registerModule(){Ys.initializeModuleBinder(),Ys._registerModule(...arguments)}constructor(e,t,i){super(),Ys.initializeModuleBinder(i),this.options={},this.columnManager=null,this.rowManager=null,this.footerManager=null,this.alertManager=null,this.vdomHoz=null,this.externalEvents=null,this.eventBus=null,this.interactionMonitor=!1,this.browser="",this.browserSlow=!1,this.browserMobile=!1,this.rtl=!1,this.originalElement=null,this.componentFunctionBinder=new A5(this),this.dataLoader=!1,this.modules={},this.modulesCore=[],this.modulesRegular=[],this.deprecationAdvisor=new N5(this),this.optionsList=new mg(this,"table constructor"),this.dependencyRegistry=new P5(this),this.initialized=!1,this.destroyed=!1,this.initializeElement(e)&&(this.initializeCoreSystems(t),setTimeout(()=>{this._create()})),this.constructor.registry.register(this)}initializeElement(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement?(this.element=e,!0):typeof e=="string"?(this.element=document.querySelector(e),this.element?!0:(console.error("Tabulator Creation Error - no element found matching selector: ",e),!1)):(console.error("Tabulator Creation Error - Invalid element provided:",e),!1)}initializeCoreSystems(e){this.columnManager=new E5(this),this.rowManager=new k5(this),this.footerManager=new S5(this),this.dataLoader=new F5(this),this.alertManager=new j5(this),this._bindModules(),this.options=this.optionsList.generate(Ys.defaultOptions,e),this._clearObjectPointers(),this._mapDeprecatedFunctionality(),this.externalEvents=new R5(this,this.options,this.options.debugEventsExternal),this.eventBus=new L5(this.options.debugEventsInternal),this.interactionMonitor=new T5(this),this.dataLoader.initialize(),this.footerManager.initialize(),this.dependencyRegistry.initialize()}_mapDeprecatedFunctionality(){}_clearSelection(){this.element.classList.add("tabulator-block-select"),window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty(),this.element.classList.remove("tabulator-block-select")}_create(){this.externalEvents.dispatch("tableBuilding"),this.eventBus.dispatch("table-building"),this._rtlCheck(),this._buildElement(),this._initializeTable(),this.initialized=!0,this._loadInitialData().finally(()=>{this.eventBus.dispatch("table-initialized"),this.externalEvents.dispatch("tableBuilt")})}_rtlCheck(){var e=window.getComputedStyle(this.element);switch(this.options.textDirection){case"auto":if(e.direction!=="rtl")break;case"rtl":this.element.classList.add("tabulator-rtl"),this.rtl=!0;break;case"ltr":this.element.classList.add("tabulator-ltr");default:this.rtl=!1}}_clearObjectPointers(){this.options.columns=this.options.columns.slice(0),Array.isArray(this.options.data)&&!this.options.reactiveData&&(this.options.data=this.options.data.slice(0))}_buildElement(){var e=this.element,t=this.options,i;if(e.tagName==="TABLE"){this.originalElement=this.element,i=document.createElement("div");var n=e.attributes;for(var s in n)typeof n[s]=="object"&&i.setAttribute(n[s].name,n[s].value);e.parentNode.replaceChild(i,e),this.element=e=i}for(e.classList.add("tabulator"),e.setAttribute("role","grid");e.firstChild;)e.removeChild(e.firstChild);t.height&&(t.height=isNaN(t.height)?t.height:t.height+"px",e.style.height=t.height),t.minHeight!==!1&&(t.minHeight=isNaN(t.minHeight)?t.minHeight:t.minHeight+"px",e.style.minHeight=t.minHeight),t.maxHeight!==!1&&(t.maxHeight=isNaN(t.maxHeight)?t.maxHeight:t.maxHeight+"px",e.style.maxHeight=t.maxHeight)}_initializeTable(){var e=this.element,t=this.options;this.interactionMonitor.initialize(),this.columnManager.initialize(),this.rowManager.initialize(),this._detectBrowser(),this.modulesCore.forEach(i=>{i.initialize()}),e.appendChild(this.columnManager.getElement()),e.appendChild(this.rowManager.getElement()),t.footerElement&&this.footerManager.activate(),t.autoColumns&&t.data&&this.columnManager.generateColumnsFromRowData(this.options.data),this.modulesRegular.forEach(i=>{i.initialize()}),this.columnManager.setColumns(t.columns),this.eventBus.dispatch("table-built")}_loadInitialData(){return this.dataLoader.load(this.options.data).finally(()=>{this.columnManager.verticalAlignHeaders()})}destroy(){var e=this.element;for(this.destroyed=!0,this.constructor.registry.deregister(this),this.eventBus.dispatch("table-destroy"),this.rowManager.destroy();e.firstChild;)e.removeChild(e.firstChild);e.classList.remove("tabulator"),this.externalEvents.dispatch("tableDestroyed")}_detectBrowser(){var e=navigator.userAgent||navigator.vendor||window.opera;e.indexOf("Trident")>-1?(this.browser="ie",this.browserSlow=!0):e.indexOf("Edge")>-1?(this.browser="edge",this.browserSlow=!0):e.indexOf("Firefox")>-1?(this.browser="firefox",this.browserSlow=!1):e.indexOf("Mac OS")>-1?(this.browser="safari",this.browserSlow=!1):(this.browser="other",this.browserSlow=!1),this.browserMobile=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(e.slice(0,4))}initGuard(e,t){var i,n;return this.options.debugInitialization&&!this.initialized&&(e||(i=new Error().stack.split(`
`),n=i[0]=="Error"?i[2]:i[1],n[0]==" "?e=n.trim().split(" ")[1].split(".")[1]:e=n.trim().split("@")[0]),console.warn("Table Not Initialized - Calling the "+e+" function before the table is initialized may result in inconsistent behavior, Please wait for the `tableBuilt` event before calling this function."+(t?" "+t:""))),this.initialized}blockRedraw(){this.initGuard(),this.eventBus.dispatch("redraw-blocking"),this.rowManager.blockRedraw(),this.columnManager.blockRedraw(),this.eventBus.dispatch("redraw-blocked")}restoreRedraw(){this.initGuard(),this.eventBus.dispatch("redraw-restoring"),this.rowManager.restoreRedraw(),this.columnManager.restoreRedraw(),this.eventBus.dispatch("redraw-restored")}setData(e,t,i){return this.initGuard(!1,"To set initial data please use the 'data' property in the table constructor."),this.dataLoader.load(e,t,i,!1)}clearData(){this.initGuard(),this.dataLoader.blockActiveLoad(),this.rowManager.clearData()}getData(e){return this.rowManager.getData(e)}getDataCount(e){return this.rowManager.getDataCount(e)}replaceData(e,t,i){return this.initGuard(),this.dataLoader.load(e,t,i,!0,!0)}updateData(e){var t=0;return this.initGuard(),new Promise((i,n)=>{this.dataLoader.blockActiveLoad(),typeof e=="string"&&(e=JSON.parse(e)),e&&e.length>0?e.forEach(s=>{var a=this.rowManager.findRow(s[this.options.index]);a?(t++,a.updateData(s).then(()=>{t--,t||i()}).catch(o=>{n("Update Error - Unable to update row",s,o)})):n("Update Error - Unable to find row",s)}):(console.warn("Update Error - No data provided"),n("Update Error - No data provided"))})}addData(e,t,i){return this.initGuard(),new Promise((n,s)=>{this.dataLoader.blockActiveLoad(),typeof e=="string"&&(e=JSON.parse(e)),e?this.rowManager.addRows(e,t,i).then(a=>{var o=[];a.forEach(function(l){o.push(l.getComponent())}),n(o)}):(console.warn("Update Error - No data provided"),s("Update Error - No data provided"))})}updateOrAddData(e){var t=[],i=0;return this.initGuard(),new Promise((n,s)=>{this.dataLoader.blockActiveLoad(),typeof e=="string"&&(e=JSON.parse(e)),e&&e.length>0?e.forEach(a=>{var o=this.rowManager.findRow(a[this.options.index]);i++,o?o.updateData(a).then(()=>{i--,t.push(o.getComponent()),i||n(t)}):this.rowManager.addRows(a).then(l=>{i--,t.push(l[0].getComponent()),i||n(t)})}):(console.warn("Update Error - No data provided"),s("Update Error - No data provided"))})}getRow(e){var t=this.rowManager.findRow(e);return t?t.getComponent():(console.warn("Find Error - No matching row found:",e),!1)}getRowFromPosition(e){var t=this.rowManager.getRowFromPosition(e);return t?t.getComponent():(console.warn("Find Error - No matching row found:",e),!1)}deleteRow(e){var t=[];this.initGuard(),Array.isArray(e)||(e=[e]);for(let i of e){let n=this.rowManager.findRow(i,!0);if(n)t.push(n);else return console.error("Delete Error - No matching row found:",i),Promise.reject("Delete Error - No matching row found")}return t.sort((i,n)=>this.rowManager.rows.indexOf(i)>this.rowManager.rows.indexOf(n)?1:-1),t.forEach(i=>{i.delete()}),this.rowManager.reRenderInPosition(),Promise.resolve()}addRow(e,t,i){return this.initGuard(),typeof e=="string"&&(e=JSON.parse(e)),this.rowManager.addRows(e,t,i,!0).then(n=>n[0].getComponent())}updateOrAddRow(e,t){var i=this.rowManager.findRow(e);return this.initGuard(),typeof t=="string"&&(t=JSON.parse(t)),i?i.updateData(t).then(()=>i.getComponent()):this.rowManager.addRows(t).then(n=>n[0].getComponent())}updateRow(e,t){var i=this.rowManager.findRow(e);return this.initGuard(),typeof t=="string"&&(t=JSON.parse(t)),i?i.updateData(t).then(()=>Promise.resolve(i.getComponent())):(console.warn("Update Error - No matching row found:",e),Promise.reject("Update Error - No matching row found"))}scrollToRow(e,t,i){var n=this.rowManager.findRow(e);return n?this.rowManager.scrollToRow(n,t,i):(console.warn("Scroll Error - No matching row found:",e),Promise.reject("Scroll Error - No matching row found"))}moveRow(e,t,i){var n=this.rowManager.findRow(e);this.initGuard(),n?n.moveToRow(t,i):console.warn("Move Error - No matching row found:",e)}getRows(e){return this.rowManager.getComponents(e)}getRowPosition(e){var t=this.rowManager.findRow(e);return t?t.getPosition():(console.warn("Position Error - No matching row found:",e),!1)}setColumns(e){this.initGuard(!1,"To set initial columns please use the 'columns' property in the table constructor"),this.columnManager.setColumns(e)}getColumns(e){return this.columnManager.getComponents(e)}getColumn(e){var t=this.columnManager.findColumn(e);return t?t.getComponent():(console.warn("Find Error - No matching column found:",e),!1)}getColumnDefinitions(){return this.columnManager.getDefinitionTree()}showColumn(e){var t=this.columnManager.findColumn(e);if(this.initGuard(),t)t.show();else return console.warn("Column Show Error - No matching column found:",e),!1}hideColumn(e){var t=this.columnManager.findColumn(e);if(this.initGuard(),t)t.hide();else return console.warn("Column Hide Error - No matching column found:",e),!1}toggleColumn(e){var t=this.columnManager.findColumn(e);if(this.initGuard(),t)t.visible?t.hide():t.show();else return console.warn("Column Visibility Toggle Error - No matching column found:",e),!1}addColumn(e,t,i){var n=this.columnManager.findColumn(i);return this.initGuard(),this.columnManager.addColumn(e,t,n).then(s=>s.getComponent())}deleteColumn(e){var t=this.columnManager.findColumn(e);return this.initGuard(),t?t.delete():(console.warn("Column Delete Error - No matching column found:",e),Promise.reject())}updateColumnDefinition(e,t){var i=this.columnManager.findColumn(e);return this.initGuard(),i?i.updateDefinition(t):(console.warn("Column Update Error - No matching column found:",e),Promise.reject())}moveColumn(e,t,i){var n=this.columnManager.findColumn(e),s=this.columnManager.findColumn(t);this.initGuard(),n?s?this.columnManager.moveColumn(n,s,i):console.warn("Move Error - No matching column found:",s):console.warn("Move Error - No matching column found:",e)}scrollToColumn(e,t,i){return new Promise((n,s)=>{var a=this.columnManager.findColumn(e);return a?this.columnManager.scrollToColumn(a,t,i):(console.warn("Scroll Error - No matching column found:",e),Promise.reject("Scroll Error - No matching column found"))})}redraw(e){this.initGuard(),this.columnManager.redraw(e),this.rowManager.redraw(e)}setHeight(e){this.options.height=isNaN(e)?e:e+"px",this.element.style.height=this.options.height,this.rowManager.initializeRenderer(),this.rowManager.redraw(!0)}on(e,t){this.externalEvents.subscribe(e,t)}off(e,t){this.externalEvents.unsubscribe(e,t)}dispatchEvent(){var e=Array.from(arguments);e.shift(),this.externalEvents.dispatch(...arguments)}alert(e,t){this.initGuard(),this.alertManager.alert(e,t)}clearAlert(){this.initGuard(),this.alertManager.clear()}modExists(e,t){return this.modules[e]?!0:(t&&console.error("Tabulator Module Not Installed: "+e),!1)}module(e){var t=this.modules[e];return t||console.error("Tabulator module not installed: "+e),t}}var xl=Ys;class W5 extends xl{static extendModule(){xl.initializeModuleBinder(nf),xl._extendModule(...arguments)}static registerModule(){xl.initializeModuleBinder(nf),xl._registerModule(...arguments)}constructor(e,t,i){super(e,t,nf)}}var U5=W5;const V5="modulepreload",G5=function(r){return"/build/"+r},op={},Mf=function(e,t,i){let n=Promise.resolve();if(t&&t.length>0){let l=function(h){return Promise.all(h.map(c=>Promise.resolve(c).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");n=l(t.map(h=>{if(h=G5(h),h in op)return;op[h]=!0;const c=h.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${d}`))return;const p=document.createElement("link");if(p.rel=c?"stylesheet":V5,c||(p.as="script"),p.crossOrigin="",p.href=h,o&&p.setAttribute("nonce",o),document.head.appendChild(p),c)return new Promise((f,g)=>{p.addEventListener("load",f),p.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return n.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return e().catch(s)})};function tr(r){"@babel/helpers - typeof";return tr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tr(r)}var zi=Uint8Array,Li=Uint16Array,Ul=Uint32Array,eu=new zi([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),tu=new zi([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Of=new zi([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),gg=function(r,e){for(var t=new Li(31),i=0;i<31;++i)t[i]=e+=1<<r[i-1];for(var n=new Ul(t[30]),i=1;i<30;++i)for(var s=t[i];s<t[i+1];++s)n[s]=s-t[i]<<5|i;return[t,n]},vg=gg(eu,2),bg=vg[0],If=vg[1];bg[28]=258,If[258]=28;var wg=gg(tu,0),q5=wg[0],lp=wg[1],Bf=new Li(32768);for(var gr=0;gr<32768;++gr){var qs=(gr&43690)>>>1|(gr&21845)<<1;qs=(qs&52428)>>>2|(qs&13107)<<2,qs=(qs&61680)>>>4|(qs&3855)<<4,Bf[gr]=((qs&65280)>>>8|(qs&255)<<8)>>>1}var ss=(function(r,e,t){for(var i=r.length,n=0,s=new Li(e);n<i;++n)++s[r[n]-1];var a=new Li(e);for(n=0;n<e;++n)a[n]=a[n-1]+s[n-1]<<1;var o;if(t){o=new Li(1<<e);var l=15-e;for(n=0;n<i;++n)if(r[n])for(var h=n<<4|r[n],c=e-r[n],d=a[r[n]-1]++<<c,p=d|(1<<c)-1;d<=p;++d)o[Bf[d]>>>l]=h}else for(o=new Li(i),n=0;n<i;++n)o[n]=Bf[a[r[n]-1]++]>>>15-r[n];return o}),ia=new zi(288);for(var gr=0;gr<144;++gr)ia[gr]=8;for(var gr=144;gr<256;++gr)ia[gr]=9;for(var gr=256;gr<280;++gr)ia[gr]=7;for(var gr=280;gr<288;++gr)ia[gr]=8;var Vl=new zi(32);for(var gr=0;gr<32;++gr)Vl[gr]=5;var X5=ss(ia,9,0),K5=ss(ia,9,1),Y5=ss(Vl,5,0),$5=ss(Vl,5,1),sf=function(r){for(var e=r[0],t=1;t<r.length;++t)r[t]>e&&(e=r[t]);return e},Mn=function(r,e,t){var i=e/8>>0;return(r[i]|r[i+1]<<8)>>>(e&7)&t},af=function(r,e){var t=e/8>>0;return(r[t]|r[t+1]<<8|r[t+2]<<16)>>>(e&7)},md=function(r){return(r/8>>0)+(r&7&&1)},xg=function(r,e,t){(t==null||t>r.length)&&(t=r.length);var i=new(r instanceof Li?Li:r instanceof Ul?Ul:zi)(t-e);return i.set(r.subarray(e,t)),i},J5=function(r,e,t){var i=r.length,n=!e||t,s=!t||t.i;t||(t={}),e||(e=new zi(i*3));var a=function(X){var he=e.length;if(X>he){var ce=new zi(Math.max(he*2,X));ce.set(e),e=ce}},o=t.f||0,l=t.p||0,h=t.b||0,c=t.l,d=t.d,p=t.m,f=t.n,g=i*8;do{if(!c){t.f=o=Mn(r,l,1);var m=Mn(r,l+1,3);if(l+=3,m)if(m==1)c=K5,d=$5,p=9,f=5;else if(m==2){var C=Mn(r,l,31)+257,F=Mn(r,l+10,15)+4,L=C+Mn(r,l+5,31)+1;l+=14;for(var D=new zi(L),S=new zi(19),A=0;A<F;++A)S[Of[A]]=Mn(r,l+A*3,7);l+=F*3;var O=sf(S),U=(1<<O)-1;if(!s&&l+L*(O+7)>g)break;for(var R=ss(S,O,1),A=0;A<L;){var k=R[Mn(r,l,U)];l+=k&15;var b=k>>>4;if(b<16)D[A++]=b;else{var M=0,V=0;for(b==16?(V=3+Mn(r,l,3),l+=2,M=D[A-1]):b==17?(V=3+Mn(r,l,7),l+=3):b==18&&(V=11+Mn(r,l,127),l+=7);V--;)D[A++]=M}}var oe=D.subarray(0,C),K=D.subarray(C);p=sf(oe),f=sf(K),c=ss(oe,p,1),d=ss(K,f,1)}else throw"invalid block type";else{var b=md(l)+4,w=r[b-4]|r[b-3]<<8,E=b+w;if(E>i){if(s)throw"unexpected EOF";break}n&&a(h+w),e.set(r.subarray(b,E),h),t.b=h+=w,t.p=l=E*8;continue}if(l>g)throw"unexpected EOF"}n&&a(h+131072);for(var Y=(1<<p)-1,se=(1<<f)-1,q=p+f+18;s||l+q<g;){var M=c[af(r,l)&Y],fe=M>>>4;if(l+=M&15,l>g)throw"unexpected EOF";if(!M)throw"invalid length/literal";if(fe<256)e[h++]=fe;else if(fe==256){c=null;break}else{var ge=fe-254;if(fe>264){var A=fe-257,_=eu[A];ge=Mn(r,l,(1<<_)-1)+bg[A],l+=_}var P=d[af(r,l)&se],N=P>>>4;if(!P)throw"invalid distance";l+=P&15;var K=q5[N];if(N>3){var _=tu[N];K+=af(r,l)&(1<<_)-1,l+=_}if(l>g)throw"unexpected EOF";n&&a(h+131072);for(var I=h+ge;h<I;h+=4)e[h]=e[h-K],e[h+1]=e[h+1-K],e[h+2]=e[h+2-K],e[h+3]=e[h+3-K];h=I}}t.l=c,t.p=l,t.b=h,c&&(o=1,t.m=p,t.d=d,t.n=f)}while(!o);return h==e.length?e:xg(e,0,h)},Cs=function(r,e,t){t<<=e&7;var i=e/8>>0;r[i]|=t,r[i+1]|=t>>>8},yl=function(r,e,t){t<<=e&7;var i=e/8>>0;r[i]|=t,r[i+1]|=t>>>8,r[i+2]|=t>>>16},of=function(r,e){for(var t=[],i=0;i<r.length;++i)r[i]&&t.push({s:i,f:r[i]});var n=t.length,s=t.slice();if(!n)return[new zi(0),0];if(n==1){var a=new zi(t[0].s+1);return a[t[0].s]=1,[a,1]}t.sort(function(L,D){return L.f-D.f}),t.push({s:-1,f:25001});var o=t[0],l=t[1],h=0,c=1,d=2;for(t[0]={s:-1,f:o.f+l.f,l:o,r:l};c!=n-1;)o=t[t[h].f<t[d].f?h++:d++],l=t[h!=c&&t[h].f<t[d].f?h++:d++],t[c++]={s:-1,f:o.f+l.f,l:o,r:l};for(var p=s[0].s,i=1;i<n;++i)s[i].s>p&&(p=s[i].s);var f=new Li(p+1),g=Hf(t[c-1],f,0);if(g>e){var i=0,m=0,b=g-e,w=1<<b;for(s.sort(function(D,S){return f[S.s]-f[D.s]||D.f-S.f});i<n;++i){var E=s[i].s;if(f[E]>e)m+=w-(1<<g-f[E]),f[E]=e;else break}for(m>>>=b;m>0;){var C=s[i].s;f[C]<e?m-=1<<e-f[C]++-1:++i}for(;i>=0&&m;--i){var F=s[i].s;f[F]==e&&(--f[F],++m)}g=e}return[new zi(f),g]},Hf=function(r,e,t){return r.s==-1?Math.max(Hf(r.l,e,t+1),Hf(r.r,e,t+1)):e[r.s]=t},hp=function(r){for(var e=r.length;e&&!r[--e];);for(var t=new Li(++e),i=0,n=r[0],s=1,a=function(l){t[i++]=l},o=1;o<=e;++o)if(r[o]==n&&o!=e)++s;else{if(!n&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(n),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(n);s=1,n=r[o]}return[t.subarray(0,i),e]},El=function(r,e){for(var t=0,i=0;i<e.length;++i)t+=r[i]*e[i];return t},zf=function(r,e,t){var i=t.length,n=md(e+2);r[n]=i&255,r[n+1]=i>>>8,r[n+2]=r[n]^255,r[n+3]=r[n+1]^255;for(var s=0;s<i;++s)r[n+s+4]=t[s];return(n+4+i)*8},cp=function(r,e,t,i,n,s,a,o,l,h,c){Cs(e,c++,t),++n[256];for(var d=of(n,15),p=d[0],f=d[1],g=of(s,15),m=g[0],b=g[1],w=hp(p),E=w[0],C=w[1],F=hp(m),L=F[0],D=F[1],S=new Li(19),A=0;A<E.length;++A)S[E[A]&31]++;for(var A=0;A<L.length;++A)S[L[A]&31]++;for(var O=of(S,7),U=O[0],R=O[1],k=19;k>4&&!U[Of[k-1]];--k);var M=h+5<<3,V=El(n,ia)+El(s,Vl)+a,oe=El(n,p)+El(s,m)+a+14+3*k+El(S,U)+(2*S[16]+3*S[17]+7*S[18]);if(M<=V&&M<=oe)return zf(e,c,r.subarray(l,l+h));var K,Y,se,q;if(Cs(e,c,1+(oe<V)),c+=2,oe<V){K=ss(p,f,0),Y=p,se=ss(m,b,0),q=m;var fe=ss(U,R,0);Cs(e,c,C-257),Cs(e,c+5,D-1),Cs(e,c+10,k-4),c+=14;for(var A=0;A<k;++A)Cs(e,c+3*A,U[Of[A]]);c+=3*k;for(var ge=[E,L],_=0;_<2;++_)for(var P=ge[_],A=0;A<P.length;++A){var N=P[A]&31;Cs(e,c,fe[N]),c+=U[N],N>15&&(Cs(e,c,P[A]>>>5&127),c+=P[A]>>>12)}}else K=X5,Y=ia,se=Y5,q=Vl;for(var A=0;A<o;++A)if(i[A]>255){var N=i[A]>>>18&31;yl(e,c,K[N+257]),c+=Y[N+257],N>7&&(Cs(e,c,i[A]>>>23&31),c+=eu[N]);var I=i[A]&31;yl(e,c,se[I]),c+=q[I],I>3&&(yl(e,c,i[A]>>>5&8191),c+=tu[I])}else yl(e,c,K[i[A]]),c+=Y[i[A]];return yl(e,c,K[256]),c+Y[256]},Z5=new Ul([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Q5=function(r,e,t,i,n,s){var a=r.length,o=new zi(i+a+5*(1+Math.floor(a/7e3))+n),l=o.subarray(i,o.length-n),h=0;if(!e||a<8)for(var c=0;c<=a;c+=65535){var d=c+65535;d<a?h=zf(l,h,r.subarray(c,d)):(l[c]=s,h=zf(l,h,r.subarray(c,a)))}else{for(var p=Z5[e-1],f=p>>>13,g=p&8191,m=(1<<t)-1,b=new Li(32768),w=new Li(m+1),E=Math.ceil(t/3),C=2*E,F=function(Ye){return(r[Ye]^r[Ye+1]<<E^r[Ye+2]<<C)&m},L=new Ul(25e3),D=new Li(288),S=new Li(32),A=0,O=0,c=0,U=0,R=0,k=0;c<a;++c){var M=F(c),V=c&32767,oe=w[M];if(b[V]=oe,w[M]=V,R<=c){var K=a-c;if((A>7e3||U>24576)&&K>423){h=cp(r,l,0,L,D,S,O,U,k,c-k,h),U=A=O=0,k=c;for(var Y=0;Y<286;++Y)D[Y]=0;for(var Y=0;Y<30;++Y)S[Y]=0}var se=2,q=0,fe=g,ge=V-oe&32767;if(K>2&&M==F(c-ge))for(var _=Math.min(f,K)-1,P=Math.min(32767,c),N=Math.min(258,K);ge<=P&&--fe&&V!=oe;){if(r[c+se]==r[c+se-ge]){for(var I=0;I<N&&r[c+I]==r[c+I-ge];++I);if(I>se){if(se=I,q=ge,I>_)break;for(var X=Math.min(ge,I-2),he=0,Y=0;Y<X;++Y){var ce=c-ge+Y+32768&32767,ue=b[ce],be=ce-ue+32768&32767;be>he&&(he=be,oe=ce)}}}V=oe,oe=b[V],ge+=V-oe+32768&32767}if(q){L[U++]=268435456|If[se]<<18|lp[q];var Le=If[se]&31,Z=lp[q]&31;O+=eu[Le]+tu[Z],++D[257+Le],++S[Z],R=c+se,++A}else L[U++]=r[c],++D[r[c]]}}h=cp(r,l,s,L,D,S,O,U,k,c-k,h)}return xg(o,0,i+md(h)+n)},ey=function(){var r=1,e=0;return{p:function(t){for(var i=r,n=e,s=t.length,a=0;a!=s;){for(var o=Math.min(a+5552,s);a<o;++a)i+=t[a],n+=i;i%=65521,n%=65521}r=i,e=n},d:function(){return(r>>>8<<16|(e&255)<<8|e>>>8)+((r&255)<<23)*2}}},ty=function(r,e,t,i,n){return Q5(r,e.level==null?6:e.level,e.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):12+e.mem,t,i,!0)},ry=function(r,e,t){for(;t;++e)r[e]=t,t>>>=8},iy=function(r,e){var t=e.level,i=t==0?0:t<6?1:t==9?3:2;r[0]=120,r[1]=i<<6|(i?32-2*i:1)},ny=function(r){if((r[0]&15)!=8||r[0]>>>4>7||(r[0]<<8|r[1])%31)throw"invalid zlib data";if(r[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function jf(r,e){e===void 0&&(e={});var t=ey();t.p(r);var i=ty(r,e,2,4);return iy(i,e),ry(i,i.length-4,t.d()),i}function sy(r,e){return J5((ny(r),r.subarray(2,-4)),e)}var wt=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function lf(){wt.console&&typeof wt.console.log=="function"&&wt.console.log.apply(wt.console,arguments)}var lr={log:lf,warn:function(r){wt.console&&(typeof wt.console.warn=="function"?wt.console.warn.apply(wt.console,arguments):lf.call(null,arguments))},error:function(r){wt.console&&(typeof wt.console.error=="function"?wt.console.error.apply(wt.console,arguments):lf(r))}};function hf(r,e,t){var i=new XMLHttpRequest;i.open("GET",r),i.responseType="blob",i.onload=function(){wa(i.response,e,t)},i.onerror=function(){lr.error("could not download file")},i.send()}function up(r){var e=new XMLHttpRequest;e.open("HEAD",r,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function sc(r){try{r.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),r.dispatchEvent(e)}}var Rl,Wf,wa=wt.saveAs||((typeof window>"u"?"undefined":tr(window))!=="object"||window!==wt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(r,e,t){var i=wt.URL||wt.webkitURL,n=document.createElement("a");e=e||r.name||"download",n.download=e,n.rel="noopener",typeof r=="string"?(n.href=r,n.origin!==location.origin?up(n.href)?hf(r,e,t):sc(n,n.target="_blank"):sc(n)):(n.href=i.createObjectURL(r),setTimeout((function(){i.revokeObjectURL(n.href)}),4e4),setTimeout((function(){sc(n)}),0))}:"msSaveOrOpenBlob"in navigator?function(r,e,t){if(e=e||r.name||"download",typeof r=="string")if(up(r))hf(r,e,t);else{var i=document.createElement("a");i.href=r,i.target="_blank",setTimeout((function(){sc(i)}))}else navigator.msSaveOrOpenBlob((function(n,s){return s===void 0?s={autoBom:!1}:tr(s)!=="object"&&(lr.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n})(r,t),e)}:function(r,e,t,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),typeof r=="string")return hf(r,e,t);var n=r.type==="application/octet-stream",s=/constructor/i.test(wt.HTMLElement)||wt.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||n&&s)&&(typeof FileReader>"u"?"undefined":tr(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var c=o.result;c=a?c:c.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=c:location=c,i=null},o.readAsDataURL(r)}else{var l=wt.URL||wt.webkitURL,h=l.createObjectURL(r);i?i.location=h:location.href=h,i=null,setTimeout((function(){l.revokeObjectURL(h)}),4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function yg(r){var e;r=r||"",this.ok=!1,r.charAt(0)=="#"&&(r=r.substr(1,6)),r={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[r=(r=r.replace(/ /g,"")).toLowerCase()]||r;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],i=0;i<t.length;i++){var n=t[i].re,s=t[i].process,a=n.exec(r);a&&(e=s(a),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),l=this.g.toString(16),h=this.b.toString(16);return o.length==1&&(o="0"+o),l.length==1&&(l="0"+l),h.length==1&&(h="0"+h),"#"+o+l+h}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function cf(r,e){var t=r[0],i=r[1],n=r[2],s=r[3];t=di(t,i,n,s,e[0],7,-680876936),s=di(s,t,i,n,e[1],12,-389564586),n=di(n,s,t,i,e[2],17,606105819),i=di(i,n,s,t,e[3],22,-1044525330),t=di(t,i,n,s,e[4],7,-176418897),s=di(s,t,i,n,e[5],12,1200080426),n=di(n,s,t,i,e[6],17,-1473231341),i=di(i,n,s,t,e[7],22,-45705983),t=di(t,i,n,s,e[8],7,1770035416),s=di(s,t,i,n,e[9],12,-1958414417),n=di(n,s,t,i,e[10],17,-42063),i=di(i,n,s,t,e[11],22,-1990404162),t=di(t,i,n,s,e[12],7,1804603682),s=di(s,t,i,n,e[13],12,-40341101),n=di(n,s,t,i,e[14],17,-1502002290),t=pi(t,i=di(i,n,s,t,e[15],22,1236535329),n,s,e[1],5,-165796510),s=pi(s,t,i,n,e[6],9,-1069501632),n=pi(n,s,t,i,e[11],14,643717713),i=pi(i,n,s,t,e[0],20,-373897302),t=pi(t,i,n,s,e[5],5,-701558691),s=pi(s,t,i,n,e[10],9,38016083),n=pi(n,s,t,i,e[15],14,-660478335),i=pi(i,n,s,t,e[4],20,-405537848),t=pi(t,i,n,s,e[9],5,568446438),s=pi(s,t,i,n,e[14],9,-1019803690),n=pi(n,s,t,i,e[3],14,-187363961),i=pi(i,n,s,t,e[8],20,1163531501),t=pi(t,i,n,s,e[13],5,-1444681467),s=pi(s,t,i,n,e[2],9,-51403784),n=pi(n,s,t,i,e[7],14,1735328473),t=mi(t,i=pi(i,n,s,t,e[12],20,-1926607734),n,s,e[5],4,-378558),s=mi(s,t,i,n,e[8],11,-2022574463),n=mi(n,s,t,i,e[11],16,1839030562),i=mi(i,n,s,t,e[14],23,-35309556),t=mi(t,i,n,s,e[1],4,-1530992060),s=mi(s,t,i,n,e[4],11,1272893353),n=mi(n,s,t,i,e[7],16,-155497632),i=mi(i,n,s,t,e[10],23,-1094730640),t=mi(t,i,n,s,e[13],4,681279174),s=mi(s,t,i,n,e[0],11,-358537222),n=mi(n,s,t,i,e[3],16,-722521979),i=mi(i,n,s,t,e[6],23,76029189),t=mi(t,i,n,s,e[9],4,-640364487),s=mi(s,t,i,n,e[12],11,-421815835),n=mi(n,s,t,i,e[15],16,530742520),t=gi(t,i=mi(i,n,s,t,e[2],23,-995338651),n,s,e[0],6,-198630844),s=gi(s,t,i,n,e[7],10,1126891415),n=gi(n,s,t,i,e[14],15,-1416354905),i=gi(i,n,s,t,e[5],21,-57434055),t=gi(t,i,n,s,e[12],6,1700485571),s=gi(s,t,i,n,e[3],10,-1894986606),n=gi(n,s,t,i,e[10],15,-1051523),i=gi(i,n,s,t,e[1],21,-2054922799),t=gi(t,i,n,s,e[8],6,1873313359),s=gi(s,t,i,n,e[15],10,-30611744),n=gi(n,s,t,i,e[6],15,-1560198380),i=gi(i,n,s,t,e[13],21,1309151649),t=gi(t,i,n,s,e[4],6,-145523070),s=gi(s,t,i,n,e[11],10,-1120210379),n=gi(n,s,t,i,e[2],15,718787259),i=gi(i,n,s,t,e[9],21,-343485551),r[0]=Js(t,r[0]),r[1]=Js(i,r[1]),r[2]=Js(n,r[2]),r[3]=Js(s,r[3])}function ru(r,e,t,i,n,s){return e=Js(Js(e,r),Js(i,s)),Js(e<<n|e>>>32-n,t)}function di(r,e,t,i,n,s,a){return ru(e&t|~e&i,r,e,n,s,a)}function pi(r,e,t,i,n,s,a){return ru(e&i|t&~i,r,e,n,s,a)}function mi(r,e,t,i,n,s,a){return ru(e^t^i,r,e,n,s,a)}function gi(r,e,t,i,n,s,a){return ru(t^(e|~i),r,e,n,s,a)}function Eg(r){var e,t=r.length,i=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=r.length;e+=64)cf(i,ay(r.substring(e-64,e)));r=r.substring(e-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<r.length;e++)n[e>>2]|=r.charCodeAt(e)<<(e%4<<3);if(n[e>>2]|=128<<(e%4<<3),e>55)for(cf(i,n),e=0;e<16;e++)n[e]=0;return n[14]=8*t,cf(i,n),i}function ay(r){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=r.charCodeAt(e)+(r.charCodeAt(e+1)<<8)+(r.charCodeAt(e+2)<<16)+(r.charCodeAt(e+3)<<24);return t}Rl=wt.atob.bind(wt),Wf=wt.btoa.bind(wt);var fp="0123456789abcdef".split("");function oy(r){for(var e="",t=0;t<4;t++)e+=fp[r>>8*t+4&15]+fp[r>>8*t&15];return e}function ly(r){return String.fromCharCode((255&r)>>0,(65280&r)>>8,(16711680&r)>>16,(4278190080&r)>>24)}function Uf(r){return Eg(r).map(ly).join("")}var hy=(function(r){for(var e=0;e<r.length;e++)r[e]=oy(r[e]);return r.join("")})(Eg("hello"))!="5d41402abc4b2a76b9719d911017c592";function Js(r,e){if(hy){var t=(65535&r)+(65535&e);return(r>>16)+(e>>16)+(t>>16)<<16|65535&t}return r+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Vf(r,e){var t,i,n,s;if(r!==t){for(var a=(n=r,s=1+(256/r.length>>0),new Array(s+1).join(n)),o=[],l=0;l<256;l++)o[l]=l;var h=0;for(l=0;l<256;l++){var c=o[l];h=(h+c+a.charCodeAt(l))%256,o[l]=o[h],o[h]=c}t=r,i=o}else o=i;var d=e.length,p=0,f=0,g="";for(l=0;l<d;l++)f=(f+(c=o[p=(p+1)%256]))%256,o[p]=o[f],o[f]=c,a=o[(o[p]+o[f])%256],g+=String.fromCharCode(e.charCodeAt(l)^a);return g}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var dp={print:4,modify:8,copy:16,"annot-forms":32};function Eo(r,e,t,i){this.v=1,this.r=2;var n=192;r.forEach((function(o){if(dp.perm!==void 0)throw new Error("Invalid permission: "+o);n+=dp[o]})),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(e+this.padding).substr(0,32),a=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,a),this.P=-(1+(255^n)),this.encryptionKey=Uf(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(i)).substr(0,5),this.U=Vf(this.encryptionKey,this.padding)}function Co(r){if(/[^\u0000-\u00ff]/.test(r))throw new Error("Invalid PDF Name Object: "+r+", Only accept ASCII characters.");for(var e="",t=r.length,i=0;i<t;i++){var n=r.charCodeAt(i);n<33||n===35||n===37||n===40||n===41||n===47||n===60||n===62||n===91||n===93||n===123||n===125||n>126?e+="#"+("0"+n.toString(16)).slice(-2):e+=r[i]}return e}function pp(r){if(tr(r)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,i,n){if(n=n||!1,typeof t!="string"||typeof i!="function"||typeof n!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var s=Math.random().toString(35);return e[t][s]=[i,!!n],s},this.unsubscribe=function(t){for(var i in e)if(e[i][t])return delete e[i][t],Object.keys(e[i]).length===0&&delete e[i],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var i=Array.prototype.slice.call(arguments,1),n=[];for(var s in e[t]){var a=e[t][s];try{a[0].apply(r,i)}catch(o){wt.console&&lr.error("jsPDF PubSub Error",o.message,o)}a[1]&&n.push(s)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Gl(r){if(!(this instanceof Gl))return new Gl(r);var e="opacity,stroke-opacity".split(",");for(var t in r)r.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=r[t]);this.id="",this.objectNumber=-1}function Cg(r,e){this.gState=r,this.matrix=e,this.id="",this.objectNumber=-1}function $s(r,e,t,i,n){if(!(this instanceof $s))return new $s(r,e,t,i,n);this.type=r==="axial"?2:3,this.coords=e,this.colors=t,Cg.call(this,i,n)}function Ca(r,e,t,i,n){if(!(this instanceof Ca))return new Ca(r,e,t,i,n);this.boundingBox=r,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,Cg.call(this,i,n)}function dt(r){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",i=arguments[1],n=arguments[2],s=arguments[3],a=[],o=1,l=16,h="S",c=null;tr(r=r||{})==="object"&&(t=r.orientation,i=r.unit||i,n=r.format||n,s=r.compress||r.compressPdf||s,(c=r.encryption||null)!==null&&(c.userPassword=c.userPassword||"",c.ownerPassword=c.ownerPassword||"",c.userPermissions=c.userPermissions||[]),o=typeof r.userUnit=="number"?Math.abs(r.userUnit):1,r.precision!==void 0&&(e=r.precision),r.floatPrecision!==void 0&&(l=r.floatPrecision),h=r.defaultPathOperation||"S"),a=r.filters||(s===!0?["FlateEncode"]:a),i=i||"mm",t=(""+(t||"P")).toLowerCase();var d=r.putOnlyUsedFonts||!1,p={},f={internal:{},__private__:{}};f.__private__.PubSub=pp;var g="1.3",m=f.__private__.getPdfVersion=function(){return g};f.__private__.setPdfVersion=function(x){g=x};var b={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};f.__private__.getPageFormats=function(){return b};var w=f.__private__.getPageFormat=function(x){return b[x]};n=n||"a4";var E={COMPAT:"compat",ADVANCED:"advanced"},C=E.COMPAT;function F(){this.saveGraphicsState(),re(new mt(Ve,0,0,-Ve,0,Ps()*Ve).toString()+" cm"),this.setFontSize(this.getFontSize()/Ve),h="n",C=E.ADVANCED}function L(){this.restoreGraphicsState(),h="S",C=E.COMPAT}var D=f.__private__.combineFontStyleAndFontWeight=function(x,H){if(x=="bold"&&H=="normal"||x=="bold"&&H==400||x=="normal"&&H=="italic"||x=="bold"&&H=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return H&&(x=H==400||H==="normal"?x==="italic"?"italic":"normal":H!=700&&H!=="bold"||x!=="normal"?(H==700?"bold":H)+""+x:"bold"),x};f.advancedAPI=function(x){var H=C===E.COMPAT;return H&&F.call(this),typeof x!="function"||(x(this),H&&L.call(this)),this},f.compatAPI=function(x){var H=C===E.ADVANCED;return H&&L.call(this),typeof x!="function"||(x(this),H&&F.call(this)),this},f.isAdvancedAPI=function(){return C===E.ADVANCED};var S,A=function(x){if(C!==E.ADVANCED)throw new Error(x+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},O=f.roundToPrecision=f.__private__.roundToPrecision=function(x,H){var le=e||H;if(isNaN(x)||isNaN(le))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return x.toFixed(le).replace(/0+$/,"")};S=f.hpf=f.__private__.hpf=typeof l=="number"?function(x){if(isNaN(x))throw new Error("Invalid argument passed to jsPDF.hpf");return O(x,l)}:l==="smart"?function(x){if(isNaN(x))throw new Error("Invalid argument passed to jsPDF.hpf");return O(x,x>-1&&x<1?16:5)}:function(x){if(isNaN(x))throw new Error("Invalid argument passed to jsPDF.hpf");return O(x,16)};var U=f.f2=f.__private__.f2=function(x){if(isNaN(x))throw new Error("Invalid argument passed to jsPDF.f2");return O(x,2)},R=f.__private__.f3=function(x){if(isNaN(x))throw new Error("Invalid argument passed to jsPDF.f3");return O(x,3)},k=f.scale=f.__private__.scale=function(x){if(isNaN(x))throw new Error("Invalid argument passed to jsPDF.scale");return C===E.COMPAT?x*Ve:C===E.ADVANCED?x:void 0},M=function(x){return C===E.COMPAT?Ps()-x:C===E.ADVANCED?x:void 0},V=function(x){return k(M(x))};f.__private__.setPrecision=f.setPrecision=function(x){typeof parseInt(x,10)=="number"&&(e=parseInt(x,10))};var oe,K="00000000000000000000000000000000",Y=f.__private__.getFileId=function(){return K},se=f.__private__.setFileId=function(x){return K=x!==void 0&&/^[a-fA-F0-9]{32}$/.test(x)?x.toUpperCase():K.split("").map((function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))})).join(""),c!==null&&(ui=new Eo(c.userPermissions,c.userPassword,c.ownerPassword,K)),K};f.setFileId=function(x){return se(x),this},f.getFileId=function(){return Y()};var q=f.__private__.convertDateToPDFDate=function(x){var H=x.getTimezoneOffset(),le=H<0?"+":"-",de=Math.floor(Math.abs(H/60)),xe=Math.abs(H%60),Ne=[le,N(de),"'",N(xe),"'"].join("");return["D:",x.getFullYear(),N(x.getMonth()+1),N(x.getDate()),N(x.getHours()),N(x.getMinutes()),N(x.getSeconds()),Ne].join("")},fe=f.__private__.convertPDFDateToDate=function(x){var H=parseInt(x.substr(2,4),10),le=parseInt(x.substr(6,2),10)-1,de=parseInt(x.substr(8,2),10),xe=parseInt(x.substr(10,2),10),Ne=parseInt(x.substr(12,2),10),We=parseInt(x.substr(14,2),10);return new Date(H,le,de,xe,Ne,We,0)},ge=f.__private__.setCreationDate=function(x){var H;if(x===void 0&&(x=new Date),x instanceof Date)H=q(x);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(x))throw new Error("Invalid argument passed to jsPDF.setCreationDate");H=x}return oe=H},_=f.__private__.getCreationDate=function(x){var H=oe;return x==="jsDate"&&(H=fe(oe)),H};f.setCreationDate=function(x){return ge(x),this},f.getCreationDate=function(x){return _(x)};var P,N=f.__private__.padd2=function(x){return("0"+parseInt(x)).slice(-2)},I=f.__private__.padd2Hex=function(x){return("00"+(x=x.toString())).substr(x.length)},X=0,he=[],ce=[],ue=0,be=[],Le=[],Z=!1,Ue=ce,Ye=function(){X=0,ue=0,ce=[],he=[],be=[],Q=Er(),ee=Er()};f.__private__.setCustomOutputDestination=function(x){Z=!0,Ue=x};var Se=function(x){Z||(Ue=x)};f.__private__.resetCustomOutputDestination=function(){Z=!1,Ue=ce};var re=f.__private__.out=function(x){return x=x.toString(),ue+=x.length+1,Ue.push(x),Ue},De=f.__private__.write=function(x){return re(arguments.length===1?x.toString():Array.prototype.join.call(arguments," "))},Je=f.__private__.getArrayBuffer=function(x){for(var H=x.length,le=new ArrayBuffer(H),de=new Uint8Array(le);H--;)de[H]=x.charCodeAt(H);return le},He=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];f.__private__.getStandardFonts=function(){return He};var qe=r.fontSize||16;f.__private__.setFontSize=f.setFontSize=function(x){return qe=C===E.ADVANCED?x/Ve:x,this};var Ze,Qe=f.__private__.getFontSize=f.getFontSize=function(){return C===E.COMPAT?qe:qe*Ve},lt=r.R2L||!1;f.__private__.setR2L=f.setR2L=function(x){return lt=x,this},f.__private__.getR2L=f.getR2L=function(){return lt};var ht,bt=f.__private__.setZoomMode=function(x){var H=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(x))Ze=x;else if(isNaN(x)){if(H.indexOf(x)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+x+'" is not recognized.');Ze=x}else Ze=parseInt(x,10)};f.__private__.getZoomMode=function(){return Ze};var Et,Mt=f.__private__.setPageMode=function(x){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(x)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+x+'" is not recognized.');ht=x};f.__private__.getPageMode=function(){return ht};var St=f.__private__.setLayoutMode=function(x){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(x)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+x+'" is not recognized.');Et=x};f.__private__.getLayoutMode=function(){return Et},f.__private__.setDisplayMode=f.setDisplayMode=function(x,H,le){return bt(x),St(H),Mt(le),this};var ct={title:"",subject:"",author:"",keywords:"",creator:""};f.__private__.getDocumentProperty=function(x){if(Object.keys(ct).indexOf(x)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ct[x]},f.__private__.getDocumentProperties=function(){return ct},f.__private__.setDocumentProperties=f.setProperties=f.setDocumentProperties=function(x){for(var H in ct)ct.hasOwnProperty(H)&&x[H]&&(ct[H]=x[H]);return this},f.__private__.setDocumentProperty=function(x,H){if(Object.keys(ct).indexOf(x)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ct[x]=H};var tt,Ve,$t,pt,qr,Kt={},ur={},sn=[],Wt={},Vn={},pr={},Gi={},Cn=null,ar=0,_t=[],Gt=new pp(f),us=r.hotfixes||[],Xr={},an={},on=[],mt=function x(H,le,de,xe,Ne,We){if(!(this instanceof x))return new x(H,le,de,xe,Ne,We);isNaN(H)&&(H=1),isNaN(le)&&(le=0),isNaN(de)&&(de=0),isNaN(xe)&&(xe=1),isNaN(Ne)&&(Ne=0),isNaN(We)&&(We=0),this._matrix=[H,le,de,xe,Ne,We]};Object.defineProperty(mt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(x){this._matrix[0]=x}}),Object.defineProperty(mt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(x){this._matrix[1]=x}}),Object.defineProperty(mt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(x){this._matrix[2]=x}}),Object.defineProperty(mt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(x){this._matrix[3]=x}}),Object.defineProperty(mt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(x){this._matrix[4]=x}}),Object.defineProperty(mt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(x){this._matrix[5]=x}}),Object.defineProperty(mt.prototype,"a",{get:function(){return this._matrix[0]},set:function(x){this._matrix[0]=x}}),Object.defineProperty(mt.prototype,"b",{get:function(){return this._matrix[1]},set:function(x){this._matrix[1]=x}}),Object.defineProperty(mt.prototype,"c",{get:function(){return this._matrix[2]},set:function(x){this._matrix[2]=x}}),Object.defineProperty(mt.prototype,"d",{get:function(){return this._matrix[3]},set:function(x){this._matrix[3]=x}}),Object.defineProperty(mt.prototype,"e",{get:function(){return this._matrix[4]},set:function(x){this._matrix[4]=x}}),Object.defineProperty(mt.prototype,"f",{get:function(){return this._matrix[5]},set:function(x){this._matrix[5]=x}}),Object.defineProperty(mt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(mt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(mt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(mt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),mt.prototype.join=function(x){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(S).join(x)},mt.prototype.multiply=function(x){var H=x.sx*this.sx+x.shy*this.shx,le=x.sx*this.shy+x.shy*this.sy,de=x.shx*this.sx+x.sy*this.shx,xe=x.shx*this.shy+x.sy*this.sy,Ne=x.tx*this.sx+x.ty*this.shx+this.tx,We=x.tx*this.shy+x.ty*this.sy+this.ty;return new mt(H,le,de,xe,Ne,We)},mt.prototype.decompose=function(){var x=this.sx,H=this.shy,le=this.shx,de=this.sy,xe=this.tx,Ne=this.ty,We=Math.sqrt(x*x+H*H),st=(x/=We)*le+(H/=We)*de;le-=x*st,de-=H*st;var ft=Math.sqrt(le*le+de*de);return st/=ft,x*(de/=ft)<H*(le/=ft)&&(x=-x,H=-H,st=-st,We=-We),{scale:new mt(We,0,0,ft,0,0),translate:new mt(1,0,0,1,xe,Ne),rotate:new mt(x,H,-H,x,0,0),skew:new mt(1,0,st,1,0,0)}},mt.prototype.toString=function(x){return this.join(" ")},mt.prototype.inversed=function(){var x=this.sx,H=this.shy,le=this.shx,de=this.sy,xe=this.tx,Ne=this.ty,We=1/(x*de-H*le),st=de*We,ft=-H*We,At=-le*We,Pt=x*We;return new mt(st,ft,At,Pt,-st*xe-At*Ne,-ft*xe-Pt*Ne)},mt.prototype.applyToPoint=function(x){var H=x.x*this.sx+x.y*this.shx+this.tx,le=x.x*this.shy+x.y*this.sy+this.ty;return new to(H,le)},mt.prototype.applyToRectangle=function(x){var H=this.applyToPoint(x),le=this.applyToPoint(new to(x.x+x.w,x.y+x.h));return new el(H.x,H.y,le.x-H.x,le.y-H.y)},mt.prototype.clone=function(){var x=this.sx,H=this.shy,le=this.shx,de=this.sy,xe=this.tx,Ne=this.ty;return new mt(x,H,le,de,xe,Ne)},f.Matrix=mt;var qi=f.matrixMult=function(x,H){return H.multiply(x)},Pi=new mt(1,0,0,1,0,0);f.unitMatrix=f.identityMatrix=Pi;var ci=function(x,H){if(!Vn[x]){var le=(H instanceof $s?"Sh":"P")+(Object.keys(Wt).length+1).toString(10);H.id=le,Vn[x]=le,Wt[le]=H,Gt.publish("addPattern",H)}};f.ShadingPattern=$s,f.TilingPattern=Ca,f.addShadingPattern=function(x,H){return A("addShadingPattern()"),ci(x,H),this},f.beginTilingPattern=function(x){A("beginTilingPattern()"),Mh(x.boundingBox[0],x.boundingBox[1],x.boundingBox[2]-x.boundingBox[0],x.boundingBox[3]-x.boundingBox[1],x.matrix)},f.endTilingPattern=function(x,H){A("endTilingPattern()"),H.stream=Le[P].join(`
`),ci(x,H),Gt.publish("endTilingPattern",H),on.pop().restore()};var Rr=f.__private__.newObject=function(){var x=Er();return j(x,!0),x},Er=f.__private__.newObjectDeferred=function(){return X++,he[X]=function(){return ue},X},j=function(x,H){return H=typeof H=="boolean"&&H,he[x]=ue,H&&re(x+" 0 obj"),x},ne=f.__private__.newAdditionalObject=function(){var x={objId:Er(),content:""};return be.push(x),x},Q=Er(),ee=Er(),ie=f.__private__.decodeColorString=function(x){var H=x.split(" ");if(H.length!==2||H[1]!=="g"&&H[1]!=="G")H.length===5&&(H[4]==="k"||H[4]==="K")&&(H=[(1-H[0])*(1-H[3]),(1-H[1])*(1-H[3]),(1-H[2])*(1-H[3]),"r"]);else{var le=parseFloat(H[0]);H=[le,le,le,"r"]}for(var de="#",xe=0;xe<3;xe++)de+=("0"+Math.floor(255*parseFloat(H[xe])).toString(16)).slice(-2);return de},ae=f.__private__.encodeColorString=function(x){var H;typeof x=="string"&&(x={ch1:x});var le=x.ch1,de=x.ch2,xe=x.ch3,Ne=x.ch4,We=x.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof le=="string"&&le.charAt(0)!=="#"){var st=new yg(le);if(st.ok)le=st.toHex();else if(!/^\d*\.?\d*$/.test(le))throw new Error('Invalid color "'+le+'" passed to jsPDF.encodeColorString.')}if(typeof le=="string"&&/^#[0-9A-Fa-f]{3}$/.test(le)&&(le="#"+le[1]+le[1]+le[2]+le[2]+le[3]+le[3]),typeof le=="string"&&/^#[0-9A-Fa-f]{6}$/.test(le)){var ft=parseInt(le.substr(1),16);le=ft>>16&255,de=ft>>8&255,xe=255&ft}if(de===void 0||Ne===void 0&&le===de&&de===xe)if(typeof le=="string")H=le+" "+We[0];else switch(x.precision){case 2:H=U(le/255)+" "+We[0];break;case 3:default:H=R(le/255)+" "+We[0]}else if(Ne===void 0||tr(Ne)==="object"){if(Ne&&!isNaN(Ne.a)&&Ne.a===0)return H=["1.","1.","1.",We[1]].join(" ");if(typeof le=="string")H=[le,de,xe,We[1]].join(" ");else switch(x.precision){case 2:H=[U(le/255),U(de/255),U(xe/255),We[1]].join(" ");break;default:case 3:H=[R(le/255),R(de/255),R(xe/255),We[1]].join(" ")}}else if(typeof le=="string")H=[le,de,xe,Ne,We[2]].join(" ");else switch(x.precision){case 2:H=[U(le),U(de),U(xe),U(Ne),We[2]].join(" ");break;case 3:default:H=[R(le),R(de),R(xe),R(Ne),We[2]].join(" ")}return H},Ee=f.__private__.getFilters=function(){return a},Fe=f.__private__.putStream=function(x){var H=(x=x||{}).data||"",le=x.filters||Ee(),de=x.alreadyAppliedFilters||[],xe=x.addLength1||!1,Ne=H.length,We=x.objectId,st=function(fi){return fi};if(c!==null&&We===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");c!==null&&(st=ui.encryptor(We,0));var ft={};le===!0&&(le=["FlateEncode"]);var At=x.additionalKeyValues||[],Pt=(ft=dt.API.processDataByFilters!==void 0?dt.API.processDataByFilters(H,le):{data:H,reverseChain:[]}).reverseChain+(Array.isArray(de)?de.join(" "):de.toString());if(ft.data.length!==0&&(At.push({key:"Length",value:ft.data.length}),xe===!0&&At.push({key:"Length1",value:Ne})),Pt.length!=0)if(Pt.split("/").length-1==1)At.push({key:"Filter",value:Pt});else{At.push({key:"Filter",value:"["+Pt+"]"});for(var zt=0;zt<At.length;zt+=1)if(At[zt].key==="DecodeParms"){for(var xr=[],Cr=0;Cr<ft.reverseChain.split("/").length-1;Cr+=1)xr.push("null");xr.push(At[zt].value),At[zt].value="["+xr.join(" ")+"]"}}re("<<");for(var zr=0;zr<At.length;zr++)re("/"+At[zr].key+" "+At[zr].value);re(">>"),ft.data.length!==0&&(re("stream"),re(st(ft.data)),re("endstream"))},ye=f.__private__.putPage=function(x){var H=x.number,le=x.data,de=x.objId,xe=x.contentsObjId;j(de,!0),re("<</Type /Page"),re("/Parent "+x.rootDictionaryObjId+" 0 R"),re("/Resources "+x.resourceDictionaryObjId+" 0 R"),re("/MediaBox ["+parseFloat(S(x.mediaBox.bottomLeftX))+" "+parseFloat(S(x.mediaBox.bottomLeftY))+" "+S(x.mediaBox.topRightX)+" "+S(x.mediaBox.topRightY)+"]"),x.cropBox!==null&&re("/CropBox ["+S(x.cropBox.bottomLeftX)+" "+S(x.cropBox.bottomLeftY)+" "+S(x.cropBox.topRightX)+" "+S(x.cropBox.topRightY)+"]"),x.bleedBox!==null&&re("/BleedBox ["+S(x.bleedBox.bottomLeftX)+" "+S(x.bleedBox.bottomLeftY)+" "+S(x.bleedBox.topRightX)+" "+S(x.bleedBox.topRightY)+"]"),x.trimBox!==null&&re("/TrimBox ["+S(x.trimBox.bottomLeftX)+" "+S(x.trimBox.bottomLeftY)+" "+S(x.trimBox.topRightX)+" "+S(x.trimBox.topRightY)+"]"),x.artBox!==null&&re("/ArtBox ["+S(x.artBox.bottomLeftX)+" "+S(x.artBox.bottomLeftY)+" "+S(x.artBox.topRightX)+" "+S(x.artBox.topRightY)+"]"),typeof x.userUnit=="number"&&x.userUnit!==1&&re("/UserUnit "+x.userUnit),Gt.publish("putPage",{objId:de,pageContext:_t[H],pageNumber:H,page:le}),re("/Contents "+xe+" 0 R"),re(">>"),re("endobj");var Ne=le.join(`
`);return C===E.ADVANCED&&(Ne+=`
Q`),j(xe,!0),Fe({data:Ne,filters:Ee(),objectId:xe}),re("endobj"),de},ke=f.__private__.putPages=function(){var x,H,le=[];for(x=1;x<=ar;x++)_t[x].objId=Er(),_t[x].contentsObjId=Er();for(x=1;x<=ar;x++)le.push(ye({number:x,data:Le[x],objId:_t[x].objId,contentsObjId:_t[x].contentsObjId,mediaBox:_t[x].mediaBox,cropBox:_t[x].cropBox,bleedBox:_t[x].bleedBox,trimBox:_t[x].trimBox,artBox:_t[x].artBox,userUnit:_t[x].userUnit,rootDictionaryObjId:Q,resourceDictionaryObjId:ee}));j(Q,!0),re("<</Type /Pages");var de="/Kids [";for(H=0;H<ar;H++)de+=le[H]+" 0 R ";re(de+"]"),re("/Count "+ar),re(">>"),re("endobj"),Gt.publish("postPutPages")},Te=function(x){Gt.publish("putFont",{font:x,out:re,newObject:Rr,putStream:Fe}),x.isAlreadyPutted!==!0&&(x.objectNumber=Rr(),re("<<"),re("/Type /Font"),re("/BaseFont /"+Co(x.postScriptName)),re("/Subtype /Type1"),typeof x.encoding=="string"&&re("/Encoding /"+x.encoding),re("/FirstChar 32"),re("/LastChar 255"),re(">>"),re("endobj"))},je=function(){for(var x in Kt)Kt.hasOwnProperty(x)&&(d===!1||d===!0&&p.hasOwnProperty(x))&&Te(Kt[x])},Xe=function(x){x.objectNumber=Rr();var H=[];H.push({key:"Type",value:"/XObject"}),H.push({key:"Subtype",value:"/Form"}),H.push({key:"BBox",value:"["+[S(x.x),S(x.y),S(x.x+x.width),S(x.y+x.height)].join(" ")+"]"}),H.push({key:"Matrix",value:"["+x.matrix.toString()+"]"});var le=x.pages[1].join(`
`);Fe({data:le,additionalKeyValues:H,objectId:x.objectNumber}),re("endobj")},nt=function(){for(var x in Xr)Xr.hasOwnProperty(x)&&Xe(Xr[x])},Ge=function(x,H){var le,de=[],xe=1/(H-1);for(le=0;le<1;le+=xe)de.push(le);if(de.push(1),x[0].offset!=0){var Ne={offset:0,color:x[0].color};x.unshift(Ne)}if(x[x.length-1].offset!=1){var We={offset:1,color:x[x.length-1].color};x.push(We)}for(var st="",ft=0,At=0;At<de.length;At++){for(le=de[At];le>x[ft+1].offset;)ft++;var Pt=x[ft].offset,zt=(le-Pt)/(x[ft+1].offset-Pt),xr=x[ft].color,Cr=x[ft+1].color;st+=I(Math.round((1-zt)*xr[0]+zt*Cr[0]).toString(16))+I(Math.round((1-zt)*xr[1]+zt*Cr[1]).toString(16))+I(Math.round((1-zt)*xr[2]+zt*Cr[2]).toString(16))}return st.trim()},it=function(x,H){H||(H=21);var le=Rr(),de=Ge(x.colors,H),xe=[];xe.push({key:"FunctionType",value:"0"}),xe.push({key:"Domain",value:"[0.0 1.0]"}),xe.push({key:"Size",value:"["+H+"]"}),xe.push({key:"BitsPerSample",value:"8"}),xe.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),xe.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Fe({data:de,additionalKeyValues:xe,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:le}),re("endobj"),x.objectNumber=Rr(),re("<< /ShadingType "+x.type),re("/ColorSpace /DeviceRGB");var Ne="/Coords ["+S(parseFloat(x.coords[0]))+" "+S(parseFloat(x.coords[1]))+" ";x.type===2?Ne+=S(parseFloat(x.coords[2]))+" "+S(parseFloat(x.coords[3])):Ne+=S(parseFloat(x.coords[2]))+" "+S(parseFloat(x.coords[3]))+" "+S(parseFloat(x.coords[4]))+" "+S(parseFloat(x.coords[5])),re(Ne+="]"),x.matrix&&re("/Matrix ["+x.matrix.toString()+"]"),re("/Function "+le+" 0 R"),re("/Extend [true true]"),re(">>"),re("endobj")},Ct=function(x,H){var le=Er(),de=Rr();H.push({resourcesOid:le,objectOid:de}),x.objectNumber=de;var xe=[];xe.push({key:"Type",value:"/Pattern"}),xe.push({key:"PatternType",value:"1"}),xe.push({key:"PaintType",value:"1"}),xe.push({key:"TilingType",value:"1"}),xe.push({key:"BBox",value:"["+x.boundingBox.map(S).join(" ")+"]"}),xe.push({key:"XStep",value:S(x.xStep)}),xe.push({key:"YStep",value:S(x.yStep)}),xe.push({key:"Resources",value:le+" 0 R"}),x.matrix&&xe.push({key:"Matrix",value:"["+x.matrix.toString()+"]"}),Fe({data:x.stream,additionalKeyValues:xe,objectId:x.objectNumber}),re("endobj")},Yt=function(x){var H;for(H in Wt)Wt.hasOwnProperty(H)&&(Wt[H]instanceof $s?it(Wt[H]):Wt[H]instanceof Ca&&Ct(Wt[H],x))},ir=function(x){for(var H in x.objectNumber=Rr(),re("<<"),x)switch(H){case"opacity":re("/ca "+U(x[H]));break;case"stroke-opacity":re("/CA "+U(x[H]))}re(">>"),re("endobj")},Hr=function(){var x;for(x in pr)pr.hasOwnProperty(x)&&ir(pr[x])},_n=function(){for(var x in re("/XObject <<"),Xr)Xr.hasOwnProperty(x)&&Xr[x].objectNumber>=0&&re("/"+x+" "+Xr[x].objectNumber+" 0 R");Gt.publish("putXobjectDict"),re(">>")},fs=function(){ui.oid=Rr(),re("<<"),re("/Filter /Standard"),re("/V "+ui.v),re("/R "+ui.r),re("/U <"+ui.toHexString(ui.U)+">"),re("/O <"+ui.toHexString(ui.O)+">"),re("/P "+ui.P),re(">>"),re("endobj")},Gn=function(){for(var x in re("/Font <<"),Kt)Kt.hasOwnProperty(x)&&(d===!1||d===!0&&p.hasOwnProperty(x))&&re("/"+x+" "+Kt[x].objectNumber+" 0 R");re(">>")},kn=function(){if(Object.keys(Wt).length>0){for(var x in re("/Shading <<"),Wt)Wt.hasOwnProperty(x)&&Wt[x]instanceof $s&&Wt[x].objectNumber>=0&&re("/"+x+" "+Wt[x].objectNumber+" 0 R");Gt.publish("putShadingPatternDict"),re(">>")}},qn=function(x){if(Object.keys(Wt).length>0){for(var H in re("/Pattern <<"),Wt)Wt.hasOwnProperty(H)&&Wt[H]instanceof f.TilingPattern&&Wt[H].objectNumber>=0&&Wt[H].objectNumber<x&&re("/"+H+" "+Wt[H].objectNumber+" 0 R");Gt.publish("putTilingPatternDict"),re(">>")}},Xi=function(){if(Object.keys(pr).length>0){var x;for(x in re("/ExtGState <<"),pr)pr.hasOwnProperty(x)&&pr[x].objectNumber>=0&&re("/"+x+" "+pr[x].objectNumber+" 0 R");Gt.publish("putGStateDict"),re(">>")}},Lr=function(x){j(x.resourcesOid,!0),re("<<"),re("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Gn(),kn(),qn(x.objectOid),Xi(),_n(),re(">>"),re("endobj")},xh=function(){var x=[];je(),Hr(),nt(),Yt(x),Gt.publish("putResources"),x.forEach(Lr),Lr({resourcesOid:ee,objectOid:Number.MAX_SAFE_INTEGER}),Gt.publish("postPutResources")},yh=function(){Gt.publish("putAdditionalObjects");for(var x=0;x<be.length;x++){var H=be[x];j(H.objId,!0),re(H.content),re("endobj")}Gt.publish("postPutAdditionalObjects")},Eh=function(x){ur[x.fontName]=ur[x.fontName]||{},ur[x.fontName][x.fontStyle]=x.id},Go=function(x,H,le,de,xe){var Ne={id:"F"+(Object.keys(Kt).length+1).toString(10),postScriptName:x,fontName:H,fontStyle:le,encoding:de,isStandardFont:xe||!1,metadata:{}};return Gt.publish("addFont",{font:Ne,instance:this}),Kt[Ne.id]=Ne,Eh(Ne),Ne.id},mu=function(x){for(var H=0,le=He.length;H<le;H++){var de=Go.call(this,x[H][0],x[H][1],x[H][2],He[H][3],!0);d===!1&&(p[de]=!0);var xe=x[H][0].split("-");Eh({id:de,fontName:xe[0],fontStyle:xe[1]||""})}Gt.publish("addFonts",{fonts:Kt,dictionary:ur})},Sn=function(x){return x.foo=function(){try{return x.apply(this,arguments)}catch(de){var H=de.stack||"";~H.indexOf(" at ")&&(H=H.split(" at ")[1]);var le="Error in function "+H.split(`
`)[0].split("<")[0]+": "+de.message;if(!wt.console)throw new Error(le);wt.console.error(le,de),wt.alert&&alert(le)}},x.foo.bar=x,x.foo},Ya=function(x,H){var le,de,xe,Ne,We,st,ft,At,Pt;if(xe=(H=H||{}).sourceEncoding||"Unicode",We=H.outputEncoding,(H.autoencode||We)&&Kt[tt].metadata&&Kt[tt].metadata[xe]&&Kt[tt].metadata[xe].encoding&&(Ne=Kt[tt].metadata[xe].encoding,!We&&Kt[tt].encoding&&(We=Kt[tt].encoding),!We&&Ne.codePages&&(We=Ne.codePages[0]),typeof We=="string"&&(We=Ne[We]),We)){for(ft=!1,st=[],le=0,de=x.length;le<de;le++)(At=We[x.charCodeAt(le)])?st.push(String.fromCharCode(At)):st.push(x[le]),st[le].charCodeAt(0)>>8&&(ft=!0);x=st.join("")}for(le=x.length;ft===void 0&&le!==0;)x.charCodeAt(le-1)>>8&&(ft=!0),le--;if(!ft)return x;for(st=H.noBOM?[]:[254,255],le=0,de=x.length;le<de;le++){if((Pt=(At=x.charCodeAt(le))>>8)>>8)throw new Error("Character at position "+le+" of string '"+x+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");st.push(Pt),st.push(At-(Pt<<8))}return String.fromCharCode.apply(void 0,st)},Di=f.__private__.pdfEscape=f.pdfEscape=function(x,H){return Ya(x,H).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},qo=f.__private__.beginPage=function(x){Le[++ar]=[],_t[ar]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(x[0]),topRightY:Number(x[1])}},_h(ar),Se(Le[P])},Ch=function(x,H){var le,de,xe;switch(t=H||t,typeof x=="string"&&(le=w(x.toLowerCase()),Array.isArray(le)&&(de=le[0],xe=le[1])),Array.isArray(x)&&(de=x[0]*Ve,xe=x[1]*Ve),isNaN(de)&&(de=n[0],xe=n[1]),(de>14400||xe>14400)&&(lr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),de=Math.min(14400,de),xe=Math.min(14400,xe)),n=[de,xe],t.substr(0,1)){case"l":xe>de&&(n=[xe,de]);break;case"p":de>xe&&(n=[xe,de])}qo(n),Rh($o),re(Tn),Zo!==0&&re(Zo+" J"),Qo!==0&&re(Qo+" j"),Gt.publish("addPage",{pageNumber:ar})},gu=function(x){x>0&&x<=ar&&(Le.splice(x,1),_t.splice(x,1),ar--,P>ar&&(P=ar),this.setPage(P))},_h=function(x){x>0&&x<=ar&&(P=x)},vu=f.__private__.getNumberOfPages=f.getNumberOfPages=function(){return Le.length-1},kh=function(x,H,le){var de,xe=void 0;return le=le||{},x=x!==void 0?x:Kt[tt].fontName,H=H!==void 0?H:Kt[tt].fontStyle,de=x.toLowerCase(),ur[de]!==void 0&&ur[de][H]!==void 0?xe=ur[de][H]:ur[x]!==void 0&&ur[x][H]!==void 0?xe=ur[x][H]:le.disableWarning===!1&&lr.warn("Unable to look up font label for font '"+x+"', '"+H+"'. Refer to getFontList() for available fonts."),xe||le.noFallback||(xe=ur.times[H])==null&&(xe=ur.times.normal),xe},bu=f.__private__.putInfo=function(){var x=Rr(),H=function(de){return de};for(var le in c!==null&&(H=ui.encryptor(x,0)),re("<<"),re("/Producer ("+Di(H("jsPDF "+dt.version))+")"),ct)ct.hasOwnProperty(le)&&ct[le]&&re("/"+le.substr(0,1).toUpperCase()+le.substr(1)+" ("+Di(H(ct[le]))+")");re("/CreationDate ("+Di(H(oe))+")"),re(">>"),re("endobj")},Xo=f.__private__.putCatalog=function(x){var H=(x=x||{}).rootDictionaryObjId||Q;switch(Rr(),re("<<"),re("/Type /Catalog"),re("/Pages "+H+" 0 R"),Ze||(Ze="fullwidth"),Ze){case"fullwidth":re("/OpenAction [3 0 R /FitH null]");break;case"fullheight":re("/OpenAction [3 0 R /FitV null]");break;case"fullpage":re("/OpenAction [3 0 R /Fit]");break;case"original":re("/OpenAction [3 0 R /XYZ null null 1]");break;default:var le=""+Ze;le.substr(le.length-1)==="%"&&(Ze=parseInt(Ze)/100),typeof Ze=="number"&&re("/OpenAction [3 0 R /XYZ null null "+U(Ze)+"]")}switch(Et||(Et="continuous"),Et){case"continuous":re("/PageLayout /OneColumn");break;case"single":re("/PageLayout /SinglePage");break;case"two":case"twoleft":re("/PageLayout /TwoColumnLeft");break;case"tworight":re("/PageLayout /TwoColumnRight")}ht&&re("/PageMode /"+ht),Gt.publish("putCatalog"),re(">>"),re("endobj")},wu=f.__private__.putTrailer=function(){re("trailer"),re("<<"),re("/Size "+(X+1)),re("/Root "+X+" 0 R"),re("/Info "+(X-1)+" 0 R"),c!==null&&re("/Encrypt "+ui.oid+" 0 R"),re("/ID [ <"+K+"> <"+K+"> ]"),re(">>")},xu=f.__private__.putHeader=function(){re("%PDF-"+g),re("%")},yu=f.__private__.putXRef=function(){var x="0000000000";re("xref"),re("0 "+(X+1)),re("0000000000 65535 f ");for(var H=1;H<=X;H++)typeof he[H]=="function"?re((x+he[H]()).slice(-10)+" 00000 n "):he[H]!==void 0?re((x+he[H]).slice(-10)+" 00000 n "):re("0000000000 00000 n ")},ds=f.__private__.buildDocument=function(){Ye(),Se(ce),Gt.publish("buildDocument"),xu(),ke(),yh(),xh(),c!==null&&fs(),bu(),Xo();var x=ue;return yu(),wu(),re("startxref"),re(""+x),re("%%EOF"),Se(Le[P]),ce.join(`
`)},$a=f.__private__.getBlob=function(x){return new Blob([Je(x)],{type:"application/pdf"})},Ja=f.output=f.__private__.output=Sn((function(x,H){switch(typeof(H=H||{})=="string"?H={filename:H}:H.filename=H.filename||"generated.pdf",x){case void 0:return ds();case"save":f.save(H.filename);break;case"arraybuffer":return Je(ds());case"blob":return $a(ds());case"bloburi":case"bloburl":if(wt.URL!==void 0&&typeof wt.URL.createObjectURL=="function")return wt.URL&&wt.URL.createObjectURL($a(ds()))||void 0;lr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var le="",de=ds();try{le=Wf(de)}catch{le=Wf(unescape(encodeURIComponent(de)))}return"data:application/pdf;filename="+H.filename+";base64,"+le;case"pdfobjectnewwindow":if(Object.prototype.toString.call(wt)==="[object Window]"){var xe="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ne=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';H.pdfObjectUrl&&(xe=H.pdfObjectUrl,Ne="");var We='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+xe+'"'+Ne+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(H)+");<\/script></body></html>",st=wt.open();return st!==null&&st.document.write(We),st}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(wt)==="[object Window]"){var ft='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(H.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+H.filename+'" width="500px" height="400px" /></body></html>',At=wt.open();if(At!==null){At.document.write(ft);var Pt=this;At.document.documentElement.querySelector("#pdfViewer").onload=function(){At.document.title=H.filename,At.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Pt.output("bloburl"))}}return At}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(wt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var zt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",H)+'"></iframe></body></html>',xr=wt.open();if(xr!==null&&(xr.document.write(zt),xr.document.title=H.filename),xr||typeof safari>"u")return xr;break;case"datauri":case"dataurl":return wt.document.location.href=this.output("datauristring",H);default:return null}})),Sh=function(x){return Array.isArray(us)===!0&&us.indexOf(x)>-1};switch(i){case"pt":Ve=1;break;case"mm":Ve=72/25.4;break;case"cm":Ve=72/2.54;break;case"in":Ve=72;break;case"px":Ve=Sh("px_scaling")==1?.75:96/72;break;case"pc":case"em":Ve=12;break;case"ex":Ve=6;break;default:if(typeof i!="number")throw new Error("Invalid unit: "+i);Ve=i}var ui=null;ge(),se();var Eu=function(x){return c!==null?ui.encryptor(x,0):function(H){return H}},Th=f.__private__.getPageInfo=f.getPageInfo=function(x){if(isNaN(x)||x%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:_t[x].objId,pageNumber:x,pageContext:_t[x]}},kt=f.__private__.getPageInfoByObjId=function(x){if(isNaN(x)||x%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var H in _t)if(_t[H].objId===x)break;return Th(H)},Cu=f.__private__.getCurrentPageInfo=f.getCurrentPageInfo=function(){return{objId:_t[P].objId,pageNumber:P,pageContext:_t[P]}};f.addPage=function(){return Ch.apply(this,arguments),this},f.setPage=function(){return _h.apply(this,arguments),Se.call(this,Le[P]),this},f.insertPage=function(x){return this.addPage(),this.movePage(P,x),this},f.movePage=function(x,H){var le,de;if(x>H){le=Le[x],de=_t[x];for(var xe=x;xe>H;xe--)Le[xe]=Le[xe-1],_t[xe]=_t[xe-1];Le[H]=le,_t[H]=de,this.setPage(H)}else if(x<H){le=Le[x],de=_t[x];for(var Ne=x;Ne<H;Ne++)Le[Ne]=Le[Ne+1],_t[Ne]=_t[Ne+1];Le[H]=le,_t[H]=de,this.setPage(H)}return this},f.deletePage=function(){return gu.apply(this,arguments),this},f.__private__.text=f.text=function(x,H,le,de,xe){var Ne,We,st,ft,At,Pt,zt,xr,Cr,zr=(de=de||{}).scope||this;if(typeof x=="number"&&typeof H=="number"&&(typeof le=="string"||Array.isArray(le))){var fi=le;le=H,H=x,x=fi}if(arguments[3]instanceof mt?(A("The transform parameter of text() with a Matrix value"),Cr=xe):(st=arguments[4],ft=arguments[5],tr(zt=arguments[3])==="object"&&zt!==null||(typeof st=="string"&&(ft=st,st=null),typeof zt=="string"&&(ft=zt,zt=null),typeof zt=="number"&&(st=zt,zt=null),de={flags:zt,angle:st,align:ft})),isNaN(H)||isNaN(le)||x==null)throw new Error("Invalid arguments passed to jsPDF.text");if(x.length===0)return zr;var Zr="",An=!1,Ki=typeof de.lineHeightFactor=="number"?de.lineHeightFactor:da,ms=zr.internal.scaleFactor;function Oh(fr){return fr=fr.split("	").join(Array(de.TabLen||9).join(" ")),Di(fr,zt)}function nl(fr){for(var dr,Nr=fr.concat(),Kr=[],ws=Nr.length;ws--;)typeof(dr=Nr.shift())=="string"?Kr.push(dr):Array.isArray(fr)&&(dr.length===1||dr[1]===void 0&&dr[2]===void 0)?Kr.push(dr[0]):Kr.push([dr[0],dr[1],dr[2]]);return Kr}function sl(fr,dr){var Nr;if(typeof fr=="string")Nr=dr(fr)[0];else if(Array.isArray(fr)){for(var Kr,ws,Bs=fr.concat(),uo=[],Bh=Bs.length;Bh--;)typeof(Kr=Bs.shift())=="string"?uo.push(dr(Kr)[0]):Array.isArray(Kr)&&typeof Kr[0]=="string"&&(ws=dr(Kr[0],Kr[1],Kr[2]),uo.push([ws[0],ws[1],ws[2]]));Nr=uo}return Nr}var io=!1,al=!0;if(typeof x=="string")io=!0;else if(Array.isArray(x)){var ol=x.concat();We=[];for(var no,Mi=ol.length;Mi--;)(typeof(no=ol.shift())!="string"||Array.isArray(no)&&typeof no[0]!="string")&&(al=!1);io=al}if(io===!1)throw new Error('Type of text must be string or Array. "'+x+'" is not recognized.');typeof x=="string"&&(x=x.match(/[\r?\n]/)?x.split(/\r\n|\r|\n/g):[x]);var so=qe/zr.internal.scaleFactor,ao=so*(Ki-1);switch(de.baseline){case"bottom":le-=ao;break;case"top":le+=so-ao;break;case"hanging":le+=so-2*ao;break;case"middle":le+=so/2-ao}if((Pt=de.maxWidth||0)>0&&(typeof x=="string"?x=zr.splitTextToSize(x,Pt):Object.prototype.toString.call(x)==="[object Array]"&&(x=x.reduce((function(fr,dr){return fr.concat(zr.splitTextToSize(dr,Pt))}),[]))),Ne={text:x,x:H,y:le,options:de,mutex:{pdfEscape:Di,activeFontKey:tt,fonts:Kt,activeFontSize:qe}},Gt.publish("preProcessText",Ne),x=Ne.text,st=(de=Ne.options).angle,!(Cr instanceof mt)&&st&&typeof st=="number"){st*=Math.PI/180,de.rotationDirection===0&&(st=-st),C===E.ADVANCED&&(st=-st);var oo=Math.cos(st),ll=Math.sin(st);Cr=new mt(oo,ll,-ll,oo,0,0)}else st&&st instanceof mt&&(Cr=st);C!==E.ADVANCED||Cr||(Cr=Pi),(At=de.charSpace||eo)!==void 0&&(Zr+=S(k(At))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(xr=de.horizontalScale)!==void 0&&(Zr+=S(100*xr)+` Tz
`),de.lang;var Oi=-1,Pu=de.renderingMode!==void 0?de.renderingMode:de.stroke,hl=zr.internal.getCurrentPageInfo().pageContext;switch(Pu){case 0:case!1:case"fill":Oi=0;break;case 1:case!0:case"stroke":Oi=1;break;case 2:case"fillThenStroke":Oi=2;break;case 3:case"invisible":Oi=3;break;case 4:case"fillAndAddForClipping":Oi=4;break;case 5:case"strokeAndAddPathForClipping":Oi=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Oi=6;break;case 7:case"addToPathForClipping":Oi=7}var Ih=hl.usedRenderingMode!==void 0?hl.usedRenderingMode:-1;Oi!==-1?Zr+=Oi+` Tr
`:Ih!==-1&&(Zr+=`0 Tr
`),Oi!==-1&&(hl.usedRenderingMode=Oi),ft=de.align||"left";var Fn,cl=qe*Ki,Du=zr.internal.pageSize.getWidth(),Mu=Kt[tt];At=de.charSpace||eo,Pt=de.maxWidth||0,zt=Object.assign({autoencode:!0,noBOM:!0},de.flags);var Ds=[];if(Object.prototype.toString.call(x)==="[object Array]"){var ln;We=nl(x),ft!=="left"&&(Fn=We.map((function(fr){return zr.getStringUnitWidth(fr,{font:Mu,charSpace:At,fontSize:qe,doKerning:!1})*qe/ms})));var Rn,Ms=0;if(ft==="right"){H-=Fn[0],x=[],Mi=We.length;for(var Kn=0;Kn<Mi;Kn++)Kn===0?(Rn=ps(H),ln=Ls(le)):(Rn=k(Ms-Fn[Kn]),ln=-cl),x.push([We[Kn],Rn,ln]),Ms=Fn[Kn]}else if(ft==="center"){H-=Fn[0]/2,x=[],Mi=We.length;for(var gs=0;gs<Mi;gs++)gs===0?(Rn=ps(H),ln=Ls(le)):(Rn=k((Ms-Fn[gs])/2),ln=-cl),x.push([We[gs],Rn,ln]),Ms=Fn[gs]}else if(ft==="left"){x=[],Mi=We.length;for(var lo=0;lo<Mi;lo++)x.push(We[lo])}else{if(ft!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');x=[],Mi=We.length,Pt=Pt!==0?Pt:Du;for(var Ln=0;Ln<Mi;Ln++)ln=Ln===0?Ls(le):-cl,Rn=Ln===0?ps(H):0,Ln<Mi-1?Ds.push(S(k((Pt-Fn[Ln])/(We[Ln].split(" ").length-1)))):Ds.push(0),x.push([We[Ln],Rn,ln])}}var ho=typeof de.R2L=="boolean"?de.R2L:lt;ho===!0&&(x=sl(x,(function(fr,dr,Nr){return[fr.split("").reverse().join(""),dr,Nr]}))),Ne={text:x,x:H,y:le,options:de,mutex:{pdfEscape:Di,activeFontKey:tt,fonts:Kt,activeFontSize:qe}},Gt.publish("postProcessText",Ne),x=Ne.text,An=Ne.mutex.isHex||!1;var ul=Kt[tt].encoding;ul!=="WinAnsiEncoding"&&ul!=="StandardEncoding"||(x=sl(x,(function(fr,dr,Nr){return[Oh(fr),dr,Nr]}))),We=nl(x),x=[];for(var Os,Nn,vs,ga=0,co=1,va=Array.isArray(We[0])?co:ga,Is="",fl=function(fr,dr,Nr){var Kr="";return Nr instanceof mt?(Nr=typeof de.angle=="number"?qi(Nr,new mt(1,0,0,1,fr,dr)):qi(new mt(1,0,0,1,fr,dr),Nr),C===E.ADVANCED&&(Nr=qi(new mt(1,0,0,-1,0,0),Nr)),Kr=Nr.join(" ")+` Tm
`):Kr=S(fr)+" "+S(dr)+` Td
`,Kr},hn=0;hn<We.length;hn++){switch(Is="",va){case co:vs=(An?"<":"(")+We[hn][0]+(An?">":")"),Os=parseFloat(We[hn][1]),Nn=parseFloat(We[hn][2]);break;case ga:vs=(An?"<":"(")+We[hn]+(An?">":")"),Os=ps(H),Nn=Ls(le)}Ds!==void 0&&Ds[hn]!==void 0&&(Is=Ds[hn]+` Tw
`),hn===0?x.push(Is+fl(Os,Nn,Cr)+vs):va===ga?x.push(Is+vs):va===co&&x.push(Is+fl(Os,Nn,Cr)+vs)}x=va===ga?x.join(` Tj
T* `):x.join(` Tj
`),x+=` Tj
`;var bs=`BT
/`;return bs+=tt+" "+qe+` Tf
`,bs+=S(qe*Ki)+` TL
`,bs+=pa+`
`,bs+=Zr,bs+=x,re(bs+="ET"),p[tt]=!0,zr};var _u=f.__private__.clip=f.clip=function(x){return re(x==="evenodd"?"W*":"W"),this};f.clipEvenOdd=function(){return _u("evenodd")},f.__private__.discardPath=f.discardPath=function(){return re("n"),this};var Xn=f.__private__.isValidStyle=function(x){var H=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(x)!==-1&&(H=!0),H};f.__private__.setDefaultPathOperation=f.setDefaultPathOperation=function(x){return Xn(x)&&(h=x),this};var Ah=f.__private__.getStyle=f.getStyle=function(x){var H=h;switch(x){case"D":case"S":H="S";break;case"F":H="f";break;case"FD":case"DF":H="B";break;case"f":case"f*":case"B":case"B*":H=x}return H},Fh=f.close=function(){return re("h"),this};f.stroke=function(){return re("S"),this},f.fill=function(x){return Za("f",x),this},f.fillEvenOdd=function(x){return Za("f*",x),this},f.fillStroke=function(x){return Za("B",x),this},f.fillStrokeEvenOdd=function(x){return Za("B*",x),this};var Za=function(x,H){tr(H)==="object"?Su(H,x):re(x)},Ko=function(x){x===null||C===E.ADVANCED&&x===void 0||(x=Ah(x),re(x))};function ku(x,H,le,de,xe){var Ne=new Ca(H||this.boundingBox,le||this.xStep,de||this.yStep,this.gState,xe||this.matrix);Ne.stream=this.stream;var We=x+"$$"+this.cloneIndex+++"$$";return ci(We,Ne),Ne}var Su=function(x,H){var le=Vn[x.key],de=Wt[le];if(de instanceof $s)re("q"),re(Tu(H)),de.gState&&f.setGState(de.gState),re(x.matrix.toString()+" cm"),re("/"+le+" sh"),re("Q");else if(de instanceof Ca){var xe=new mt(1,0,0,-1,0,Ps());x.matrix&&(xe=xe.multiply(x.matrix||Pi),le=ku.call(de,x.key,x.boundingBox,x.xStep,x.yStep,xe).id),re("q"),re("/Pattern cs"),re("/"+le+" scn"),de.gState&&f.setGState(de.gState),re(H),re("Q")}},Tu=function(x){switch(x){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Yo=f.moveTo=function(x,H){return re(S(k(x))+" "+S(V(H))+" m"),this},fa=f.lineTo=function(x,H){return re(S(k(x))+" "+S(V(H))+" l"),this},Rs=f.curveTo=function(x,H,le,de,xe,Ne){return re([S(k(x)),S(V(H)),S(k(le)),S(V(de)),S(k(xe)),S(V(Ne)),"c"].join(" ")),this};f.__private__.line=f.line=function(x,H,le,de,xe){if(isNaN(x)||isNaN(H)||isNaN(le)||isNaN(de)||!Xn(xe))throw new Error("Invalid arguments passed to jsPDF.line");return C===E.COMPAT?this.lines([[le-x,de-H]],x,H,[1,1],xe||"S"):this.lines([[le-x,de-H]],x,H,[1,1]).stroke()},f.__private__.lines=f.lines=function(x,H,le,de,xe,Ne){var We,st,ft,At,Pt,zt,xr,Cr,zr,fi,Zr,An;if(typeof x=="number"&&(An=le,le=H,H=x,x=An),de=de||[1,1],Ne=Ne||!1,isNaN(H)||isNaN(le)||!Array.isArray(x)||!Array.isArray(de)||!Xn(xe)||typeof Ne!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Yo(H,le),We=de[0],st=de[1],At=x.length,fi=H,Zr=le,ft=0;ft<At;ft++)(Pt=x[ft]).length===2?(fi=Pt[0]*We+fi,Zr=Pt[1]*st+Zr,fa(fi,Zr)):(zt=Pt[0]*We+fi,xr=Pt[1]*st+Zr,Cr=Pt[2]*We+fi,zr=Pt[3]*st+Zr,fi=Pt[4]*We+fi,Zr=Pt[5]*st+Zr,Rs(zt,xr,Cr,zr,fi,Zr));return Ne&&Fh(),Ko(xe),this},f.path=function(x){for(var H=0;H<x.length;H++){var le=x[H],de=le.c;switch(le.op){case"m":Yo(de[0],de[1]);break;case"l":fa(de[0],de[1]);break;case"c":Rs.apply(this,de);break;case"h":Fh()}}return this},f.__private__.rect=f.rect=function(x,H,le,de,xe){if(isNaN(x)||isNaN(H)||isNaN(le)||isNaN(de)||!Xn(xe))throw new Error("Invalid arguments passed to jsPDF.rect");return C===E.COMPAT&&(de=-de),re([S(k(x)),S(V(H)),S(k(le)),S(k(de)),"re"].join(" ")),Ko(xe),this},f.__private__.triangle=f.triangle=function(x,H,le,de,xe,Ne,We){if(isNaN(x)||isNaN(H)||isNaN(le)||isNaN(de)||isNaN(xe)||isNaN(Ne)||!Xn(We))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[le-x,de-H],[xe-le,Ne-de],[x-xe,H-Ne]],x,H,[1,1],We,!0),this},f.__private__.roundedRect=f.roundedRect=function(x,H,le,de,xe,Ne,We){if(isNaN(x)||isNaN(H)||isNaN(le)||isNaN(de)||isNaN(xe)||isNaN(Ne)||!Xn(We))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var st=4/3*(Math.SQRT2-1);return xe=Math.min(xe,.5*le),Ne=Math.min(Ne,.5*de),this.lines([[le-2*xe,0],[xe*st,0,xe,Ne-Ne*st,xe,Ne],[0,de-2*Ne],[0,Ne*st,-xe*st,Ne,-xe,Ne],[2*xe-le,0],[-xe*st,0,-xe,-Ne*st,-xe,-Ne],[0,2*Ne-de],[0,-Ne*st,xe*st,-Ne,xe,-Ne]],x+xe,H,[1,1],We,!0),this},f.__private__.ellipse=f.ellipse=function(x,H,le,de,xe){if(isNaN(x)||isNaN(H)||isNaN(le)||isNaN(de)||!Xn(xe))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ne=4/3*(Math.SQRT2-1)*le,We=4/3*(Math.SQRT2-1)*de;return Yo(x+le,H),Rs(x+le,H-We,x+Ne,H-de,x,H-de),Rs(x-Ne,H-de,x-le,H-We,x-le,H),Rs(x-le,H+We,x-Ne,H+de,x,H+de),Rs(x+Ne,H+de,x+le,H+We,x+le,H),Ko(xe),this},f.__private__.circle=f.circle=function(x,H,le,de){if(isNaN(x)||isNaN(H)||isNaN(le)||!Xn(de))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(x,H,le,le,de)},f.setFont=function(x,H,le){return le&&(H=D(H,le)),tt=kh(x,H,{disableWarning:!1}),this};var Au=f.__private__.getFont=f.getFont=function(){return Kt[kh.apply(f,arguments)]};f.__private__.getFontList=f.getFontList=function(){var x,H,le={};for(x in ur)if(ur.hasOwnProperty(x))for(H in le[x]=[],ur[x])ur[x].hasOwnProperty(H)&&le[x].push(H);return le},f.addFont=function(x,H,le,de,xe){var Ne=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ne.indexOf(arguments[3])!==-1?xe=arguments[3]:arguments[3]&&Ne.indexOf(arguments[3])==-1&&(le=D(le,de)),xe=xe||"Identity-H",Go.call(this,x,H,le,xe)};var da,$o=r.lineWidth||.200025,Qa=f.__private__.getLineWidth=f.getLineWidth=function(){return $o},Rh=f.__private__.setLineWidth=f.setLineWidth=function(x){return $o=x,re(S(k(x))+" w"),this};f.__private__.setLineDash=dt.API.setLineDash=dt.API.setLineDashPattern=function(x,H){if(x=x||[],H=H||0,isNaN(H)||!Array.isArray(x))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return x=x.map((function(le){return S(k(le))})).join(" "),H=S(k(H)),re("["+x+"] "+H+" d"),this};var Lh=f.__private__.getLineHeight=f.getLineHeight=function(){return qe*da};f.__private__.getLineHeight=f.getLineHeight=function(){return qe*da};var Nh=f.__private__.setLineHeightFactor=f.setLineHeightFactor=function(x){return typeof(x=x||1.15)=="number"&&(da=x),this},Ph=f.__private__.getLineHeightFactor=f.getLineHeightFactor=function(){return da};Nh(r.lineHeight);var ps=f.__private__.getHorizontalCoordinate=function(x){return k(x)},Ls=f.__private__.getVerticalCoordinate=function(x){return C===E.ADVANCED?x:_t[P].mediaBox.topRightY-_t[P].mediaBox.bottomLeftY-k(x)},Fu=f.__private__.getHorizontalCoordinateString=f.getHorizontalCoordinateString=function(x){return S(ps(x))},Ns=f.__private__.getVerticalCoordinateString=f.getVerticalCoordinateString=function(x){return S(Ls(x))},Tn=r.strokeColor||"0 G";f.__private__.getStrokeColor=f.getDrawColor=function(){return ie(Tn)},f.__private__.setStrokeColor=f.setDrawColor=function(x,H,le,de){return Tn=ae({ch1:x,ch2:H,ch3:le,ch4:de,pdfColorType:"draw",precision:2}),re(Tn),this};var Jo=r.fillColor||"0 g";f.__private__.getFillColor=f.getFillColor=function(){return ie(Jo)},f.__private__.setFillColor=f.setFillColor=function(x,H,le,de){return Jo=ae({ch1:x,ch2:H,ch3:le,ch4:de,pdfColorType:"fill",precision:2}),re(Jo),this};var pa=r.textColor||"0 g",Ru=f.__private__.getTextColor=f.getTextColor=function(){return ie(pa)};f.__private__.setTextColor=f.setTextColor=function(x,H,le,de){return pa=ae({ch1:x,ch2:H,ch3:le,ch4:de,pdfColorType:"text",precision:3}),this};var eo=r.charSpace,Lu=f.__private__.getCharSpace=f.getCharSpace=function(){return parseFloat(eo||0)};f.__private__.setCharSpace=f.setCharSpace=function(x){if(isNaN(x))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return eo=x,this};var Zo=0;f.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},f.__private__.setLineCap=f.setLineCap=function(x){var H=f.CapJoinStyles[x];if(H===void 0)throw new Error("Line cap style of '"+x+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Zo=H,re(H+" J"),this};var Qo=0;f.__private__.setLineJoin=f.setLineJoin=function(x){var H=f.CapJoinStyles[x];if(H===void 0)throw new Error("Line join style of '"+x+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Qo=H,re(H+" j"),this},f.__private__.setLineMiterLimit=f.__private__.setMiterLimit=f.setLineMiterLimit=f.setMiterLimit=function(x){if(x=x||0,isNaN(x))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return re(S(k(x))+" M"),this},f.GState=Gl,f.setGState=function(x){(x=typeof x=="string"?pr[Gi[x]]:Dh(null,x)).equals(Cn)||(re("/"+x.id+" gs"),Cn=x)};var Dh=function(x,H){if(!x||!Gi[x]){var le=!1;for(var de in pr)if(pr.hasOwnProperty(de)&&pr[de].equals(H)){le=!0;break}if(le)H=pr[de];else{var xe="GS"+(Object.keys(pr).length+1).toString(10);pr[xe]=H,H.id=xe}return x&&(Gi[x]=H.id),Gt.publish("addGState",H),H}};f.addGState=function(x,H){return Dh(x,H),this},f.saveGraphicsState=function(){return re("q"),sn.push({key:tt,size:qe,color:pa}),this},f.restoreGraphicsState=function(){re("Q");var x=sn.pop();return tt=x.key,qe=x.size,pa=x.color,Cn=null,this},f.setCurrentTransformationMatrix=function(x){return re(x.toString()+" cm"),this},f.comment=function(x){return re("#"+x),this};var to=function(x,H){var le=x||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return le},set:function(Ne){isNaN(Ne)||(le=parseFloat(Ne))}});var de=H||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return de},set:function(Ne){isNaN(Ne)||(de=parseFloat(Ne))}});var xe="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return xe},set:function(Ne){xe=Ne.toString()}}),this},el=function(x,H,le,de){to.call(this,x,H),this.type="rect";var xe=le||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return xe},set:function(We){isNaN(We)||(xe=parseFloat(We))}});var Ne=de||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ne},set:function(We){isNaN(We)||(Ne=parseFloat(We))}}),this},tl=function(){this.page=ar,this.currentPage=P,this.pages=Le.slice(0),this.pagesContext=_t.slice(0),this.x=$t,this.y=pt,this.matrix=qr,this.width=ma(P),this.height=Ps(P),this.outputDestination=Ue,this.id="",this.objectNumber=-1};tl.prototype.restore=function(){ar=this.page,P=this.currentPage,_t=this.pagesContext,Le=this.pages,$t=this.x,pt=this.y,qr=this.matrix,rl(P,this.width),il(P,this.height),Ue=this.outputDestination};var Mh=function(x,H,le,de,xe){on.push(new tl),ar=P=0,Le=[],$t=x,pt=H,qr=xe,qo([le,de])},Nu=function(x){if(an[x])on.pop().restore();else{var H=new tl,le="Xo"+(Object.keys(Xr).length+1).toString(10);H.id=le,an[x]=le,Xr[le]=H,Gt.publish("addFormObject",H),on.pop().restore()}};for(var ro in f.beginFormObject=function(x,H,le,de,xe){return Mh(x,H,le,de,xe),this},f.endFormObject=function(x){return Nu(x),this},f.doFormObject=function(x,H){var le=Xr[an[x]];return re("q"),re(H.toString()+" cm"),re("/"+le.id+" Do"),re("Q"),this},f.getFormObject=function(x){var H=Xr[an[x]];return{x:H.x,y:H.y,width:H.width,height:H.height,matrix:H.matrix}},f.save=function(x,H){return x=x||"generated.pdf",(H=H||{}).returnPromise=H.returnPromise||!1,H.returnPromise===!1?(wa($a(ds()),x),typeof wa.unload=="function"&&wt.setTimeout&&setTimeout(wa.unload,911),this):new Promise((function(le,de){try{var xe=wa($a(ds()),x);typeof wa.unload=="function"&&wt.setTimeout&&setTimeout(wa.unload,911),le(xe)}catch(Ne){de(Ne.message)}}))},dt.API)dt.API.hasOwnProperty(ro)&&(ro==="events"&&dt.API.events.length?(function(x,H){var le,de,xe;for(xe=H.length-1;xe!==-1;xe--)le=H[xe][0],de=H[xe][1],x.subscribe.apply(x,[le].concat(typeof de=="function"?[de]:de))})(Gt,dt.API.events):f[ro]=dt.API[ro]);var ma=f.getPageWidth=function(x){return(_t[x=x||P].mediaBox.topRightX-_t[x].mediaBox.bottomLeftX)/Ve},rl=f.setPageWidth=function(x,H){_t[x].mediaBox.topRightX=H*Ve+_t[x].mediaBox.bottomLeftX},Ps=f.getPageHeight=function(x){return(_t[x=x||P].mediaBox.topRightY-_t[x].mediaBox.bottomLeftY)/Ve},il=f.setPageHeight=function(x,H){_t[x].mediaBox.topRightY=H*Ve+_t[x].mediaBox.bottomLeftY};return f.internal={pdfEscape:Di,getStyle:Ah,getFont:Au,getFontSize:Qe,getCharSpace:Lu,getTextColor:Ru,getLineHeight:Lh,getLineHeightFactor:Ph,getLineWidth:Qa,write:De,getHorizontalCoordinate:ps,getVerticalCoordinate:Ls,getCoordinateString:Fu,getVerticalCoordinateString:Ns,collections:{},newObject:Rr,newAdditionalObject:ne,newObjectDeferred:Er,newObjectDeferredBegin:j,getFilters:Ee,putStream:Fe,events:Gt,scaleFactor:Ve,pageSize:{getWidth:function(){return ma(P)},setWidth:function(x){rl(P,x)},getHeight:function(){return Ps(P)},setHeight:function(x){il(P,x)}},encryptionOptions:c,encryption:ui,getEncryptor:Eu,output:Ja,getNumberOfPages:vu,pages:Le,out:re,f2:U,f3:R,getPageInfo:Th,getPageInfoByObjId:kt,getCurrentPageInfo:Cu,getPDFVersion:m,Point:to,Rectangle:el,Matrix:mt,hasHotfix:Sh},Object.defineProperty(f.internal.pageSize,"width",{get:function(){return ma(P)},set:function(x){rl(P,x)},enumerable:!0,configurable:!0}),Object.defineProperty(f.internal.pageSize,"height",{get:function(){return Ps(P)},set:function(x){il(P,x)},enumerable:!0,configurable:!0}),mu.call(f,He),tt="F1",Ch(n,t),Gt.publish("initialized"),f}Eo.prototype.lsbFirstWord=function(r){return String.fromCharCode(r>>0&255,r>>8&255,r>>16&255,r>>24&255)},Eo.prototype.toHexString=function(r){return r.split("").map((function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)})).join("")},Eo.prototype.hexToBytes=function(r){for(var e=[],t=0;t<r.length;t+=2)e.push(String.fromCharCode(parseInt(r.substr(t,2),16)));return e.join("")},Eo.prototype.processOwnerPassword=function(r,e){return Vf(Uf(e).substr(0,5),r)},Eo.prototype.encryptor=function(r,e){var t=Uf(this.encryptionKey+String.fromCharCode(255&r,r>>8&255,r>>16&255,255&e,e>>8&255)).substr(0,10);return function(i){return Vf(t,i)}},Gl.prototype.equals=function(r){var e,t="id,objectNumber,equals";if(!r||tr(r)!==tr(this))return!1;var i=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!r.hasOwnProperty(e)||this[e]!==r[e])return!1;i++}for(e in r)r.hasOwnProperty(e)&&t.indexOf(e)<0&&i--;return i===0},dt.API={events:[]},dt.version="2.5.1";var kr=dt.API,gd=1,ja=function(r){return r.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},vo=function(r){return r.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Tt=function(r){return r.toFixed(2)},Xs=function(r){return r.toFixed(5)};kr.__acroform__={};var Vi=function(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r},mp=function(r){return r*gd},Zn=function(r){var e=new kg,t=ot.internal.getHeight(r)||0,i=ot.internal.getWidth(r)||0;return e.BBox=[0,0,Number(Tt(i)),Number(Tt(t))],e},cy=kr.__acroform__.setBit=function(r,e){if(r=r||0,e=e||0,isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return r|=1<<e},uy=kr.__acroform__.clearBit=function(r,e){if(r=r||0,e=e||0,isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return r&=~(1<<e)},fy=kr.__acroform__.getBit=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return(r&1<<e)==0?0:1},Dr=kr.__acroform__.getBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return fy(r,e-1)},Mr=kr.__acroform__.setBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return cy(r,e-1)},Or=kr.__acroform__.clearBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return uy(r,e-1)},dy=kr.__acroform__.calculateCoordinates=function(r,e){var t=e.internal.getHorizontalCoordinate,i=e.internal.getVerticalCoordinate,n=r[0],s=r[1],a=r[2],o=r[3],l={};return l.lowerLeft_X=t(n)||0,l.lowerLeft_Y=i(s+o)||0,l.upperRight_X=t(n+a)||0,l.upperRight_Y=i(s)||0,[Number(Tt(l.lowerLeft_X)),Number(Tt(l.lowerLeft_Y)),Number(Tt(l.upperRight_X)),Number(Tt(l.upperRight_Y))]},py=function(r){if(r.appearanceStreamContent)return r.appearanceStreamContent;if(r.V||r.DV){var e=[],t=r._V||r.DV,i=Gf(r,t),n=r.scope.internal.getFont(r.fontName,r.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(r.scope.__private__.encodeColorString(r.color)),e.push("/"+n+" "+Tt(i.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(i.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=Zn(r);return s.scope=r.scope,s.stream=e.join(`
`),s}},Gf=function(r,e){var t=r.fontSize===0?r.maxFontSize:r.fontSize,i={text:"",fontSize:""},n=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");n=r.multiline?n.map((function(R){return R.split(`
`)})):n.map((function(R){return[R]}));var s=t,a=ot.internal.getHeight(r)||0;a=a<0?-a:a;var o=ot.internal.getWidth(r)||0;o=o<0?-o:o;var l=function(R,k,M){if(R+1<n.length){var V=k+" "+n[R+1][0];return ac(V,r,M).width<=o-4}return!1};s++;e:for(;s>0;){e="",s--;var h,c,d=ac("3",r,s).height,p=r.multiline?a-s:(a-d)/2,f=p+=2,g=0,m=0,b=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+ac(e,r,s=12).width+", FieldWidth:"+o+`
`;break}for(var w="",E=0,C=0;C<n.length;C++)if(n.hasOwnProperty(C)){var F=!1;if(n[C].length!==1&&b!==n[C].length-1){if((d+2)*(E+2)+2>a)continue e;w+=n[C][b],F=!0,m=C,C--}else{w=(w+=n[C][b]+" ").substr(w.length-1)==" "?w.substr(0,w.length-1):w;var L=parseInt(C),D=l(L,w,s),S=C>=n.length-1;if(D&&!S){w+=" ",b=0;continue}if(D||S){if(S)m=L;else if(r.multiline&&(d+2)*(E+2)+2>a)continue e}else{if(!r.multiline||(d+2)*(E+2)+2>a)continue e;m=L}}for(var A="",O=g;O<=m;O++){var U=n[O];if(r.multiline){if(O===m){A+=U[b]+" ",b=(b+1)%U.length;continue}if(O===g){A+=U[U.length-1]+" ";continue}}A+=U[0]+" "}switch(A=A.substr(A.length-1)==" "?A.substr(0,A.length-1):A,c=ac(A,r,s).width,r.textAlign){case"right":h=o-c-2;break;case"center":h=(o-c)/2;break;case"left":default:h=2}e+=Tt(h)+" "+Tt(f)+` Td
`,e+="("+ja(A)+`) Tj
`,e+=-Tt(h)+` 0 Td
`,f=-(s+2),c=0,g=F?m:m+1,E++,w=""}break}return i.text=e,i.fontSize=s,i},ac=function(r,e,t){var i=e.scope.internal.getFont(e.fontName,e.fontStyle),n=e.scope.getStringUnitWidth(r,{font:i,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:i,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:n}},my={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},gy=function(r,e){var t={type:"reference",object:r};e.internal.getPageInfo(r.page).pageContext.annotations.find((function(i){return i.type===t.type&&i.object===t.object}))===void 0&&e.internal.getPageInfo(r.page).pageContext.annotations.push(t)},vy=function(r,e){for(var t in r)if(r.hasOwnProperty(t)){var i=t,n=r[t];e.internal.newObjectDeferredBegin(n.objId,!0),tr(n)==="object"&&typeof n.putStream=="function"&&n.putStream(),delete r[i]}},by=function(r,e){if(e.scope=r,r.internal!==void 0&&(r.internal.acroformPlugin===void 0||r.internal.acroformPlugin.isInitialized===!1)){if(Wn.FieldNum=0,r.internal.acroformPlugin=JSON.parse(JSON.stringify(my)),r.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");gd=r.internal.scaleFactor,r.internal.acroformPlugin.acroFormDictionaryRoot=new Sg,r.internal.acroformPlugin.acroFormDictionaryRoot.scope=r,r.internal.acroformPlugin.acroFormDictionaryRoot._eventID=r.internal.events.subscribe("postPutResources",(function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(r)})),r.internal.events.subscribe("buildDocument",(function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var i=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in i)if(i.hasOwnProperty(n)){var s=i[n];s.objId=void 0,s.hasAnnotation&&gy(s,t)}})(r)})),r.internal.events.subscribe("putCatalog",(function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(r)})),r.internal.events.subscribe("postPutPages",(function(t){(function(i,n){var s=!i;for(var a in i||(n.internal.newObjectDeferredBegin(n.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),n.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),i=i||n.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(i.hasOwnProperty(a)){var o=i[a],l=[],h=o.Rect;if(o.Rect&&(o.Rect=dy(o.Rect,n)),n.internal.newObjectDeferredBegin(o.objId,!0),o.DA=ot.createDefaultAppearanceStream(o),tr(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(l=o.getKeyValueListForStream()),o.Rect=h,o.hasAppearanceStream&&!o.appearanceStreamContent){var c=py(o);l.push({key:"AP",value:"<</N "+c+">>"}),n.internal.acroformPlugin.xForms.push(c)}if(o.appearanceStreamContent){var d="";for(var p in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(p)){var f=o.appearanceStreamContent[p];if(d+="/"+p+" ",d+="<<",Object.keys(f).length>=1||Array.isArray(f)){for(var a in f)if(f.hasOwnProperty(a)){var g=f[a];typeof g=="function"&&(g=g.call(n,o)),d+="/"+a+" "+g+" ",n.internal.acroformPlugin.xForms.indexOf(g)>=0||n.internal.acroformPlugin.xForms.push(g)}}else typeof(g=f)=="function"&&(g=g.call(n,o)),d+="/"+a+" "+g,n.internal.acroformPlugin.xForms.indexOf(g)>=0||n.internal.acroformPlugin.xForms.push(g);d+=">>"}l.push({key:"AP",value:`<<
`+d+">>"})}n.internal.putStream({additionalKeyValues:l,objectId:o.objId}),n.internal.out("endobj")}s&&vy(n.internal.acroformPlugin.xForms,n)})(t,r)})),r.internal.acroformPlugin.isInitialized=!0}},_g=kr.__acroform__.arrayToPdfArray=function(r,e,t){var i=function(a){return a};if(Array.isArray(r)){for(var n="[",s=0;s<r.length;s++)switch(s!==0&&(n+=" "),tr(r[s])){case"boolean":case"number":case"object":n+=r[s].toString();break;case"string":r[s].substr(0,1)!=="/"?(e!==void 0&&t&&(i=t.internal.getEncryptor(e)),n+="("+ja(i(r[s].toString()))+")"):n+=r[s].toString()}return n+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},uf=function(r,e,t){var i=function(n){return n};return e!==void 0&&t&&(i=t.internal.getEncryptor(e)),(r=r||"").toString(),r="("+ja(i(r))+")"},is=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(r){this._objId=r}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};is.prototype.toString=function(){return this.objId+" 0 R"},is.prototype.putStream=function(){var r=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:r,objectId:this.objId}),this.scope.internal.out("endobj")},is.prototype.getKeyValueListForStream=function(){var r=[],e=Object.getOwnPropertyNames(this).filter((function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"}));for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var i=e[t],n=this[i];n&&(Array.isArray(n)?r.push({key:i,value:_g(n,this.objId,this.scope)}):n instanceof is?(n.scope=this.scope,r.push({key:i,value:n.objId+" 0 R"})):typeof n!="function"&&r.push({key:i,value:n}))}return r};var kg=function(){is.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var r,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){r=t.trim()},get:function(){return r||null}})};Vi(kg,is);var Sg=function(){is.call(this);var r,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(r){var t=function(i){return i};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+ja(t(r))+")"}},set:function(t){r=t}})};Vi(Sg,is);var Wn=function r(){is.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(w){if(isNaN(w))throw new Error('Invalid value "'+w+'" for attribute F supplied.');e=w}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Dr(e,3)},set:function(w){w?this.F=Mr(e,3):this.F=Or(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(w){if(isNaN(w))throw new Error('Invalid value "'+w+'" for attribute Ff supplied.');t=w}});var i=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(i.length!==0)return i},set:function(w){i=w!==void 0?w:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[0])?0:i[0]},set:function(w){i[0]=w}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[1])?0:i[1]},set:function(w){i[1]=w}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[2])?0:i[2]},set:function(w){i[2]=w}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[3])?0:i[3]},set:function(w){i[3]=w}});var n="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return n},set:function(w){switch(w){case"/Btn":case"/Tx":case"/Ch":case"/Sig":n=w;break;default:throw new Error('Invalid value "'+w+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof Lc)return;s="FieldObject"+r.FieldNum++}var w=function(E){return E};return this.scope&&(w=this.scope.internal.getEncryptor(this.objId)),"("+ja(w(s))+")"},set:function(w){s=w.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(w){s=w}});var a="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return a},set:function(w){a=w}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(w){o=w}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(w){l=w}});var h=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return h===void 0?50/gd:h},set:function(w){h=w}});var c="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return c},set:function(w){c=w}});var d="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!d||this instanceof Lc||this instanceof ra))return uf(d,this.objId,this.scope)},set:function(w){w=w.toString(),d=w}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Yr?p:uf(p,this.objId,this.scope)},set:function(w){w=w.toString(),p=this instanceof Yr?w:w.substr(0,1)==="("?vo(w.substr(1,w.length-2)):vo(w)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Yr?vo(p.substr(1,p.length-1)):p},set:function(w){w=w.toString(),p=this instanceof Yr?"/"+w:w}});var f=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(f)return f},set:function(w){this.V=w}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof Yr?f:uf(f,this.objId,this.scope)},set:function(w){w=w.toString(),f=this instanceof Yr?w:w.substr(0,1)==="("?vo(w.substr(1,w.length-2)):vo(w)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Yr?vo(f.substr(1,f.length-1)):f},set:function(w){w=w.toString(),f=this instanceof Yr?"/"+w:w}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var g,m=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return m},set:function(w){w=!!w,m=w}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(g)return g},set:function(w){g=w}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,1)},set:function(w){w?this.Ff=Mr(this.Ff,1):this.Ff=Or(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,2)},set:function(w){w?this.Ff=Mr(this.Ff,2):this.Ff=Or(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,3)},set:function(w){w?this.Ff=Mr(this.Ff,3):this.Ff=Or(this.Ff,3)}});var b=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(b!==null)return b},set:function(w){if([0,1,2].indexOf(w)===-1)throw new Error('Invalid value "'+w+'" for attribute Q supplied.');b=w}}),Object.defineProperty(this,"textAlign",{get:function(){var w;switch(b){case 0:default:w="left";break;case 1:w="center";break;case 2:w="right"}return w},configurable:!0,enumerable:!0,set:function(w){switch(w){case"right":case 2:b=2;break;case"center":case 1:b=1;break;case"left":case 0:default:b=0}}})};Vi(Wn,is);var ka=function(){Wn.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var r=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return r},set:function(t){r=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return _g(e,this.objId,this.scope)},set:function(t){var i,n;n=[],typeof(i=t)=="string"&&(n=(function(s,a,o){o||(o=1);for(var l,h=[];l=a.exec(s);)h.push(l[o]);return h})(i,/\((.*?)\)/g)),e=n}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,i){for(i=i||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),i!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,18)},set:function(t){t?this.Ff=Mr(this.Ff,18):this.Ff=Or(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=Mr(this.Ff,19):this.Ff=Or(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,20)},set:function(t){t?(this.Ff=Mr(this.Ff,20),e.sort()):this.Ff=Or(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,22)},set:function(t){t?this.Ff=Mr(this.Ff,22):this.Ff=Or(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,23)},set:function(t){t?this.Ff=Mr(this.Ff,23):this.Ff=Or(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,27)},set:function(t){t?this.Ff=Mr(this.Ff,27):this.Ff=Or(this.Ff,27)}}),this.hasAppearanceStream=!1};Vi(ka,Wn);var Sa=function(){ka.call(this),this.fontName="helvetica",this.combo=!1};Vi(Sa,ka);var Ta=function(){Sa.call(this),this.combo=!0};Vi(Ta,Sa);var Ll=function(){Ta.call(this),this.edit=!0};Vi(Ll,Ta);var Yr=function(){Wn.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,15)},set:function(t){t?this.Ff=Mr(this.Ff,15):this.Ff=Or(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,16)},set:function(t){t?this.Ff=Mr(this.Ff,16):this.Ff=Or(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,17)},set:function(t){t?this.Ff=Mr(this.Ff,17):this.Ff=Or(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,26)},set:function(t){t?this.Ff=Mr(this.Ff,26):this.Ff=Or(this.Ff,26)}});var r,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(s){return s};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var i,n=[];for(i in n.push("<<"),e)n.push("/"+i+" ("+ja(t(e[i]))+")");return n.push(">>"),n.join(`
`)}},set:function(t){tr(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(t){r="/"+t}})};Vi(Yr,Wn);var Nl=function(){Yr.call(this),this.pushButton=!0};Vi(Nl,Yr);var Aa=function(){Yr.call(this),this.radio=!0,this.pushButton=!1;var r=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){r=e!==void 0?e:[]}})};Vi(Aa,Yr);var Lc=function(){var r,e;Wn.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return r},set:function(n){r=n}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(n){e=n}});var t,i={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(o){return o};this.scope&&(n=this.scope.internal.getEncryptor(this.objId));var s,a=[];for(s in a.push("<<"),i)a.push("/"+s+" ("+ja(n(i[s]))+")");return a.push(">>"),a.join(`
`)},set:function(n){tr(n)==="object"&&(i=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return i.CA||""},set:function(n){typeof n=="string"&&(i.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(n){t="/"+n}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=ot.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Vi(Lc,Wn),Aa.prototype.setAppearance=function(r){if(!("createAppearanceStream"in r)||!("getCA"in r))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=r.createAppearanceStream(t.optionName),t.caption=r.getCA()}},Aa.prototype.createOption=function(r){var e=new Lc;return e.Parent=this,e.optionName=r,this.Kids.push(e),wy.call(this.scope,e),e};var Pl=function(){Yr.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=ot.CheckBox.createAppearanceStream()};Vi(Pl,Yr);var ra=function(){Wn.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,13)},set:function(e){e?this.Ff=Mr(this.Ff,13):this.Ff=Or(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,21)},set:function(e){e?this.Ff=Mr(this.Ff,21):this.Ff=Or(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,23)},set:function(e){e?this.Ff=Mr(this.Ff,23):this.Ff=Or(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,24)},set:function(e){e?this.Ff=Mr(this.Ff,24):this.Ff=Or(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,25)},set:function(e){e?this.Ff=Mr(this.Ff,25):this.Ff=Or(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,26)},set:function(e){e?this.Ff=Mr(this.Ff,26):this.Ff=Or(this.Ff,26)}});var r=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return r},set:function(e){Number.isInteger(e)&&(r=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Vi(ra,Wn);var Dl=function(){ra.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,14)},set:function(r){r?this.Ff=Mr(this.Ff,14):this.Ff=Or(this.Ff,14)}}),this.password=!0};Vi(Dl,ra);var ot={CheckBox:{createAppearanceStream:function(){return{N:{On:ot.CheckBox.YesNormal},D:{On:ot.CheckBox.YesPushDown,Off:ot.CheckBox.OffPushDown}}},YesPushDown:function(r){var e=Zn(r);e.scope=r.scope;var t=[],i=r.scope.internal.getFont(r.fontName,r.fontStyle).id,n=r.scope.__private__.encodeColorString(r.color),s=Gf(r,r.caption);return t.push("0.749023 g"),t.push("0 0 "+Tt(ot.internal.getWidth(r))+" "+Tt(ot.internal.getHeight(r))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+i+" "+Tt(s.fontSize)+" Tf "+n),t.push("BT"),t.push(s.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(r){var e=Zn(r);e.scope=r.scope;var t=r.scope.internal.getFont(r.fontName,r.fontStyle).id,i=r.scope.__private__.encodeColorString(r.color),n=[],s=ot.internal.getHeight(r),a=ot.internal.getWidth(r),o=Gf(r,r.caption);return n.push("1 g"),n.push("0 0 "+Tt(a)+" "+Tt(s)+" re"),n.push("f"),n.push("q"),n.push("0 0 1 rg"),n.push("0 0 "+Tt(a-1)+" "+Tt(s-1)+" re"),n.push("W"),n.push("n"),n.push("0 g"),n.push("BT"),n.push("/"+t+" "+Tt(o.fontSize)+" Tf "+i),n.push(o.text),n.push("ET"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(r){var e=Zn(r);e.scope=r.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Tt(ot.internal.getWidth(r))+" "+Tt(ot.internal.getHeight(r))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(r){var e={D:{Off:ot.RadioButton.Circle.OffPushDown},N:{}};return e.N[r]=ot.RadioButton.Circle.YesNormal,e.D[r]=ot.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(r){var e=Zn(r);e.scope=r.scope;var t=[],i=ot.internal.getWidth(r)<=ot.internal.getHeight(r)?ot.internal.getWidth(r)/4:ot.internal.getHeight(r)/4;i=Number((.9*i).toFixed(5));var n=ot.internal.Bezier_C,s=Number((i*n).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+Xs(ot.internal.getWidth(r)/2)+" "+Xs(ot.internal.getHeight(r)/2)+" cm"),t.push(i+" 0 m"),t.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),t.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),t.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),t.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(r){var e=Zn(r);e.scope=r.scope;var t=[],i=ot.internal.getWidth(r)<=ot.internal.getHeight(r)?ot.internal.getWidth(r)/4:ot.internal.getHeight(r)/4;i=Number((.9*i).toFixed(5));var n=Number((2*i).toFixed(5)),s=Number((n*ot.internal.Bezier_C).toFixed(5)),a=Number((i*ot.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Xs(ot.internal.getWidth(r)/2)+" "+Xs(ot.internal.getHeight(r)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),t.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),t.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),t.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+Xs(ot.internal.getWidth(r)/2)+" "+Xs(ot.internal.getHeight(r)/2)+" cm"),t.push(i+" 0 m"),t.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),t.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),t.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),t.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(r){var e=Zn(r);e.scope=r.scope;var t=[],i=ot.internal.getWidth(r)<=ot.internal.getHeight(r)?ot.internal.getWidth(r)/4:ot.internal.getHeight(r)/4;i=Number((.9*i).toFixed(5));var n=Number((2*i).toFixed(5)),s=Number((n*ot.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Xs(ot.internal.getWidth(r)/2)+" "+Xs(ot.internal.getHeight(r)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),t.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),t.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),t.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(r){var e={D:{Off:ot.RadioButton.Cross.OffPushDown},N:{}};return e.N[r]=ot.RadioButton.Cross.YesNormal,e.D[r]=ot.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(r){var e=Zn(r);e.scope=r.scope;var t=[],i=ot.internal.calculateCross(r);return t.push("q"),t.push("1 1 "+Tt(ot.internal.getWidth(r)-2)+" "+Tt(ot.internal.getHeight(r)-2)+" re"),t.push("W"),t.push("n"),t.push(Tt(i.x1.x)+" "+Tt(i.x1.y)+" m"),t.push(Tt(i.x2.x)+" "+Tt(i.x2.y)+" l"),t.push(Tt(i.x4.x)+" "+Tt(i.x4.y)+" m"),t.push(Tt(i.x3.x)+" "+Tt(i.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(r){var e=Zn(r);e.scope=r.scope;var t=ot.internal.calculateCross(r),i=[];return i.push("0.749023 g"),i.push("0 0 "+Tt(ot.internal.getWidth(r))+" "+Tt(ot.internal.getHeight(r))+" re"),i.push("f"),i.push("q"),i.push("1 1 "+Tt(ot.internal.getWidth(r)-2)+" "+Tt(ot.internal.getHeight(r)-2)+" re"),i.push("W"),i.push("n"),i.push(Tt(t.x1.x)+" "+Tt(t.x1.y)+" m"),i.push(Tt(t.x2.x)+" "+Tt(t.x2.y)+" l"),i.push(Tt(t.x4.x)+" "+Tt(t.x4.y)+" m"),i.push(Tt(t.x3.x)+" "+Tt(t.x3.y)+" l"),i.push("s"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(r){var e=Zn(r);e.scope=r.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Tt(ot.internal.getWidth(r))+" "+Tt(ot.internal.getHeight(r))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(r){var e=r.scope.internal.getFont(r.fontName,r.fontStyle).id,t=r.scope.__private__.encodeColorString(r.color);return"/"+e+" "+r.fontSize+" Tf "+t}};ot.internal={Bezier_C:.551915024494,calculateCross:function(r){var e=ot.internal.getWidth(r),t=ot.internal.getHeight(r),i=Math.min(e,t);return{x1:{x:(e-i)/2,y:(t-i)/2+i},x2:{x:(e-i)/2+i,y:(t-i)/2},x3:{x:(e-i)/2,y:(t-i)/2},x4:{x:(e-i)/2+i,y:(t-i)/2+i}}}},ot.internal.getWidth=function(r){var e=0;return tr(r)==="object"&&(e=mp(r.Rect[2])),e},ot.internal.getHeight=function(r){var e=0;return tr(r)==="object"&&(e=mp(r.Rect[3])),e};var wy=kr.addField=function(r){if(by(this,r),!(r instanceof Wn))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=r).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),r.page=r.scope.internal.getCurrentPageInfo().pageNumber,this};kr.AcroFormChoiceField=ka,kr.AcroFormListBox=Sa,kr.AcroFormComboBox=Ta,kr.AcroFormEditBox=Ll,kr.AcroFormButton=Yr,kr.AcroFormPushButton=Nl,kr.AcroFormRadioButton=Aa,kr.AcroFormCheckBox=Pl,kr.AcroFormTextField=ra,kr.AcroFormPasswordField=Dl,kr.AcroFormAppearance=ot,kr.AcroForm={ChoiceField:ka,ListBox:Sa,ComboBox:Ta,EditBox:Ll,Button:Yr,PushButton:Nl,RadioButton:Aa,CheckBox:Pl,TextField:ra,PasswordField:Dl,Appearance:ot},dt.AcroForm={ChoiceField:ka,ListBox:Sa,ComboBox:Ta,EditBox:Ll,Button:Yr,PushButton:Nl,RadioButton:Aa,CheckBox:Pl,TextField:ra,PasswordField:Dl,Appearance:ot};var xy=dt.AcroForm;function Tg(r){return r.reduce((function(e,t,i){return e[t]=i,e}),{})}(function(r){r.__addimage__={};var e="UNKNOWN",t={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=r.__addimage__.getImageFileTypeByImageData=function(R,k){var M,V,oe,K,Y,se=e;if((k=k||e)==="RGBA"||R.data!==void 0&&R.data instanceof Uint8ClampedArray&&"height"in R&&"width"in R)return"RGBA";if(D(R))for(Y in t)for(oe=t[Y],M=0;M<oe.length;M+=1){for(K=!0,V=0;V<oe[M].length;V+=1)if(oe[M][V]!==void 0&&oe[M][V]!==R[V]){K=!1;break}if(K===!0){se=Y;break}}else for(Y in t)for(oe=t[Y],M=0;M<oe.length;M+=1){for(K=!0,V=0;V<oe[M].length;V+=1)if(oe[M][V]!==void 0&&oe[M][V]!==R.charCodeAt(V)){K=!1;break}if(K===!0){se=Y;break}}return se===e&&k!==e&&(se=k),se},n=function R(k){for(var M=this.internal.write,V=this.internal.putStream,oe=(0,this.internal.getFilters)();oe.indexOf("FlateEncode")!==-1;)oe.splice(oe.indexOf("FlateEncode"),1);k.objectId=this.internal.newObject();var K=[];if(K.push({key:"Type",value:"/XObject"}),K.push({key:"Subtype",value:"/Image"}),K.push({key:"Width",value:k.width}),K.push({key:"Height",value:k.height}),k.colorSpace===b.INDEXED?K.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(k.palette.length/3-1)+" "+("sMask"in k&&k.sMask!==void 0?k.objectId+2:k.objectId+1)+" 0 R]"}):(K.push({key:"ColorSpace",value:"/"+k.colorSpace}),k.colorSpace===b.DEVICE_CMYK&&K.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),K.push({key:"BitsPerComponent",value:k.bitsPerComponent}),"decodeParameters"in k&&k.decodeParameters!==void 0&&K.push({key:"DecodeParms",value:"<<"+k.decodeParameters+">>"}),"transparency"in k&&Array.isArray(k.transparency)){for(var Y="",se=0,q=k.transparency.length;se<q;se++)Y+=k.transparency[se]+" "+k.transparency[se]+" ";K.push({key:"Mask",value:"["+Y+"]"})}k.sMask!==void 0&&K.push({key:"SMask",value:k.objectId+1+" 0 R"});var fe=k.filter!==void 0?["/"+k.filter]:void 0;if(V({data:k.data,additionalKeyValues:K,alreadyAppliedFilters:fe,objectId:k.objectId}),M("endobj"),"sMask"in k&&k.sMask!==void 0){var ge="/Predictor "+k.predictor+" /Colors 1 /BitsPerComponent "+k.bitsPerComponent+" /Columns "+k.width,_={width:k.width,height:k.height,colorSpace:"DeviceGray",bitsPerComponent:k.bitsPerComponent,decodeParameters:ge,data:k.sMask};"filter"in k&&(_.filter=k.filter),R.call(this,_)}if(k.colorSpace===b.INDEXED){var P=this.internal.newObject();V({data:A(new Uint8Array(k.palette)),objectId:P}),M("endobj")}},s=function(){var R=this.internal.collections.addImage_images;for(var k in R)n.call(this,R[k])},a=function(){var R,k=this.internal.collections.addImage_images,M=this.internal.write;for(var V in k)M("/I"+(R=k[V]).index,R.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",a))},l=function(){var R=this.internal.collections.addImage_images;return o.call(this),R},h=function(){return Object.keys(this.internal.collections.addImage_images).length},c=function(R){return typeof r["process"+R.toUpperCase()]=="function"},d=function(R){return tr(R)==="object"&&R.nodeType===1},p=function(R,k){if(R.nodeName==="IMG"&&R.hasAttribute("src")){var M=""+R.getAttribute("src");if(M.indexOf("data:image/")===0)return Rl(unescape(M).split("base64,").pop());var V=r.loadFile(M,!0);if(V!==void 0)return V}if(R.nodeName==="CANVAS"){if(R.width===0||R.height===0)throw new Error("Given canvas must have data. Canvas width: "+R.width+", height: "+R.height);var oe;switch(k){case"PNG":oe="image/png";break;case"WEBP":oe="image/webp";break;case"JPEG":case"JPG":default:oe="image/jpeg"}return Rl(R.toDataURL(oe,1).split("base64,").pop())}},f=function(R){var k=this.internal.collections.addImage_images;if(k){for(var M in k)if(R===k[M].alias)return k[M]}},g=function(R,k,M){return R||k||(R=-96,k=-96),R<0&&(R=-1*M.width*72/R/this.internal.scaleFactor),k<0&&(k=-1*M.height*72/k/this.internal.scaleFactor),R===0&&(R=k*M.width/M.height),k===0&&(k=R*M.height/M.width),[R,k]},m=function(R,k,M,V,oe,K){var Y=g.call(this,M,V,oe),se=this.internal.getCoordinateString,q=this.internal.getVerticalCoordinateString,fe=l.call(this);if(M=Y[0],V=Y[1],fe[oe.index]=oe,K){K*=Math.PI/180;var ge=Math.cos(K),_=Math.sin(K),P=function(I){return I.toFixed(4)},N=[P(ge),P(_),P(-1*_),P(ge),0,0,"cm"]}this.internal.write("q"),K?(this.internal.write([1,"0","0",1,se(R),q(k+V),"cm"].join(" ")),this.internal.write(N.join(" ")),this.internal.write([se(M),"0","0",se(V),"0","0","cm"].join(" "))):this.internal.write([se(M),"0","0",se(V),se(R),q(k+V),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+oe.index+" Do"),this.internal.write("Q")},b=r.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};r.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var w=r.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},E=r.__addimage__.sHashCode=function(R){var k,M,V=0;if(typeof R=="string")for(M=R.length,k=0;k<M;k++)V=(V<<5)-V+R.charCodeAt(k),V|=0;else if(D(R))for(M=R.byteLength/2,k=0;k<M;k++)V=(V<<5)-V+R[k],V|=0;return V},C=r.__addimage__.validateStringAsBase64=function(R){(R=R||"").toString().trim();var k=!0;return R.length===0&&(k=!1),R.length%4!=0&&(k=!1),/^[A-Za-z0-9+/]+$/.test(R.substr(0,R.length-2))===!1&&(k=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(R.substr(-2))===!1&&(k=!1),k},F=r.__addimage__.extractImageFromDataUrl=function(R){var k=(R=R||"").split("base64,"),M=null;if(k.length===2){var V=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(k[0]);Array.isArray(V)&&(M={mimeType:V[1],charset:V[2],data:k[1]})}return M},L=r.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};r.__addimage__.isArrayBuffer=function(R){return L()&&R instanceof ArrayBuffer};var D=r.__addimage__.isArrayBufferView=function(R){return L()&&typeof Uint32Array<"u"&&(R instanceof Int8Array||R instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&R instanceof Uint8ClampedArray||R instanceof Int16Array||R instanceof Uint16Array||R instanceof Int32Array||R instanceof Uint32Array||R instanceof Float32Array||R instanceof Float64Array)},S=r.__addimage__.binaryStringToUint8Array=function(R){for(var k=R.length,M=new Uint8Array(k),V=0;V<k;V++)M[V]=R.charCodeAt(V);return M},A=r.__addimage__.arrayBufferToBinaryString=function(R){for(var k="",M=D(R)?R:new Uint8Array(R),V=0;V<M.length;V+=8192)k+=String.fromCharCode.apply(null,M.subarray(V,V+8192));return k};r.addImage=function(){var R,k,M,V,oe,K,Y,se,q;if(typeof arguments[1]=="number"?(k=e,M=arguments[1],V=arguments[2],oe=arguments[3],K=arguments[4],Y=arguments[5],se=arguments[6],q=arguments[7]):(k=arguments[1],M=arguments[2],V=arguments[3],oe=arguments[4],K=arguments[5],Y=arguments[6],se=arguments[7],q=arguments[8]),tr(R=arguments[0])==="object"&&!d(R)&&"imageData"in R){var fe=R;R=fe.imageData,k=fe.format||k||e,M=fe.x||M||0,V=fe.y||V||0,oe=fe.w||fe.width||oe,K=fe.h||fe.height||K,Y=fe.alias||Y,se=fe.compression||se,q=fe.rotation||fe.angle||q}var ge=this.internal.getFilters();if(se===void 0&&ge.indexOf("FlateEncode")!==-1&&(se="SLOW"),isNaN(M)||isNaN(V))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var _=O.call(this,R,k,Y,se);return m.call(this,M,V,oe,K,_,q),this};var O=function(R,k,M,V){var oe,K,Y;if(typeof R=="string"&&i(R)===e){R=unescape(R);var se=U(R,!1);(se!==""||(se=r.loadFile(R,!0))!==void 0)&&(R=se)}if(d(R)&&(R=p(R,k)),k=i(R,k),!c(k))throw new Error("addImage does not support files of type '"+k+"', please ensure that a plugin for '"+k+"' support is added.");if(((Y=M)==null||Y.length===0)&&(M=(function(q){return typeof q=="string"||D(q)?E(q):D(q.data)?E(q.data):null})(R)),(oe=f.call(this,M))||(L()&&(R instanceof Uint8Array||k==="RGBA"||(K=R,R=S(R))),oe=this["process"+k.toUpperCase()](R,h.call(this),M,(function(q){return q&&typeof q=="string"&&(q=q.toUpperCase()),q in r.image_compression?q:w.NONE})(V),K)),!oe)throw new Error("An unknown error occurred whilst processing the image.");return oe},U=r.__addimage__.convertBase64ToBinaryString=function(R,k){var M;k=typeof k!="boolean"||k;var V,oe="";if(typeof R=="string"){V=(M=F(R))!==null?M.data:R;try{oe=Rl(V)}catch(K){if(k)throw C(V)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+K.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return oe};r.getImageProperties=function(R){var k,M,V="";if(d(R)&&(R=p(R)),typeof R=="string"&&i(R)===e&&((V=U(R,!1))===""&&(V=r.loadFile(R)||""),R=V),M=i(R),!c(M))throw new Error("addImage does not support files of type '"+M+"', please ensure that a plugin for '"+M+"' support is added.");if(!L()||R instanceof Uint8Array||(R=S(R)),!(k=this["process"+M.toUpperCase()](R)))throw new Error("An unknown error occurred whilst processing the image");return k.fileType=M,k}})(dt.API),(function(r){var e=function(t){if(t!==void 0&&t!="")return!0};dt.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),r.events.push(["putPage",function(t){for(var i,n,s,a=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(t.objId),h=t.pageContext.annotations,c=!1,d=0;d<h.length&&!c;d++)switch((i=h[d]).type){case"link":(e(i.options.url)||e(i.options.pageNumber))&&(c=!0);break;case"reference":case"text":case"freetext":c=!0}if(c!=0){this.internal.write("/Annots [");for(var p=0;p<h.length;p++){i=h[p];var f=this.internal.pdfEscape,g=this.internal.getEncryptor(t.objId);switch(i.type){case"reference":this.internal.write(" "+i.object.objId+" 0 R ");break;case"text":var m=this.internal.newAdditionalObject(),b=this.internal.newAdditionalObject(),w=this.internal.getEncryptor(m.objId),E=i.title||"Note";s="<</Type /Annot /Subtype /Text "+(n="/Rect ["+a(i.bounds.x)+" "+o(i.bounds.y+i.bounds.h)+" "+a(i.bounds.x+i.bounds.w)+" "+o(i.bounds.y)+"] ")+"/Contents ("+f(w(i.contents))+")",s+=" /Popup "+b.objId+" 0 R",s+=" /P "+l.objId+" 0 R",s+=" /T ("+f(w(E))+") >>",m.content=s;var C=m.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+a(i.bounds.x+30)+" "+o(i.bounds.y+i.bounds.h)+" "+a(i.bounds.x+i.bounds.w+30)+" "+o(i.bounds.y)+"] ")+" /Parent "+C,i.open&&(s+=" /Open true"),s+=" >>",b.content=s,this.internal.write(m.objId,"0 R",b.objId,"0 R");break;case"freetext":n="/Rect ["+a(i.bounds.x)+" "+o(i.bounds.y)+" "+a(i.bounds.x+i.bounds.w)+" "+o(i.bounds.y+i.bounds.h)+"] ";var F=i.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+f(g(i.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+F+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(i.options.name){var L=this.annotations._nameMap[i.options.name];i.options.pageNumber=L.page,i.options.top=L.y}else i.options.top||(i.options.top=0);if(n="/Rect ["+i.finalBounds.x+" "+i.finalBounds.y+" "+i.finalBounds.w+" "+i.finalBounds.h+"] ",s="",i.options.url)s="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+f(g(i.options.url))+") >>";else if(i.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(i.options.pageNumber).objId+" 0 R",i.options.magFactor=i.options.magFactor||"XYZ",i.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+i.options.top+"]";break;case"FitV":i.options.left=i.options.left||0,s+=" /FitV "+i.options.left+"]";break;case"XYZ":default:var D=o(i.options.top);i.options.left=i.options.left||0,i.options.zoom===void 0&&(i.options.zoom=0),s+=" /XYZ "+i.options.left+" "+D+" "+i.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),r.createAnnotation=function(t){var i=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":i.pageContext.annotations.push(t)}},r.link=function(t,i,n,s,a){var o=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,h=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:l(t),y:h(i),w:l(t+n),h:h(i+s)},options:a,type:"link"})},r.textWithLink=function(t,i,n,s){var a,o,l=this.getTextWidth(t),h=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){o=s.maxWidth;var c=this.splitTextToSize(t,o).length;a=Math.ceil(h*c)}else o=l,a=h;return this.text(t,i,n,s),n+=.2*h,s.align==="center"&&(i-=l/2),s.align==="right"&&(i-=l),this.link(i,n-h,o,a,s),l},r.getTextWidth=function(t){var i=this.internal.getFontSize();return this.getStringUnitWidth(t)*i/this.internal.scaleFactor}})(dt.API),(function(r){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},i={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},n=[1570,1571,1573,1575];r.__arabicParser__={};var s=r.__arabicParser__.isInArabicSubstitutionA=function(m){return e[m.charCodeAt(0)]!==void 0},a=r.__arabicParser__.isArabicLetter=function(m){return typeof m=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(m)},o=r.__arabicParser__.isArabicEndLetter=function(m){return a(m)&&s(m)&&e[m.charCodeAt(0)].length<=2},l=r.__arabicParser__.isArabicAlfLetter=function(m){return a(m)&&n.indexOf(m.charCodeAt(0))>=0};r.__arabicParser__.arabicLetterHasIsolatedForm=function(m){return a(m)&&s(m)&&e[m.charCodeAt(0)].length>=1};var h=r.__arabicParser__.arabicLetterHasFinalForm=function(m){return a(m)&&s(m)&&e[m.charCodeAt(0)].length>=2};r.__arabicParser__.arabicLetterHasInitialForm=function(m){return a(m)&&s(m)&&e[m.charCodeAt(0)].length>=3};var c=r.__arabicParser__.arabicLetterHasMedialForm=function(m){return a(m)&&s(m)&&e[m.charCodeAt(0)].length==4},d=r.__arabicParser__.resolveLigatures=function(m){var b=0,w=t,E="",C=0;for(b=0;b<m.length;b+=1)w[m.charCodeAt(b)]!==void 0?(C++,typeof(w=w[m.charCodeAt(b)])=="number"&&(E+=String.fromCharCode(w),w=t,C=0),b===m.length-1&&(w=t,E+=m.charAt(b-(C-1)),b-=C-1,C=0)):(w=t,E+=m.charAt(b-C),b-=C,C=0);return E};r.__arabicParser__.isArabicDiacritic=function(m){return m!==void 0&&i[m.charCodeAt(0)]!==void 0};var p=r.__arabicParser__.getCorrectForm=function(m,b,w){return a(m)?s(m)===!1?-1:!h(m)||!a(b)&&!a(w)||!a(w)&&o(b)||o(m)&&!a(b)||o(m)&&l(b)||o(m)&&o(b)?0:c(m)&&a(b)&&!o(b)&&a(w)&&h(w)?3:o(m)||!a(w)?1:2:-1},f=function(m){var b=0,w=0,E=0,C="",F="",L="",D=(m=m||"").split("\\s+"),S=[];for(b=0;b<D.length;b+=1){for(S.push(""),w=0;w<D[b].length;w+=1)C=D[b][w],F=D[b][w-1],L=D[b][w+1],a(C)?(E=p(C,F,L),S[b]+=E!==-1?String.fromCharCode(e[C.charCodeAt(0)][E]):C):S[b]+=C;S[b]=d(S[b])}return S.join(" ")},g=r.__arabicParser__.processArabic=r.processArabic=function(){var m,b=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,w=[];if(Array.isArray(b)){var E=0;for(w=[],E=0;E<b.length;E+=1)Array.isArray(b[E])?w.push([f(b[E][0]),b[E][1],b[E][2]]):w.push([f(b[E])]);m=w}else m=f(b);return typeof arguments[0]=="string"?m:(arguments[0].text=m,arguments[0])};r.events.push(["preProcessText",g])})(dt.API),dt.API.autoPrint=function(r){var e;switch((r=r||{}).variant=r.variant||"non-conform",r.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",(function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")})),this.internal.events.subscribe("putCatalog",(function(){this.internal.out("/OpenAction "+e+" 0 R")}))}return this},(function(r){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(o){t=o}});var i=150;Object.defineProperty(this,"width",{get:function(){return i},set:function(o){i=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=i+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(o){s=o}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(o){a=o}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,i){var n;if((t=t||"2d")!=="2d")return null;for(n in i)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=i[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},r.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(dt.API),(function(r){var e={left:0,top:0,bottom:0,right:0},t=!1,i=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),n.call(this))},n=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(m){l=m}});var h=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return h},set:function(m){h=m}});var c=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return c},set:function(m){c=m}});var d=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return d},set:function(m){d=m}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(m){p=m}});var f=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return f},set:function(m){f=m}});var g=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return g},set:function(m){g=m}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},r.setHeaderFunction=function(l){return i.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},r.getTextDimensions=function(l,h){i.call(this);var c=(h=h||{}).fontSize||this.getFontSize(),d=h.font||this.getFont(),p=h.scaleFactor||this.internal.scaleFactor,f=0,g=0,m=0,b=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var w=h.maxWidth;w>0?typeof l=="string"?l=this.splitTextToSize(l,w):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce((function(C,F){return C.concat(b.splitTextToSize(F,w))}),[])):l=Array.isArray(l)?l:[l];for(var E=0;E<l.length;E++)f<(m=this.getStringUnitWidth(l[E],{font:d})*c)&&(f=m);return f!==0&&(g=l.length),{w:f/=p,h:Math.max((g*c*this.getLineHeightFactor()-c*(this.getLineHeightFactor()-1))/p,0)}},r.cellAddPage=function(){i.call(this),this.addPage();var l=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var a=r.cell=function(){var l;l=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),i.call(this);var h=this.internal.__cell__.lastCell,c=this.internal.__cell__.padding,d=this.internal.__cell__.margins||e,p=this.internal.__cell__.tableHeaderRow,f=this.internal.__cell__.printHeaders;return h.lineNumber!==void 0&&(h.lineNumber===l.lineNumber?(l.x=(h.x||0)+(h.width||0),l.y=h.y||0):h.y+h.height+l.height+d.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=d.top,f&&p&&(this.printHeaderRow(l.lineNumber,!0),l.y+=p[0].height)):l.y=h.y+h.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,t===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-c,l.y+c,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+c,{align:"center",baseline:"top",maxWidth:l.width-c-c}):this.text(l.text,l.x+c,l.y+c,{align:"left",baseline:"top",maxWidth:l.width-c-c})),this.internal.__cell__.lastCell=l,this};r.table=function(l,h,c,d,p){if(i.call(this),!c)throw new Error("No data for PDF table.");var f,g,m,b,w=[],E=[],C=[],F={},L={},D=[],S=[],A=(p=p||{}).autoSize||!1,O=p.printHeaders!==!1,U=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,R=p.margins||Object.assign({width:this.getPageWidth()},e),k=typeof p.padding=="number"?p.padding:3,M=p.headerBackgroundColor||"#c8c8c8",V=p.headerTextColor||"#000";if(n.call(this),this.internal.__cell__.printHeaders=O,this.internal.__cell__.margins=R,this.internal.__cell__.table_font_size=U,this.internal.__cell__.padding=k,this.internal.__cell__.headerBackgroundColor=M,this.internal.__cell__.headerTextColor=V,this.setFontSize(U),d==null)E=w=Object.keys(c[0]),C=w.map((function(){return"left"}));else if(Array.isArray(d)&&tr(d[0])==="object")for(w=d.map((function(fe){return fe.name})),E=d.map((function(fe){return fe.prompt||fe.name||""})),C=d.map((function(fe){return fe.align||"left"})),f=0;f<d.length;f+=1)L[d[f].name]=d[f].width*(19.049976/25.4);else Array.isArray(d)&&typeof d[0]=="string"&&(E=w=d,C=w.map((function(){return"left"})));if(A||Array.isArray(d)&&typeof d[0]=="string")for(f=0;f<w.length;f+=1){for(F[b=w[f]]=c.map((function(fe){return fe[b]})),this.setFont(void 0,"bold"),D.push(this.getTextDimensions(E[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),g=F[b],this.setFont(void 0,"normal"),m=0;m<g.length;m+=1)D.push(this.getTextDimensions(g[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);L[b]=Math.max.apply(null,D)+k+k,D=[]}if(O){var oe={};for(f=0;f<w.length;f+=1)oe[w[f]]={},oe[w[f]].text=E[f],oe[w[f]].align=C[f];var K=o.call(this,oe,L);S=w.map((function(fe){return new s(l,h,L[fe],K,oe[fe].text,void 0,oe[fe].align)})),this.setTableHeaderRow(S),this.printHeaderRow(1,!1)}var Y=d.reduce((function(fe,ge){return fe[ge.name]=ge.align,fe}),{});for(f=0;f<c.length;f+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:f,data:c[f]},this);var se=o.call(this,c[f],L);for(m=0;m<w.length;m+=1){var q=c[f][w[m]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:f,col:m,data:q},this),a.call(this,new s(l,h,L[w[m]],se,q,f+2,Y[w[m]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=h,this};var o=function(l,h){var c=this.internal.__cell__.padding,d=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(l).map((function(f){var g=l[f];return this.splitTextToSize(g.hasOwnProperty("text")?g.text:g,h[f]-c-c)}),this).map((function(f){return this.getLineHeightFactor()*f.length*d/p+c+c}),this).reduce((function(f,g){return Math.max(f,g)}),0)};r.setTableHeaderRow=function(l){i.call(this),this.internal.__cell__.tableHeaderRow=l},r.printHeaderRow=function(l,h){if(i.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var c;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var d=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(d[0],d[1],d[2],d[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],f=0;f<this.internal.__cell__.tableHeaderRow.length;f+=1){c=this.internal.__cell__.tableHeaderRow[f].clone(),h&&(c.y=this.internal.__cell__.margins.top||0,p.push(c)),c.lineNumber=l;var g=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),a.call(this,c),this.setTextColor(g)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),t=!1}})(dt.API);var Ag={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Fg=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],qf=Tg(Fg),Rg=[100,200,300,400,500,600,700,800,900],yy=Tg(Rg);function Xf(r){var e=r.family.replace(/"|'/g,"").toLowerCase(),t=(function(s){return Ag[s=s||"normal"]?s:"normal"})(r.style),i=(function(s){if(!s)return 400;if(typeof s=="number")return s>=100&&s<=900&&s%100==0?s:400;if(/^\d00$/.test(s))return parseInt(s);switch(s){case"bold":return 700;case"normal":default:return 400}})(r.weight),n=(function(s){return typeof qf[s=s||"normal"]=="number"?s:"normal"})(r.stretch);return{family:e,style:t,weight:i,stretch:n,src:r.src||[],ref:r.ref||{name:e,style:[n,t,i].join(" ")}}}function gp(r,e,t,i){var n;for(n=t;n>=0&&n<e.length;n+=i)if(r[e[n]])return r[e[n]];for(n=t;n>=0&&n<e.length;n-=i)if(r[e[n]])return r[e[n]]}var Ey={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},vp={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function bp(r){return[r.stretch,r.style,r.weight,r.family].join(" ")}function Cy(r,e,t){for(var i=(t=t||{}).defaultFontFamily||"times",n=Object.assign({},Ey,t.genericFontFamilies||{}),s=null,a=null,o=0;o<e.length;++o)if(n[(s=Xf(e[o])).family]&&(s.family=n[s.family]),r.hasOwnProperty(s.family)){a=r[s.family];break}if(!(a=a||r[i]))throw new Error("Could not find a font-family for the rule '"+bp(s)+"' and default family '"+i+"'.");if(a=(function(l,h){if(h[l])return h[l];var c=qf[l],d=c<=qf.normal?-1:1,p=gp(h,Fg,c,d);if(!p)throw new Error("Could not find a matching font-stretch value for "+l);return p})(s.stretch,a),a=(function(l,h){if(h[l])return h[l];for(var c=Ag[l],d=0;d<c.length;++d)if(h[c[d]])return h[c[d]];throw new Error("Could not find a matching font-style for "+l)})(s.style,a),!(a=(function(l,h){if(h[l])return h[l];if(l===400&&h[500])return h[500];if(l===500&&h[400])return h[400];var c=yy[l],d=gp(h,Rg,c,l<400?-1:1);if(!d)throw new Error("Could not find a matching font-weight for value "+l);return d})(s.weight,a)))throw new Error("Failed to resolve a font for the rule '"+bp(s)+"'.");return a}function wp(r){return r.trimLeft()}function _y(r,e){for(var t=0;t<r.length;){if(r.charAt(t)===e)return[r.substring(0,t),r.substring(t+1)];t+=1}return null}function ky(r){var e=r.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],r.substring(e[0].length)]}var oc,xp,yp,ff=["times"];(function(r){var e,t,i,n,s,a,o,l,h,c=function(_){return _=_||{},this.isStrokeTransparent=_.isStrokeTransparent||!1,this.strokeOpacity=_.strokeOpacity||1,this.strokeStyle=_.strokeStyle||"#000000",this.fillStyle=_.fillStyle||"#000000",this.isFillTransparent=_.isFillTransparent||!1,this.fillOpacity=_.fillOpacity||1,this.font=_.font||"10px sans-serif",this.textBaseline=_.textBaseline||"alphabetic",this.textAlign=_.textAlign||"left",this.lineWidth=_.lineWidth||1,this.lineJoin=_.lineJoin||"miter",this.lineCap=_.lineCap||"butt",this.path=_.path||[],this.transform=_.transform!==void 0?_.transform.clone():new l,this.globalCompositeOperation=_.globalCompositeOperation||"normal",this.globalAlpha=_.globalAlpha||1,this.clip_path=_.clip_path||[],this.currentPoint=_.currentPoint||new a,this.miterLimit=_.miterLimit||10,this.lastPoint=_.lastPoint||new a,this.lineDashOffset=_.lineDashOffset||0,this.lineDash=_.lineDash||[],this.margin=_.margin||[0,0,0,0],this.prevPageLastElemOffset=_.prevPageLastElemOffset||0,this.ignoreClearRect=typeof _.ignoreClearRect!="boolean"||_.ignoreClearRect,this};r.events.push(["initialized",function(){this.context2d=new d(this),e=this.internal.f2,t=this.internal.getCoordinateString,i=this.internal.getVerticalCoordinateString,n=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,a=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,h=new c}]);var d=function(_){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var P=_;Object.defineProperty(this,"pdf",{get:function(){return P}});var N=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return N},set:function(Se){N=!!Se}});var I=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return I},set:function(Se){I=!!Se}});var X=0;Object.defineProperty(this,"posX",{get:function(){return X},set:function(Se){isNaN(Se)||(X=Se)}});var he=0;Object.defineProperty(this,"posY",{get:function(){return he},set:function(Se){isNaN(Se)||(he=Se)}}),Object.defineProperty(this,"margin",{get:function(){return h.margin},set:function(Se){var re;typeof Se=="number"?re=[Se,Se,Se,Se]:((re=new Array(4))[0]=Se[0],re[1]=Se.length>=2?Se[1]:re[0],re[2]=Se.length>=3?Se[2]:re[0],re[3]=Se.length>=4?Se[3]:re[1]),h.margin=re}});var ce=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ce},set:function(Se){ce=Se}});var ue=0;Object.defineProperty(this,"lastBreak",{get:function(){return ue},set:function(Se){ue=Se}});var be=[];Object.defineProperty(this,"pageBreaks",{get:function(){return be},set:function(Se){be=Se}}),Object.defineProperty(this,"ctx",{get:function(){return h},set:function(Se){Se instanceof c&&(h=Se)}}),Object.defineProperty(this,"path",{get:function(){return h.path},set:function(Se){h.path=Se}});var Le=[];Object.defineProperty(this,"ctxStack",{get:function(){return Le},set:function(Se){Le=Se}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Se){var re;re=p(Se),this.ctx.fillStyle=re.style,this.ctx.isFillTransparent=re.a===0,this.ctx.fillOpacity=re.a,this.pdf.setFillColor(re.r,re.g,re.b,{a:re.a}),this.pdf.setTextColor(re.r,re.g,re.b,{a:re.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Se){var re=p(Se);this.ctx.strokeStyle=re.style,this.ctx.isStrokeTransparent=re.a===0,this.ctx.strokeOpacity=re.a,re.a===0?this.pdf.setDrawColor(255,255,255):(re.a,this.pdf.setDrawColor(re.r,re.g,re.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Se){["butt","round","square"].indexOf(Se)!==-1&&(this.ctx.lineCap=Se,this.pdf.setLineCap(Se))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Se){isNaN(Se)||(this.ctx.lineWidth=Se,this.pdf.setLineWidth(Se))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Se){["bevel","round","miter"].indexOf(Se)!==-1&&(this.ctx.lineJoin=Se,this.pdf.setLineJoin(Se))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Se){isNaN(Se)||(this.ctx.miterLimit=Se,this.pdf.setMiterLimit(Se))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Se){this.ctx.textBaseline=Se}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Se){["right","end","center","left","start"].indexOf(Se)!==-1&&(this.ctx.textAlign=Se)}});var Z=null;function Ue(Se,re){if(Z===null){var De=(function(Je){var He=[];return Object.keys(Je).forEach((function(qe){Je[qe].forEach((function(Ze){var Qe=null;switch(Ze){case"bold":Qe={family:qe,weight:"bold"};break;case"italic":Qe={family:qe,style:"italic"};break;case"bolditalic":Qe={family:qe,weight:"bold",style:"italic"};break;case"":case"normal":Qe={family:qe}}Qe!==null&&(Qe.ref={name:qe,style:Ze},He.push(Qe))}))})),He})(Se.getFontList());Z=(function(Je){for(var He={},qe=0;qe<Je.length;++qe){var Ze=Xf(Je[qe]),Qe=Ze.family,lt=Ze.stretch,ht=Ze.style,bt=Ze.weight;He[Qe]=He[Qe]||{},He[Qe][lt]=He[Qe][lt]||{},He[Qe][lt][ht]=He[Qe][lt][ht]||{},He[Qe][lt][ht][bt]=Ze}return He})(De.concat(re))}return Z}var Ye=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ye},set:function(Se){Z=null,Ye=Se}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Se){var re;if(this.ctx.font=Se,(re=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Se))!==null){var De=re[1],Je=(re[2],re[3]),He=re[4],qe=(re[5],re[6]),Ze=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(He)[2];He=Math.floor(Ze==="px"?parseFloat(He)*this.pdf.internal.scaleFactor:Ze==="em"?parseFloat(He)*this.pdf.getFontSize():parseFloat(He)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(He);var Qe=(function(ct){var tt,Ve,$t=[],pt=ct.trim();if(pt==="")return ff;if(pt in vp)return[vp[pt]];for(;pt!=="";){switch(Ve=null,tt=(pt=wp(pt)).charAt(0)){case'"':case"'":Ve=_y(pt.substring(1),tt);break;default:Ve=ky(pt)}if(Ve===null||($t.push(Ve[0]),(pt=wp(Ve[1]))!==""&&pt.charAt(0)!==","))return ff;pt=pt.replace(/^,/,"")}return $t})(qe);if(this.fontFaces){var lt=Cy(Ue(this.pdf,this.fontFaces),Qe.map((function(ct){return{family:ct,stretch:"normal",weight:Je,style:De}})));this.pdf.setFont(lt.ref.name,lt.ref.style)}else{var ht="";(Je==="bold"||parseInt(Je,10)>=700||De==="bold")&&(ht="bold"),De==="italic"&&(ht+="italic"),ht.length===0&&(ht="normal");for(var bt="",Et={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Mt=0;Mt<Qe.length;Mt++){if(this.pdf.internal.getFont(Qe[Mt],ht,{noFallback:!0,disableWarning:!0})!==void 0){bt=Qe[Mt];break}if(ht==="bolditalic"&&this.pdf.internal.getFont(Qe[Mt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)bt=Qe[Mt],ht="bold";else if(this.pdf.internal.getFont(Qe[Mt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){bt=Qe[Mt],ht="normal";break}}if(bt===""){for(var St=0;St<Qe.length;St++)if(Et[Qe[St]]){bt=Et[Qe[St]];break}}bt=bt===""?"Times":bt,this.pdf.setFont(bt,ht)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Se){this.ctx.globalCompositeOperation=Se}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Se){this.ctx.globalAlpha=Se}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Se){this.ctx.lineDashOffset=Se,ge.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Se){this.ctx.lineDash=Se,ge.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Se){this.ctx.ignoreClearRect=!!Se}})};d.prototype.setLineDash=function(_){this.lineDash=_},d.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},d.prototype.fill=function(){F.call(this,"fill",!1)},d.prototype.stroke=function(){F.call(this,"stroke",!1)},d.prototype.beginPath=function(){this.path=[{type:"begin"}]},d.prototype.moveTo=function(_,P){if(isNaN(_)||isNaN(P))throw lr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var N=this.ctx.transform.applyToPoint(new a(_,P));this.path.push({type:"mt",x:N.x,y:N.y}),this.ctx.lastPoint=new a(_,P)},d.prototype.closePath=function(){var _=new a(0,0),P=0;for(P=this.path.length-1;P!==-1;P--)if(this.path[P].type==="begin"&&tr(this.path[P+1])==="object"&&typeof this.path[P+1].x=="number"){_=new a(this.path[P+1].x,this.path[P+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new a(_.x,_.y)},d.prototype.lineTo=function(_,P){if(isNaN(_)||isNaN(P))throw lr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var N=this.ctx.transform.applyToPoint(new a(_,P));this.path.push({type:"lt",x:N.x,y:N.y}),this.ctx.lastPoint=new a(N.x,N.y)},d.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),F.call(this,null,!0)},d.prototype.quadraticCurveTo=function(_,P,N,I){if(isNaN(N)||isNaN(I)||isNaN(_)||isNaN(P))throw lr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var X=this.ctx.transform.applyToPoint(new a(N,I)),he=this.ctx.transform.applyToPoint(new a(_,P));this.path.push({type:"qct",x1:he.x,y1:he.y,x:X.x,y:X.y}),this.ctx.lastPoint=new a(X.x,X.y)},d.prototype.bezierCurveTo=function(_,P,N,I,X,he){if(isNaN(X)||isNaN(he)||isNaN(_)||isNaN(P)||isNaN(N)||isNaN(I))throw lr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ce=this.ctx.transform.applyToPoint(new a(X,he)),ue=this.ctx.transform.applyToPoint(new a(_,P)),be=this.ctx.transform.applyToPoint(new a(N,I));this.path.push({type:"bct",x1:ue.x,y1:ue.y,x2:be.x,y2:be.y,x:ce.x,y:ce.y}),this.ctx.lastPoint=new a(ce.x,ce.y)},d.prototype.arc=function(_,P,N,I,X,he){if(isNaN(_)||isNaN(P)||isNaN(N)||isNaN(I)||isNaN(X))throw lr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(he=!!he,!this.ctx.transform.isIdentity){var ce=this.ctx.transform.applyToPoint(new a(_,P));_=ce.x,P=ce.y;var ue=this.ctx.transform.applyToPoint(new a(0,N)),be=this.ctx.transform.applyToPoint(new a(0,0));N=Math.sqrt(Math.pow(ue.x-be.x,2)+Math.pow(ue.y-be.y,2))}Math.abs(X-I)>=2*Math.PI&&(I=0,X=2*Math.PI),this.path.push({type:"arc",x:_,y:P,radius:N,startAngle:I,endAngle:X,counterclockwise:he})},d.prototype.arcTo=function(_,P,N,I,X){throw new Error("arcTo not implemented.")},d.prototype.rect=function(_,P,N,I){if(isNaN(_)||isNaN(P)||isNaN(N)||isNaN(I))throw lr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(_,P),this.lineTo(_+N,P),this.lineTo(_+N,P+I),this.lineTo(_,P+I),this.lineTo(_,P),this.lineTo(_+N,P),this.lineTo(_,P)},d.prototype.fillRect=function(_,P,N,I){if(isNaN(_)||isNaN(P)||isNaN(N)||isNaN(I))throw lr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var X={};this.lineCap!=="butt"&&(X.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(X.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(_,P,N,I),this.fill(),X.hasOwnProperty("lineCap")&&(this.lineCap=X.lineCap),X.hasOwnProperty("lineJoin")&&(this.lineJoin=X.lineJoin)}},d.prototype.strokeRect=function(_,P,N,I){if(isNaN(_)||isNaN(P)||isNaN(N)||isNaN(I))throw lr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");g.call(this)||(this.beginPath(),this.rect(_,P,N,I),this.stroke())},d.prototype.clearRect=function(_,P,N,I){if(isNaN(_)||isNaN(P)||isNaN(N)||isNaN(I))throw lr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(_,P,N,I))},d.prototype.save=function(_){_=typeof _!="boolean"||_;for(var P=this.pdf.internal.getCurrentPageInfo().pageNumber,N=0;N<this.pdf.internal.getNumberOfPages();N++)this.pdf.setPage(N+1),this.pdf.internal.out("q");if(this.pdf.setPage(P),_){this.ctx.fontSize=this.pdf.internal.getFontSize();var I=new c(this.ctx);this.ctxStack.push(this.ctx),this.ctx=I}},d.prototype.restore=function(_){_=typeof _!="boolean"||_;for(var P=this.pdf.internal.getCurrentPageInfo().pageNumber,N=0;N<this.pdf.internal.getNumberOfPages();N++)this.pdf.setPage(N+1),this.pdf.internal.out("Q");this.pdf.setPage(P),_&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},d.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(_){var P,N,I,X;if(_.isCanvasGradient===!0&&(_=_.getColor()),!_)return{r:0,g:0,b:0,a:0,style:_};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(_))P=0,N=0,I=0,X=0;else{var he=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(_);if(he!==null)P=parseInt(he[1]),N=parseInt(he[2]),I=parseInt(he[3]),X=1;else if((he=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(_))!==null)P=parseInt(he[1]),N=parseInt(he[2]),I=parseInt(he[3]),X=parseFloat(he[4]);else{if(X=1,typeof _=="string"&&_.charAt(0)!=="#"){var ce=new yg(_);_=ce.ok?ce.toHex():"#000000"}_.length===4?(P=_.substring(1,2),P+=P,N=_.substring(2,3),N+=N,I=_.substring(3,4),I+=I):(P=_.substring(1,3),N=_.substring(3,5),I=_.substring(5,7)),P=parseInt(P,16),N=parseInt(N,16),I=parseInt(I,16)}}return{r:P,g:N,b:I,a:X,style:_}},f=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},g=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};d.prototype.fillText=function(_,P,N,I){if(isNaN(P)||isNaN(N)||typeof _!="string")throw lr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(I=isNaN(I)?void 0:I,!f.call(this)){var X=se(this.ctx.transform.rotation),he=this.ctx.transform.scaleX;k.call(this,{text:_,x:P,y:N,scale:he,angle:X,align:this.textAlign,maxWidth:I})}},d.prototype.strokeText=function(_,P,N,I){if(isNaN(P)||isNaN(N)||typeof _!="string")throw lr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!g.call(this)){I=isNaN(I)?void 0:I;var X=se(this.ctx.transform.rotation),he=this.ctx.transform.scaleX;k.call(this,{text:_,x:P,y:N,scale:he,renderingMode:"stroke",angle:X,align:this.textAlign,maxWidth:I})}},d.prototype.measureText=function(_){if(typeof _!="string")throw lr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var P=this.pdf,N=this.pdf.internal.scaleFactor,I=P.internal.getFontSize(),X=P.getStringUnitWidth(_)*I/P.internal.scaleFactor,he=function(ce){var ue=(ce=ce||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ue}}),this};return new he({width:X*=Math.round(96*N/72*1e4)/1e4})},d.prototype.scale=function(_,P){if(isNaN(_)||isNaN(P))throw lr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var N=new l(_,0,0,P,0,0);this.ctx.transform=this.ctx.transform.multiply(N)},d.prototype.rotate=function(_){if(isNaN(_))throw lr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var P=new l(Math.cos(_),Math.sin(_),-Math.sin(_),Math.cos(_),0,0);this.ctx.transform=this.ctx.transform.multiply(P)},d.prototype.translate=function(_,P){if(isNaN(_)||isNaN(P))throw lr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var N=new l(1,0,0,1,_,P);this.ctx.transform=this.ctx.transform.multiply(N)},d.prototype.transform=function(_,P,N,I,X,he){if(isNaN(_)||isNaN(P)||isNaN(N)||isNaN(I)||isNaN(X)||isNaN(he))throw lr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ce=new l(_,P,N,I,X,he);this.ctx.transform=this.ctx.transform.multiply(ce)},d.prototype.setTransform=function(_,P,N,I,X,he){_=isNaN(_)?1:_,P=isNaN(P)?0:P,N=isNaN(N)?0:N,I=isNaN(I)?1:I,X=isNaN(X)?0:X,he=isNaN(he)?0:he,this.ctx.transform=new l(_,P,N,I,X,he)};var m=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};d.prototype.drawImage=function(_,P,N,I,X,he,ce,ue,be){var Le=this.pdf.getImageProperties(_),Z=1,Ue=1,Ye=1,Se=1;I!==void 0&&ue!==void 0&&(Ye=ue/I,Se=be/X,Z=Le.width/I*ue/I,Ue=Le.height/X*be/X),he===void 0&&(he=P,ce=N,P=0,N=0),I!==void 0&&ue===void 0&&(ue=I,be=X),I===void 0&&ue===void 0&&(ue=Le.width,be=Le.height);for(var re,De=this.ctx.transform.decompose(),Je=se(De.rotate.shx),He=new l,qe=(He=(He=(He=He.multiply(De.translate)).multiply(De.skew)).multiply(De.scale)).applyToRectangle(new o(he-P*Ye,ce-N*Se,I*Z,X*Ue)),Ze=b.call(this,qe),Qe=[],lt=0;lt<Ze.length;lt+=1)Qe.indexOf(Ze[lt])===-1&&Qe.push(Ze[lt]);if(C(Qe),this.autoPaging)for(var ht=Qe[0],bt=Qe[Qe.length-1],Et=ht;Et<bt+1;Et++){this.pdf.setPage(Et);var Mt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],St=Et===1?this.posY+this.margin[0]:this.margin[0],ct=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],tt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ve=Et===1?0:ct+(Et-2)*tt;if(this.ctx.clip_path.length!==0){var $t=this.path;re=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=E(re,this.posX+this.margin[3],-Ve+St+this.ctx.prevPageLastElemOffset),L.call(this,"fill",!0),this.path=$t}var pt=JSON.parse(JSON.stringify(qe));pt=E([pt],this.posX+this.margin[3],-Ve+St+this.ctx.prevPageLastElemOffset)[0];var qr=(Et>ht||Et<bt)&&m.call(this);qr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Mt,tt,null).clip().discardPath()),this.pdf.addImage(_,"JPEG",pt.x,pt.y,pt.w,pt.h,null,null,Je),qr&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(_,"JPEG",qe.x,qe.y,qe.w,qe.h,null,null,Je)};var b=function(_,P,N){var I=[];P=P||this.pdf.internal.pageSize.width,N=N||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var X=this.posY+this.ctx.prevPageLastElemOffset;switch(_.type){default:case"mt":case"lt":I.push(Math.floor((_.y+X)/N)+1);break;case"arc":I.push(Math.floor((_.y+X-_.radius)/N)+1),I.push(Math.floor((_.y+X+_.radius)/N)+1);break;case"qct":var he=q(this.ctx.lastPoint.x,this.ctx.lastPoint.y,_.x1,_.y1,_.x,_.y);I.push(Math.floor((he.y+X)/N)+1),I.push(Math.floor((he.y+he.h+X)/N)+1);break;case"bct":var ce=fe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,_.x1,_.y1,_.x2,_.y2,_.x,_.y);I.push(Math.floor((ce.y+X)/N)+1),I.push(Math.floor((ce.y+ce.h+X)/N)+1);break;case"rect":I.push(Math.floor((_.y+X)/N)+1),I.push(Math.floor((_.y+_.h+X)/N)+1)}for(var ue=0;ue<I.length;ue+=1)for(;this.pdf.internal.getNumberOfPages()<I[ue];)w.call(this);return I},w=function(){var _=this.fillStyle,P=this.strokeStyle,N=this.font,I=this.lineCap,X=this.lineWidth,he=this.lineJoin;this.pdf.addPage(),this.fillStyle=_,this.strokeStyle=P,this.font=N,this.lineCap=I,this.lineWidth=X,this.lineJoin=he},E=function(_,P,N){for(var I=0;I<_.length;I++)switch(_[I].type){case"bct":_[I].x2+=P,_[I].y2+=N;case"qct":_[I].x1+=P,_[I].y1+=N;case"mt":case"lt":case"arc":default:_[I].x+=P,_[I].y+=N}return _},C=function(_){return _.sort((function(P,N){return P-N}))},F=function(_,P){for(var N,I,X=this.fillStyle,he=this.strokeStyle,ce=this.lineCap,ue=this.lineWidth,be=Math.abs(ue*this.ctx.transform.scaleX),Le=this.lineJoin,Z=JSON.parse(JSON.stringify(this.path)),Ue=JSON.parse(JSON.stringify(this.path)),Ye=[],Se=0;Se<Ue.length;Se++)if(Ue[Se].x!==void 0)for(var re=b.call(this,Ue[Se]),De=0;De<re.length;De+=1)Ye.indexOf(re[De])===-1&&Ye.push(re[De]);for(var Je=0;Je<Ye.length;Je++)for(;this.pdf.internal.getNumberOfPages()<Ye[Je];)w.call(this);if(C(Ye),this.autoPaging)for(var He=Ye[0],qe=Ye[Ye.length-1],Ze=He;Ze<qe+1;Ze++){this.pdf.setPage(Ze),this.fillStyle=X,this.strokeStyle=he,this.lineCap=ce,this.lineWidth=be,this.lineJoin=Le;var Qe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],lt=Ze===1?this.posY+this.margin[0]:this.margin[0],ht=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],bt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Et=Ze===1?0:ht+(Ze-2)*bt;if(this.ctx.clip_path.length!==0){var Mt=this.path;N=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=E(N,this.posX+this.margin[3],-Et+lt+this.ctx.prevPageLastElemOffset),L.call(this,_,!0),this.path=Mt}if(I=JSON.parse(JSON.stringify(Z)),this.path=E(I,this.posX+this.margin[3],-Et+lt+this.ctx.prevPageLastElemOffset),P===!1||Ze===0){var St=(Ze>He||Ze<qe)&&m.call(this);St&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Qe,bt,null).clip().discardPath()),L.call(this,_,P),St&&this.pdf.restoreGraphicsState()}this.lineWidth=ue}else this.lineWidth=be,L.call(this,_,P),this.lineWidth=ue;this.path=Z},L=function(_,P){if((_!=="stroke"||P||!g.call(this))&&(_==="stroke"||P||!f.call(this))){for(var N,I,X=[],he=this.path,ce=0;ce<he.length;ce++){var ue=he[ce];switch(ue.type){case"begin":X.push({begin:!0});break;case"close":X.push({close:!0});break;case"mt":X.push({start:ue,deltas:[],abs:[]});break;case"lt":var be=X.length;if(he[ce-1]&&!isNaN(he[ce-1].x)&&(N=[ue.x-he[ce-1].x,ue.y-he[ce-1].y],be>0)){for(;be>=0;be--)if(X[be-1].close!==!0&&X[be-1].begin!==!0){X[be-1].deltas.push(N),X[be-1].abs.push(ue);break}}break;case"bct":N=[ue.x1-he[ce-1].x,ue.y1-he[ce-1].y,ue.x2-he[ce-1].x,ue.y2-he[ce-1].y,ue.x-he[ce-1].x,ue.y-he[ce-1].y],X[X.length-1].deltas.push(N);break;case"qct":var Le=he[ce-1].x+2/3*(ue.x1-he[ce-1].x),Z=he[ce-1].y+2/3*(ue.y1-he[ce-1].y),Ue=ue.x+2/3*(ue.x1-ue.x),Ye=ue.y+2/3*(ue.y1-ue.y),Se=ue.x,re=ue.y;N=[Le-he[ce-1].x,Z-he[ce-1].y,Ue-he[ce-1].x,Ye-he[ce-1].y,Se-he[ce-1].x,re-he[ce-1].y],X[X.length-1].deltas.push(N);break;case"arc":X.push({deltas:[],abs:[],arc:!0}),Array.isArray(X[X.length-1].abs)&&X[X.length-1].abs.push(ue)}}I=P?null:_==="stroke"?"stroke":"fill";for(var De=!1,Je=0;Je<X.length;Je++)if(X[Je].arc)for(var He=X[Je].abs,qe=0;qe<He.length;qe++){var Ze=He[qe];Ze.type==="arc"?A.call(this,Ze.x,Ze.y,Ze.radius,Ze.startAngle,Ze.endAngle,Ze.counterclockwise,void 0,P,!De):M.call(this,Ze.x,Ze.y),De=!0}else if(X[Je].close===!0)this.pdf.internal.out("h"),De=!1;else if(X[Je].begin!==!0){var Qe=X[Je].start.x,lt=X[Je].start.y;V.call(this,X[Je].deltas,Qe,lt),De=!0}I&&O.call(this,I),P&&U.call(this)}},D=function(_){var P=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,N=P*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return _-N;case"top":return _+P-N;case"hanging":return _+P-2*N;case"middle":return _+P/2-N;case"ideographic":return _;case"alphabetic":default:return _}},S=function(_){return _+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};d.prototype.createLinearGradient=function(){var _=function(){};return _.colorStops=[],_.addColorStop=function(P,N){this.colorStops.push([P,N])},_.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},_.isCanvasGradient=!0,_},d.prototype.createPattern=function(){return this.createLinearGradient()},d.prototype.createRadialGradient=function(){return this.createLinearGradient()};var A=function(_,P,N,I,X,he,ce,ue,be){for(var Le=K.call(this,N,I,X,he),Z=0;Z<Le.length;Z++){var Ue=Le[Z];Z===0&&(be?R.call(this,Ue.x1+_,Ue.y1+P):M.call(this,Ue.x1+_,Ue.y1+P)),oe.call(this,_,P,Ue.x2,Ue.y2,Ue.x3,Ue.y3,Ue.x4,Ue.y4)}ue?U.call(this):O.call(this,ce)},O=function(_){switch(_){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},U=function(){this.pdf.clip(),this.pdf.discardPath()},R=function(_,P){this.pdf.internal.out(t(_)+" "+i(P)+" m")},k=function(_){var P;switch(_.align){case"right":case"end":P="right";break;case"center":P="center";break;case"left":case"start":default:P="left"}var N=this.pdf.getTextDimensions(_.text),I=D.call(this,_.y),X=S.call(this,I)-N.h,he=this.ctx.transform.applyToPoint(new a(_.x,I)),ce=this.ctx.transform.decompose(),ue=new l;ue=(ue=(ue=ue.multiply(ce.translate)).multiply(ce.skew)).multiply(ce.scale);for(var be,Le,Z,Ue=this.ctx.transform.applyToRectangle(new o(_.x,I,N.w,N.h)),Ye=ue.applyToRectangle(new o(_.x,X,N.w,N.h)),Se=b.call(this,Ye),re=[],De=0;De<Se.length;De+=1)re.indexOf(Se[De])===-1&&re.push(Se[De]);if(C(re),this.autoPaging)for(var Je=re[0],He=re[re.length-1],qe=Je;qe<He+1;qe++){this.pdf.setPage(qe);var Ze=qe===1?this.posY+this.margin[0]:this.margin[0],Qe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],lt=this.pdf.internal.pageSize.height-this.margin[2],ht=lt-this.margin[0],bt=this.pdf.internal.pageSize.width-this.margin[1],Et=bt-this.margin[3],Mt=qe===1?0:Qe+(qe-2)*ht;if(this.ctx.clip_path.length!==0){var St=this.path;be=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=E(be,this.posX+this.margin[3],-1*Mt+Ze),L.call(this,"fill",!0),this.path=St}var ct=E([JSON.parse(JSON.stringify(Ye))],this.posX+this.margin[3],-Mt+Ze+this.ctx.prevPageLastElemOffset)[0];_.scale>=.01&&(Le=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Le*_.scale),Z=this.lineWidth,this.lineWidth=Z*_.scale);var tt=this.autoPaging!=="text";if(tt||ct.y+ct.h<=lt){if(tt||ct.y>=Ze&&ct.x<=bt){var Ve=tt?_.text:this.pdf.splitTextToSize(_.text,_.maxWidth||bt-ct.x)[0],$t=E([JSON.parse(JSON.stringify(Ue))],this.posX+this.margin[3],-Mt+Ze+this.ctx.prevPageLastElemOffset)[0],pt=tt&&(qe>Je||qe<He)&&m.call(this);pt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Et,ht,null).clip().discardPath()),this.pdf.text(Ve,$t.x,$t.y,{angle:_.angle,align:P,renderingMode:_.renderingMode}),pt&&this.pdf.restoreGraphicsState()}}else ct.y<lt&&(this.ctx.prevPageLastElemOffset+=lt-ct.y);_.scale>=.01&&(this.pdf.setFontSize(Le),this.lineWidth=Z)}else _.scale>=.01&&(Le=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Le*_.scale),Z=this.lineWidth,this.lineWidth=Z*_.scale),this.pdf.text(_.text,he.x+this.posX,he.y+this.posY,{angle:_.angle,align:P,renderingMode:_.renderingMode,maxWidth:_.maxWidth}),_.scale>=.01&&(this.pdf.setFontSize(Le),this.lineWidth=Z)},M=function(_,P,N,I){N=N||0,I=I||0,this.pdf.internal.out(t(_+N)+" "+i(P+I)+" l")},V=function(_,P,N){return this.pdf.lines(_,P,N,null,null)},oe=function(_,P,N,I,X,he,ce,ue){this.pdf.internal.out([e(n(N+_)),e(s(I+P)),e(n(X+_)),e(s(he+P)),e(n(ce+_)),e(s(ue+P)),"c"].join(" "))},K=function(_,P,N,I){for(var X=2*Math.PI,he=Math.PI/2;P>N;)P-=X;var ce=Math.abs(N-P);ce<X&&I&&(ce=X-ce);for(var ue=[],be=I?-1:1,Le=P;ce>1e-5;){var Z=Le+be*Math.min(ce,he);ue.push(Y.call(this,_,Le,Z)),ce-=Math.abs(Z-Le),Le=Z}return ue},Y=function(_,P,N){var I=(N-P)/2,X=_*Math.cos(I),he=_*Math.sin(I),ce=X,ue=-he,be=ce*ce+ue*ue,Le=be+ce*X+ue*he,Z=4/3*(Math.sqrt(2*be*Le)-Le)/(ce*he-ue*X),Ue=ce-Z*ue,Ye=ue+Z*ce,Se=Ue,re=-Ye,De=I+P,Je=Math.cos(De),He=Math.sin(De);return{x1:_*Math.cos(P),y1:_*Math.sin(P),x2:Ue*Je-Ye*He,y2:Ue*He+Ye*Je,x3:Se*Je-re*He,y3:Se*He+re*Je,x4:_*Math.cos(N),y4:_*Math.sin(N)}},se=function(_){return 180*_/Math.PI},q=function(_,P,N,I,X,he){var ce=_+.5*(N-_),ue=P+.5*(I-P),be=X+.5*(N-X),Le=he+.5*(I-he),Z=Math.min(_,X,ce,be),Ue=Math.max(_,X,ce,be),Ye=Math.min(P,he,ue,Le),Se=Math.max(P,he,ue,Le);return new o(Z,Ye,Ue-Z,Se-Ye)},fe=function(_,P,N,I,X,he,ce,ue){var be,Le,Z,Ue,Ye,Se,re,De,Je,He,qe,Ze,Qe,lt,ht=N-_,bt=I-P,Et=X-N,Mt=he-I,St=ce-X,ct=ue-he;for(Le=0;Le<41;Le++)Je=(re=(Z=_+(be=Le/40)*ht)+be*((Ye=N+be*Et)-Z))+be*(Ye+be*(X+be*St-Ye)-re),He=(De=(Ue=P+be*bt)+be*((Se=I+be*Mt)-Ue))+be*(Se+be*(he+be*ct-Se)-De),Le==0?(qe=Je,Ze=He,Qe=Je,lt=He):(qe=Math.min(qe,Je),Ze=Math.min(Ze,He),Qe=Math.max(Qe,Je),lt=Math.max(lt,He));return new o(Math.round(qe),Math.round(Ze),Math.round(Qe-qe),Math.round(lt-Ze))},ge=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var _,P,N=(_=this.ctx.lineDash,P=this.ctx.lineDashOffset,JSON.stringify({lineDash:_,lineDashOffset:P}));this.prevLineDash!==N&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=N)}}})(dt.API),(function(r){var e=function(s){var a,o,l,h,c,d,p,f,g,m;for(o=[],l=0,h=(s+=a="\0\0\0\0".slice(s.length%4||4)).length;h>l;l+=4)(c=(s.charCodeAt(l)<<24)+(s.charCodeAt(l+1)<<16)+(s.charCodeAt(l+2)<<8)+s.charCodeAt(l+3))!==0?(d=(c=((c=((c=((c=(c-(m=c%85))/85)-(g=c%85))/85)-(f=c%85))/85)-(p=c%85))/85)%85,o.push(d+33,p+33,f+33,g+33,m+33)):o.push(122);return(function(b,w){for(var E=w;E>0;E--)b.pop()})(o,a.length),String.fromCharCode.apply(String,o)+"~>"},t=function(s){var a,o,l,h,c,d=String,p="length",f=255,g="charCodeAt",m="slice",b="replace";for(s[m](-2),s=s[m](0,-2)[b](/\s/g,"")[b]("z","!!!!!"),l=[],h=0,c=(s+=a="uuuuu"[m](s[p]%5||5))[p];c>h;h+=5)o=52200625*(s[g](h)-33)+614125*(s[g](h+1)-33)+7225*(s[g](h+2)-33)+85*(s[g](h+3)-33)+(s[g](h+4)-33),l.push(f&o>>24,f&o>>16,f&o>>8,f&o);return(function(w,E){for(var C=E;C>0;C--)w.pop()})(l,a[p]),d.fromCharCode.apply(d,l)},i=function(s){var a=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),a.test(s)===!1)return"";for(var o="",l=0;l<s.length;l+=2)o+=String.fromCharCode("0x"+(s[l]+s[l+1]));return o},n=function(s){for(var a=new Uint8Array(s.length),o=s.length;o--;)a[o]=s.charCodeAt(o);return s=(a=jf(a)).reduce((function(l,h){return l+String.fromCharCode(h)}),"")};r.processDataByFilters=function(s,a){var o=0,l=s||"",h=[];for(typeof(a=a||[])=="string"&&(a=[a]),o=0;o<a.length;o+=1)switch(a[o]){case"ASCII85Decode":case"/ASCII85Decode":l=t(l),h.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":l=e(l),h.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":l=i(l),h.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":l=l.split("").map((function(c){return("0"+c.charCodeAt().toString(16)).slice(-2)})).join("")+">",h.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":l=n(l),h.push("/FlateDecode");break;default:throw new Error('The filter: "'+a[o]+'" is not implemented')}return{data:l,reverseChain:h.reverse().join(" ")}}})(dt.API),(function(r){r.loadFile=function(e,t,i){return(function(n,s,a){s=s!==!1,a=typeof a=="function"?a:function(){};var o=void 0;try{o=(function(l,h,c){var d=new XMLHttpRequest,p=0,f=function(g){var m=g.length,b=[],w=String.fromCharCode;for(p=0;p<m;p+=1)b.push(w(255&g.charCodeAt(p)));return b.join("")};if(d.open("GET",l,!h),d.overrideMimeType("text/plain; charset=x-user-defined"),h===!1&&(d.onload=function(){d.status===200?c(f(this.responseText)):c(void 0)}),d.send(null),h&&d.status===200)return f(d.responseText)})(n,s,a)}catch{}return o})(e,t,i)},r.loadImageFile=r.loadFile})(dt.API),(function(r){function e(){return(wt.html2canvas?Promise.resolve(wt.html2canvas):Mf(()=>import("./html2canvas.esm-B0tyYwQk.js"),[])).catch((function(a){return Promise.reject(new Error("Could not load html2canvas: "+a))})).then((function(a){return a.default?a.default:a}))}function t(){return(wt.DOMPurify?Promise.resolve(wt.DOMPurify):Mf(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch((function(a){return Promise.reject(new Error("Could not load dompurify: "+a))})).then((function(a){return a.default?a.default:a}))}var i=function(a){var o=tr(a);return o==="undefined"?"undefined":o==="string"||a instanceof String?"string":o==="number"||a instanceof Number?"number":o==="function"||a instanceof Function?"function":a&&a.constructor===Array?"array":a&&a.nodeType===1?"element":o==="object"?"object":"unknown"},n=function(a,o){var l=document.createElement(a);for(var h in o.className&&(l.className=o.className),o.innerHTML&&o.dompurify&&(l.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)l.style[h]=o.style[h];return l},s=function a(o){var l=Object.assign(a.convert(Promise.resolve()),JSON.parse(JSON.stringify(a.template))),h=a.convert(Promise.resolve(),l);return h=(h=h.setProgress(1,a,1,[a])).set(o)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(a,o){return a.__proto__=o||s.prototype,a},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(a,o){return this.then((function(){switch(o=o||(function(l){switch(i(l)){case"string":return"string";case"element":return l.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(a)){case"string":return this.then(t).then((function(l){return this.set({src:n("div",{innerHTML:a,dompurify:l})})}));case"element":return this.set({src:a});case"canvas":return this.set({canvas:a});case"img":return this.set({img:a});default:return this.error("Unknown source type.")}}))},s.prototype.to=function(a){switch(a){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then((function(){var a={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=(function l(h,c){for(var d=h.nodeType===3?document.createTextNode(h.nodeValue):h.cloneNode(!1),p=h.firstChild;p;p=p.nextSibling)c!==!0&&p.nodeType===1&&p.nodeName==="SCRIPT"||d.appendChild(l(p,c));return h.nodeType===1&&(h.nodeName==="CANVAS"?(d.width=h.width,d.height=h.height,d.getContext("2d").drawImage(h,0,0)):h.nodeName!=="TEXTAREA"&&h.nodeName!=="SELECT"||(d.value=h.value),d.addEventListener("load",(function(){d.scrollTop=h.scrollTop,d.scrollLeft=h.scrollLeft}),!0)),d})(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(a.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=n("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=n("div",{className:"html2pdf__container",style:a}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(n("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"}))},s.prototype.toCanvas=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(e).then((function(o){var l=Object.assign({},this.opt.html2canvas);return delete l.onrendered,o(this.prop.container,l)})).then((function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)}))},s.prototype.toContext2d=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(e).then((function(o){var l=this.opt.jsPDF,h=this.opt.fontFaces,c=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,d=Object.assign({async:!0,allowTaint:!0,scale:c,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete d.onrendered,l.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,l.context2d.posX=this.opt.x,l.context2d.posY=this.opt.y,l.context2d.margin=this.opt.margin,l.context2d.fontFaces=h,h)for(var p=0;p<h.length;++p){var f=h[p],g=f.src.find((function(m){return m.format==="truetype"}));g&&l.addFont(g.url,f.ref.name,f.ref.style)}return d.windowHeight=d.windowHeight||0,d.windowHeight=d.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):d.windowHeight,l.context2d.save(!0),o(this.prop.container,d)})).then((function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)}))},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then((function(){var a=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=a}))},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then((function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF}))},s.prototype.output=function(a,o,l){return(l=l||"pdf").toLowerCase()==="img"||l.toLowerCase()==="image"?this.outputImg(a,o):this.outputPdf(a,o)},s.prototype.outputPdf=function(a,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then((function(){return this.prop.pdf.output(a,o)}))},s.prototype.outputImg=function(a){return this.thenList([function(){return this.prop.img||this.toImg()}]).then((function(){switch(a){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+a+'" is not supported.'}}))},s.prototype.save=function(a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(a?{filename:a}:null).then((function(){this.prop.pdf.save(this.opt.filename)}))},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then((function(){this.prop.callback(this.prop.pdf)}))},s.prototype.set=function(a){if(i(a)!=="object")return this;var o=Object.keys(a||{}).map((function(l){if(l in s.template.prop)return function(){this.prop[l]=a[l]};switch(l){case"margin":return this.setMargin.bind(this,a.margin);case"jsPDF":return function(){return this.opt.jsPDF=a.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,a.pageSize);default:return function(){this.opt[l]=a[l]}}}),this);return this.then((function(){return this.thenList(o)}))},s.prototype.get=function(a,o){return this.then((function(){var l=a in s.template.prop?this.prop[a]:this.opt[a];return o?o(l):l}))},s.prototype.setMargin=function(a){return this.then((function(){switch(i(a)){case"number":a=[a,a,a,a];case"array":if(a.length===2&&(a=[a[0],a[1],a[0],a[1]]),a.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=a})).then(this.setPageSize)},s.prototype.setPageSize=function(a){function o(l,h){return Math.floor(l*h/72*96)}return this.then((function(){(a=a||dt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(a.inner={width:a.width-this.opt.margin[1]-this.opt.margin[3],height:a.height-this.opt.margin[0]-this.opt.margin[2]},a.inner.px={width:o(a.inner.width,a.k),height:o(a.inner.height,a.k)},a.inner.ratio=a.inner.height/a.inner.width),this.prop.pageSize=a}))},s.prototype.setProgress=function(a,o,l,h){return a!=null&&(this.progress.val=a),o!=null&&(this.progress.state=o),l!=null&&(this.progress.n=l),h!=null&&(this.progress.stack=h),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(a,o,l,h){return this.setProgress(a?this.progress.val+a:null,o||null,l?this.progress.n+l:null,h?this.progress.stack.concat(h):null)},s.prototype.then=function(a,o){var l=this;return this.thenCore(a,o,(function(h,c){return l.updateProgress(null,null,1,[h]),Promise.prototype.then.call(this,(function(d){return l.updateProgress(null,h),d})).then(h,c).then((function(d){return l.updateProgress(1),d}))}))},s.prototype.thenCore=function(a,o,l){l=l||Promise.prototype.then,a&&(a=a.bind(this)),o&&(o=o.bind(this));var h=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:s.convert(Object.assign({},this),Promise.prototype),c=l.call(h,a,o);return s.convert(c,this.__proto__)},s.prototype.thenExternal=function(a,o){return Promise.prototype.then.call(this,a,o)},s.prototype.thenList=function(a){var o=this;return a.forEach((function(l){o=o.thenCore(l)})),o},s.prototype.catch=function(a){a&&(a=a.bind(this));var o=Promise.prototype.catch.call(this,a);return s.convert(o,this)},s.prototype.catchExternal=function(a){return Promise.prototype.catch.call(this,a)},s.prototype.error=function(a){return this.then((function(){throw new Error(a)}))},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,dt.getPageSize=function(a,o,l){if(tr(a)==="object"){var h=a;a=h.orientation,o=h.unit||o,l=h.format||l}o=o||"mm",l=l||"a4",a=(""+(a||"P")).toLowerCase();var c,d=(""+l).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":c=1;break;case"mm":c=72/25.4;break;case"cm":c=72/2.54;break;case"in":c=72;break;case"px":c=.75;break;case"pc":case"em":c=12;break;case"ex":c=6;break;default:throw"Invalid unit: "+o}var f,g=0,m=0;if(p.hasOwnProperty(d))g=p[d][1]/c,m=p[d][0]/c;else try{g=l[1],m=l[0]}catch{throw new Error("Invalid format: "+l)}if(a==="p"||a==="portrait")a="p",m>g&&(f=m,m=g,g=f);else{if(a!=="l"&&a!=="landscape")throw"Invalid orientation: "+a;a="l",g>m&&(f=m,m=g,g=f)}return{width:m,height:g,unit:o,k:c,orientation:a}},r.html=function(a,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(Xf):null;var l=new s(o);return o.worker?l:l.from(a).doCallback()}})(dt.API),dt.API.addJS=function(r){return yp=r,this.internal.events.subscribe("postPutResources",(function(){oc=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(oc+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),xp=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+yp+")"),this.internal.out(">>"),this.internal.out("endobj")})),this.internal.events.subscribe("putCatalog",(function(){oc!==void 0&&xp!==void 0&&this.internal.out("/Names <</JavaScript "+oc+" 0 R>>")})),this},(function(r){var e;r.events.push(["postPutResources",function(){var t=this,i=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var n=t.outline.render().split(/\r\n/),s=0;s<n.length;s++){var a=n[s],o=i.exec(a);if(o!=null){var l=o[1];t.internal.newObjectDeferredBegin(l,!1)}t.internal.write(a)}if(this.outline.createNamedDestinations){var h=this.internal.pages.length,c=[];for(s=0;s<h;s++){var d=t.internal.newObject();c.push(d);var p=t.internal.getPageInfo(s+1);t.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var f=t.internal.newObject();for(t.internal.write("<< /Names [ "),s=0;s<c.length;s++)t.internal.write("(page_"+(s+1)+")"+c[s]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+f+" 0 R"),t.internal.write(">>","endobj")}}]),r.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),r.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(i,n,s){var a={title:n,options:s,children:[]};return i==null&&(i=this.root),i.children.push(a),a},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(i){i.id=t.internal.newObjectDeferred();for(var n=0;n<i.children.length;n++)this.genIds_r(i.children[n])},t.outline.renderRoot=function(i){this.objStart(i),this.line("/Type /Outlines"),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1]))),this.line("/Count "+this.count_r({count:0},i)),this.objEnd()},t.outline.renderItems=function(i){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<i.children.length;s++){var a=i.children[s];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(i)),s>0&&this.line("/Prev "+this.makeRef(i.children[s-1])),s<i.children.length-1&&this.line("/Next "+this.makeRef(i.children[s+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var o=this.count=this.count_r({count:0},a);if(o>0&&this.line("/Count "+o),a.options&&a.options.pageNumber){var l=t.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var h=0;h<i.children.length;h++)this.renderItems(i.children[h])},t.outline.line=function(i){this.ctx.val+=i+`\r
`},t.outline.makeRef=function(i){return i.id+" 0 R"},t.outline.makeString=function(i){return"("+t.internal.pdfEscape(i)+")"},t.outline.objStart=function(i){this.ctx.val+=`\r
`+i.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(i,n){for(var s=0;s<n.children.length;s++)i.count++,this.count_r(i,n.children[s]);return i.count}}])})(dt.API),(function(r){var e=[192,193,194,195,196,197,198,199];r.processJPEG=function(t,i,n,s,a,o){var l,h=this.decode.DCT_DECODE,c=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=a||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,(l=(function(d){for(var p,f=256*d.charCodeAt(4)+d.charCodeAt(5),g=d.length,m={width:0,height:0,numcomponents:1},b=4;b<g;b+=2){if(b+=f,e.indexOf(d.charCodeAt(b+1))!==-1){p=256*d.charCodeAt(b+5)+d.charCodeAt(b+6),m={width:256*d.charCodeAt(b+7)+d.charCodeAt(b+8),height:p,numcomponents:d.charCodeAt(b+9)};break}f=256*d.charCodeAt(b+2)+d.charCodeAt(b+3)}return m})(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}c={data:t,width:l.width,height:l.height,colorSpace:o,bitsPerComponent:8,filter:h,index:i,alias:n}}return c}})(dt.API);var bo,lc,Ep,Cp,_p,Sy=(function(){var r,e,t;function i(s){var a,o,l,h,c,d,p,f,g,m,b,w,E,C;for(this.data=s,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},d=null;;){switch(a=this.readUInt32(),g=(function(){var F,L;for(L=[],F=0;F<4;++F)L.push(String.fromCharCode(this.data[this.pos++]));return L}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(a);break;case"fcTL":d&&this.animation.frames.push(d),this.pos+=4,d={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},c=this.readUInt16(),h=this.readUInt16()||100,d.delay=1e3*c/h,d.disposeOp=this.data[this.pos++],d.blendOp=this.data[this.pos++],d.data=[];break;case"IDAT":case"fdAT":for(g==="fdAT"&&(this.pos+=4,a-=4),s=d?.data||this.imgData,w=0;0<=a?w<a:w>a;0<=a?++w:--w)s.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(l=this.palette.length/3,this.transparency.indexed=this.read(a),this.transparency.indexed.length>l)throw new Error("More transparent colors than palette size");if((m=l-this.transparency.indexed.length)>0)for(E=0;0<=m?E<m:E>m;0<=m?++E:--E)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(a)[0];break;case 2:this.transparency.rgb=this.read(a)}break;case"tEXt":p=(b=this.read(a)).indexOf(0),f=String.fromCharCode.apply(String,b.slice(0,p)),this.text[f]=String.fromCharCode.apply(String,b.slice(p+1));break;case"IEND":return d&&this.animation.frames.push(d),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(C=this.colorType)===4||C===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=a}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}i.prototype.read=function(s){var a,o;for(o=[],a=0;0<=s?a<s:a>s;0<=s?++a:--a)o.push(this.data[this.pos++]);return o},i.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},i.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},i.prototype.decodePixels=function(s){var a=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*a),l=0,h=this;if(s==null&&(s=this.imgData),s.length===0)return new Uint8Array(0);function c(d,p,f,g){var m,b,w,E,C,F,L,D,S,A,O,U,R,k,M,V,oe,K,Y,se,q,fe=Math.ceil((h.width-d)/f),ge=Math.ceil((h.height-p)/g),_=h.width==fe&&h.height==ge;for(k=a*fe,U=_?o:new Uint8Array(k*ge),F=s.length,R=0,b=0;R<ge&&l<F;){switch(s[l++]){case 0:for(E=oe=0;oe<k;E=oe+=1)U[b++]=s[l++];break;case 1:for(E=K=0;K<k;E=K+=1)m=s[l++],C=E<a?0:U[b-a],U[b++]=(m+C)%256;break;case 2:for(E=Y=0;Y<k;E=Y+=1)m=s[l++],w=(E-E%a)/a,M=R&&U[(R-1)*k+w*a+E%a],U[b++]=(M+m)%256;break;case 3:for(E=se=0;se<k;E=se+=1)m=s[l++],w=(E-E%a)/a,C=E<a?0:U[b-a],M=R&&U[(R-1)*k+w*a+E%a],U[b++]=(m+Math.floor((C+M)/2))%256;break;case 4:for(E=q=0;q<k;E=q+=1)m=s[l++],w=(E-E%a)/a,C=E<a?0:U[b-a],R===0?M=V=0:(M=U[(R-1)*k+w*a+E%a],V=w&&U[(R-1)*k+(w-1)*a+E%a]),L=C+M-V,D=Math.abs(L-C),A=Math.abs(L-M),O=Math.abs(L-V),S=D<=A&&D<=O?C:A<=O?M:V,U[b++]=(m+S)%256;break;default:throw new Error("Invalid filter algorithm: "+s[l-1])}if(!_){var P=((p+R*g)*h.width+d)*a,N=R*k;for(E=0;E<fe;E+=1){for(var I=0;I<a;I+=1)o[P++]=U[N++];P+=(f-1)*a}}R++}}return s=sy(s),h.interlaceMethod==1?(c(0,0,8,8),c(4,0,8,8),c(0,4,4,8),c(2,0,4,4),c(0,2,2,4),c(1,0,2,2),c(0,1,1,2)):c(0,0,1,1),o},i.prototype.decodePalette=function(){var s,a,o,l,h,c,d,p,f;for(o=this.palette,c=this.transparency.indexed||[],h=new Uint8Array((c.length||0)+o.length),l=0,s=0,a=d=0,p=o.length;d<p;a=d+=3)h[l++]=o[a],h[l++]=o[a+1],h[l++]=o[a+2],h[l++]=(f=c[s++])!=null?f:255;return h},i.prototype.copyToImageData=function(s,a){var o,l,h,c,d,p,f,g,m,b,w;if(l=this.colors,m=null,o=this.hasAlphaChannel,this.palette.length&&(m=(w=this._decodedPalette)!=null?w:this._decodedPalette=this.decodePalette(),l=4,o=!0),g=(h=s.data||s).length,d=m||a,c=p=0,l===1)for(;c<g;)f=m?4*a[c/4]:p,b=d[f++],h[c++]=b,h[c++]=b,h[c++]=b,h[c++]=o?d[f++]:255,p=f;else for(;c<g;)f=m?4*a[c/4]:p,h[c++]=d[f++],h[c++]=d[f++],h[c++]=d[f++],h[c++]=o?d[f++]:255,p=f},i.prototype.decode=function(){var s;return s=new Uint8Array(this.width*this.height*4),this.copyToImageData(s,this.decodePixels()),s};var n=function(){if(Object.prototype.toString.call(wt)==="[object Window]"){try{e=wt.document.createElement("canvas"),t=e.getContext("2d")}catch{return!1}return!0}return!1};return n(),r=function(s){var a;if(n()===!0)return t.width=s.width,t.height=s.height,t.clearRect(0,0,s.width,s.height),t.putImageData(s,0,0),(a=new Image).src=e.toDataURL(),a;throw new Error("This method requires a Browser with Canvas-capability.")},i.prototype.decodeFrames=function(s){var a,o,l,h,c,d,p,f;if(this.animation){for(f=[],o=c=0,d=(p=this.animation.frames).length;c<d;o=++c)a=p[o],l=s.createImageData(a.width,a.height),h=this.decodePixels(new Uint8Array(a.data)),this.copyToImageData(l,h),a.imageData=l,f.push(a.image=r(l));return f}},i.prototype.renderFrame=function(s,a){var o,l,h;return o=(l=this.animation.frames)[a],h=l[a-1],a===0&&s.clearRect(0,0,this.width,this.height),h?.disposeOp===1?s.clearRect(h.xOffset,h.yOffset,h.width,h.height):h?.disposeOp===2&&s.putImageData(h.imageData,h.xOffset,h.yOffset),o.blendOp===0&&s.clearRect(o.xOffset,o.yOffset,o.width,o.height),s.drawImage(o.image,o.xOffset,o.yOffset)},i.prototype.animate=function(s){var a,o,l,h,c,d,p=this;return o=0,d=this.animation,h=d.numFrames,l=d.frames,c=d.numPlays,(a=function(){var f,g;if(f=o++%h,g=l[f],p.renderFrame(s,f),h>1&&o/h<c)return p.animation._timeout=setTimeout(a,g.delay)})()},i.prototype.stopAnimation=function(){var s;return clearTimeout((s=this.animation)!=null?s._timeout:void 0)},i.prototype.render=function(s){var a,o;return s._png&&s._png.stopAnimation(),s._png=this,s.width=this.width,s.height=this.height,a=s.getContext("2d"),this.animation?(this.decodeFrames(a),this.animate(a)):(o=a.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),a.putImageData(o,0,0))},i})();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function Ty(r){var e=0;if(r[e++]!==71||r[e++]!==73||r[e++]!==70||r[e++]!==56||(r[e++]+1&253)!=56||r[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=r[e++]|r[e++]<<8,i=r[e++]|r[e++]<<8,n=r[e++],s=n>>7,a=1<<(7&n)+1;r[e++],r[e++];var o=null,l=null;s&&(o=e,l=a,e+=3*a);var h=!0,c=[],d=0,p=null,f=0,g=null;for(this.width=t,this.height=i;h&&e<r.length;)switch(r[e++]){case 33:switch(r[e++]){case 255:if(r[e]!==11||r[e+1]==78&&r[e+2]==69&&r[e+3]==84&&r[e+4]==83&&r[e+5]==67&&r[e+6]==65&&r[e+7]==80&&r[e+8]==69&&r[e+9]==50&&r[e+10]==46&&r[e+11]==48&&r[e+12]==3&&r[e+13]==1&&r[e+16]==0)e+=14,g=r[e++]|r[e++]<<8,e++;else for(e+=12;;){if(!((R=r[e++])>=0))throw Error("Invalid block size");if(R===0)break;e+=R}break;case 249:if(r[e++]!==4||r[e+4]!==0)throw new Error("Invalid graphics extension block.");var m=r[e++];d=r[e++]|r[e++]<<8,p=r[e++],(1&m)==0&&(p=null),f=m>>2&7,e++;break;case 254:for(;;){if(!((R=r[e++])>=0))throw Error("Invalid block size");if(R===0)break;e+=R}break;default:throw new Error("Unknown graphic control label: 0x"+r[e-1].toString(16))}break;case 44:var b=r[e++]|r[e++]<<8,w=r[e++]|r[e++]<<8,E=r[e++]|r[e++]<<8,C=r[e++]|r[e++]<<8,F=r[e++],L=F>>6&1,D=1<<(7&F)+1,S=o,A=l,O=!1;F>>7&&(O=!0,S=e,A=D,e+=3*D);var U=e;for(e++;;){var R;if(!((R=r[e++])>=0))throw Error("Invalid block size");if(R===0)break;e+=R}c.push({x:b,y:w,width:E,height:C,has_local_palette:O,palette_offset:S,palette_size:A,data_offset:U,data_length:e-U,transparent_index:p,interlaced:!!L,delay:d,disposal:f});break;case 59:h=!1;break;default:throw new Error("Unknown gif block: 0x"+r[e-1].toString(16))}this.numFrames=function(){return c.length},this.loopCount=function(){return g},this.frameInfo=function(k){if(k<0||k>=c.length)throw new Error("Frame index out of range.");return c[k]},this.decodeAndBlitFrameBGRA=function(k,M){var V=this.frameInfo(k),oe=V.width*V.height,K=new Uint8Array(oe);kp(r,V.data_offset,K,oe);var Y=V.palette_offset,se=V.transparent_index;se===null&&(se=256);var q=V.width,fe=t-q,ge=q,_=4*(V.y*t+V.x),P=4*((V.y+V.height)*t+V.x),N=_,I=4*fe;V.interlaced===!0&&(I+=4*t*7);for(var X=8,he=0,ce=K.length;he<ce;++he){var ue=K[he];if(ge===0&&(ge=q,(N+=I)>=P&&(I=4*fe+4*t*(X-1),N=_+(q+fe)*(X<<1),X>>=1)),ue===se)N+=4;else{var be=r[Y+3*ue],Le=r[Y+3*ue+1],Z=r[Y+3*ue+2];M[N++]=Z,M[N++]=Le,M[N++]=be,M[N++]=255}--ge}},this.decodeAndBlitFrameRGBA=function(k,M){var V=this.frameInfo(k),oe=V.width*V.height,K=new Uint8Array(oe);kp(r,V.data_offset,K,oe);var Y=V.palette_offset,se=V.transparent_index;se===null&&(se=256);var q=V.width,fe=t-q,ge=q,_=4*(V.y*t+V.x),P=4*((V.y+V.height)*t+V.x),N=_,I=4*fe;V.interlaced===!0&&(I+=4*t*7);for(var X=8,he=0,ce=K.length;he<ce;++he){var ue=K[he];if(ge===0&&(ge=q,(N+=I)>=P&&(I=4*fe+4*t*(X-1),N=_+(q+fe)*(X<<1),X>>=1)),ue===se)N+=4;else{var be=r[Y+3*ue],Le=r[Y+3*ue+1],Z=r[Y+3*ue+2];M[N++]=be,M[N++]=Le,M[N++]=Z,M[N++]=255}--ge}}}function kp(r,e,t,i){for(var n=r[e++],s=1<<n,a=s+1,o=a+1,l=n+1,h=(1<<l)-1,c=0,d=0,p=0,f=r[e++],g=new Int32Array(4096),m=null;;){for(;c<16&&f!==0;)d|=r[e++]<<c,c+=8,f===1?f=r[e++]:--f;if(c<l)break;var b=d&h;if(d>>=l,c-=l,b!==s){if(b===a)break;for(var w=b<o?b:m,E=0,C=w;C>s;)C=g[C]>>8,++E;var F=C;if(p+E+(w!==b?1:0)>i)return void lr.log("Warning, gif stream longer than expected.");t[p++]=F;var L=p+=E;for(w!==b&&(t[p++]=F),C=w;E--;)C=g[C],t[--L]=255&C,C>>=8;m!==null&&o<4096&&(g[o++]=m<<8|F,o>=h+1&&l<12&&(++l,h=h<<1|1)),m=b}else o=a+1,h=(1<<(l=n+1))-1,m=null}return p!==i&&lr.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function df(r){var e,t,i,n,s,a=Math.floor,o=new Array(64),l=new Array(64),h=new Array(64),c=new Array(64),d=new Array(65535),p=new Array(65535),f=new Array(64),g=new Array(64),m=[],b=0,w=7,E=new Array(64),C=new Array(64),F=new Array(64),L=new Array(256),D=new Array(2048),S=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],A=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],O=[0,1,2,3,4,5,6,7,8,9,10,11],U=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],R=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],k=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],M=[0,1,2,3,4,5,6,7,8,9,10,11],V=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],oe=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function K(_,P){for(var N=0,I=0,X=new Array,he=1;he<=16;he++){for(var ce=1;ce<=_[he];ce++)X[P[I]]=[],X[P[I]][0]=N,X[P[I]][1]=he,I++,N++;N*=2}return X}function Y(_){for(var P=_[0],N=_[1]-1;N>=0;)P&1<<N&&(b|=1<<w),N--,--w<0&&(b==255?(se(255),se(0)):se(b),w=7,b=0)}function se(_){m.push(_)}function q(_){se(_>>8&255),se(255&_)}function fe(_,P,N,I,X){for(var he,ce=X[0],ue=X[240],be=(function(He,qe){var Ze,Qe,lt,ht,bt,Et,Mt,St,ct,tt,Ve=0;for(ct=0;ct<8;++ct){Ze=He[Ve],Qe=He[Ve+1],lt=He[Ve+2],ht=He[Ve+3],bt=He[Ve+4],Et=He[Ve+5],Mt=He[Ve+6];var $t=Ze+(St=He[Ve+7]),pt=Ze-St,qr=Qe+Mt,Kt=Qe-Mt,ur=lt+Et,sn=lt-Et,Wt=ht+bt,Vn=ht-bt,pr=$t+Wt,Gi=$t-Wt,Cn=qr+ur,ar=qr-ur;He[Ve]=pr+Cn,He[Ve+4]=pr-Cn;var _t=.707106781*(ar+Gi);He[Ve+2]=Gi+_t,He[Ve+6]=Gi-_t;var Gt=.382683433*((pr=Vn+sn)-(ar=Kt+pt)),us=.5411961*pr+Gt,Xr=1.306562965*ar+Gt,an=.707106781*(Cn=sn+Kt),on=pt+an,mt=pt-an;He[Ve+5]=mt+us,He[Ve+3]=mt-us,He[Ve+1]=on+Xr,He[Ve+7]=on-Xr,Ve+=8}for(Ve=0,ct=0;ct<8;++ct){Ze=He[Ve],Qe=He[Ve+8],lt=He[Ve+16],ht=He[Ve+24],bt=He[Ve+32],Et=He[Ve+40],Mt=He[Ve+48];var qi=Ze+(St=He[Ve+56]),Pi=Ze-St,ci=Qe+Mt,Rr=Qe-Mt,Er=lt+Et,j=lt-Et,ne=ht+bt,Q=ht-bt,ee=qi+ne,ie=qi-ne,ae=ci+Er,Ee=ci-Er;He[Ve]=ee+ae,He[Ve+32]=ee-ae;var Fe=.707106781*(Ee+ie);He[Ve+16]=ie+Fe,He[Ve+48]=ie-Fe;var ye=.382683433*((ee=Q+j)-(Ee=Rr+Pi)),ke=.5411961*ee+ye,Te=1.306562965*Ee+ye,je=.707106781*(ae=j+Rr),Xe=Pi+je,nt=Pi-je;He[Ve+40]=nt+ke,He[Ve+24]=nt-ke,He[Ve+8]=Xe+Te,He[Ve+56]=Xe-Te,Ve++}for(ct=0;ct<64;++ct)tt=He[ct]*qe[ct],f[ct]=tt>0?tt+.5|0:tt-.5|0;return f})(_,P),Le=0;Le<64;++Le)g[S[Le]]=be[Le];var Z=g[0]-N;N=g[0],Z==0?Y(I[0]):(Y(I[p[he=32767+Z]]),Y(d[he]));for(var Ue=63;Ue>0&&g[Ue]==0;)Ue--;if(Ue==0)return Y(ce),N;for(var Ye,Se=1;Se<=Ue;){for(var re=Se;g[Se]==0&&Se<=Ue;)++Se;var De=Se-re;if(De>=16){Ye=De>>4;for(var Je=1;Je<=Ye;++Je)Y(ue);De&=15}he=32767+g[Se],Y(X[(De<<4)+p[he]]),Y(d[he]),Se++}return Ue!=63&&Y(ce),N}function ge(_){_=Math.min(Math.max(_,1),100),s!=_&&((function(P){for(var N=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],I=0;I<64;I++){var X=a((N[I]*P+50)/100);X=Math.min(Math.max(X,1),255),o[S[I]]=X}for(var he=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ce=0;ce<64;ce++){var ue=a((he[ce]*P+50)/100);ue=Math.min(Math.max(ue,1),255),l[S[ce]]=ue}for(var be=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Le=0,Z=0;Z<8;Z++)for(var Ue=0;Ue<8;Ue++)h[Le]=1/(o[S[Le]]*be[Z]*be[Ue]*8),c[Le]=1/(l[S[Le]]*be[Z]*be[Ue]*8),Le++})(_<50?Math.floor(5e3/_):Math.floor(200-2*_)),s=_)}this.encode=function(_,P){P&&ge(P),m=new Array,b=0,w=7,q(65496),q(65504),q(16),se(74),se(70),se(73),se(70),se(0),se(1),se(1),se(0),q(1),q(1),se(0),se(0),(function(){q(65499),q(132),se(0);for(var Qe=0;Qe<64;Qe++)se(o[Qe]);se(1);for(var lt=0;lt<64;lt++)se(l[lt])})(),(function(Qe,lt){q(65472),q(17),se(8),q(lt),q(Qe),se(3),se(1),se(17),se(0),se(2),se(17),se(1),se(3),se(17),se(1)})(_.width,_.height),(function(){q(65476),q(418),se(0);for(var Qe=0;Qe<16;Qe++)se(A[Qe+1]);for(var lt=0;lt<=11;lt++)se(O[lt]);se(16);for(var ht=0;ht<16;ht++)se(U[ht+1]);for(var bt=0;bt<=161;bt++)se(R[bt]);se(1);for(var Et=0;Et<16;Et++)se(k[Et+1]);for(var Mt=0;Mt<=11;Mt++)se(M[Mt]);se(17);for(var St=0;St<16;St++)se(V[St+1]);for(var ct=0;ct<=161;ct++)se(oe[ct])})(),q(65498),q(12),se(3),se(1),se(0),se(2),se(17),se(3),se(17),se(0),se(63),se(0);var N=0,I=0,X=0;b=0,w=7,this.encode.displayName="_encode_";for(var he,ce,ue,be,Le,Z,Ue,Ye,Se,re=_.data,De=_.width,Je=_.height,He=4*De,qe=0;qe<Je;){for(he=0;he<He;){for(Le=He*qe+he,Ue=-1,Ye=0,Se=0;Se<64;Se++)Z=Le+(Ye=Se>>3)*He+(Ue=4*(7&Se)),qe+Ye>=Je&&(Z-=He*(qe+1+Ye-Je)),he+Ue>=He&&(Z-=he+Ue-He+4),ce=re[Z++],ue=re[Z++],be=re[Z++],E[Se]=(D[ce]+D[ue+256>>0]+D[be+512>>0]>>16)-128,C[Se]=(D[ce+768>>0]+D[ue+1024>>0]+D[be+1280>>0]>>16)-128,F[Se]=(D[ce+1280>>0]+D[ue+1536>>0]+D[be+1792>>0]>>16)-128;N=fe(E,h,N,e,i),I=fe(C,c,I,t,n),X=fe(F,c,X,t,n),he+=32}qe+=8}if(w>=0){var Ze=[];Ze[1]=w+1,Ze[0]=(1<<w+1)-1,Y(Ze)}return q(65497),new Uint8Array(m)},r=r||50,(function(){for(var _=String.fromCharCode,P=0;P<256;P++)L[P]=_(P)})(),e=K(A,O),t=K(k,M),i=K(U,R),n=K(V,oe),(function(){for(var _=1,P=2,N=1;N<=15;N++){for(var I=_;I<P;I++)p[32767+I]=N,d[32767+I]=[],d[32767+I][1]=N,d[32767+I][0]=I;for(var X=-(P-1);X<=-_;X++)p[32767+X]=N,d[32767+X]=[],d[32767+X][1]=N,d[32767+X][0]=P-1+X;_<<=1,P<<=1}})(),(function(){for(var _=0;_<256;_++)D[_]=19595*_,D[_+256>>0]=38470*_,D[_+512>>0]=7471*_+32768,D[_+768>>0]=-11059*_,D[_+1024>>0]=-21709*_,D[_+1280>>0]=32768*_+8421375,D[_+1536>>0]=-27439*_,D[_+1792>>0]=-5329*_})(),ge(r)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function On(r,e){if(this.pos=0,this.buffer=r,this.datav=new DataView(r.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Sp(r){function e(A){if(!A)throw Error("assert :P")}function t(A,O,U){for(var R=0;4>R;R++)if(A[O+R]!=U.charCodeAt(R))return!0;return!1}function i(A,O,U,R,k){for(var M=0;M<k;M++)A[O+M]=U[R+M]}function n(A,O,U,R){for(var k=0;k<R;k++)A[O+k]=U}function s(A){return new Int32Array(A)}function a(A,O){for(var U=[],R=0;R<A;R++)U.push(new O);return U}function o(A,O){var U=[];return(function R(k,M,V){for(var oe=V[M],K=0;K<oe&&(k.push(V.length>M+1?[]:new O),!(V.length<M+1));K++)R(k[K],M+1,V)})(U,0,A),U}var l=function(){var A=this;function O(u,v){for(var y=1<<v-1>>>0;u&y;)y>>>=1;return y?(u&y-1)+y:u}function U(u,v,y,T,B){e(!(T%y));do u[v+(T-=y)]=B;while(0<T)}function R(u,v,y,T,B){if(e(2328>=B),512>=B)var z=s(512);else if((z=s(B))==null)return 0;return(function(W,G,J,te,pe,Ce){var _e,we,Ie=G,Re=1<<J,me=s(16),ve=s(16);for(e(pe!=0),e(te!=null),e(W!=null),e(0<J),we=0;we<pe;++we){if(15<te[we])return 0;++me[te[we]]}if(me[0]==pe)return 0;for(ve[1]=0,_e=1;15>_e;++_e){if(me[_e]>1<<_e)return 0;ve[_e+1]=ve[_e]+me[_e]}for(we=0;we<pe;++we)_e=te[we],0<te[we]&&(Ce[ve[_e]++]=we);if(ve[15]==1)return(te=new k).g=0,te.value=Ce[0],U(W,Ie,1,Re,te),Re;var Me,ze=-1,Oe=Re-1,at=0,et=1,gt=1,rt=1<<J;for(we=0,_e=1,pe=2;_e<=J;++_e,pe<<=1){if(et+=gt<<=1,0>(gt-=me[_e]))return 0;for(;0<me[_e];--me[_e])(te=new k).g=_e,te.value=Ce[we++],U(W,Ie+at,pe,rt,te),at=O(at,_e)}for(_e=J+1,pe=2;15>=_e;++_e,pe<<=1){if(et+=gt<<=1,0>(gt-=me[_e]))return 0;for(;0<me[_e];--me[_e]){if(te=new k,(at&Oe)!=ze){for(Ie+=rt,Me=1<<(ze=_e)-J;15>ze&&!(0>=(Me-=me[ze]));)++ze,Me<<=1;Re+=rt=1<<(Me=ze-J),W[G+(ze=at&Oe)].g=Me+J,W[G+ze].value=Ie-G-ze}te.g=_e-J,te.value=Ce[we++],U(W,Ie+(at>>J),pe,rt,te),at=O(at,_e)}}return et!=2*ve[15]-1?0:Re})(u,v,y,T,B,z)}function k(){this.value=this.g=0}function M(){this.value=this.g=0}function V(){this.G=a(5,k),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=a(Mi,M)}function oe(u,v,y,T){e(u!=null),e(v!=null),e(2147483648>T),u.Ca=254,u.I=0,u.b=-8,u.Ka=0,u.oa=v,u.pa=y,u.Jd=v,u.Yc=y+T,u.Zc=4<=T?y+T-4+1:y,he(u)}function K(u,v){for(var y=0;0<v--;)y|=ue(u,128)<<v;return y}function Y(u,v){var y=K(u,v);return ce(u)?-y:y}function se(u,v,y,T){var B,z=0;for(e(u!=null),e(v!=null),e(4294967288>T),u.Sb=T,u.Ra=0,u.u=0,u.h=0,4<T&&(T=4),B=0;B<T;++B)z+=v[y+B]<<8*B;u.Ra=z,u.bb=T,u.oa=v,u.pa=y}function q(u){for(;8<=u.u&&u.bb<u.Sb;)u.Ra>>>=8,u.Ra+=u.oa[u.pa+u.bb]<<oo-8>>>0,++u.bb,u.u-=8;N(u)&&(u.h=1,u.u=0)}function fe(u,v){if(e(0<=v),!u.h&&v<=ao){var y=P(u)&so[v];return u.u+=v,q(u),y}return u.h=1,u.u=0}function ge(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function _(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function P(u){return u.Ra>>>(u.u&oo-1)>>>0}function N(u){return e(u.bb<=u.Sb),u.h||u.bb==u.Sb&&u.u>oo}function I(u,v){u.u=v,u.h=N(u)}function X(u){u.u>=ll&&(e(u.u>=ll),q(u))}function he(u){e(u!=null&&u.oa!=null),u.pa<u.Zc?(u.I=(u.oa[u.pa++]|u.I<<8)>>>0,u.b+=8):(e(u!=null&&u.oa!=null),u.pa<u.Yc?(u.b+=8,u.I=u.oa[u.pa++]|u.I<<8):u.Ka?u.b=0:(u.I<<=8,u.b+=8,u.Ka=1))}function ce(u){return K(u,1)}function ue(u,v){var y=u.Ca;0>u.b&&he(u);var T=u.b,B=y*v>>>8,z=(u.I>>>T>B)+0;for(z?(y-=B,u.I-=B+1<<T>>>0):y=B+1,T=y,B=0;256<=T;)B+=8,T>>=8;return T=7^B+Oi[T],u.b-=T,u.Ca=(y<<T)-1,z}function be(u,v,y){u[v+0]=y>>24&255,u[v+1]=y>>16&255,u[v+2]=y>>8&255,u[v+3]=y>>0&255}function Le(u,v){return u[v+0]<<0|u[v+1]<<8}function Z(u,v){return Le(u,v)|u[v+2]<<16}function Ue(u,v){return Le(u,v)|Le(u,v+2)<<16}function Ye(u,v){var y=1<<v;return e(u!=null),e(0<v),u.X=s(y),u.X==null?0:(u.Mb=32-v,u.Xa=v,1)}function Se(u,v){e(u!=null),e(v!=null),e(u.Xa==v.Xa),i(v.X,0,u.X,0,1<<v.Xa)}function re(){this.X=[],this.Xa=this.Mb=0}function De(u,v,y,T){e(y!=null),e(T!=null);var B=y[0],z=T[0];return B==0&&(B=(u*z+v/2)/v),z==0&&(z=(v*B+u/2)/u),0>=B||0>=z?0:(y[0]=B,T[0]=z,1)}function Je(u,v){return u+(1<<v)-1>>>v}function He(u,v){return((4278255360&u)+(4278255360&v)>>>0&4278255360)+((16711935&u)+(16711935&v)>>>0&16711935)>>>0}function qe(u,v){A[v]=function(y,T,B,z,W,G,J){var te;for(te=0;te<W;++te){var pe=A[u](G[J+te-1],B,z+te);G[J+te]=He(y[T+te],pe)}}}function Ze(){this.ud=this.hd=this.jd=0}function Qe(u,v){return((4278124286&(u^v))>>>1)+(u&v)>>>0}function lt(u){return 0<=u&&256>u?u:0>u?0:255<u?255:void 0}function ht(u,v){return lt(u+(u-v+.5>>1))}function bt(u,v,y){return Math.abs(v-y)-Math.abs(u-y)}function Et(u,v,y,T,B,z,W){for(T=z[W-1],y=0;y<B;++y)z[W+y]=T=He(u[v+y],T)}function Mt(u,v,y,T,B){var z;for(z=0;z<y;++z){var W=u[v+z],G=W>>8&255,J=16711935&(J=(J=16711935&W)+((G<<16)+G));T[B+z]=(4278255360&W)+J>>>0}}function St(u,v){v.jd=u>>0&255,v.hd=u>>8&255,v.ud=u>>16&255}function ct(u,v,y,T,B,z){var W;for(W=0;W<T;++W){var G=v[y+W],J=G>>>8,te=G,pe=255&(pe=(pe=G>>>16)+((u.jd<<24>>24)*(J<<24>>24)>>>5));te=255&(te=(te=te+((u.hd<<24>>24)*(J<<24>>24)>>>5))+((u.ud<<24>>24)*(pe<<24>>24)>>>5)),B[z+W]=(4278255360&G)+(pe<<16)+te}}function tt(u,v,y,T,B){A[v]=function(z,W,G,J,te,pe,Ce,_e,we){for(J=Ce;J<_e;++J)for(Ce=0;Ce<we;++Ce)te[pe++]=B(G[T(z[W++])])},A[u]=function(z,W,G,J,te,pe,Ce){var _e=8>>z.b,we=z.Ea,Ie=z.K[0],Re=z.w;if(8>_e)for(z=(1<<z.b)-1,Re=(1<<_e)-1;W<G;++W){var me,ve=0;for(me=0;me<we;++me)me&z||(ve=T(J[te++])),pe[Ce++]=B(Ie[ve&Re]),ve>>=_e}else A["VP8LMapColor"+y](J,te,Ie,Re,pe,Ce,W,G,we)}}function Ve(u,v,y,T,B){for(y=v+y;v<y;){var z=u[v++];T[B++]=z>>16&255,T[B++]=z>>8&255,T[B++]=z>>0&255}}function $t(u,v,y,T,B){for(y=v+y;v<y;){var z=u[v++];T[B++]=z>>16&255,T[B++]=z>>8&255,T[B++]=z>>0&255,T[B++]=z>>24&255}}function pt(u,v,y,T,B){for(y=v+y;v<y;){var z=(W=u[v++])>>16&240|W>>12&15,W=W>>0&240|W>>28&15;T[B++]=z,T[B++]=W}}function qr(u,v,y,T,B){for(y=v+y;v<y;){var z=(W=u[v++])>>16&248|W>>13&7,W=W>>5&224|W>>3&31;T[B++]=z,T[B++]=W}}function Kt(u,v,y,T,B){for(y=v+y;v<y;){var z=u[v++];T[B++]=z>>0&255,T[B++]=z>>8&255,T[B++]=z>>16&255}}function ur(u,v,y,T,B,z){if(z==0)for(y=v+y;v<y;)be(T,((z=u[v++])[0]>>24|z[1]>>8&65280|z[2]<<8&16711680|z[3]<<24)>>>0),B+=32;else i(T,B,u,v,y)}function sn(u,v){A[v][0]=A[u+"0"],A[v][1]=A[u+"1"],A[v][2]=A[u+"2"],A[v][3]=A[u+"3"],A[v][4]=A[u+"4"],A[v][5]=A[u+"5"],A[v][6]=A[u+"6"],A[v][7]=A[u+"7"],A[v][8]=A[u+"8"],A[v][9]=A[u+"9"],A[v][10]=A[u+"10"],A[v][11]=A[u+"11"],A[v][12]=A[u+"12"],A[v][13]=A[u+"13"],A[v][14]=A[u+"0"],A[v][15]=A[u+"0"]}function Wt(u){return u==Bu||u==Hu||u==Vh||u==zu}function Vn(){this.eb=[],this.size=this.A=this.fb=0}function pr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Gi(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Vn,this.f.kb=new pr,this.sd=null}function Cn(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function ar(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function _t(u){return alert("todo:WebPSamplerProcessPlane"),u.T}function Gt(u,v){var y=u.T,T=v.ba.f.RGBA,B=T.eb,z=T.fb+u.ka*T.A,W=un[v.ba.S],G=u.y,J=u.O,te=u.f,pe=u.N,Ce=u.ea,_e=u.W,we=v.cc,Ie=v.dc,Re=v.Mc,me=v.Nc,ve=u.ka,Me=u.ka+u.T,ze=u.U,Oe=ze+1>>1;for(ve==0?W(G,J,null,null,te,pe,Ce,_e,te,pe,Ce,_e,B,z,null,null,ze):(W(v.ec,v.fc,G,J,we,Ie,Re,me,te,pe,Ce,_e,B,z-T.A,B,z,ze),++y);ve+2<Me;ve+=2)we=te,Ie=pe,Re=Ce,me=_e,pe+=u.Rc,_e+=u.Rc,z+=2*T.A,W(G,(J+=2*u.fa)-u.fa,G,J,we,Ie,Re,me,te,pe,Ce,_e,B,z-T.A,B,z,ze);return J+=u.fa,u.j+Me<u.o?(i(v.ec,v.fc,G,J,ze),i(v.cc,v.dc,te,pe,Oe),i(v.Mc,v.Nc,Ce,_e,Oe),y--):1&Me||W(G,J,null,null,te,pe,Ce,_e,te,pe,Ce,_e,B,z+T.A,null,null,ze),y}function us(u,v,y){var T=u.F,B=[u.J];if(T!=null){var z=u.U,W=v.ba.S,G=W==Uh||W==Vh;v=v.ba.f.RGBA;var J=[0],te=u.ka;J[0]=u.T,u.Kb&&(te==0?--J[0]:(--te,B[0]-=u.width),u.j+u.ka+u.T==u.o&&(J[0]=u.o-u.j-te));var pe=v.eb;te=v.fb+te*v.A,u=Bh(T,B[0],u.width,z,J,pe,te+(G?0:3),v.A),e(y==J),u&&Wt(W)&&Bs(pe,te,G,z,J,v.A)}return 0}function Xr(u){var v=u.ma,y=v.ba.S,T=11>y,B=y==jh||y==Wh||y==Uh||y==Iu||y==12||Wt(y);if(v.memory=null,v.Ib=null,v.Jb=null,v.Nd=null,!al(v.Oa,u,B?11:12))return 0;if(B&&Wt(y)&&We(),u.da)alert("todo:use_scaling");else{if(T){if(v.Ib=_t,u.Kb){if(y=u.U+1>>1,v.memory=s(u.U+2*y),v.memory==null)return 0;v.ec=v.memory,v.fc=0,v.cc=v.ec,v.dc=v.fc+u.U,v.Mc=v.cc,v.Nc=v.dc+y,v.Ib=Gt,We()}}else alert("todo:EmitYUV");B&&(v.Jb=us,T&&xe())}if(T&&!_0){for(u=0;256>u;++u)c2[u]=89858*(u-128)+qh>>Gh,d2[u]=-22014*(u-128)+qh,f2[u]=-45773*(u-128),u2[u]=113618*(u-128)+qh>>Gh;for(u=pl;u<Uu;++u)v=76283*(u-16)+qh>>Gh,p2[u-pl]=Ki(v,255),m2[u-pl]=Ki(v+8>>4,15);_0=1}return 1}function an(u){var v=u.ma,y=u.U,T=u.T;return e(!(1&u.ka)),0>=y||0>=T?0:(y=v.Ib(u,v),v.Jb!=null&&v.Jb(u,v,y),v.Dc+=y,1)}function on(u){u.ma.memory=null}function mt(u,v,y,T){return fe(u,8)!=47?0:(v[0]=fe(u,14)+1,y[0]=fe(u,14)+1,T[0]=fe(u,1),fe(u,3)!=0?0:!u.h)}function qi(u,v){if(4>u)return u+1;var y=u-2>>1;return(2+(1&u)<<y)+fe(v,y)+1}function Pi(u,v){return 120<v?v-120:1<=(y=((y=$v[v-1])>>4)*u+(8-(15&y)))?y:1;var y}function ci(u,v,y){var T=P(y),B=u[v+=255&T].g-8;return 0<B&&(I(y,y.u+8),T=P(y),v+=u[v].value,v+=T&(1<<B)-1),I(y,y.u+u[v].g),u[v].value}function Rr(u,v,y){return y.g+=u.g,y.value+=u.value<<v>>>0,e(8>=y.g),u.g}function Er(u,v,y){var T=u.xc;return e((v=T==0?0:u.vc[u.md*(y>>T)+(v>>T)])<u.Wb),u.Ya[v]}function j(u,v,y,T){var B=u.ab,z=u.c*v,W=u.C;v=W+v;var G=y,J=T;for(T=u.Ta,y=u.Ua;0<B--;){var te=u.gc[B],pe=W,Ce=v,_e=G,we=J,Ie=(J=T,G=y,te.Ea);switch(e(pe<Ce),e(Ce<=te.nc),te.hc){case 2:Ih(_e,we,(Ce-pe)*Ie,J,G);break;case 0:var Re=pe,me=Ce,ve=J,Me=G,ze=(rt=te).Ea;Re==0&&(Pu(_e,we,null,null,1,ve,Me),Et(_e,we+1,0,0,ze-1,ve,Me+1),we+=ze,Me+=ze,++Re);for(var Oe=1<<rt.b,at=Oe-1,et=Je(ze,rt.b),gt=rt.K,rt=rt.w+(Re>>rt.b)*et;Re<me;){var Xt=gt,Jt=rt,Ut=1;for(hl(_e,we,ve,Me-ze,1,ve,Me);Ut<ze;){var Bt=(Ut&~at)+Oe;Bt>ze&&(Bt=ze),(0,Ds[Xt[Jt++]>>8&15])(_e,we+ +Ut,ve,Me+Ut-ze,Bt-Ut,ve,Me+Ut),Ut=Bt}we+=ze,Me+=ze,++Re&at||(rt+=et)}Ce!=te.nc&&i(J,G-Ie,J,G+(Ce-pe-1)*Ie,Ie);break;case 1:for(Ie=_e,me=we,ze=(_e=te.Ea)-(Me=_e&~(ve=(we=1<<te.b)-1)),Re=Je(_e,te.b),Oe=te.K,te=te.w+(pe>>te.b)*Re;pe<Ce;){for(at=Oe,et=te,gt=new Ze,rt=me+Me,Xt=me+_e;me<rt;)St(at[et++],gt),ln(gt,Ie,me,we,J,G),me+=we,G+=we;me<Xt&&(St(at[et++],gt),ln(gt,Ie,me,ze,J,G),me+=ze,G+=ze),++pe&ve||(te+=Re)}break;case 3:if(_e==J&&we==G&&0<te.b){for(me=J,_e=Ie=G+(Ce-pe)*Ie-(Me=(Ce-pe)*Je(te.Ea,te.b)),we=J,ve=G,Re=[],Me=(ze=Me)-1;0<=Me;--Me)Re[Me]=we[ve+Me];for(Me=ze-1;0<=Me;--Me)me[_e+Me]=Re[Me];Fn(te,pe,Ce,J,Ie,J,G)}else Fn(te,pe,Ce,_e,we,J,G)}G=T,J=y}J!=y&&i(T,y,G,J,z)}function ne(u,v){var y=u.V,T=u.Ba+u.c*u.C,B=v-u.C;if(e(v<=u.l.o),e(16>=B),0<B){var z=u.l,W=u.Ta,G=u.Ua,J=z.width;if(j(u,B,y,T),B=G=[G],e((y=u.C)<(T=v)),e(z.v<z.va),T>z.o&&(T=z.o),y<z.j){var te=z.j-y;y=z.j,B[0]+=te*J}if(y>=T?y=0:(B[0]+=4*z.v,z.ka=y-z.j,z.U=z.va-z.v,z.T=T-y,y=1),y){if(G=G[0],11>(y=u.ca).S){var pe=y.f.RGBA,Ce=(T=y.S,B=z.U,z=z.T,te=pe.eb,pe.A),_e=z;for(pe=pe.fb+u.Ma*pe.A;0<_e--;){var we=W,Ie=G,Re=B,me=te,ve=pe;switch(T){case zh:Rn(we,Ie,Re,me,ve);break;case jh:Ms(we,Ie,Re,me,ve);break;case Bu:Ms(we,Ie,Re,me,ve),Bs(me,ve,0,Re,1,0);break;case m0:lo(we,Ie,Re,me,ve);break;case Wh:ur(we,Ie,Re,me,ve,1);break;case Hu:ur(we,Ie,Re,me,ve,1),Bs(me,ve,0,Re,1,0);break;case Uh:ur(we,Ie,Re,me,ve,0);break;case Vh:ur(we,Ie,Re,me,ve,0),Bs(me,ve,1,Re,1,0);break;case Iu:Kn(we,Ie,Re,me,ve);break;case zu:Kn(we,Ie,Re,me,ve),uo(me,ve,Re,1,0);break;case g0:gs(we,Ie,Re,me,ve);break;default:e(0)}G+=J,pe+=Ce}u.Ma+=z}else alert("todo:EmitRescaledRowsYUVA");e(u.Ma<=y.height)}}u.C=v,e(u.C<=u.i)}function Q(u){var v;if(0<u.ua)return 0;for(v=0;v<u.Wb;++v){var y=u.Ya[v].G,T=u.Ya[v].H;if(0<y[1][T[1]+0].g||0<y[2][T[2]+0].g||0<y[3][T[3]+0].g)return 0}return 1}function ee(u,v,y,T,B,z){if(u.Z!=0){var W=u.qd,G=u.rd;for(e(zs[u.Z]!=null);v<y;++v)zs[u.Z](W,G,T,B,T,B,z),W=T,G=B,B+=z;u.qd=W,u.rd=G}}function ie(u,v){var y=u.l.ma,T=y.Z==0||y.Z==1?u.l.j:u.C;if(T=u.C<T?T:u.C,e(v<=u.l.o),v>T){var B=u.l.width,z=y.ca,W=y.tb+B*T,G=u.V,J=u.Ba+u.c*T,te=u.gc;e(u.ab==1),e(te[0].hc==3),Du(te[0],T,v,G,J,z,W),ee(y,T,v,z,W,B)}u.C=u.Ma=v}function ae(u,v,y,T,B,z,W){var G=u.$/T,J=u.$%T,te=u.m,pe=u.s,Ce=y+u.$,_e=Ce;B=y+T*B;var we=y+T*z,Ie=280+pe.ua,Re=u.Pb?G:16777216,me=0<pe.ua?pe.Wa:null,ve=pe.wc,Me=Ce<we?Er(pe,J,G):null;e(u.C<z),e(we<=B);var ze=!1;e:for(;;){for(;ze||Ce<we;){var Oe=0;if(G>=Re){var at=Ce-y;e((Re=u).Pb),Re.wd=Re.m,Re.xd=at,0<Re.s.ua&&Se(Re.s.Wa,Re.s.vb),Re=G+Zv}if(J&ve||(Me=Er(pe,J,G)),e(Me!=null),Me.Qb&&(v[Ce]=Me.qb,ze=!0),!ze)if(X(te),Me.jc){Oe=te,at=v;var et=Ce,gt=Me.pd[P(Oe)&Mi-1];e(Me.jc),256>gt.g?(I(Oe,Oe.u+gt.g),at[et]=gt.value,Oe=0):(I(Oe,Oe.u+gt.g-256),e(256<=gt.value),Oe=gt.value),Oe==0&&(ze=!0)}else Oe=ci(Me.G[0],Me.H[0],te);if(te.h)break;if(ze||256>Oe){if(!ze)if(Me.nd)v[Ce]=(Me.qb|Oe<<8)>>>0;else{if(X(te),ze=ci(Me.G[1],Me.H[1],te),X(te),at=ci(Me.G[2],Me.H[2],te),et=ci(Me.G[3],Me.H[3],te),te.h)break;v[Ce]=(et<<24|ze<<16|Oe<<8|at)>>>0}if(ze=!1,++Ce,++J>=T&&(J=0,++G,W!=null&&G<=z&&!(G%16)&&W(u,G),me!=null))for(;_e<Ce;)Oe=v[_e++],me.X[(506832829*Oe&4294967295)>>>me.Mb]=Oe}else if(280>Oe){if(Oe=qi(Oe-256,te),at=ci(Me.G[4],Me.H[4],te),X(te),at=Pi(T,at=qi(at,te)),te.h)break;if(Ce-y<at||B-Ce<Oe)break e;for(et=0;et<Oe;++et)v[Ce+et]=v[Ce+et-at];for(Ce+=Oe,J+=Oe;J>=T;)J-=T,++G,W!=null&&G<=z&&!(G%16)&&W(u,G);if(e(Ce<=B),J&ve&&(Me=Er(pe,J,G)),me!=null)for(;_e<Ce;)Oe=v[_e++],me.X[(506832829*Oe&4294967295)>>>me.Mb]=Oe}else{if(!(Oe<Ie))break e;for(ze=Oe-280,e(me!=null);_e<Ce;)Oe=v[_e++],me.X[(506832829*Oe&4294967295)>>>me.Mb]=Oe;Oe=Ce,e(!(ze>>>(at=me).Xa)),v[Oe]=at.X[ze],ze=!0}ze||e(te.h==N(te))}if(u.Pb&&te.h&&Ce<B)e(u.m.h),u.a=5,u.m=u.wd,u.$=u.xd,0<u.s.ua&&Se(u.s.vb,u.s.Wa);else{if(te.h)break e;W?.(u,G>z?z:G),u.a=0,u.$=Ce-y}return 1}return u.a=3,0}function Ee(u){e(u!=null),u.vc=null,u.yc=null,u.Ya=null;var v=u.Wa;v!=null&&(v.X=null),u.vb=null,e(u!=null)}function Fe(){var u=new Nu;return u==null?null:(u.a=0,u.xb=w0,sn("Predictor","VP8LPredictors"),sn("Predictor","VP8LPredictors_C"),sn("PredictorAdd","VP8LPredictorsAdd"),sn("PredictorAdd","VP8LPredictorsAdd_C"),Ih=Mt,ln=ct,Rn=Ve,Ms=$t,Kn=pt,gs=qr,lo=Kt,A.VP8LMapColor32b=cl,A.VP8LMapColor8b=Mu,u)}function ye(u,v,y,T,B){var z=1,W=[u],G=[v],J=T.m,te=T.s,pe=null,Ce=0;e:for(;;){if(y)for(;z&&fe(J,1);){var _e=W,we=G,Ie=T,Re=1,me=Ie.m,ve=Ie.gc[Ie.ab],Me=fe(me,2);if(Ie.Oc&1<<Me)z=0;else{switch(Ie.Oc|=1<<Me,ve.hc=Me,ve.Ea=_e[0],ve.nc=we[0],ve.K=[null],++Ie.ab,e(4>=Ie.ab),Me){case 0:case 1:ve.b=fe(me,3)+2,Re=ye(Je(ve.Ea,ve.b),Je(ve.nc,ve.b),0,Ie,ve.K),ve.K=ve.K[0];break;case 3:var ze,Oe=fe(me,8)+1,at=16<Oe?0:4<Oe?1:2<Oe?2:3;if(_e[0]=Je(ve.Ea,at),ve.b=at,ze=Re=ye(Oe,1,0,Ie,ve.K)){var et,gt=Oe,rt=ve,Xt=1<<(8>>rt.b),Jt=s(Xt);if(Jt==null)ze=0;else{var Ut=rt.K[0],Bt=rt.w;for(Jt[0]=rt.K[0][0],et=1;et<1*gt;++et)Jt[et]=He(Ut[Bt+et],Jt[et-1]);for(;et<4*Xt;++et)Jt[et]=0;rt.K[0]=null,rt.K[0]=Jt,ze=1}}Re=ze;break;case 2:break;default:e(0)}z=Re}}if(W=W[0],G=G[0],z&&fe(J,1)&&!(z=1<=(Ce=fe(J,4))&&11>=Ce)){T.a=3;break e}var or;if(or=z)t:{var nr,Ft,jr,Ii=T,Wr=W,Bi=G,Zt=Ce,$i=y,Ji=Ii.m,Qr=Ii.s,si=[null],Ai=1,fn=0,Yn=Jv[Zt];r:for(;;){if($i&&fe(Ji,1)){var ei=fe(Ji,3)+2,ys=Je(Wr,ei),ba=Je(Bi,ei),fo=ys*ba;if(!ye(ys,ba,0,Ii,si))break r;for(si=si[0],Qr.xc=ei,nr=0;nr<fo;++nr){var js=si[nr]>>8&65535;si[nr]=js,js>=Ai&&(Ai=js+1)}}if(Ji.h)break r;for(Ft=0;5>Ft;++Ft){var _r=v0[Ft];!Ft&&0<Zt&&(_r+=1<<Zt),fn<_r&&(fn=_r)}var Vu=a(Ai*Yn,k),T0=Ai,A0=a(T0,V);if(A0==null)var Kh=null;else e(65536>=T0),Kh=A0;var ml=s(fn);if(Kh==null||ml==null||Vu==null){Ii.a=1;break r}var Yh=Vu;for(nr=jr=0;nr<Ai;++nr){var Dn=Kh[nr],po=Dn.G,mo=Dn.H,F0=0,$h=1,R0=0;for(Ft=0;5>Ft;++Ft){_r=v0[Ft],po[Ft]=Yh,mo[Ft]=jr,!Ft&&0<Zt&&(_r+=1<<Zt);n:{var Jh,Gu=_r,Zh=Ii,gl=ml,b2=Yh,w2=jr,qu=0,Ws=Zh.m,x2=fe(Ws,1);if(n(gl,0,0,Gu),x2){var y2=fe(Ws,1)+1,E2=fe(Ws,1),L0=fe(Ws,E2==0?1:8);gl[L0]=1,y2==2&&(gl[L0=fe(Ws,8)]=1);var Qh=1}else{var N0=s(19),P0=fe(Ws,4)+4;if(19<P0){Zh.a=3;var ec=0;break n}for(Jh=0;Jh<P0;++Jh)N0[Yv[Jh]]=fe(Ws,3);var Xu=void 0,vl=void 0,D0=Zh,C2=N0,tc=Gu,M0=gl,Ku=0,Us=D0.m,O0=8,I0=a(128,k);i:for(;R(I0,0,7,C2,19);){if(fe(Us,1)){var _2=2+2*fe(Us,3);if((Xu=2+fe(Us,_2))>tc)break i}else Xu=tc;for(vl=0;vl<tc&&Xu--;){X(Us);var B0=I0[0+(127&P(Us))];I(Us,Us.u+B0.g);var go=B0.value;if(16>go)M0[vl++]=go,go!=0&&(O0=go);else{var k2=go==16,H0=go-16,S2=Xv[H0],z0=fe(Us,qv[H0])+S2;if(vl+z0>tc)break i;for(var T2=k2?O0:0;0<z0--;)M0[vl++]=T2}}Ku=1;break i}Ku||(D0.a=3),Qh=Ku}(Qh=Qh&&!Ws.h)&&(qu=R(b2,w2,8,gl,Gu)),Qh&&qu!=0?ec=qu:(Zh.a=3,ec=0)}if(ec==0)break r;if($h&&Kv[Ft]==1&&($h=Yh[jr].g==0),F0+=Yh[jr].g,jr+=ec,3>=Ft){var bl,Yu=ml[0];for(bl=1;bl<_r;++bl)ml[bl]>Yu&&(Yu=ml[bl]);R0+=Yu}}if(Dn.nd=$h,Dn.Qb=0,$h&&(Dn.qb=(po[3][mo[3]+0].value<<24|po[1][mo[1]+0].value<<16|po[2][mo[2]+0].value)>>>0,F0==0&&256>po[0][mo[0]+0].value&&(Dn.Qb=1,Dn.qb+=po[0][mo[0]+0].value<<8)),Dn.jc=!Dn.Qb&&6>R0,Dn.jc){var rc,Es=Dn;for(rc=0;rc<Mi;++rc){var Vs=rc,Gs=Es.pd[Vs],ic=Es.G[0][Es.H[0]+Vs];256<=ic.value?(Gs.g=ic.g+256,Gs.value=ic.value):(Gs.g=0,Gs.value=0,Vs>>=Rr(ic,8,Gs),Vs>>=Rr(Es.G[1][Es.H[1]+Vs],16,Gs),Vs>>=Rr(Es.G[2][Es.H[2]+Vs],0,Gs),Rr(Es.G[3][Es.H[3]+Vs],24,Gs))}}}Qr.vc=si,Qr.Wb=Ai,Qr.Ya=Kh,Qr.yc=Vu,or=1;break t}or=0}if(!(z=or)){T.a=3;break e}if(0<Ce){if(te.ua=1<<Ce,!Ye(te.Wa,Ce)){T.a=1,z=0;break e}}else te.ua=0;var $u=T,j0=W,A2=G,Ju=$u.s,Zu=Ju.xc;if($u.c=j0,$u.i=A2,Ju.md=Je(j0,Zu),Ju.wc=Zu==0?-1:(1<<Zu)-1,y){T.xb=s2;break e}if((pe=s(W*G))==null){T.a=1,z=0;break e}z=(z=ae(T,pe,0,W,G,G,null))&&!J.h;break e}return z?(B!=null?B[0]=pe:(e(pe==null),e(y)),T.$=0,y||Ee(te)):Ee(te),z}function ke(u,v){var y=u.c*u.i,T=y+v+16*v;return e(u.c<=v),u.V=s(T),u.V==null?(u.Ta=null,u.Ua=0,u.a=1,0):(u.Ta=u.V,u.Ua=u.Ba+y+v,1)}function Te(u,v){var y=u.C,T=v-y,B=u.V,z=u.Ba+u.c*y;for(e(v<=u.l.o);0<T;){var W=16<T?16:T,G=u.l.ma,J=u.l.width,te=J*W,pe=G.ca,Ce=G.tb+J*y,_e=u.Ta,we=u.Ua;j(u,W,B,z),h0(_e,we,pe,Ce,te),ee(G,y,y+W,pe,Ce,J),T-=W,B+=W*u.c,y+=W}e(y==v),u.C=u.Ma=v}function je(){this.ub=this.yd=this.td=this.Rb=0}function Xe(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function nt(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Ge(){this.Yb=(function(){var u=[];return(function v(y,T,B){for(var z=B[T],W=0;W<z&&(y.push(B.length>T+1?[]:0),!(B.length<T+1));W++)v(y[W],T+1,B)})(u,0,[3,11]),u})()}function it(){this.jb=s(3),this.Wc=o([4,8],Ge),this.Xc=o([4,17],Ge)}function Ct(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Yt(){this.ld=this.La=this.dd=this.tc=0}function ir(){this.Na=this.la=0}function Hr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function _n(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function fs(){this.uc=this.M=this.Nb=0,this.wa=Array(new Yt),this.Y=0,this.ya=Array(new _n),this.aa=0,this.l=new qn}function Gn(){this.y=s(16),this.f=s(8),this.ea=s(8)}function kn(){this.cb=this.a=0,this.sc="",this.m=new ge,this.Od=new je,this.Kc=new Xe,this.ed=new Ct,this.Qa=new nt,this.Ic=this.$c=this.Aa=0,this.D=new fs,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=a(8,ge),this.ia=0,this.pb=a(4,Hr),this.Pa=new it,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Gn),this.Hd=0,this.rb=Array(new ir),this.sb=0,this.wa=Array(new Yt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new _n),this.L=this.aa=0,this.gd=o([4,2],Yt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function qn(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Xi(){var u=new kn;return u!=null&&(u.a=0,u.sc="OK",u.cb=0,u.Xb=0,dl||(dl=Eh)),u}function Lr(u,v,y){return u.a==0&&(u.a=v,u.sc=y,u.cb=0),0}function xh(u,v,y){return 3<=y&&u[v+0]==157&&u[v+1]==1&&u[v+2]==42}function yh(u,v){if(u==null)return 0;if(u.a=0,u.sc="OK",v==null)return Lr(u,2,"null VP8Io passed to VP8GetHeaders()");var y=v.data,T=v.w,B=v.ha;if(4>B)return Lr(u,7,"Truncated header.");var z=y[T+0]|y[T+1]<<8|y[T+2]<<16,W=u.Od;if(W.Rb=!(1&z),W.td=z>>1&7,W.yd=z>>4&1,W.ub=z>>5,3<W.td)return Lr(u,3,"Incorrect keyframe parameters.");if(!W.yd)return Lr(u,4,"Frame not displayable.");T+=3,B-=3;var G=u.Kc;if(W.Rb){if(7>B)return Lr(u,7,"cannot parse picture header");if(!xh(y,T,B))return Lr(u,3,"Bad code word");G.c=16383&(y[T+4]<<8|y[T+3]),G.Td=y[T+4]>>6,G.i=16383&(y[T+6]<<8|y[T+5]),G.Ud=y[T+6]>>6,T+=7,B-=7,u.za=G.c+15>>4,u.Ub=G.i+15>>4,v.width=G.c,v.height=G.i,v.Da=0,v.j=0,v.v=0,v.va=v.width,v.o=v.height,v.da=0,v.ib=v.width,v.hb=v.height,v.U=v.width,v.T=v.height,n((z=u.Pa).jb,0,255,z.jb.length),e((z=u.Qa)!=null),z.Cb=0,z.Bb=0,z.Fb=1,n(z.Zb,0,0,z.Zb.length),n(z.Lb,0,0,z.Lb)}if(W.ub>B)return Lr(u,7,"bad partition length");oe(z=u.m,y,T,W.ub),T+=W.ub,B-=W.ub,W.Rb&&(G.Ld=ce(z),G.Kd=ce(z)),G=u.Qa;var J,te=u.Pa;if(e(z!=null),e(G!=null),G.Cb=ce(z),G.Cb){if(G.Bb=ce(z),ce(z)){for(G.Fb=ce(z),J=0;4>J;++J)G.Zb[J]=ce(z)?Y(z,7):0;for(J=0;4>J;++J)G.Lb[J]=ce(z)?Y(z,6):0}if(G.Bb)for(J=0;3>J;++J)te.jb[J]=ce(z)?K(z,8):255}else G.Bb=0;if(z.Ka)return Lr(u,3,"cannot parse segment header");if((G=u.ed).zd=ce(z),G.Tb=K(z,6),G.wb=K(z,3),G.Pc=ce(z),G.Pc&&ce(z)){for(te=0;4>te;++te)ce(z)&&(G.vd[te]=Y(z,6));for(te=0;4>te;++te)ce(z)&&(G.od[te]=Y(z,6))}if(u.L=G.Tb==0?0:G.zd?1:2,z.Ka)return Lr(u,3,"cannot parse filter header");var pe=B;if(B=J=T,T=J+pe,G=pe,u.Xb=(1<<K(u.m,2))-1,pe<3*(te=u.Xb))y=7;else{for(J+=3*te,G-=3*te,pe=0;pe<te;++pe){var Ce=y[B+0]|y[B+1]<<8|y[B+2]<<16;Ce>G&&(Ce=G),oe(u.Jc[+pe],y,J,Ce),J+=Ce,G-=Ce,B+=3}oe(u.Jc[+te],y,J,G),y=J<T?0:5}if(y!=0)return Lr(u,y,"cannot parse partitions");for(y=K(J=u.m,7),B=ce(J)?Y(J,4):0,T=ce(J)?Y(J,4):0,G=ce(J)?Y(J,4):0,te=ce(J)?Y(J,4):0,J=ce(J)?Y(J,4):0,pe=u.Qa,Ce=0;4>Ce;++Ce){if(pe.Cb){var _e=pe.Zb[Ce];pe.Fb||(_e+=y)}else{if(0<Ce){u.pb[Ce]=u.pb[0];continue}_e=y}var we=u.pb[Ce];we.Sc[0]=ju[Ki(_e+B,127)],we.Sc[1]=Wu[Ki(_e+0,127)],we.Eb[0]=2*ju[Ki(_e+T,127)],we.Eb[1]=101581*Wu[Ki(_e+G,127)]>>16,8>we.Eb[1]&&(we.Eb[1]=8),we.Qc[0]=ju[Ki(_e+te,117)],we.Qc[1]=Wu[Ki(_e+J,127)],we.lc=_e+J}if(!W.Rb)return Lr(u,4,"Not a key frame.");for(ce(z),W=u.Pa,y=0;4>y;++y){for(B=0;8>B;++B)for(T=0;3>T;++T)for(G=0;11>G;++G)te=ue(z,i2[y][B][T][G])?K(z,8):t2[y][B][T][G],W.Wc[y][B].Yb[T][G]=te;for(B=0;17>B;++B)W.Xc[y][B]=W.Wc[y][n2[B]]}return u.kc=ce(z),u.kc&&(u.Bd=K(z,8)),u.cb=1}function Eh(u,v,y,T,B,z,W){var G=v[B].Yb[y];for(y=0;16>B;++B){if(!ue(u,G[y+0]))return B;for(;!ue(u,G[y+1]);)if(G=v[++B].Yb[0],y=0,B==16)return 16;var J=v[B+1].Yb;if(ue(u,G[y+2])){var te=u,pe=0;if(ue(te,(_e=G)[(Ce=y)+3]))if(ue(te,_e[Ce+6])){for(G=0,Ce=2*(pe=ue(te,_e[Ce+8]))+(_e=ue(te,_e[Ce+9+pe])),pe=0,_e=Qv[Ce];_e[G];++G)pe+=pe+ue(te,_e[G]);pe+=3+(8<<Ce)}else ue(te,_e[Ce+7])?(pe=7+2*ue(te,165),pe+=ue(te,145)):pe=5+ue(te,159);else pe=ue(te,_e[Ce+4])?3+ue(te,_e[Ce+5]):2;G=J[2]}else pe=1,G=J[1];J=W+e2[B],0>(te=u).b&&he(te);var Ce,_e=te.b,we=(Ce=te.Ca>>1)-(te.I>>_e)>>31;--te.b,te.Ca+=we,te.Ca|=1,te.I-=(Ce+1&we)<<_e,z[J]=((pe^we)-we)*T[(0<B)+0]}return 16}function Go(u){var v=u.rb[u.sb-1];v.la=0,v.Na=0,n(u.zc,0,0,u.zc.length),u.ja=0}function mu(u,v){if(u==null)return 0;if(v==null)return Lr(u,2,"NULL VP8Io parameter in VP8Decode().");if(!u.cb&&!yh(u,v))return 0;if(e(u.cb),v.ac==null||v.ac(v)){v.ob&&(u.L=0);var y=Xh[u.L];if(u.L==2?(u.yb=0,u.zb=0):(u.yb=v.v-y>>4,u.zb=v.j-y>>4,0>u.yb&&(u.yb=0),0>u.zb&&(u.zb=0)),u.Va=v.o+15+y>>4,u.Hb=v.va+15+y>>4,u.Hb>u.za&&(u.Hb=u.za),u.Va>u.Ub&&(u.Va=u.Ub),0<u.L){var T=u.ed;for(y=0;4>y;++y){var B;if(u.Qa.Cb){var z=u.Qa.Lb[y];u.Qa.Fb||(z+=T.Tb)}else z=T.Tb;for(B=0;1>=B;++B){var W=u.gd[y][B],G=z;if(T.Pc&&(G+=T.vd[0],B&&(G+=T.od[0])),0<(G=0>G?0:63<G?63:G)){var J=G;0<T.wb&&(J=4<T.wb?J>>2:J>>1)>9-T.wb&&(J=9-T.wb),1>J&&(J=1),W.dd=J,W.tc=2*G+J,W.ld=40<=G?2:15<=G?1:0}else W.tc=0;W.La=B}}}y=0}else Lr(u,6,"Frame setup failed"),y=u.a;if(y=y==0){if(y){u.$c=0,0<u.Aa||(u.Ic=v2);e:{y=u.Ic,T=4*(J=u.za);var te=32*J,pe=J+1,Ce=0<u.L?J*(0<u.Aa?2:1):0,_e=(u.Aa==2?2:1)*J;if((W=T+832+(B=3*(16*y+Xh[u.L])/2*te)+(z=u.Fa!=null&&0<u.Fa.length?u.Kc.c*u.Kc.i:0))!=W)y=0;else{if(W>u.Vb){if(u.Vb=0,u.Ec=s(W),u.Fc=0,u.Ec==null){y=Lr(u,1,"no memory during frame initialization.");break e}u.Vb=W}W=u.Ec,G=u.Fc,u.Ac=W,u.Bc=G,G+=T,u.Gd=a(te,Gn),u.Hd=0,u.rb=a(pe+1,ir),u.sb=1,u.wa=Ce?a(Ce,Yt):null,u.Y=0,u.D.Nb=0,u.D.wa=u.wa,u.D.Y=u.Y,0<u.Aa&&(u.D.Y+=J),e(!0),u.oc=W,u.pc=G,G+=832,u.ya=a(_e,_n),u.aa=0,u.D.ya=u.ya,u.D.aa=u.aa,u.Aa==2&&(u.D.aa+=J),u.R=16*J,u.B=8*J,J=(te=Xh[u.L])*u.R,te=te/2*u.B,u.sa=W,u.ta=G+J,u.qa=u.sa,u.ra=u.ta+16*y*u.R+te,u.Ha=u.qa,u.Ia=u.ra+8*y*u.B+te,u.$c=0,G+=B,u.mb=z?W:null,u.nb=z?G:null,e(G+z<=u.Fc+u.Vb),Go(u),n(u.Ac,u.Bc,0,T),y=1}}if(y){if(v.ka=0,v.y=u.sa,v.O=u.ta,v.f=u.qa,v.N=u.ra,v.ea=u.Ha,v.Vd=u.Ia,v.fa=u.R,v.Rc=u.B,v.F=null,v.J=0,!p0){for(y=-255;255>=y;++y)c0[255+y]=0>y?-y:y;for(y=-1020;1020>=y;++y)u0[1020+y]=-128>y?-128:127<y?127:y;for(y=-112;112>=y;++y)f0[112+y]=-16>y?-16:15<y?15:y;for(y=-255;510>=y;++y)d0[255+y]=0>y?0:255<y?255:y;p0=1}Ln=bu,ho=gu,Os=_h,Nn=vu,vs=kh,ul=Ch,ga=Jo,co=pa,va=Lu,Is=Zo,fl=Ru,hn=eo,bs=Qo,fr=Dh,dr=Ph,Nr=ps,Kr=Ls,ws=Fu,Pn[0]=Xn,Pn[1]=wu,Pn[2]=Cu,Pn[3]=_u,Pn[4]=Ah,Pn[5]=Za,Pn[6]=Fh,Pn[7]=Ko,Pn[8]=Su,Pn[9]=ku,Hs[0]=Sh,Hs[1]=yu,Hs[2]=ds,Hs[3]=$a,Hs[4]=ui,Hs[5]=Eu,Hs[6]=Th,xs[0]=Rs,xs[1]=xu,xs[2]=Tu,xs[3]=Yo,xs[4]=da,xs[5]=Au,xs[6]=$o,y=1}else y=0}y&&(y=(function(we,Ie){for(we.M=0;we.M<we.Va;++we.M){var Re,me=we.Jc[we.M&we.Xb],ve=we.m,Me=we;for(Re=0;Re<Me.za;++Re){var ze=ve,Oe=Me,at=Oe.Ac,et=Oe.Bc+4*Re,gt=Oe.zc,rt=Oe.ya[Oe.aa+Re];if(Oe.Qa.Bb?rt.$b=ue(ze,Oe.Pa.jb[0])?2+ue(ze,Oe.Pa.jb[2]):ue(ze,Oe.Pa.jb[1]):rt.$b=0,Oe.kc&&(rt.Ad=ue(ze,Oe.Bd)),rt.Za=!ue(ze,145)+0,rt.Za){var Xt=rt.Ob,Jt=0;for(Oe=0;4>Oe;++Oe){var Ut,Bt=gt[0+Oe];for(Ut=0;4>Ut;++Ut){Bt=r2[at[et+Ut]][Bt];for(var or=b0[ue(ze,Bt[0])];0<or;)or=b0[2*or+ue(ze,Bt[or])];Bt=-or,at[et+Ut]=Bt}i(Xt,Jt,at,et,4),Jt+=4,gt[0+Oe]=Bt}}else Bt=ue(ze,156)?ue(ze,128)?1:3:ue(ze,163)?2:0,rt.Ob[0]=Bt,n(at,et,Bt,4),n(gt,0,Bt,4);rt.Dd=ue(ze,142)?ue(ze,114)?ue(ze,183)?1:3:2:0}if(Me.m.Ka)return Lr(we,7,"Premature end-of-partition0 encountered.");for(;we.ja<we.za;++we.ja){if(Me=me,ze=(ve=we).rb[ve.sb-1],at=ve.rb[ve.sb+ve.ja],Re=ve.ya[ve.aa+ve.ja],et=ve.kc?Re.Ad:0)ze.la=at.la=0,Re.Za||(ze.Na=at.Na=0),Re.Hc=0,Re.Gc=0,Re.ia=0;else{var nr,Ft;if(ze=at,at=Me,et=ve.Pa.Xc,gt=ve.ya[ve.aa+ve.ja],rt=ve.pb[gt.$b],Oe=gt.ad,Xt=0,Jt=ve.rb[ve.sb-1],Bt=Ut=0,n(Oe,Xt,0,384),gt.Za)var jr=0,Ii=et[3];else{or=s(16);var Wr=ze.Na+Jt.Na;if(Wr=dl(at,et[1],Wr,rt.Eb,0,or,0),ze.Na=Jt.Na=(0<Wr)+0,1<Wr)Ln(or,0,Oe,Xt);else{var Bi=or[0]+3>>3;for(or=0;256>or;or+=16)Oe[Xt+or]=Bi}jr=1,Ii=et[0]}var Zt=15&ze.la,$i=15&Jt.la;for(or=0;4>or;++or){var Ji=1&$i;for(Bi=Ft=0;4>Bi;++Bi)Zt=Zt>>1|(Ji=(Wr=dl(at,Ii,Wr=Ji+(1&Zt),rt.Sc,jr,Oe,Xt))>jr)<<7,Ft=Ft<<2|(3<Wr?3:1<Wr?2:Oe[Xt+0]!=0),Xt+=16;Zt>>=4,$i=$i>>1|Ji<<7,Ut=(Ut<<8|Ft)>>>0}for(Ii=Zt,jr=$i>>4,nr=0;4>nr;nr+=2){for(Ft=0,Zt=ze.la>>4+nr,$i=Jt.la>>4+nr,or=0;2>or;++or){for(Ji=1&$i,Bi=0;2>Bi;++Bi)Wr=Ji+(1&Zt),Zt=Zt>>1|(Ji=0<(Wr=dl(at,et[2],Wr,rt.Qc,0,Oe,Xt)))<<3,Ft=Ft<<2|(3<Wr?3:1<Wr?2:Oe[Xt+0]!=0),Xt+=16;Zt>>=2,$i=$i>>1|Ji<<5}Bt|=Ft<<4*nr,Ii|=Zt<<4<<nr,jr|=(240&$i)<<nr}ze.la=Ii,Jt.la=jr,gt.Hc=Ut,gt.Gc=Bt,gt.ia=43690&Bt?0:rt.ia,et=!(Ut|Bt)}if(0<ve.L&&(ve.wa[ve.Y+ve.ja]=ve.gd[Re.$b][Re.Za],ve.wa[ve.Y+ve.ja].La|=!et),Me.Ka)return Lr(we,7,"Premature end-of-file encountered.")}if(Go(we),ve=Ie,Me=1,Re=(me=we).D,ze=0<me.L&&me.M>=me.zb&&me.M<=me.Va,me.Aa==0)e:{if(Re.M=me.M,Re.uc=ze,sl(me,Re),Me=1,Re=(Ft=me.D).Nb,ze=(Bt=Xh[me.L])*me.R,at=Bt/2*me.B,or=16*Re*me.R,Bi=8*Re*me.B,et=me.sa,gt=me.ta-ze+or,rt=me.qa,Oe=me.ra-at+Bi,Xt=me.Ha,Jt=me.Ia-at+Bi,$i=(Zt=Ft.M)==0,Ut=Zt>=me.Va-1,me.Aa==2&&sl(me,Ft),Ft.uc)for(Ji=(Wr=me).D.M,e(Wr.D.uc),Ft=Wr.yb;Ft<Wr.Hb;++Ft){jr=Ft,Ii=Ji;var Qr=(si=(_r=Wr).D).Nb;nr=_r.R;var si=si.wa[si.Y+jr],Ai=_r.sa,fn=_r.ta+16*Qr*nr+16*jr,Yn=si.dd,ei=si.tc;if(ei!=0)if(e(3<=ei),_r.L==1)0<jr&&Nr(Ai,fn,nr,ei+4),si.La&&ws(Ai,fn,nr,ei),0<Ii&&dr(Ai,fn,nr,ei+4),si.La&&Kr(Ai,fn,nr,ei);else{var ys=_r.B,ba=_r.qa,fo=_r.ra+8*Qr*ys+8*jr,js=_r.Ha,_r=_r.Ia+8*Qr*ys+8*jr;Qr=si.ld,0<jr&&(co(Ai,fn,nr,ei+4,Yn,Qr),Is(ba,fo,js,_r,ys,ei+4,Yn,Qr)),si.La&&(hn(Ai,fn,nr,ei,Yn,Qr),fr(ba,fo,js,_r,ys,ei,Yn,Qr)),0<Ii&&(ga(Ai,fn,nr,ei+4,Yn,Qr),va(ba,fo,js,_r,ys,ei+4,Yn,Qr)),si.La&&(fl(Ai,fn,nr,ei,Yn,Qr),bs(ba,fo,js,_r,ys,ei,Yn,Qr))}}if(me.ia&&alert("todo:DitherRow"),ve.put!=null){if(Ft=16*Zt,Zt=16*(Zt+1),$i?(ve.y=me.sa,ve.O=me.ta+or,ve.f=me.qa,ve.N=me.ra+Bi,ve.ea=me.Ha,ve.W=me.Ia+Bi):(Ft-=Bt,ve.y=et,ve.O=gt,ve.f=rt,ve.N=Oe,ve.ea=Xt,ve.W=Jt),Ut||(Zt-=Bt),Zt>ve.o&&(Zt=ve.o),ve.F=null,ve.J=null,me.Fa!=null&&0<me.Fa.length&&Ft<Zt&&(ve.J=il(me,ve,Ft,Zt-Ft),ve.F=me.mb,ve.F==null&&ve.F.length==0)){Me=Lr(me,3,"Could not decode alpha data.");break e}Ft<ve.j&&(Bt=ve.j-Ft,Ft=ve.j,e(!(1&Bt)),ve.O+=me.R*Bt,ve.N+=me.B*(Bt>>1),ve.W+=me.B*(Bt>>1),ve.F!=null&&(ve.J+=ve.width*Bt)),Ft<Zt&&(ve.O+=ve.v,ve.N+=ve.v>>1,ve.W+=ve.v>>1,ve.F!=null&&(ve.J+=ve.v),ve.ka=Ft-ve.j,ve.U=ve.va-ve.v,ve.T=Zt-Ft,Me=ve.put(ve))}Re+1!=me.Ic||Ut||(i(me.sa,me.ta-ze,et,gt+16*me.R,ze),i(me.qa,me.ra-at,rt,Oe+8*me.B,at),i(me.Ha,me.Ia-at,Xt,Jt+8*me.B,at))}if(!Me)return Lr(we,6,"Output aborted.")}return 1})(u,v)),v.bc!=null&&v.bc(v),y&=1}return y?(u.cb=0,y):0}function Sn(u,v,y,T,B){B=u[v+y+32*T]+(B>>3),u[v+y+32*T]=-256&B?0>B?0:255:B}function Ya(u,v,y,T,B,z){Sn(u,v,0,y,T+B),Sn(u,v,1,y,T+z),Sn(u,v,2,y,T-z),Sn(u,v,3,y,T-B)}function Di(u){return(20091*u>>16)+u}function qo(u,v,y,T){var B,z=0,W=s(16);for(B=0;4>B;++B){var G=u[v+0]+u[v+8],J=u[v+0]-u[v+8],te=(35468*u[v+4]>>16)-Di(u[v+12]),pe=Di(u[v+4])+(35468*u[v+12]>>16);W[z+0]=G+pe,W[z+1]=J+te,W[z+2]=J-te,W[z+3]=G-pe,z+=4,v++}for(B=z=0;4>B;++B)G=(u=W[z+0]+4)+W[z+8],J=u-W[z+8],te=(35468*W[z+4]>>16)-Di(W[z+12]),Sn(y,T,0,0,G+(pe=Di(W[z+4])+(35468*W[z+12]>>16))),Sn(y,T,1,0,J+te),Sn(y,T,2,0,J-te),Sn(y,T,3,0,G-pe),z++,T+=32}function Ch(u,v,y,T){var B=u[v+0]+4,z=35468*u[v+4]>>16,W=Di(u[v+4]),G=35468*u[v+1]>>16;Ya(y,T,0,B+W,u=Di(u[v+1]),G),Ya(y,T,1,B+z,u,G),Ya(y,T,2,B-z,u,G),Ya(y,T,3,B-W,u,G)}function gu(u,v,y,T,B){qo(u,v,y,T),B&&qo(u,v+16,y,T+4)}function _h(u,v,y,T){ho(u,v+0,y,T,1),ho(u,v+32,y,T+128,1)}function vu(u,v,y,T){var B;for(u=u[v+0]+4,B=0;4>B;++B)for(v=0;4>v;++v)Sn(y,T,v,B,u)}function kh(u,v,y,T){u[v+0]&&Nn(u,v+0,y,T),u[v+16]&&Nn(u,v+16,y,T+4),u[v+32]&&Nn(u,v+32,y,T+128),u[v+48]&&Nn(u,v+48,y,T+128+4)}function bu(u,v,y,T){var B,z=s(16);for(B=0;4>B;++B){var W=u[v+0+B]+u[v+12+B],G=u[v+4+B]+u[v+8+B],J=u[v+4+B]-u[v+8+B],te=u[v+0+B]-u[v+12+B];z[0+B]=W+G,z[8+B]=W-G,z[4+B]=te+J,z[12+B]=te-J}for(B=0;4>B;++B)W=(u=z[0+4*B]+3)+z[3+4*B],G=z[1+4*B]+z[2+4*B],J=z[1+4*B]-z[2+4*B],te=u-z[3+4*B],y[T+0]=W+G>>3,y[T+16]=te+J>>3,y[T+32]=W-G>>3,y[T+48]=te-J>>3,T+=64}function Xo(u,v,y){var T,B=v-32,z=Yi,W=255-u[B-1];for(T=0;T<y;++T){var G,J=z,te=W+u[v-1];for(G=0;G<y;++G)u[v+G]=J[te+u[B+G]];v+=32}}function wu(u,v){Xo(u,v,4)}function xu(u,v){Xo(u,v,8)}function yu(u,v){Xo(u,v,16)}function ds(u,v){var y;for(y=0;16>y;++y)i(u,v+32*y,u,v-32,16)}function $a(u,v){var y;for(y=16;0<y;--y)n(u,v,u[v-1],16),v+=32}function Ja(u,v,y){var T;for(T=0;16>T;++T)n(v,y+32*T,u,16)}function Sh(u,v){var y,T=16;for(y=0;16>y;++y)T+=u[v-1+32*y]+u[v+y-32];Ja(T>>5,u,v)}function ui(u,v){var y,T=8;for(y=0;16>y;++y)T+=u[v-1+32*y];Ja(T>>4,u,v)}function Eu(u,v){var y,T=8;for(y=0;16>y;++y)T+=u[v+y-32];Ja(T>>4,u,v)}function Th(u,v){Ja(128,u,v)}function kt(u,v,y){return u+2*v+y+2>>2}function Cu(u,v){var y,T=v-32;for(T=new Uint8Array([kt(u[T-1],u[T+0],u[T+1]),kt(u[T+0],u[T+1],u[T+2]),kt(u[T+1],u[T+2],u[T+3]),kt(u[T+2],u[T+3],u[T+4])]),y=0;4>y;++y)i(u,v+32*y,T,0,T.length)}function _u(u,v){var y=u[v-1],T=u[v-1+32],B=u[v-1+64],z=u[v-1+96];be(u,v+0,16843009*kt(u[v-1-32],y,T)),be(u,v+32,16843009*kt(y,T,B)),be(u,v+64,16843009*kt(T,B,z)),be(u,v+96,16843009*kt(B,z,z))}function Xn(u,v){var y,T=4;for(y=0;4>y;++y)T+=u[v+y-32]+u[v-1+32*y];for(T>>=3,y=0;4>y;++y)n(u,v+32*y,T,4)}function Ah(u,v){var y=u[v-1+0],T=u[v-1+32],B=u[v-1+64],z=u[v-1-32],W=u[v+0-32],G=u[v+1-32],J=u[v+2-32],te=u[v+3-32];u[v+0+96]=kt(T,B,u[v-1+96]),u[v+1+96]=u[v+0+64]=kt(y,T,B),u[v+2+96]=u[v+1+64]=u[v+0+32]=kt(z,y,T),u[v+3+96]=u[v+2+64]=u[v+1+32]=u[v+0+0]=kt(W,z,y),u[v+3+64]=u[v+2+32]=u[v+1+0]=kt(G,W,z),u[v+3+32]=u[v+2+0]=kt(J,G,W),u[v+3+0]=kt(te,J,G)}function Fh(u,v){var y=u[v+1-32],T=u[v+2-32],B=u[v+3-32],z=u[v+4-32],W=u[v+5-32],G=u[v+6-32],J=u[v+7-32];u[v+0+0]=kt(u[v+0-32],y,T),u[v+1+0]=u[v+0+32]=kt(y,T,B),u[v+2+0]=u[v+1+32]=u[v+0+64]=kt(T,B,z),u[v+3+0]=u[v+2+32]=u[v+1+64]=u[v+0+96]=kt(B,z,W),u[v+3+32]=u[v+2+64]=u[v+1+96]=kt(z,W,G),u[v+3+64]=u[v+2+96]=kt(W,G,J),u[v+3+96]=kt(G,J,J)}function Za(u,v){var y=u[v-1+0],T=u[v-1+32],B=u[v-1+64],z=u[v-1-32],W=u[v+0-32],G=u[v+1-32],J=u[v+2-32],te=u[v+3-32];u[v+0+0]=u[v+1+64]=z+W+1>>1,u[v+1+0]=u[v+2+64]=W+G+1>>1,u[v+2+0]=u[v+3+64]=G+J+1>>1,u[v+3+0]=J+te+1>>1,u[v+0+96]=kt(B,T,y),u[v+0+64]=kt(T,y,z),u[v+0+32]=u[v+1+96]=kt(y,z,W),u[v+1+32]=u[v+2+96]=kt(z,W,G),u[v+2+32]=u[v+3+96]=kt(W,G,J),u[v+3+32]=kt(G,J,te)}function Ko(u,v){var y=u[v+0-32],T=u[v+1-32],B=u[v+2-32],z=u[v+3-32],W=u[v+4-32],G=u[v+5-32],J=u[v+6-32],te=u[v+7-32];u[v+0+0]=y+T+1>>1,u[v+1+0]=u[v+0+64]=T+B+1>>1,u[v+2+0]=u[v+1+64]=B+z+1>>1,u[v+3+0]=u[v+2+64]=z+W+1>>1,u[v+0+32]=kt(y,T,B),u[v+1+32]=u[v+0+96]=kt(T,B,z),u[v+2+32]=u[v+1+96]=kt(B,z,W),u[v+3+32]=u[v+2+96]=kt(z,W,G),u[v+3+64]=kt(W,G,J),u[v+3+96]=kt(G,J,te)}function ku(u,v){var y=u[v-1+0],T=u[v-1+32],B=u[v-1+64],z=u[v-1+96];u[v+0+0]=y+T+1>>1,u[v+2+0]=u[v+0+32]=T+B+1>>1,u[v+2+32]=u[v+0+64]=B+z+1>>1,u[v+1+0]=kt(y,T,B),u[v+3+0]=u[v+1+32]=kt(T,B,z),u[v+3+32]=u[v+1+64]=kt(B,z,z),u[v+3+64]=u[v+2+64]=u[v+0+96]=u[v+1+96]=u[v+2+96]=u[v+3+96]=z}function Su(u,v){var y=u[v-1+0],T=u[v-1+32],B=u[v-1+64],z=u[v-1+96],W=u[v-1-32],G=u[v+0-32],J=u[v+1-32],te=u[v+2-32];u[v+0+0]=u[v+2+32]=y+W+1>>1,u[v+0+32]=u[v+2+64]=T+y+1>>1,u[v+0+64]=u[v+2+96]=B+T+1>>1,u[v+0+96]=z+B+1>>1,u[v+3+0]=kt(G,J,te),u[v+2+0]=kt(W,G,J),u[v+1+0]=u[v+3+32]=kt(y,W,G),u[v+1+32]=u[v+3+64]=kt(T,y,W),u[v+1+64]=u[v+3+96]=kt(B,T,y),u[v+1+96]=kt(z,B,T)}function Tu(u,v){var y;for(y=0;8>y;++y)i(u,v+32*y,u,v-32,8)}function Yo(u,v){var y;for(y=0;8>y;++y)n(u,v,u[v-1],8),v+=32}function fa(u,v,y){var T;for(T=0;8>T;++T)n(v,y+32*T,u,8)}function Rs(u,v){var y,T=8;for(y=0;8>y;++y)T+=u[v+y-32]+u[v-1+32*y];fa(T>>4,u,v)}function Au(u,v){var y,T=4;for(y=0;8>y;++y)T+=u[v+y-32];fa(T>>3,u,v)}function da(u,v){var y,T=4;for(y=0;8>y;++y)T+=u[v-1+32*y];fa(T>>3,u,v)}function $o(u,v){fa(128,u,v)}function Qa(u,v,y){var T=u[v-y],B=u[v+0],z=3*(B-T)+Ou[1020+u[v-2*y]-u[v+y]],W=Hh[112+(z+4>>3)];u[v-y]=Yi[255+T+Hh[112+(z+3>>3)]],u[v+0]=Yi[255+B-W]}function Rh(u,v,y,T){var B=u[v+0],z=u[v+y];return cn[255+u[v-2*y]-u[v-y]]>T||cn[255+z-B]>T}function Lh(u,v,y,T){return 4*cn[255+u[v-y]-u[v+0]]+cn[255+u[v-2*y]-u[v+y]]<=T}function Nh(u,v,y,T,B){var z=u[v-3*y],W=u[v-2*y],G=u[v-y],J=u[v+0],te=u[v+y],pe=u[v+2*y],Ce=u[v+3*y];return 4*cn[255+G-J]+cn[255+W-te]>T?0:cn[255+u[v-4*y]-z]<=B&&cn[255+z-W]<=B&&cn[255+W-G]<=B&&cn[255+Ce-pe]<=B&&cn[255+pe-te]<=B&&cn[255+te-J]<=B}function Ph(u,v,y,T){var B=2*T+1;for(T=0;16>T;++T)Lh(u,v+T,y,B)&&Qa(u,v+T,y)}function ps(u,v,y,T){var B=2*T+1;for(T=0;16>T;++T)Lh(u,v+T*y,1,B)&&Qa(u,v+T*y,1)}function Ls(u,v,y,T){var B;for(B=3;0<B;--B)Ph(u,v+=4*y,y,T)}function Fu(u,v,y,T){var B;for(B=3;0<B;--B)ps(u,v+=4,y,T)}function Ns(u,v,y,T,B,z,W,G){for(z=2*z+1;0<B--;){if(Nh(u,v,y,z,W))if(Rh(u,v,y,G))Qa(u,v,y);else{var J=u,te=v,pe=y,Ce=J[te-2*pe],_e=J[te-pe],we=J[te+0],Ie=J[te+pe],Re=J[te+2*pe],me=27*(Me=Ou[1020+3*(we-_e)+Ou[1020+Ce-Ie]])+63>>7,ve=18*Me+63>>7,Me=9*Me+63>>7;J[te-3*pe]=Yi[255+J[te-3*pe]+Me],J[te-2*pe]=Yi[255+Ce+ve],J[te-pe]=Yi[255+_e+me],J[te+0]=Yi[255+we-me],J[te+pe]=Yi[255+Ie-ve],J[te+2*pe]=Yi[255+Re-Me]}v+=T}}function Tn(u,v,y,T,B,z,W,G){for(z=2*z+1;0<B--;){if(Nh(u,v,y,z,W))if(Rh(u,v,y,G))Qa(u,v,y);else{var J=u,te=v,pe=y,Ce=J[te-pe],_e=J[te+0],we=J[te+pe],Ie=Hh[112+((Re=3*(_e-Ce))+4>>3)],Re=Hh[112+(Re+3>>3)],me=Ie+1>>1;J[te-2*pe]=Yi[255+J[te-2*pe]+me],J[te-pe]=Yi[255+Ce+Re],J[te+0]=Yi[255+_e-Ie],J[te+pe]=Yi[255+we-me]}v+=T}}function Jo(u,v,y,T,B,z){Ns(u,v,y,1,16,T,B,z)}function pa(u,v,y,T,B,z){Ns(u,v,1,y,16,T,B,z)}function Ru(u,v,y,T,B,z){var W;for(W=3;0<W;--W)Tn(u,v+=4*y,y,1,16,T,B,z)}function eo(u,v,y,T,B,z){var W;for(W=3;0<W;--W)Tn(u,v+=4,1,y,16,T,B,z)}function Lu(u,v,y,T,B,z,W,G){Ns(u,v,B,1,8,z,W,G),Ns(y,T,B,1,8,z,W,G)}function Zo(u,v,y,T,B,z,W,G){Ns(u,v,1,B,8,z,W,G),Ns(y,T,1,B,8,z,W,G)}function Qo(u,v,y,T,B,z,W,G){Tn(u,v+4*B,B,1,8,z,W,G),Tn(y,T+4*B,B,1,8,z,W,G)}function Dh(u,v,y,T,B,z,W,G){Tn(u,v+4,1,B,8,z,W,G),Tn(y,T+4,1,B,8,z,W,G)}function to(){this.ba=new Gi,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new ar,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function el(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function tl(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Mh(){this.ua=0,this.Wa=new re,this.vb=new re,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new V,this.yc=new k}function Nu(){this.xb=this.a=0,this.l=new qn,this.ca=new Gi,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new _,this.Pb=0,this.wd=new _,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Mh,this.ab=0,this.gc=a(4,tl),this.Oc=0}function ro(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new qn,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ma(u,v,y,T,B,z,W){for(u=u==null?0:u[v+0],v=0;v<W;++v)B[z+v]=u+y[T+v]&255,u=B[z+v]}function rl(u,v,y,T,B,z,W){var G;if(u==null)ma(null,null,y,T,B,z,W);else for(G=0;G<W;++G)B[z+G]=u[v+G]+y[T+G]&255}function Ps(u,v,y,T,B,z,W){if(u==null)ma(null,null,y,T,B,z,W);else{var G,J=u[v+0],te=J,pe=J;for(G=0;G<W;++G)te=pe+(J=u[v+G])-te,pe=y[T+G]+(-256&te?0>te?0:255:te)&255,te=J,B[z+G]=pe}}function il(u,v,y,T){var B=v.width,z=v.o;if(e(u!=null&&v!=null),0>y||0>=T||y+T>z)return null;if(!u.Cc){if(u.ga==null){var W;if(u.ga=new ro,(W=u.ga==null)||(W=v.width*v.o,e(u.Gb.length==0),u.Gb=s(W),u.Uc=0,u.Gb==null?W=0:(u.mb=u.Gb,u.nb=u.Uc,u.rc=null,W=1),W=!W),!W){W=u.ga;var G=u.Fa,J=u.P,te=u.qc,pe=u.mb,Ce=u.nb,_e=J+1,we=te-1,Ie=W.l;if(e(G!=null&&pe!=null&&v!=null),zs[0]=null,zs[1]=ma,zs[2]=rl,zs[3]=Ps,W.ca=pe,W.tb=Ce,W.c=v.width,W.i=v.height,e(0<W.c&&0<W.i),1>=te)v=0;else if(W.$a=G[J+0]>>0&3,W.Z=G[J+0]>>2&3,W.Lc=G[J+0]>>4&3,J=G[J+0]>>6&3,0>W.$a||1<W.$a||4<=W.Z||1<W.Lc||J)v=0;else if(Ie.put=an,Ie.ac=Xr,Ie.bc=on,Ie.ma=W,Ie.width=v.width,Ie.height=v.height,Ie.Da=v.Da,Ie.v=v.v,Ie.va=v.va,Ie.j=v.j,Ie.o=v.o,W.$a)e:{e(W.$a==1),v=Fe();t:for(;;){if(v==null){v=0;break e}if(e(W!=null),W.mc=v,v.c=W.c,v.i=W.i,v.l=W.l,v.l.ma=W,v.l.width=W.c,v.l.height=W.i,v.a=0,se(v.m,G,_e,we),!ye(W.c,W.i,1,v,null)||(v.ab==1&&v.gc[0].hc==3&&Q(v.s)?(W.ic=1,G=v.c*v.i,v.Ta=null,v.Ua=0,v.V=s(G),v.Ba=0,v.V==null?(v.a=1,v=0):v=1):(W.ic=0,v=ke(v,W.c)),!v))break t;v=1;break e}W.mc=null,v=0}else v=we>=W.c*W.i;W=!v}if(W)return null;u.ga.Lc!=1?u.Ga=0:T=z-y}e(u.ga!=null),e(y+T<=z);e:{if(v=(G=u.ga).c,z=G.l.o,G.$a==0){if(_e=u.rc,we=u.Vc,Ie=u.Fa,J=u.P+1+y*v,te=u.mb,pe=u.nb+y*v,e(J<=u.P+u.qc),G.Z!=0)for(e(zs[G.Z]!=null),W=0;W<T;++W)zs[G.Z](_e,we,Ie,J,te,pe,v),_e=te,we=pe,pe+=v,J+=v;else for(W=0;W<T;++W)i(te,pe,Ie,J,v),_e=te,we=pe,pe+=v,J+=v;u.rc=_e,u.Vc=we}else{if(e(G.mc!=null),v=y+T,e((W=G.mc)!=null),e(v<=W.i),W.C>=v)v=1;else if(G.ic||xe(),G.ic){G=W.V,_e=W.Ba,we=W.c;var Re=W.i,me=(Ie=1,J=W.$/we,te=W.$%we,pe=W.m,Ce=W.s,W.$),ve=we*Re,Me=we*v,ze=Ce.wc,Oe=me<Me?Er(Ce,te,J):null;e(me<=ve),e(v<=Re),e(Q(Ce));t:for(;;){for(;!pe.h&&me<Me;){if(te&ze||(Oe=Er(Ce,te,J)),e(Oe!=null),X(pe),256>(Re=ci(Oe.G[0],Oe.H[0],pe)))G[_e+me]=Re,++me,++te>=we&&(te=0,++J<=v&&!(J%16)&&ie(W,J));else{if(!(280>Re)){Ie=0;break t}Re=qi(Re-256,pe);var at,et=ci(Oe.G[4],Oe.H[4],pe);if(X(pe),!(me>=(et=Pi(we,et=qi(et,pe)))&&ve-me>=Re)){Ie=0;break t}for(at=0;at<Re;++at)G[_e+me+at]=G[_e+me+at-et];for(me+=Re,te+=Re;te>=we;)te-=we,++J<=v&&!(J%16)&&ie(W,J);me<Me&&te&ze&&(Oe=Er(Ce,te,J))}e(pe.h==N(pe))}ie(W,J>v?v:J);break t}!Ie||pe.h&&me<ve?(Ie=0,W.a=pe.h?5:3):W.$=me,v=Ie}else v=ae(W,W.V,W.Ba,W.c,W.i,v,Te);if(!v){T=0;break e}}y+T>=z&&(u.Cc=1),T=1}if(!T)return null;if(u.Cc&&((T=u.ga)!=null&&(T.mc=null),u.ga=null,0<u.Ga))return alert("todo:WebPDequantizeLevels"),null}return u.nb+y*B}function x(u,v,y,T,B,z){for(;0<B--;){var W,G=u,J=v+(y?1:0),te=u,pe=v+(y?0:3);for(W=0;W<T;++W){var Ce=te[pe+4*W];Ce!=255&&(Ce*=32897,G[J+4*W+0]=G[J+4*W+0]*Ce>>23,G[J+4*W+1]=G[J+4*W+1]*Ce>>23,G[J+4*W+2]=G[J+4*W+2]*Ce>>23)}v+=z}}function H(u,v,y,T,B){for(;0<T--;){var z;for(z=0;z<y;++z){var W=u[v+2*z+0],G=15&(te=u[v+2*z+1]),J=4369*G,te=(240&te|te>>4)*J>>16;u[v+2*z+0]=(240&W|W>>4)*J>>16&240|(15&W|W<<4)*J>>16>>4&15,u[v+2*z+1]=240&te|G}v+=B}}function le(u,v,y,T,B,z,W,G){var J,te,pe=255;for(te=0;te<B;++te){for(J=0;J<T;++J){var Ce=u[v+J];z[W+4*J]=Ce,pe&=Ce}v+=y,W+=G}return pe!=255}function de(u,v,y,T,B){var z;for(z=0;z<B;++z)y[T+z]=u[v+z]>>8}function xe(){Bs=x,uo=H,Bh=le,h0=de}function Ne(u,v,y){A[u]=function(T,B,z,W,G,J,te,pe,Ce,_e,we,Ie,Re,me,ve,Me,ze){var Oe,at=ze-1>>1,et=G[J+0]|te[pe+0]<<16,gt=Ce[_e+0]|we[Ie+0]<<16;e(T!=null);var rt=3*et+gt+131074>>2;for(v(T[B+0],255&rt,rt>>16,Re,me),z!=null&&(rt=3*gt+et+131074>>2,v(z[W+0],255&rt,rt>>16,ve,Me)),Oe=1;Oe<=at;++Oe){var Xt=G[J+Oe]|te[pe+Oe]<<16,Jt=Ce[_e+Oe]|we[Ie+Oe]<<16,Ut=et+Xt+gt+Jt+524296,Bt=Ut+2*(Xt+gt)>>3;rt=Bt+et>>1,et=(Ut=Ut+2*(et+Jt)>>3)+Xt>>1,v(T[B+2*Oe-1],255&rt,rt>>16,Re,me+(2*Oe-1)*y),v(T[B+2*Oe-0],255&et,et>>16,Re,me+(2*Oe-0)*y),z!=null&&(rt=Ut+gt>>1,et=Bt+Jt>>1,v(z[W+2*Oe-1],255&rt,rt>>16,ve,Me+(2*Oe-1)*y),v(z[W+2*Oe+0],255&et,et>>16,ve,Me+(2*Oe+0)*y)),et=Xt,gt=Jt}1&ze||(rt=3*et+gt+131074>>2,v(T[B+ze-1],255&rt,rt>>16,Re,me+(ze-1)*y),z!=null&&(rt=3*gt+et+131074>>2,v(z[W+ze-1],255&rt,rt>>16,ve,Me+(ze-1)*y)))}}function We(){un[zh]=a2,un[jh]=x0,un[m0]=o2,un[Wh]=y0,un[Uh]=E0,un[Iu]=C0,un[g0]=l2,un[Bu]=x0,un[Hu]=y0,un[Vh]=E0,un[zu]=C0}function st(u){return u&-16384?0>u?0:255:u>>h2}function ft(u,v){return st((19077*u>>8)+(26149*v>>8)-14234)}function At(u,v,y){return st((19077*u>>8)-(6419*v>>8)-(13320*y>>8)+8708)}function Pt(u,v){return st((19077*u>>8)+(33050*v>>8)-17685)}function zt(u,v,y,T,B){T[B+0]=ft(u,y),T[B+1]=At(u,v,y),T[B+2]=Pt(u,v)}function xr(u,v,y,T,B){T[B+0]=Pt(u,v),T[B+1]=At(u,v,y),T[B+2]=ft(u,y)}function Cr(u,v,y,T,B){var z=At(u,v,y);v=z<<3&224|Pt(u,v)>>3,T[B+0]=248&ft(u,y)|z>>5,T[B+1]=v}function zr(u,v,y,T,B){var z=240&Pt(u,v)|15;T[B+0]=240&ft(u,y)|At(u,v,y)>>4,T[B+1]=z}function fi(u,v,y,T,B){T[B+0]=255,zt(u,v,y,T,B+1)}function Zr(u,v,y,T,B){xr(u,v,y,T,B),T[B+3]=255}function An(u,v,y,T,B){zt(u,v,y,T,B),T[B+3]=255}function Ki(u,v){return 0>u?0:u>v?v:u}function ms(u,v,y){A[u]=function(T,B,z,W,G,J,te,pe,Ce){for(var _e=pe+(-2&Ce)*y;pe!=_e;)v(T[B+0],z[W+0],G[J+0],te,pe),v(T[B+1],z[W+0],G[J+0],te,pe+y),B+=2,++W,++J,pe+=2*y;1&Ce&&v(T[B+0],z[W+0],G[J+0],te,pe)}}function Oh(u,v,y){return y==0?u==0?v==0?6:5:v==0?4:0:y}function nl(u,v,y,T,B){switch(u>>>30){case 3:ho(v,y,T,B,0);break;case 2:ul(v,y,T,B);break;case 1:Nn(v,y,T,B)}}function sl(u,v){var y,T,B=v.M,z=v.Nb,W=u.oc,G=u.pc+40,J=u.oc,te=u.pc+584,pe=u.oc,Ce=u.pc+600;for(y=0;16>y;++y)W[G+32*y-1]=129;for(y=0;8>y;++y)J[te+32*y-1]=129,pe[Ce+32*y-1]=129;for(0<B?W[G-1-32]=J[te-1-32]=pe[Ce-1-32]=129:(n(W,G-32-1,127,21),n(J,te-32-1,127,9),n(pe,Ce-32-1,127,9)),T=0;T<u.za;++T){var _e=v.ya[v.aa+T];if(0<T){for(y=-1;16>y;++y)i(W,G+32*y-4,W,G+32*y+12,4);for(y=-1;8>y;++y)i(J,te+32*y-4,J,te+32*y+4,4),i(pe,Ce+32*y-4,pe,Ce+32*y+4,4)}var we=u.Gd,Ie=u.Hd+T,Re=_e.ad,me=_e.Hc;if(0<B&&(i(W,G-32,we[Ie].y,0,16),i(J,te-32,we[Ie].f,0,8),i(pe,Ce-32,we[Ie].ea,0,8)),_e.Za){var ve=W,Me=G-32+16;for(0<B&&(T>=u.za-1?n(ve,Me,we[Ie].y[15],4):i(ve,Me,we[Ie+1].y,0,4)),y=0;4>y;y++)ve[Me+128+y]=ve[Me+256+y]=ve[Me+384+y]=ve[Me+0+y];for(y=0;16>y;++y,me<<=2)ve=W,Me=G+k0[y],Pn[_e.Ob[y]](ve,Me),nl(me,Re,16*+y,ve,Me)}else if(ve=Oh(T,B,_e.Ob[0]),Hs[ve](W,G),me!=0)for(y=0;16>y;++y,me<<=2)nl(me,Re,16*+y,W,G+k0[y]);for(y=_e.Gc,ve=Oh(T,B,_e.Dd),xs[ve](J,te),xs[ve](pe,Ce),me=Re,ve=J,Me=te,255&(_e=y>>0)&&(170&_e?Os(me,256,ve,Me):vs(me,256,ve,Me)),_e=pe,me=Ce,255&(y>>=8)&&(170&y?Os(Re,320,_e,me):vs(Re,320,_e,me)),B<u.Ub-1&&(i(we[Ie].y,0,W,G+480,16),i(we[Ie].f,0,J,te+224,8),i(we[Ie].ea,0,pe,Ce+224,8)),y=8*z*u.B,we=u.sa,Ie=u.ta+16*T+16*z*u.R,Re=u.qa,_e=u.ra+8*T+y,me=u.Ha,ve=u.Ia+8*T+y,y=0;16>y;++y)i(we,Ie+y*u.R,W,G+32*y,16);for(y=0;8>y;++y)i(Re,_e+y*u.B,J,te+32*y,8),i(me,ve+y*u.B,pe,Ce+32*y,8)}}function io(u,v,y,T,B,z,W,G,J){var te=[0],pe=[0],Ce=0,_e=J!=null?J.kd:0,we=J??new el;if(u==null||12>y)return 7;we.data=u,we.w=v,we.ha=y,v=[v],y=[y],we.gb=[we.gb];e:{var Ie=v,Re=y,me=we.gb;if(e(u!=null),e(Re!=null),e(me!=null),me[0]=0,12<=Re[0]&&!t(u,Ie[0],"RIFF")){if(t(u,Ie[0]+8,"WEBP")){me=3;break e}var ve=Ue(u,Ie[0]+4);if(12>ve||4294967286<ve){me=3;break e}if(_e&&ve>Re[0]-8){me=7;break e}me[0]=ve,Ie[0]+=12,Re[0]-=12}me=0}if(me!=0)return me;for(ve=0<we.gb[0],y=y[0];;){e:{var Me=u;Re=v,me=y;var ze=te,Oe=pe,at=Ie=[0];if((rt=Ce=[Ce])[0]=0,8>me[0])me=7;else{if(!t(Me,Re[0],"VP8X")){if(Ue(Me,Re[0]+4)!=10){me=3;break e}if(18>me[0]){me=7;break e}var et=Ue(Me,Re[0]+8),gt=1+Z(Me,Re[0]+12);if(2147483648<=gt*(Me=1+Z(Me,Re[0]+15))){me=3;break e}at!=null&&(at[0]=et),ze!=null&&(ze[0]=gt),Oe!=null&&(Oe[0]=Me),Re[0]+=18,me[0]-=18,rt[0]=1}me=0}}if(Ce=Ce[0],Ie=Ie[0],me!=0)return me;if(Re=!!(2&Ie),!ve&&Ce)return 3;if(z!=null&&(z[0]=!!(16&Ie)),W!=null&&(W[0]=Re),G!=null&&(G[0]=0),W=te[0],Ie=pe[0],Ce&&Re&&J==null){me=0;break}if(4>y){me=7;break}if(ve&&Ce||!ve&&!Ce&&!t(u,v[0],"ALPH")){y=[y],we.na=[we.na],we.P=[we.P],we.Sa=[we.Sa];e:{et=u,me=v,ve=y;var rt=we.gb;ze=we.na,Oe=we.P,at=we.Sa,gt=22,e(et!=null),e(ve!=null),Me=me[0];var Xt=ve[0];for(e(ze!=null),e(at!=null),ze[0]=null,Oe[0]=null,at[0]=0;;){if(me[0]=Me,ve[0]=Xt,8>Xt){me=7;break e}var Jt=Ue(et,Me+4);if(4294967286<Jt){me=3;break e}var Ut=8+Jt+1&-2;if(gt+=Ut,0<rt&&gt>rt){me=3;break e}if(!t(et,Me,"VP8 ")||!t(et,Me,"VP8L")){me=0;break e}if(Xt[0]<Ut){me=7;break e}t(et,Me,"ALPH")||(ze[0]=et,Oe[0]=Me+8,at[0]=Jt),Me+=Ut,Xt-=Ut}}if(y=y[0],we.na=we.na[0],we.P=we.P[0],we.Sa=we.Sa[0],me!=0)break}y=[y],we.Ja=[we.Ja],we.xa=[we.xa];e:if(rt=u,me=v,ve=y,ze=we.gb[0],Oe=we.Ja,at=we.xa,et=me[0],Me=!t(rt,et,"VP8 "),gt=!t(rt,et,"VP8L"),e(rt!=null),e(ve!=null),e(Oe!=null),e(at!=null),8>ve[0])me=7;else{if(Me||gt){if(rt=Ue(rt,et+4),12<=ze&&rt>ze-12){me=3;break e}if(_e&&rt>ve[0]-8){me=7;break e}Oe[0]=rt,me[0]+=8,ve[0]-=8,at[0]=gt}else at[0]=5<=ve[0]&&rt[et+0]==47&&!(rt[et+4]>>5),Oe[0]=ve[0];me=0}if(y=y[0],we.Ja=we.Ja[0],we.xa=we.xa[0],v=v[0],me!=0)break;if(4294967286<we.Ja)return 3;if(G==null||Re||(G[0]=we.xa?2:1),W=[W],Ie=[Ie],we.xa){if(5>y){me=7;break}G=W,_e=Ie,Re=z,u==null||5>y?u=0:5<=y&&u[v+0]==47&&!(u[v+4]>>5)?(ve=[0],rt=[0],ze=[0],se(Oe=new _,u,v,y),mt(Oe,ve,rt,ze)?(G!=null&&(G[0]=ve[0]),_e!=null&&(_e[0]=rt[0]),Re!=null&&(Re[0]=ze[0]),u=1):u=0):u=0}else{if(10>y){me=7;break}G=Ie,u==null||10>y||!xh(u,v+3,y-3)?u=0:(_e=u[v+0]|u[v+1]<<8|u[v+2]<<16,Re=16383&(u[v+7]<<8|u[v+6]),u=16383&(u[v+9]<<8|u[v+8]),1&_e||3<(_e>>1&7)||!(_e>>4&1)||_e>>5>=we.Ja||!Re||!u?u=0:(W&&(W[0]=Re),G&&(G[0]=u),u=1))}if(!u||(W=W[0],Ie=Ie[0],Ce&&(te[0]!=W||pe[0]!=Ie)))return 3;J!=null&&(J[0]=we,J.offset=v-J.w,e(4294967286>v-J.w),e(J.offset==J.ha-y));break}return me==0||me==7&&Ce&&J==null?(z!=null&&(z[0]|=we.na!=null&&0<we.na.length),T!=null&&(T[0]=W),B!=null&&(B[0]=Ie),0):me}function al(u,v,y){var T=v.width,B=v.height,z=0,W=0,G=T,J=B;if(v.Da=u!=null&&0<u.Da,v.Da&&(G=u.cd,J=u.bd,z=u.v,W=u.j,11>y||(z&=-2,W&=-2),0>z||0>W||0>=G||0>=J||z+G>T||W+J>B))return 0;if(v.v=z,v.j=W,v.va=z+G,v.o=W+J,v.U=G,v.T=J,v.da=u!=null&&0<u.da,v.da){if(!De(G,J,y=[u.ib],z=[u.hb]))return 0;v.ib=y[0],v.hb=z[0]}return v.ob=u!=null&&u.ob,v.Kb=u==null||!u.Sd,v.da&&(v.ob=v.ib<3*T/4&&v.hb<3*B/4,v.Kb=0),1}function ol(u){if(u==null)return 2;if(11>u.S){var v=u.f.RGBA;v.fb+=(u.height-1)*v.A,v.A=-v.A}else v=u.f.kb,u=u.height,v.O+=(u-1)*v.fa,v.fa=-v.fa,v.N+=(u-1>>1)*v.Ab,v.Ab=-v.Ab,v.W+=(u-1>>1)*v.Db,v.Db=-v.Db,v.F!=null&&(v.J+=(u-1)*v.lb,v.lb=-v.lb);return 0}function no(u,v,y,T){if(T==null||0>=u||0>=v)return 2;if(y!=null){if(y.Da){var B=y.cd,z=y.bd,W=-2&y.v,G=-2&y.j;if(0>W||0>G||0>=B||0>=z||W+B>u||G+z>v)return 2;u=B,v=z}if(y.da){if(!De(u,v,B=[y.ib],z=[y.hb]))return 2;u=B[0],v=z[0]}}T.width=u,T.height=v;e:{var J=T.width,te=T.height;if(u=T.S,0>=J||0>=te||!(u>=zh&&13>u))u=2;else{if(0>=T.Rd&&T.sd==null){W=z=B=v=0;var pe=(G=J*S0[u])*te;if(11>u||(z=(te+1)/2*(v=(J+1)/2),u==12&&(W=(B=J)*te)),(te=s(pe+2*z+W))==null){u=1;break e}T.sd=te,11>u?((J=T.f.RGBA).eb=te,J.fb=0,J.A=G,J.size=pe):((J=T.f.kb).y=te,J.O=0,J.fa=G,J.Fd=pe,J.f=te,J.N=0+pe,J.Ab=v,J.Cd=z,J.ea=te,J.W=0+pe+z,J.Db=v,J.Ed=z,u==12&&(J.F=te,J.J=0+pe+2*z),J.Tc=W,J.lb=B)}if(v=1,B=T.S,z=T.width,W=T.height,B>=zh&&13>B)if(11>B)u=T.f.RGBA,v&=(G=Math.abs(u.A))*(W-1)+z<=u.size,v&=G>=z*S0[B],v&=u.eb!=null;else{u=T.f.kb,G=(z+1)/2,pe=(W+1)/2,J=Math.abs(u.fa),te=Math.abs(u.Ab);var Ce=Math.abs(u.Db),_e=Math.abs(u.lb),we=_e*(W-1)+z;v&=J*(W-1)+z<=u.Fd,v&=te*(pe-1)+G<=u.Cd,v=(v&=Ce*(pe-1)+G<=u.Ed)&J>=z&te>=G&Ce>=G,v&=u.y!=null,v&=u.f!=null,v&=u.ea!=null,B==12&&(v&=_e>=z,v&=we<=u.Tc,v&=u.F!=null)}else v=0;u=v?0:2}}return u!=0||y!=null&&y.fd&&(u=ol(T)),u}var Mi=64,so=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ao=24,oo=32,ll=8,Oi=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];qe("Predictor0","PredictorAdd0"),A.Predictor0=function(){return 4278190080},A.Predictor1=function(u){return u},A.Predictor2=function(u,v,y){return v[y+0]},A.Predictor3=function(u,v,y){return v[y+1]},A.Predictor4=function(u,v,y){return v[y-1]},A.Predictor5=function(u,v,y){return Qe(Qe(u,v[y+1]),v[y+0])},A.Predictor6=function(u,v,y){return Qe(u,v[y-1])},A.Predictor7=function(u,v,y){return Qe(u,v[y+0])},A.Predictor8=function(u,v,y){return Qe(v[y-1],v[y+0])},A.Predictor9=function(u,v,y){return Qe(v[y+0],v[y+1])},A.Predictor10=function(u,v,y){return Qe(Qe(u,v[y-1]),Qe(v[y+0],v[y+1]))},A.Predictor11=function(u,v,y){var T=v[y+0];return 0>=bt(T>>24&255,u>>24&255,(v=v[y-1])>>24&255)+bt(T>>16&255,u>>16&255,v>>16&255)+bt(T>>8&255,u>>8&255,v>>8&255)+bt(255&T,255&u,255&v)?T:u},A.Predictor12=function(u,v,y){var T=v[y+0];return(lt((u>>24&255)+(T>>24&255)-((v=v[y-1])>>24&255))<<24|lt((u>>16&255)+(T>>16&255)-(v>>16&255))<<16|lt((u>>8&255)+(T>>8&255)-(v>>8&255))<<8|lt((255&u)+(255&T)-(255&v)))>>>0},A.Predictor13=function(u,v,y){var T=v[y-1];return(ht((u=Qe(u,v[y+0]))>>24&255,T>>24&255)<<24|ht(u>>16&255,T>>16&255)<<16|ht(u>>8&255,T>>8&255)<<8|ht(u>>0&255,T>>0&255))>>>0};var Pu=A.PredictorAdd0;A.PredictorAdd1=Et,qe("Predictor2","PredictorAdd2"),qe("Predictor3","PredictorAdd3"),qe("Predictor4","PredictorAdd4"),qe("Predictor5","PredictorAdd5"),qe("Predictor6","PredictorAdd6"),qe("Predictor7","PredictorAdd7"),qe("Predictor8","PredictorAdd8"),qe("Predictor9","PredictorAdd9"),qe("Predictor10","PredictorAdd10"),qe("Predictor11","PredictorAdd11"),qe("Predictor12","PredictorAdd12"),qe("Predictor13","PredictorAdd13");var hl=A.PredictorAdd2;tt("ColorIndexInverseTransform","MapARGB","32b",(function(u){return u>>8&255}),(function(u){return u})),tt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",(function(u){return u}),(function(u){return u>>8&255}));var Ih,Fn=A.ColorIndexInverseTransform,cl=A.MapARGB,Du=A.VP8LColorIndexInverseTransformAlpha,Mu=A.MapAlpha,Ds=A.VP8LPredictorsAdd=[];Ds.length=16,(A.VP8LPredictors=[]).length=16,(A.VP8LPredictorsAdd_C=[]).length=16,(A.VP8LPredictors_C=[]).length=16;var ln,Rn,Ms,Kn,gs,lo,Ln,ho,ul,Os,Nn,vs,ga,co,va,Is,fl,hn,bs,fr,dr,Nr,Kr,ws,Bs,uo,Bh,h0,c0=s(511),u0=s(2041),f0=s(225),d0=s(767),p0=0,Ou=u0,Hh=f0,Yi=d0,cn=c0,zh=0,jh=1,m0=2,Wh=3,Uh=4,Iu=5,g0=6,Bu=7,Hu=8,Vh=9,zu=10,qv=[2,3,7],Xv=[3,3,11],v0=[280,256,256,256,40],Kv=[0,1,1,1,0],Yv=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],$v=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Jv=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Zv=8,ju=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Wu=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],dl=null,Qv=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],e2=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],b0=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],t2=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],r2=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],i2=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],n2=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Hs=[],Pn=[],xs=[],s2=1,w0=2,zs=[],un=[];Ne("UpsampleRgbLinePair",zt,3),Ne("UpsampleBgrLinePair",xr,3),Ne("UpsampleRgbaLinePair",An,4),Ne("UpsampleBgraLinePair",Zr,4),Ne("UpsampleArgbLinePair",fi,4),Ne("UpsampleRgba4444LinePair",zr,2),Ne("UpsampleRgb565LinePair",Cr,2);var a2=A.UpsampleRgbLinePair,o2=A.UpsampleBgrLinePair,x0=A.UpsampleRgbaLinePair,y0=A.UpsampleBgraLinePair,E0=A.UpsampleArgbLinePair,C0=A.UpsampleRgba4444LinePair,l2=A.UpsampleRgb565LinePair,Gh=16,qh=1<<Gh-1,pl=-227,Uu=482,h2=6,_0=0,c2=s(256),u2=s(256),f2=s(256),d2=s(256),p2=s(Uu-pl),m2=s(Uu-pl);ms("YuvToRgbRow",zt,3),ms("YuvToBgrRow",xr,3),ms("YuvToRgbaRow",An,4),ms("YuvToBgraRow",Zr,4),ms("YuvToArgbRow",fi,4),ms("YuvToRgba4444Row",zr,2),ms("YuvToRgb565Row",Cr,2);var k0=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Xh=[0,2,8],g2=[8,7,6,4,4,2,2,2,1,1,1,1],v2=1;this.WebPDecodeRGBA=function(u,v,y,T,B){var z=jh,W=new to,G=new Gi;W.ba=G,G.S=z,G.width=[G.width],G.height=[G.height];var J=G.width,te=G.height,pe=new Cn;if(pe==null||u==null)var Ce=2;else e(pe!=null),Ce=io(u,v,y,pe.width,pe.height,pe.Pd,pe.Qd,pe.format,null);if(Ce!=0?J=0:(J!=null&&(J[0]=pe.width[0]),te!=null&&(te[0]=pe.height[0]),J=1),J){G.width=G.width[0],G.height=G.height[0],T!=null&&(T[0]=G.width),B!=null&&(B[0]=G.height);e:{if(T=new qn,(B=new el).data=u,B.w=v,B.ha=y,B.kd=1,v=[0],e(B!=null),((u=io(B.data,B.w,B.ha,null,null,null,v,null,B))==0||u==7)&&v[0]&&(u=4),(v=u)==0){if(e(W!=null),T.data=B.data,T.w=B.w+B.offset,T.ha=B.ha-B.offset,T.put=an,T.ac=Xr,T.bc=on,T.ma=W,B.xa){if((u=Fe())==null){W=1;break e}if((function(_e,we){var Ie=[0],Re=[0],me=[0];t:for(;;){if(_e==null)return 0;if(we==null)return _e.a=2,0;if(_e.l=we,_e.a=0,se(_e.m,we.data,we.w,we.ha),!mt(_e.m,Ie,Re,me)){_e.a=3;break t}if(_e.xb=w0,we.width=Ie[0],we.height=Re[0],!ye(Ie[0],Re[0],1,_e,null))break t;return 1}return e(_e.a!=0),0})(u,T)){if(T=(v=no(T.width,T.height,W.Oa,W.ba))==0){t:{T=u;r:for(;;){if(T==null){T=0;break t}if(e(T.s.yc!=null),e(T.s.Ya!=null),e(0<T.s.Wb),e((y=T.l)!=null),e((B=y.ma)!=null),T.xb!=0){if(T.ca=B.ba,T.tb=B.tb,e(T.ca!=null),!al(B.Oa,y,Wh)){T.a=2;break r}if(!ke(T,y.width)||y.da)break r;if((y.da||Wt(T.ca.S))&&xe(),11>T.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),T.ca.f.kb.F!=null&&xe()),T.Pb&&0<T.s.ua&&T.s.vb.X==null&&!Ye(T.s.vb,T.s.Wa.Xa)){T.a=1;break r}T.xb=0}if(!ae(T,T.V,T.Ba,T.c,T.i,y.o,ne))break r;B.Dc=T.Ma,T=1;break t}e(T.a!=0),T=0}T=!T}T&&(v=u.a)}else v=u.a}else{if((u=new Xi)==null){W=1;break e}if(u.Fa=B.na,u.P=B.P,u.qc=B.Sa,yh(u,T)){if((v=no(T.width,T.height,W.Oa,W.ba))==0){if(u.Aa=0,y=W.Oa,e((B=u)!=null),y!=null){if(0<(J=0>(J=y.Md)?0:100<J?255:255*J/100)){for(te=pe=0;4>te;++te)12>(Ce=B.pb[te]).lc&&(Ce.ia=J*g2[0>Ce.lc?0:Ce.lc]>>3),pe|=Ce.ia;pe&&(alert("todo:VP8InitRandom"),B.ia=1)}B.Ga=y.Id,100<B.Ga?B.Ga=100:0>B.Ga&&(B.Ga=0)}mu(u,T)||(v=u.a)}}else v=u.a}v==0&&W.Oa!=null&&W.Oa.fd&&(v=ol(W.ba))}W=v}z=W!=0?null:11>z?G.f.RGBA.eb:G.f.kb.y}else z=null;return z};var S0=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function h(A,O){for(var U="",R=0;R<4;R++)U+=String.fromCharCode(A[O++]);return U}function c(A,O){return(A[O+0]<<0|A[O+1]<<8|A[O+2]<<16)>>>0}function d(A,O){return(A[O+0]<<0|A[O+1]<<8|A[O+2]<<16|A[O+3]<<24)>>>0}new l;var p=[0],f=[0],g=[],m=new l,b=r,w=(function(A,O){var U={},R=0,k=!1,M=0,V=0;if(U.frames=[],!(function(P,N,I,X){for(var he=0;he<X;he++)if(P[N+he]!=I.charCodeAt(he))return!0;return!1})(A,O,"RIFF",4)){var oe,K;for(d(A,O+=4),O+=8;O<A.length;){var Y=h(A,O),se=d(A,O+=4);O+=4;var q=se+(1&se);switch(Y){case"VP8 ":case"VP8L":U.frames[R]===void 0&&(U.frames[R]={}),(_=U.frames[R]).src_off=k?V:O-8,_.src_size=M+se+8,R++,k&&(k=!1,M=0,V=0);break;case"VP8X":(_=U.header={}).feature_flags=A[O];var fe=O+4;_.canvas_width=1+c(A,fe),fe+=3,_.canvas_height=1+c(A,fe),fe+=3;break;case"ALPH":k=!0,M=q+8,V=O-8;break;case"ANIM":(_=U.header).bgcolor=d(A,O),fe=O+4,_.loop_count=(oe=A)[(K=fe)+0]<<0|oe[K+1]<<8,fe+=2;break;case"ANMF":var ge,_;(_=U.frames[R]={}).offset_x=2*c(A,O),O+=3,_.offset_y=2*c(A,O),O+=3,_.width=1+c(A,O),O+=3,_.height=1+c(A,O),O+=3,_.duration=c(A,O),O+=3,ge=A[O++],_.dispose=1&ge,_.blend=ge>>1&1}Y!="ANMF"&&(O+=q)}return U}})(b,0);w.response=b,w.rgbaoutput=!0,w.dataurl=!1;var E=w.header?w.header:null,C=w.frames?w.frames:null;if(E){E.loop_counter=E.loop_count,p=[E.canvas_height],f=[E.canvas_width];for(var F=0;F<C.length&&C[F].blend!=0;F++);}var L=C[0],D=m.WebPDecodeRGBA(b,L.src_off,L.src_size,f,p);L.rgba=D,L.imgwidth=f[0],L.imgheight=p[0];for(var S=0;S<f[0]*p[0]*4;S++)g[S]=D[S];return this.width=f,this.height=p,this.data=g,this}(function(r){var e=function(){return typeof jf=="function"},t=function(p,f,g,m){var b=4,w=a;switch(m){case r.image_compression.FAST:b=1,w=s;break;case r.image_compression.MEDIUM:b=6,w=o;break;case r.image_compression.SLOW:b=9,w=l}p=i(p,f,g,w);var E=jf(p,{level:b});return r.__addimage__.arrayBufferToBinaryString(E)},i=function(p,f,g,m){for(var b,w,E,C=p.length/f,F=new Uint8Array(p.length+C),L=c(),D=0;D<C;D+=1){if(E=D*f,b=p.subarray(E,E+f),m)F.set(m(b,g,w),E+D);else{for(var S,A=L.length,O=[];S<A;S+=1)O[S]=L[S](b,g,w);var U=d(O.concat());F.set(O[U],E+D)}w=b}return F},n=function(p){var f=Array.apply([],p);return f.unshift(0),f},s=function(p,f){var g,m=[],b=p.length;m[0]=1;for(var w=0;w<b;w+=1)g=p[w-f]||0,m[w+1]=p[w]-g+256&255;return m},a=function(p,f,g){var m,b=[],w=p.length;b[0]=2;for(var E=0;E<w;E+=1)m=g&&g[E]||0,b[E+1]=p[E]-m+256&255;return b},o=function(p,f,g){var m,b,w=[],E=p.length;w[0]=3;for(var C=0;C<E;C+=1)m=p[C-f]||0,b=g&&g[C]||0,w[C+1]=p[C]+256-(m+b>>>1)&255;return w},l=function(p,f,g){var m,b,w,E,C=[],F=p.length;C[0]=4;for(var L=0;L<F;L+=1)m=p[L-f]||0,b=g&&g[L]||0,w=g&&g[L-f]||0,E=h(m,b,w),C[L+1]=p[L]-E+256&255;return C},h=function(p,f,g){if(p===f&&f===g)return p;var m=Math.abs(f-g),b=Math.abs(p-g),w=Math.abs(p+f-g-g);return m<=b&&m<=w?p:b<=w?f:g},c=function(){return[n,s,a,o,l]},d=function(p){var f=p.map((function(g){return g.reduce((function(m,b){return m+Math.abs(b)}),0)}));return f.indexOf(Math.min.apply(null,f))};r.processPNG=function(p,f,g,m){var b,w,E,C,F,L,D,S,A,O,U,R,k,M,V,oe=this.decode.FLATE_DECODE,K="";if(this.__addimage__.isArrayBuffer(p)&&(p=new Uint8Array(p)),this.__addimage__.isArrayBufferView(p)){if(p=(E=new Sy(p)).imgData,w=E.bits,b=E.colorSpace,F=E.colors,[4,6].indexOf(E.colorType)!==-1){if(E.bits===8){A=(S=E.pixelBitlength==32?new Uint32Array(E.decodePixels().buffer):E.pixelBitlength==16?new Uint16Array(E.decodePixels().buffer):new Uint8Array(E.decodePixels().buffer)).length,U=new Uint8Array(A*E.colors),O=new Uint8Array(A);var Y,se=E.pixelBitlength-E.bits;for(M=0,V=0;M<A;M++){for(k=S[M],Y=0;Y<se;)U[V++]=k>>>Y&255,Y+=E.bits;O[M]=k>>>Y&255}}if(E.bits===16){A=(S=new Uint32Array(E.decodePixels().buffer)).length,U=new Uint8Array(A*(32/E.pixelBitlength)*E.colors),O=new Uint8Array(A*(32/E.pixelBitlength)),R=E.colors>1,M=0,V=0;for(var q=0;M<A;)k=S[M++],U[V++]=k>>>0&255,R&&(U[V++]=k>>>16&255,k=S[M++],U[V++]=k>>>0&255),O[q++]=k>>>16&255;w=8}m!==r.image_compression.NONE&&e()?(p=t(U,E.width*E.colors,E.colors,m),D=t(O,E.width,1,m)):(p=U,D=O,oe=void 0)}if(E.colorType===3&&(b=this.color_spaces.INDEXED,L=E.palette,E.transparency.indexed)){var fe=E.transparency.indexed,ge=0;for(M=0,A=fe.length;M<A;++M)ge+=fe[M];if((ge/=255)===A-1&&fe.indexOf(0)!==-1)C=[fe.indexOf(0)];else if(ge!==A){for(S=E.decodePixels(),O=new Uint8Array(S.length),M=0,A=S.length;M<A;M++)O[M]=fe[S[M]];D=t(O,E.width,1)}}var _=(function(P){var N;switch(P){case r.image_compression.FAST:N=11;break;case r.image_compression.MEDIUM:N=13;break;case r.image_compression.SLOW:N=14;break;default:N=12}return N})(m);return oe===this.decode.FLATE_DECODE&&(K="/Predictor "+_+" "),K+="/Colors "+F+" /BitsPerComponent "+w+" /Columns "+E.width,(this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),(D&&this.__addimage__.isArrayBuffer(D)||this.__addimage__.isArrayBufferView(D))&&(D=this.__addimage__.arrayBufferToBinaryString(D)),{alias:g,data:p,index:f,filter:oe,decodeParameters:K,transparency:C,palette:L,sMask:D,predictor:_,width:E.width,height:E.height,bitsPerComponent:w,colorSpace:b}}}})(dt.API),(function(r){r.processGIF89A=function(e,t,i,n){var s=new Ty(e),a=s.width,o=s.height,l=[];s.decodeAndBlitFrameRGBA(0,l);var h={data:l,width:a,height:o},c=new df(100).encode(h,100);return r.processJPEG.call(this,c,t,i,n)},r.processGIF87A=r.processGIF89A})(dt.API),On.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var r=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(r);for(var e=0;e<r;e++){var t=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:n,green:i,blue:t,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},On.prototype.parseBGR=function(){this.pos=this.offset;try{var r="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[r]()}catch(t){lr.log("bit decode error:"+t)}},On.prototype.bit1=function(){var r,e=Math.ceil(this.width/8),t=e%4;for(r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,n=0;n<e;n++)for(var s=this.datav.getUint8(this.pos++,!0),a=i*this.width*4+8*n*4,o=0;o<8&&8*n+o<this.width;o++){var l=this.palette[s>>7-o&1];this.data[a+4*o]=l.blue,this.data[a+4*o+1]=l.green,this.data[a+4*o+2]=l.red,this.data[a+4*o+3]=255}t!==0&&(this.pos+=4-t)}},On.prototype.bit4=function(){for(var r=Math.ceil(this.width/2),e=r%4,t=this.height-1;t>=0;t--){for(var i=this.bottom_up?t:this.height-1-t,n=0;n<r;n++){var s=this.datav.getUint8(this.pos++,!0),a=i*this.width*4+2*n*4,o=s>>4,l=15&s,h=this.palette[o];if(this.data[a]=h.blue,this.data[a+1]=h.green,this.data[a+2]=h.red,this.data[a+3]=255,2*n+1>=this.width)break;h=this.palette[l],this.data[a+4]=h.blue,this.data[a+4+1]=h.green,this.data[a+4+2]=h.red,this.data[a+4+3]=255}e!==0&&(this.pos+=4-e)}},On.prototype.bit8=function(){for(var r=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,i=0;i<this.width;i++){var n=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*i;if(n<this.palette.length){var a=this.palette[n];this.data[s]=a.red,this.data[s+1]=a.green,this.data[s+2]=a.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}r!==0&&(this.pos+=4-r)}},On.prototype.bit15=function(){for(var r=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var i=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(s&e)/e*255|0,o=(s>>5&e)/e*255|0,l=(s>>10&e)/e*255|0,h=s>>15?255:0,c=i*this.width*4+4*n;this.data[c]=l,this.data[c+1]=o,this.data[c+2]=a,this.data[c+3]=h}this.pos+=r}},On.prototype.bit16=function(){for(var r=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),i=this.height-1;i>=0;i--){for(var n=this.bottom_up?i:this.height-1-i,s=0;s<this.width;s++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&e)/e*255|0,l=(a>>5&t)/t*255|0,h=(a>>11)/e*255|0,c=n*this.width*4+4*s;this.data[c]=h,this.data[c+1]=l,this.data[c+2]=o,this.data[c+3]=255}this.pos+=r}},On.prototype.bit24=function(){for(var r=this.height-1;r>=0;r--){for(var e=this.bottom_up?r:this.height-1-r,t=0;t<this.width;t++){var i=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*t;this.data[a]=s,this.data[a+1]=n,this.data[a+2]=i,this.data[a+3]=255}this.pos+=this.width%4}},On.prototype.bit32=function(){for(var r=this.height-1;r>=0;r--)for(var e=this.bottom_up?r:this.height-1-r,t=0;t<this.width;t++){var i=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*t;this.data[o]=s,this.data[o+1]=n,this.data[o+2]=i,this.data[o+3]=a}},On.prototype.getData=function(){return this.data},(function(r){r.processBMP=function(e,t,i,n){var s=new On(e,!1),a=s.width,o=s.height,l={data:s.getData(),width:a,height:o},h=new df(100).encode(l,100);return r.processJPEG.call(this,h,t,i,n)}})(dt.API),Sp.prototype.getData=function(){return this.data},(function(r){r.processWEBP=function(e,t,i,n){var s=new Sp(e),a=s.width,o=s.height,l={data:s.getData(),width:a,height:o},h=new df(100).encode(l,100);return r.processJPEG.call(this,h,t,i,n)}})(dt.API),dt.API.processRGBA=function(r,e,t){for(var i=r.data,n=i.length,s=new Uint8Array(n/4*3),a=new Uint8Array(n/4),o=0,l=0,h=0;h<n;h+=4){var c=i[h],d=i[h+1],p=i[h+2],f=i[h+3];s[o++]=c,s[o++]=d,s[o++]=p,a[l++]=f}var g=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(a),data:g,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:r.width,height:r.height}},dt.API.setLanguage=function(r){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[r]!==void 0&&(this.internal.languageSettings.languageCode=r,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",(function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")})),this.internal.languageSettings.isSubscribed=!0)),this},bo=dt.API,lc=bo.getCharWidthsArray=function(r,e){var t,i,n=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),a=e.charSpace||this.internal.getCharSpace(),o=e.widths?e.widths:n.metadata.Unicode.widths,l=o.fof?o.fof:1,h=e.kerning?e.kerning:n.metadata.Unicode.kerning,c=h.fof?h.fof:1,d=e.doKerning!==!1,p=0,f=r.length,g=0,m=o[0]||l,b=[];for(t=0;t<f;t++)i=r.charCodeAt(t),typeof n.metadata.widthOfString=="function"?b.push((n.metadata.widthOfGlyph(n.metadata.characterToGlyph(i))+a*(1e3/s)||0)/1e3):(p=d&&tr(h[i])==="object"&&!isNaN(parseInt(h[i][g],10))?h[i][g]/c:0,b.push((o[i]||m)/l+p)),g=i;return b},Ep=bo.getStringUnitWidth=function(r,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),i=e.font||this.internal.getFont(),n=e.charSpace||this.internal.getCharSpace();return bo.processArabic&&(r=bo.processArabic(r)),typeof i.metadata.widthOfString=="function"?i.metadata.widthOfString(r,t,n)/t:lc.apply(this,arguments).reduce((function(s,a){return s+a}),0)},Cp=function(r,e,t,i){for(var n=[],s=0,a=r.length,o=0;s!==a&&o+e[s]<t;)o+=e[s],s++;n.push(r.slice(0,s));var l=s;for(o=0;s!==a;)o+e[s]>i&&(n.push(r.slice(l,s)),o=0,l=s),o+=e[s],s++;return l!==s&&n.push(r.slice(l,s)),n},_p=function(r,e,t){t||(t={});var i,n,s,a,o,l,h,c=[],d=[c],p=t.textIndent||0,f=0,g=0,m=r.split(" "),b=lc.apply(this,[" ",t])[0];if(l=t.lineIndent===-1?m[0].length+2:t.lineIndent||0){var w=Array(l).join(" "),E=[];m.map((function(F){(F=F.split(/\s*\n/)).length>1?E=E.concat(F.map((function(L,D){return(D&&L.length?`
`:"")+L}))):E.push(F[0])})),m=E,l=Ep.apply(this,[w,t])}for(s=0,a=m.length;s<a;s++){var C=0;if(i=m[s],l&&i[0]==`
`&&(i=i.substr(1),C=1),p+f+(g=(n=lc.apply(this,[i,t])).reduce((function(F,L){return F+L}),0))>e||C){if(g>e){for(o=Cp.apply(this,[i,n,e-(p+f),e]),c.push(o.shift()),c=[o.pop()];o.length;)d.push([o.shift()]);g=n.slice(i.length-(c[0]?c[0].length:0)).reduce((function(F,L){return F+L}),0)}else c=[i];d.push(c),p=g+l,f=b}else c.push(i),p+=f+g,f=b}return h=l?function(F,L){return(L?w:"")+F.join(" ")}:function(F){return F.join(" ")},d.map(h)},bo.splitTextToSize=function(r,e,t){var i,n=(t=t||{}).fontSize||this.internal.getFontSize(),s=(function(c){if(c.widths&&c.kerning)return{widths:c.widths,kerning:c.kerning};var d=this.internal.getFont(c.fontName,c.fontStyle);return d.metadata.Unicode?{widths:d.metadata.Unicode.widths||{0:1},kerning:d.metadata.Unicode.kerning||{}}:{font:d.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);i=Array.isArray(r)?r:String(r).split(/\r?\n/);var a=1*this.internal.scaleFactor*e/n;s.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/n:0,s.lineIndent=t.lineIndent;var o,l,h=[];for(o=0,l=i.length;o<l;o++)h=h.concat(_p.apply(this,[i[o],a,s]));return h},(function(r){r.__fontmetrics__=r.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",t={},i={},n=0;n<e.length;n++)t[e[n]]="0123456789abcdef"[n],i["0123456789abcdef"[n]]=e[n];var s=function(d){return"0x"+parseInt(d,10).toString(16)},a=r.__fontmetrics__.compress=function(d){var p,f,g,m,b=["{"];for(var w in d){if(p=d[w],isNaN(parseInt(w,10))?f="'"+w+"'":(w=parseInt(w,10),f=(f=s(w).slice(2)).slice(0,-1)+i[f.slice(-1)]),typeof p=="number")p<0?(g=s(p).slice(3),m="-"):(g=s(p).slice(2),m=""),g=m+g.slice(0,-1)+i[g.slice(-1)];else{if(tr(p)!=="object")throw new Error("Don't know what to do with value type "+tr(p)+".");g=a(p)}b.push(f+g)}return b.push("}"),b.join("")},o=r.__fontmetrics__.uncompress=function(d){if(typeof d!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,f,g,m,b={},w=1,E=b,C=[],F="",L="",D=d.length-1,S=1;S<D;S+=1)(m=d[S])=="'"?p?(g=p.join(""),p=void 0):p=[]:p?p.push(m):m=="{"?(C.push([E,g]),E={},g=void 0):m=="}"?((f=C.pop())[0][f[1]]=E,g=void 0,E=f[0]):m=="-"?w=-1:g===void 0?t.hasOwnProperty(m)?(F+=t[m],g=parseInt(F,16)*w,w=1,F=""):F+=m:t.hasOwnProperty(m)?(L+=t[m],E[g]=parseInt(L,16)*w,w=1,g=void 0,L=""):L+=m;return b},l={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},h={Unicode:{Courier:l,"Courier-Bold":l,"Courier-BoldOblique":l,"Courier-Oblique":l,Helvetica:l,"Helvetica-Bold":l,"Helvetica-BoldOblique":l,"Helvetica-Oblique":l,"Times-Roman":l,"Times-Bold":l,"Times-BoldItalic":l,"Times-Italic":l}},c={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};r.events.push(["addFont",function(d){var p=d.font,f=c.Unicode[p.postScriptName];f&&(p.metadata.Unicode={},p.metadata.Unicode.widths=f.widths,p.metadata.Unicode.kerning=f.kerning);var g=h.Unicode[p.postScriptName];g&&(p.metadata.Unicode.encoding=g,p.encoding=g.codePages[0])}])})(dt.API),(function(r){var e=function(t){for(var i=t.length,n=new Uint8Array(i),s=0;s<i;s++)n[s]=t.charCodeAt(s);return n};r.API.events.push(["addFont",function(t){var i=void 0,n=t.font,s=t.instance;if(!n.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");if(typeof(i=s.existsFileInVFS(n.postScriptName)===!1?s.loadFile(n.postScriptName):s.getFileFromVFS(n.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");(function(a,o){o=/^\x00\x01\x00\x00/.test(o)?e(o):e(Rl(o)),a.metadata=r.API.TTFFont.open(o),a.metadata.Unicode=a.metadata.Unicode||{encoding:{},kerning:{},widths:[]},a.metadata.glyIdsUsed=[0]})(n,i)}}])})(dt),(function(r){function e(){return(wt.canvg?Promise.resolve(wt.canvg):Mf(()=>import("./index.es-jNQierZp.js"),[])).catch((function(t){return Promise.reject(new Error("Could not load canvg: "+t))})).then((function(t){return t.default?t.default:t}))}dt.API.addSvgAsImage=function(t,i,n,s,a,o,l,h){if(isNaN(i)||isNaN(n))throw lr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(a))throw lr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=s,c.height=a;var d=c.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,c.width,c.height);var p={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return e().then((function(g){return g.fromString(d,t,p)}),(function(){return Promise.reject(new Error("Could not load canvg."))})).then((function(g){return g.render(p)})).then((function(){f.addImage(c.toDataURL("image/jpeg",1),i,n,s,a,l,h)}))}})(),dt.API.putTotalPages=function(r){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(r,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(r,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var i=1;i<=this.internal.getNumberOfPages();i++)for(var n=0;n<this.internal.pages[i].length;n++)this.internal.pages[i][n]=this.internal.pages[i][n].replace(e,t);return this},dt.API.viewerPreferences=function(r,e){var t;r=r||{},e=e||!1;var i,n,s,a={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(a),l=[],h=0,c=0,d=0;function p(g,m){var b,w=!1;for(b=0;b<g.length;b+=1)g[b]===m&&(w=!0);return w}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(a)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,r==="reset"||e===!0){var f=o.length;for(d=0;d<f;d+=1)t[o[d]].value=t[o[d]].defaultValue,t[o[d]].explicitSet=!1}if(tr(r)==="object"){for(n in r)if(s=r[n],p(o,n)&&s!==void 0){if(t[n].type==="boolean"&&typeof s=="boolean")t[n].value=s;else if(t[n].type==="name"&&p(t[n].valueSet,s))t[n].value=s;else if(t[n].type==="integer"&&Number.isInteger(s))t[n].value=s;else if(t[n].type==="array"){for(h=0;h<s.length;h+=1)if(i=!0,s[h].length===1&&typeof s[h][0]=="number")l.push(String(s[h]-1));else if(s[h].length>1){for(c=0;c<s[h].length;c+=1)typeof s[h][c]!="number"&&(i=!1);i===!0&&l.push([s[h][0]-1,s[h][1]-1].join(" "))}t[n].value="["+l.join(" ")+"]"}else t[n].value=t[n].defaultValue;t[n].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",(function(){var g,m=[];for(g in t)t[g].explicitSet===!0&&(t[g].type==="name"?m.push("/"+g+" /"+t[g].value):m.push("/"+g+" "+t[g].value));m.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+m.join(`
`)+`
>>`)})),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},(function(r){var e=function(){var i='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',n=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(i)),a=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),h=s.length+a.length+o.length+n.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+h+" >>"),this.internal.write("stream"),this.internal.write(n+s+a+o+l),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};r.addMetadata=function(i,n){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:i,namespaceuri:n||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}})(dt.API),(function(r){var e=r.API,t=e.pdfEscape16=function(s,a){for(var o,l=a.metadata.Unicode.widths,h=["","0","00","000","0000"],c=[""],d=0,p=s.length;d<p;++d){if(o=a.metadata.characterToGlyph(s.charCodeAt(d)),a.metadata.glyIdsUsed.push(o),a.metadata.toUnicode[o]=s.charCodeAt(d),l.indexOf(o)==-1&&(l.push(o),l.push([parseInt(a.metadata.widthOfGlyph(o),10)])),o=="0")return c.join("");o=o.toString(16),c.push(h[4-o.length],o)}return c.join("")},i=function(s){var a,o,l,h,c,d,p;for(c=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],d=0,p=(o=Object.keys(s).sort((function(f,g){return f-g}))).length;d<p;d++)a=o[d],l.length>=100&&(c+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),s[a]!==void 0&&s[a]!==null&&typeof s[a].toString=="function"&&(h=("0000"+s[a].toString(16)).slice(-4),a=("0000"+(+a).toString(16)).slice(-4),l.push("<"+a+"><"+h+">"));return l.length&&(c+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),c+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(a){var o=a.font,l=a.out,h=a.newObject,c=a.putStream;if(o.metadata instanceof r.API.TTFFont&&o.encoding==="Identity-H"){for(var d=o.metadata.Unicode.widths,p=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),f="",g=0;g<p.length;g++)f+=String.fromCharCode(p[g]);var m=h();c({data:f,addLength1:!0,objectId:m}),l("endobj");var b=h();c({data:i(o.metadata.toUnicode),addLength1:!0,objectId:b}),l("endobj");var w=h();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+Co(o.fontName)),l("/FontFile2 "+m+" 0 R"),l("/FontBBox "+r.API.PDFObject.convert(o.metadata.bbox)),l("/Flags "+o.metadata.flags),l("/StemV "+o.metadata.stemV),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l(">>"),l("endobj");var E=h();l("<<"),l("/Type /Font"),l("/BaseFont /"+Co(o.fontName)),l("/FontDescriptor "+w+" 0 R"),l("/W "+r.API.PDFObject.convert(d)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+o.encoding+")"),l(">>"),l(">>"),l("endobj"),o.objectNumber=h(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+b+" 0 R"),l("/BaseFont /"+Co(o.fontName)),l("/Encoding /"+o.encoding),l("/DescendantFonts ["+E+" 0 R]"),l(">>"),l("endobj"),o.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(a){var o=a.font,l=a.out,h=a.newObject,c=a.putStream;if(o.metadata instanceof r.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var d=o.metadata.rawData,p="",f=0;f<d.length;f++)p+=String.fromCharCode(d[f]);var g=h();c({data:p,addLength1:!0,objectId:g}),l("endobj");var m=h();c({data:i(o.metadata.toUnicode),addLength1:!0,objectId:m}),l("endobj");var b=h();l("<<"),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l("/StemV "+o.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+g+" 0 R"),l("/Flags 96"),l("/FontBBox "+r.API.PDFObject.convert(o.metadata.bbox)),l("/FontName /"+Co(o.fontName)),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l(">>"),l("endobj"),o.objectNumber=h();for(var w=0;w<o.metadata.hmtx.widths.length;w++)o.metadata.hmtx.widths[w]=parseInt(o.metadata.hmtx.widths[w]*(1e3/o.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+m+" 0 R/BaseFont/"+Co(o.fontName)+"/FontDescriptor "+b+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+r.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),l("endobj"),o.isAlreadyPutted=!0}})(s)}]);var n=function(s){var a,o=s.text||"",l=s.x,h=s.y,c=s.options||{},d=s.mutex||{},p=d.pdfEscape,f=d.activeFontKey,g=d.fonts,m=f,b="",w=0,E="",C=g[m].encoding;if(g[m].encoding!=="Identity-H")return{text:o,x:l,y:h,options:c,mutex:d};for(E=o,m=f,Array.isArray(o)&&(E=o[0]),w=0;w<E.length;w+=1)g[m].metadata.hasOwnProperty("cmap")&&(a=g[m].metadata.cmap.unicode.codeMap[E[w].charCodeAt(0)]),a||E[w].charCodeAt(0)<256&&g[m].metadata.hasOwnProperty("Unicode")?b+=E[w]:b+="";var F="";return parseInt(m.slice(1))<14||C==="WinAnsiEncoding"?F=p(b,m).split("").map((function(L){return L.charCodeAt(0).toString(16)})).join(""):C==="Identity-H"&&(F=t(b,g[m])),d.isHex=!0,{text:F,x:l,y:h,options:c,mutex:d}};e.events.push(["postProcessText",function(s){var a=s.text||"",o=[],l={text:a,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(a)){var h=0;for(h=0;h<a.length;h+=1)Array.isArray(a[h])&&a[h].length===3?o.push([n(Object.assign({},l,{text:a[h][0]})).text,a[h][1],a[h][2]]):o.push(n(Object.assign({},l,{text:a[h]})).text);s.text=o}else s.text=n(Object.assign({},l,{text:a})).text}])})(dt),(function(r){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};r.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},r.addFileToVFS=function(t,i){return e.call(this),this.internal.vFS[t]=i,this},r.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}})(dt.API),(function(r){r.__bidiEngine__=r.prototype.__bidiEngine__=function(i){var n,s,a,o,l,h,c,d=e,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],f=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],g={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},m={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},b=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],w=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),E=!1,C=0;this.__bidiEngine__={};var F=function(R){var k=R.charCodeAt(),M=k>>8,V=m[M];return V!==void 0?d[256*V+(255&k)]:M===252||M===253?"AL":w.test(M)?"L":M===8?"R":"N"},L=function(R){for(var k,M=0;M<R.length;M++){if((k=F(R.charAt(M)))==="L")return!1;if(k==="R")return!0}return!1},D=function(R,k,M,V){var oe,K,Y,se,q=k[V];switch(q){case"L":case"R":E=!1;break;case"N":case"AN":break;case"EN":E&&(q="AN");break;case"AL":E=!0,q="R";break;case"WS":q="N";break;case"CS":V<1||V+1>=k.length||(oe=M[V-1])!=="EN"&&oe!=="AN"||(K=k[V+1])!=="EN"&&K!=="AN"?q="N":E&&(K="AN"),q=K===oe?K:"N";break;case"ES":q=(oe=V>0?M[V-1]:"B")==="EN"&&V+1<k.length&&k[V+1]==="EN"?"EN":"N";break;case"ET":if(V>0&&M[V-1]==="EN"){q="EN";break}if(E){q="N";break}for(Y=V+1,se=k.length;Y<se&&k[Y]==="ET";)Y++;q=Y<se&&k[Y]==="EN"?"EN":"N";break;case"NSM":if(a&&!o){for(se=k.length,Y=V+1;Y<se&&k[Y]==="NSM";)Y++;if(Y<se){var fe=R[V],ge=fe>=1425&&fe<=2303||fe===64286;if(oe=k[Y],ge&&(oe==="R"||oe==="AL")){q="R";break}}}q=V<1||(oe=k[V-1])==="B"?"N":M[V-1];break;case"B":E=!1,n=!0,q=C;break;case"S":s=!0,q="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":E=!1;break;case"BN":q="N"}return q},S=function(R,k,M){var V=R.split("");return M&&A(V,M,{hiLevel:C}),V.reverse(),k&&k.reverse(),V.join("")},A=function(R,k,M){var V,oe,K,Y,se,q=-1,fe=R.length,ge=0,_=[],P=C?f:p,N=[];for(E=!1,n=!1,s=!1,oe=0;oe<fe;oe++)N[oe]=F(R[oe]);for(K=0;K<fe;K++){if(se=ge,_[K]=D(R,N,_,K),V=240&(ge=P[se][g[_[K]]]),ge&=15,k[K]=Y=P[ge][5],V>0)if(V===16){for(oe=q;oe<K;oe++)k[oe]=1;q=-1}else q=-1;if(P[ge][6])q===-1&&(q=K);else if(q>-1){for(oe=q;oe<K;oe++)k[oe]=Y;q=-1}N[K]==="B"&&(k[K]=0),M.hiLevel|=Y}s&&(function(I,X,he){for(var ce=0;ce<he;ce++)if(I[ce]==="S"){X[ce]=C;for(var ue=ce-1;ue>=0&&I[ue]==="WS";ue--)X[ue]=C}})(N,k,fe)},O=function(R,k,M,V,oe){if(!(oe.hiLevel<R)){if(R===1&&C===1&&!n)return k.reverse(),void(M&&M.reverse());for(var K,Y,se,q,fe=k.length,ge=0;ge<fe;){if(V[ge]>=R){for(se=ge+1;se<fe&&V[se]>=R;)se++;for(q=ge,Y=se-1;q<Y;q++,Y--)K=k[q],k[q]=k[Y],k[Y]=K,M&&(K=M[q],M[q]=M[Y],M[Y]=K);ge=se}ge++}}},U=function(R,k,M){var V=R.split(""),oe={hiLevel:C};return M||(M=[]),A(V,M,oe),(function(K,Y,se){if(se.hiLevel!==0&&c)for(var q,fe=0;fe<K.length;fe++)Y[fe]===1&&(q=b.indexOf(K[fe]))>=0&&(K[fe]=b[q+1])})(V,M,oe),O(2,V,k,M,oe),O(1,V,k,M,oe),V.join("")};return this.__bidiEngine__.doBidiReorder=function(R,k,M){if((function(oe,K){if(K)for(var Y=0;Y<oe.length;Y++)K[Y]=Y;o===void 0&&(o=L(oe)),h===void 0&&(h=L(oe))})(R,k),a||!l||h)if(a&&l&&o^h)C=o?1:0,R=S(R,k,M);else if(!a&&l&&h)C=o?1:0,R=U(R,k,M),R=S(R,k);else if(!a||o||l||h){if(a&&!l&&o^h)R=S(R,k),o?(C=0,R=U(R,k,M)):(C=1,R=U(R,k,M),R=S(R,k));else if(a&&o&&!l&&h)C=1,R=U(R,k,M),R=S(R,k);else if(!a&&!l&&o^h){var V=c;o?(C=1,R=U(R,k,M),C=0,c=!1,R=U(R,k,M),c=V):(C=0,R=U(R,k,M),R=S(R,k),C=1,c=!1,R=U(R,k,M),c=V,R=S(R,k))}}else C=0,R=U(R,k,M);else C=o?1:0,R=U(R,k,M);return R},this.__bidiEngine__.setOptions=function(R){R&&(a=R.isInputVisual,l=R.isOutputVisual,o=R.isInputRtl,h=R.isOutputRtl,c=R.isSymmetricSwapping)},this.__bidiEngine__.setOptions(i),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new r.__bidiEngine__({isInputVisual:!0});r.API.events.push(["postProcessText",function(i){var n=i.text,s=(i.x,i.y,i.options||{}),a=(i.mutex,s.lang,[]);if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,t.setOptions(s),Object.prototype.toString.call(n)==="[object Array]"){var o=0;for(a=[],o=0;o<n.length;o+=1)Object.prototype.toString.call(n[o])==="[object Array]"?a.push([t.doBidiReorder(n[o][0]),n[o][1],n[o][2]]):a.push([t.doBidiReorder(n[o])]);i.text=a}else i.text=t.doBidiReorder(n);t.setOptions({isInputVisual:!0})}])})(dt),dt.API.TTFFont=(function(){function r(e){var t;if(this.rawData=e,t=this.contents=new na(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new Wy(this),this.registerTTF()}return r.open=function(e){return new r(e)},r.prototype.parse=function(){return this.directory=new Ay(this.contents),this.head=new Ry(this),this.name=new My(this),this.cmap=new Lg(this),this.toUnicode={},this.hhea=new Ly(this),this.maxp=new Oy(this),this.hmtx=new Iy(this),this.post=new Py(this),this.os2=new Ny(this),this.loca=new jy(this),this.glyf=new By(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},r.prototype.registerTTF=function(){var e,t,i,n,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var a,o,l,h;for(h=[],a=0,o=(l=this.bbox).length;a<o;a++)e=l[a],h.push(Math.round(e*this.scaleFactor));return h}).call(this),this.stemV=0,this.post.exists?(i=255&(n=this.post.italic_angle),(32768&(t=n>>16))!=0&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+i)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},r.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},r.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},r.prototype.widthOfString=function(e,t,i){var n,s,a,o;for(a=0,s=0,o=(e=""+e).length;0<=o?s<o:s>o;s=0<=o?++s:--s)n=e.charCodeAt(s),a+=this.widthOfGlyph(this.characterToGlyph(n))+i*(1e3/t)||0;return a*(t/1e3)},r.prototype.lineHeight=function(e,t){var i;return t==null&&(t=!1),i=t?this.lineGap:0,(this.ascender+i-this.decender)/1e3*e},r})();var Un,na=(function(){function r(e){this.data=e??[],this.pos=0,this.length=this.data.length}return r.prototype.readByte=function(){return this.data[this.pos++]},r.prototype.writeByte=function(e){return this.data[this.pos++]=e},r.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},r.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},r.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},r.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},r.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},r.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},r.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},r.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},r.prototype.readString=function(e){var t,i;for(i=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)i[t]=String.fromCharCode(this.readByte());return i.join("")},r.prototype.writeString=function(e){var t,i,n;for(n=[],t=0,i=e.length;0<=i?t<i:t>i;t=0<=i?++t:--t)n.push(this.writeByte(e.charCodeAt(t)));return n},r.prototype.readShort=function(){return this.readInt16()},r.prototype.writeShort=function(e){return this.writeInt16(e)},r.prototype.readLongLong=function(){var e,t,i,n,s,a,o,l;return e=this.readByte(),t=this.readByte(),i=this.readByte(),n=this.readByte(),s=this.readByte(),a=this.readByte(),o=this.readByte(),l=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^i)+4294967296*(255^n)+16777216*(255^s)+65536*(255^a)+256*(255^o)+(255^l)+1):72057594037927940*e+281474976710656*t+1099511627776*i+4294967296*n+16777216*s+65536*a+256*o+l},r.prototype.writeLongLong=function(e){var t,i;return t=Math.floor(e/4294967296),i=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(i>>24&255),this.writeByte(i>>16&255),this.writeByte(i>>8&255),this.writeByte(255&i)},r.prototype.readInt=function(){return this.readInt32()},r.prototype.writeInt=function(e){return this.writeInt32(e)},r.prototype.read=function(e){var t,i;for(t=[],i=0;0<=e?i<e:i>e;i=0<=e?++i:--i)t.push(this.readByte());return t},r.prototype.write=function(e){var t,i,n,s;for(s=[],i=0,n=e.length;i<n;i++)t=e[i],s.push(this.writeByte(t));return s},r})(),Ay=(function(){var r;function e(t){var i,n,s;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},n=0,s=this.tableCount;0<=s?n<s:n>s;n=0<=s?++n:--n)i={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[i.tag]=i}return e.prototype.encode=function(t){var i,n,s,a,o,l,h,c,d,p,f,g,m;for(m in f=Object.keys(t).length,l=Math.log(2),d=16*Math.floor(Math.log(f)/l),a=Math.floor(d/l),c=16*f-d,(n=new na).writeInt(this.scalarType),n.writeShort(f),n.writeShort(d),n.writeShort(a),n.writeShort(c),s=16*f,h=n.pos+s,o=null,g=[],t)for(p=t[m],n.writeString(m),n.writeInt(r(p)),n.writeInt(h),n.writeInt(p.length),g=g.concat(p),m==="head"&&(o=h),h+=p.length;h%4;)g.push(0),h++;return n.write(g),i=2981146554-r(n.data),n.pos=o+8,n.writeUInt32(i),n.data},r=function(t){var i,n,s,a;for(t=Ng.call(t);t.length%4;)t.push(0);for(s=new na(t),n=0,i=0,a=t.length;i<a;i=i+=4)n+=s.readUInt32();return 4294967295&n},e})(),Fy={}.hasOwnProperty,ls=function(r,e){for(var t in e)Fy.call(e,t)&&(r[t]=e[t]);function i(){this.constructor=r}return i.prototype=e.prototype,r.prototype=new i,r.__super__=e.prototype,r};Un=(function(){function r(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return r.prototype.parse=function(){},r.prototype.encode=function(){},r.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},r})();var Ry=(function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Un),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var i;return(i=new na).writeInt(this.version),i.writeInt(this.revision),i.writeInt(this.checkSumAdjustment),i.writeInt(this.magicNumber),i.writeShort(this.flags),i.writeShort(this.unitsPerEm),i.writeLongLong(this.created),i.writeLongLong(this.modified),i.writeShort(this.xMin),i.writeShort(this.yMin),i.writeShort(this.xMax),i.writeShort(this.yMax),i.writeShort(this.macStyle),i.writeShort(this.lowestRecPPEM),i.writeShort(this.fontDirectionHint),i.writeShort(t),i.writeShort(this.glyphDataFormat),i.data},e})(),Tp=(function(){function r(e,t){var i,n,s,a,o,l,h,c,d,p,f,g,m,b,w,E,C;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),d=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=e.readByte();break;case 4:for(f=e.readUInt16(),p=f/2,e.pos+=6,s=(function(){var F,L;for(L=[],l=F=0;0<=p?F<p:F>p;l=0<=p?++F:--F)L.push(e.readUInt16());return L})(),e.pos+=2,m=(function(){var F,L;for(L=[],l=F=0;0<=p?F<p:F>p;l=0<=p?++F:--F)L.push(e.readUInt16());return L})(),h=(function(){var F,L;for(L=[],l=F=0;0<=p?F<p:F>p;l=0<=p?++F:--F)L.push(e.readUInt16());return L})(),c=(function(){var F,L;for(L=[],l=F=0;0<=p?F<p:F>p;l=0<=p?++F:--F)L.push(e.readUInt16());return L})(),n=(this.length-e.pos+this.offset)/2,o=(function(){var F,L;for(L=[],l=F=0;0<=n?F<n:F>n;l=0<=n?++F:--F)L.push(e.readUInt16());return L})(),l=w=0,C=s.length;w<C;l=++w)for(b=s[l],i=E=g=m[l];g<=b?E<=b:E>=b;i=g<=b?++E:--E)c[l]===0?a=i+h[l]:(a=o[c[l]/2+(i-g)-(p-l)]||0)!==0&&(a+=h[l]),this.codeMap[i]=65535&a}e.pos=d}return r.encode=function(e,t){var i,n,s,a,o,l,h,c,d,p,f,g,m,b,w,E,C,F,L,D,S,A,O,U,R,k,M,V,oe,K,Y,se,q,fe,ge,_,P,N,I,X,he,ce,ue,be,Le,Z;switch(V=new na,a=Object.keys(e).sort((function(Ue,Ye){return Ue-Ye})),t){case"macroman":for(m=0,b=(function(){var Ue=[];for(g=0;g<256;++g)Ue.push(0);return Ue})(),E={0:0},s={},oe=0,q=a.length;oe<q;oe++)E[ue=e[n=a[oe]]]==null&&(E[ue]=++m),s[n]={old:e[n],new:E[e[n]]},b[n]=E[e[n]];return V.writeUInt16(1),V.writeUInt16(0),V.writeUInt32(12),V.writeUInt16(0),V.writeUInt16(262),V.writeUInt16(0),V.write(b),{charMap:s,subtable:V.data,maxGlyphID:m+1};case"unicode":for(k=[],d=[],C=0,E={},i={},w=h=null,K=0,fe=a.length;K<fe;K++)E[L=e[n=a[K]]]==null&&(E[L]=++C),i[n]={old:L,new:E[L]},o=E[L]-n,w!=null&&o===h||(w&&d.push(w),k.push(n),h=o),w=n;for(w&&d.push(w),d.push(65535),k.push(65535),U=2*(O=k.length),A=2*Math.pow(Math.log(O)/Math.LN2,2),p=Math.log(A/2)/Math.LN2,S=2*O-A,l=[],D=[],f=[],g=Y=0,ge=k.length;Y<ge;g=++Y){if(R=k[g],c=d[g],R===65535){l.push(0),D.push(0);break}if(R-(M=i[R].new)>=32768)for(l.push(0),D.push(2*(f.length+O-g)),n=se=R;R<=c?se<=c:se>=c;n=R<=c?++se:--se)f.push(i[n].new);else l.push(M-R),D.push(0)}for(V.writeUInt16(3),V.writeUInt16(1),V.writeUInt32(12),V.writeUInt16(4),V.writeUInt16(16+8*O+2*f.length),V.writeUInt16(0),V.writeUInt16(U),V.writeUInt16(A),V.writeUInt16(p),V.writeUInt16(S),he=0,_=d.length;he<_;he++)n=d[he],V.writeUInt16(n);for(V.writeUInt16(0),ce=0,P=k.length;ce<P;ce++)n=k[ce],V.writeUInt16(n);for(be=0,N=l.length;be<N;be++)o=l[be],V.writeUInt16(o);for(Le=0,I=D.length;Le<I;Le++)F=D[Le],V.writeUInt16(F);for(Z=0,X=f.length;Z<X;Z++)m=f[Z],V.writeUInt16(m);return{charMap:i,subtable:V.data,maxGlyphID:C+1}}},r})(),Lg=(function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Un),e.prototype.tag="cmap",e.prototype.parse=function(t){var i,n,s;for(t.pos=this.offset,this.version=t.readUInt16(),s=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=s?n<s:n>s;n=0<=s?++n:--n)i=new Tp(t,this.offset),this.tables.push(i),i.isUnicode&&this.unicode==null&&(this.unicode=i);return!0},e.encode=function(t,i){var n,s;return i==null&&(i="macroman"),n=Tp.encode(t,i),(s=new na).writeUInt16(0),s.writeUInt16(1),n.table=s.data.concat(n.subtable),n},e})(),Ly=(function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Un),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e})(),Ny=(function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Un),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=(function(){var i,n;for(n=[],i=0;i<10;++i)n.push(t.readByte());return n})(),this.charRange=(function(){var i,n;for(n=[],i=0;i<4;++i)n.push(t.readInt());return n})(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=(function(){var i,n;for(n=[],i=0;i<2;i=++i)n.push(t.readInt());return n})(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e})(),Py=(function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Un),e.prototype.tag="post",e.prototype.parse=function(t){var i,n,s;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:break;case 131072:var a;for(n=t.readUInt16(),this.glyphNameIndex=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],s=[];t.pos<this.offset+this.length;)i=t.readByte(),s.push(this.names.push(t.readString(i)));return s;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 196608:break;case 262144:return this.map=(function(){var o,l,h;for(h=[],a=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;a=0<=l?++o:--o)h.push(t.readUInt32());return h}).call(this)}},e})(),Dy=function(r,e){this.raw=r,this.length=r.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},My=(function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Un),e.prototype.tag="name",e.prototype.parse=function(t){var i,n,s,a,o,l,h,c,d,p,f;for(t.pos=this.offset,t.readShort(),i=t.readShort(),l=t.readShort(),n=[],a=0;0<=i?a<i:a>i;a=0<=i?++a:--a)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+l+t.readShort()});for(h={},a=d=0,p=n.length;d<p;a=++d)s=n[a],t.pos=s.offset,c=t.readString(s.length),o=new Dy(c,s),h[f=s.nameID]==null&&(h[f]=[]),h[s.nameID].push(o);this.strings=h,this.copyright=h[0],this.fontFamily=h[1],this.fontSubfamily=h[2],this.uniqueSubfamily=h[3],this.fontName=h[4],this.version=h[5];try{this.postscriptName=h[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=h[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=h[7],this.manufacturer=h[8],this.designer=h[9],this.description=h[10],this.vendorUrl=h[11],this.designerUrl=h[12],this.license=h[13],this.licenseUrl=h[14],this.preferredFamily=h[15],this.preferredSubfamily=h[17],this.compatibleFull=h[18],this.sampleText=h[19]},e})(),Oy=(function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Un),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e})(),Iy=(function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Un),e.prototype.tag="hmtx",e.prototype.parse=function(t){var i,n,s,a,o,l,h;for(t.pos=this.offset,this.metrics=[],i=0,l=this.file.hhea.numberOfMetrics;0<=l?i<l:i>l;i=0<=l?++i:--i)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var c,d;for(d=[],i=c=0;0<=s?c<s:c>s;i=0<=s?++c:--c)d.push(t.readInt16());return d})(),this.widths=(function(){var c,d,p,f;for(f=[],c=0,d=(p=this.metrics).length;c<d;c++)a=p[c],f.push(a.advance);return f}).call(this),n=this.widths[this.widths.length-1],h=[],i=o=0;0<=s?o<s:o>s;i=0<=s?++o:--o)h.push(this.widths.push(n));return h},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e})(),Ng=[].slice,By=(function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Un),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var i,n,s,a,o,l,h,c,d,p;return t in this.cache?this.cache[t]:(a=this.file.loca,i=this.file.contents,n=a.indexOf(t),(s=a.lengthOf(t))===0?this.cache[t]=null:(i.pos=this.offset+n,o=(l=new na(i.read(s))).readShort(),c=l.readShort(),p=l.readShort(),h=l.readShort(),d=l.readShort(),this.cache[t]=o===-1?new zy(l,c,p,h,d):new Hy(l,o,c,p,h,d),this.cache[t]))},e.prototype.encode=function(t,i,n){var s,a,o,l,h;for(o=[],a=[],l=0,h=i.length;l<h;l++)s=t[i[l]],a.push(o.length),s&&(o=o.concat(s.encode(n)));return a.push(o.length),{table:o,offsets:a}},e})(),Hy=(function(){function r(e,t,i,n,s,a){this.raw=e,this.numberOfContours=t,this.xMin=i,this.yMin=n,this.xMax=s,this.yMax=a,this.compound=!1}return r.prototype.encode=function(){return this.raw.data},r})(),zy=(function(){function r(e,t,i,n,s){var a,o;for(this.raw=e,this.xMin=t,this.yMin=i,this.xMax=n,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],a=this.raw;o=a.readShort(),this.glyphOffsets.push(a.pos),this.glyphIDs.push(a.readUInt16()),32&o;)a.pos+=1&o?4:2,128&o?a.pos+=8:64&o?a.pos+=4:8&o&&(a.pos+=2)}return r.prototype.encode=function(){var e,t,i;for(t=new na(Ng.call(this.raw.data)),e=0,i=this.glyphIDs.length;e<i;++e)t.pos=this.glyphOffsets[e];return t.data},r})(),jy=(function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Un),e.prototype.tag="loca",e.prototype.parse=function(t){var i,n;return t.pos=this.offset,i=this.file.head.indexToLocFormat,this.offsets=i===0?(function(){var s,a;for(a=[],n=0,s=this.length;n<s;n+=2)a.push(2*t.readUInt16());return a}).call(this):(function(){var s,a;for(a=[],n=0,s=this.length;n<s;n+=4)a.push(t.readUInt32());return a}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,i){for(var n=new Uint32Array(this.offsets.length),s=0,a=0,o=0;o<n.length;++o)if(n[o]=s,a<i.length&&i[a]==o){++a,n[o]=s;var l=this.offsets[o],h=this.offsets[o+1]-l;h>0&&(s+=h)}for(var c=new Array(4*n.length),d=0;d<n.length;++d)c[4*d+3]=255&n[d],c[4*d+2]=(65280&n[d])>>8,c[4*d+1]=(16711680&n[d])>>16,c[4*d]=(4278190080&n[d])>>24;return c},e})(),Wy=(function(){function r(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return r.prototype.generateCmap=function(){var e,t,i,n,s;for(t in n=this.font.cmap.tables[0].codeMap,e={},s=this.subset)i=s[t],e[t]=n[i];return e},r.prototype.glyphsFor=function(e){var t,i,n,s,a,o,l;for(n={},a=0,o=e.length;a<o;a++)n[s=e[a]]=this.font.glyf.glyphFor(s);for(s in t=[],n)(i=n[s])!=null&&i.compound&&t.push.apply(t,i.glyphIDs);if(t.length>0)for(s in l=this.glyphsFor(t))i=l[s],n[s]=i;return n},r.prototype.encode=function(e,t){var i,n,s,a,o,l,h,c,d,p,f,g,m,b,w;for(n in i=Lg.encode(this.generateCmap(),"unicode"),a=this.glyphsFor(e),f={0:0},w=i.charMap)f[(l=w[n]).old]=l.new;for(g in p=i.maxGlyphID,a)g in f||(f[g]=p++);return c=(function(E){var C,F;for(C in F={},E)F[E[C]]=C;return F})(f),d=Object.keys(c).sort((function(E,C){return E-C})),m=(function(){var E,C,F;for(F=[],E=0,C=d.length;E<C;E++)o=d[E],F.push(c[o]);return F})(),s=this.font.glyf.encode(a,m,f),h=this.font.loca.encode(s.offsets,m),b={cmap:this.font.cmap.raw(),glyf:s.table,loca:h,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(b["OS/2"]=this.font.os2.raw()),this.font.directory.encode(b)},r})();dt.API.PDFObject=(function(){var r;function e(){}return r=function(t,i){return(Array(i+1).join("0")+t).slice(-i)},e.convert=function(t){var i,n,s,a;if(Array.isArray(t))return"["+(function(){var o,l,h;for(h=[],o=0,l=t.length;o<l;o++)i=t[o],h.push(e.convert(i));return h})().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t?.isString)return"("+t+")";if(t instanceof Date)return"(D:"+r(t.getUTCFullYear(),4)+r(t.getUTCMonth(),2)+r(t.getUTCDate(),2)+r(t.getUTCHours(),2)+r(t.getUTCMinutes(),2)+r(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(n in s=["<<"],t)a=t[n],s.push("/"+n+" "+e.convert(a));return s.push(">>"),s.join(`
`)}return""+t},e})();const Uy=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:xy,AcroFormAppearance:ot,AcroFormButton:Yr,AcroFormCheckBox:Pl,AcroFormChoiceField:ka,AcroFormComboBox:Ta,AcroFormEditBox:Ll,AcroFormListBox:Sa,AcroFormPasswordField:Dl,AcroFormPushButton:Nl,AcroFormRadioButton:Aa,AcroFormTextField:ra,GState:Gl,ShadingPattern:$s,TilingPattern:Ca,default:dt,jsPDF:dt},Symbol.toStringTag,{value:"Module"}));var Vy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function m8(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function Gy(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var e=r.default;if(typeof e=="function"){var t=function i(){var n=!1;try{n=this instanceof i}catch{}return n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(i){var n=Object.getOwnPropertyDescriptor(r,i);Object.defineProperty(t,i,n.get?n:{enumerable:!0,get:function(){return r[i]}})}),t}var Ec={exports:{}};const qy=Gy(Uy);/*!
 * 
 *               jsPDF AutoTable plugin v3.5.28
 *
 *               Copyright (c) 2022 Simon Bengtsson, https://github.com/simonbengtsson/jsPDF-AutoTable
 *               Licensed under the MIT License.
 *               http://opensource.org/licenses/mit-license
 *
 */var Ap=Ec.exports,Fp;function Xy(){return Fp||(Fp=1,(function(r,e){(function(i,n){r.exports=n((function(){try{return qy}catch{}})())})(typeof globalThis<"u"?globalThis:typeof Ap<"u"?Ap:typeof window<"u"?window:typeof self<"u"?self:Vy,function(t){return(function(){var i={662:(function(o,l){var h=this&&this.__extends||(function(){var p=function(f,g){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,b){m.__proto__=b}||function(m,b){for(var w in b)Object.prototype.hasOwnProperty.call(b,w)&&(m[w]=b[w])},p(f,g)};return function(f,g){if(typeof g!="function"&&g!==null)throw new TypeError("Class extends value "+String(g)+" is not a constructor or null");p(f,g);function m(){this.constructor=f}f.prototype=g===null?Object.create(g):(m.prototype=g.prototype,new m)}})();Object.defineProperty(l,"__esModule",{value:!0}),l.CellHookData=l.HookData=void 0;var c=(function(){function p(f,g,m){this.table=g,this.pageNumber=g.pageNumber,this.pageCount=this.pageNumber,this.settings=g.settings,this.cursor=m,this.doc=f.getDocument()}return p})();l.HookData=c;var d=(function(p){h(f,p);function f(g,m,b,w,E,C){var F=p.call(this,g,m,C)||this;return F.cell=b,F.row=w,F.column=E,F.section=w.section,F}return f})(c);l.CellHookData=d}),790:(function(o,l,h){Object.defineProperty(l,"__esModule",{value:!0});var c=h(148),d=h(938),p=h(323),f=h(587),g=h(49),m=h(858);function b(w){w.API.autoTable=function(){for(var E=[],C=0;C<arguments.length;C++)E[C]=arguments[C];var F;E.length===1?F=E[0]:(console.error("Use of deprecated autoTable initiation"),F=E[2]||{},F.columns=E[0],F.body=E[1]);var L=(0,f.parseInput)(this,F),D=(0,m.createTable)(this,L);return(0,g.drawTable)(this,D),this},w.API.lastAutoTable=!1,w.API.previousAutoTable=!1,w.API.autoTable.previous=!1,w.API.autoTableText=function(E,C,F,L){(0,d.default)(E,C,F,L,this)},w.API.autoTableSetDefaults=function(E){return p.DocHandler.setDefaults(E,this),this},w.autoTableSetDefaults=function(E,C){p.DocHandler.setDefaults(E,C)},w.API.autoTableHtmlToJson=function(E,C){if(C===void 0&&(C=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var F=new p.DocHandler(this),L=(0,c.parseHtml)(F,E,window,C,!1),D=L.head,S=L.body,A=D[0].map(function(O){return O.content});return{columns:A,rows:S,data:S}},w.API.autoTableEndPosY=function(){console.error("Use of deprecated function: autoTableEndPosY. Use doc.lastAutoTable.finalY instead.");var E=this.lastAutoTable;return E&&E.finalY?E.finalY:0},w.API.autoTableAddPageContent=function(E){return console.error("Use of deprecated function: autoTableAddPageContent. Use jsPDF.autoTableSetDefaults({didDrawPage: () => {}}) instead."),w.API.autoTable.globalDefaults||(w.API.autoTable.globalDefaults={}),w.API.autoTable.globalDefaults.addPageContent=E,this},w.API.autoTableAddPage=function(){return console.error("Use of deprecated function: autoTableAddPage. Use doc.addPage()"),this.addPage(),this}}l.default=b}),938:(function(o,l){Object.defineProperty(l,"__esModule",{value:!0});function h(c,d,p,f,g){f=f||{};var m=1.15,b=g.internal.scaleFactor,w=g.internal.getFontSize()/b,E=/\r\n|\r|\n/g,C="",F=1;if((f.valign==="middle"||f.valign==="bottom"||f.halign==="center"||f.halign==="right")&&(C=typeof c=="string"?c.split(E):c,F=C.length||1),p+=w*(2-m),f.valign==="middle"?p-=F/2*w*m:f.valign==="bottom"&&(p-=F*w*m),f.halign==="center"||f.halign==="right"){var L=w;if(f.halign==="center"&&(L*=.5),C&&F>=1){for(var D=0;D<C.length;D++)g.text(C[D],d-g.getStringUnitWidth(C[D])*L,p),p+=w*m;return g}d-=g.getStringUnitWidth(c)*L}return f.halign==="justify"?g.text(c,d,p,{maxWidth:f.maxWidth||100,align:"justify"}):g.text(c,d,p),g}l.default=h}),200:(function(o,l){Object.defineProperty(l,"__esModule",{value:!0}),l.parseSpacing=l.getFillStyle=l.addTableBorder=l.getStringWidth=void 0;function h(f,g,m){m.applyStyles(g,!0);var b=Array.isArray(f)?f:[f],w=b.map(function(E){return m.getTextWidth(E)}).reduce(function(E,C){return Math.max(E,C)},0);return w}l.getStringWidth=h;function c(f,g,m,b){var w=g.settings.tableLineWidth,E=g.settings.tableLineColor;f.applyStyles({lineWidth:w,lineColor:E});var C=d(w,!1);C&&f.rect(m.x,m.y,g.getWidth(f.pageSize().width),b.y-m.y,C)}l.addTableBorder=c;function d(f,g){var m=f>0,b=g||g===0;return m&&b?"DF":m?"S":b?"F":null}l.getFillStyle=d;function p(f,g){var m,b,w,E;if(f=f||g,Array.isArray(f)){if(f.length>=4)return{top:f[0],right:f[1],bottom:f[2],left:f[3]};if(f.length===3)return{top:f[0],right:f[1],bottom:f[2],left:f[1]};if(f.length===2)return{top:f[0],right:f[1],bottom:f[0],left:f[1]};f.length===1?f=f[0]:f=g}return typeof f=="object"?(typeof f.vertical=="number"&&(f.top=f.vertical,f.bottom=f.vertical),typeof f.horizontal=="number"&&(f.right=f.horizontal,f.left=f.horizontal),{left:(m=f.left)!==null&&m!==void 0?m:g,top:(b=f.top)!==null&&b!==void 0?b:g,right:(w=f.right)!==null&&w!==void 0?w:g,bottom:(E=f.bottom)!==null&&E!==void 0?E:g}):(typeof f!="number"&&(f=g),{top:f,right:f,bottom:f,left:f})}l.parseSpacing=p}),913:(function(o,l){var h=this&&this.__extends||(function(){var f=function(g,m){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,w){b.__proto__=w}||function(b,w){for(var E in w)Object.prototype.hasOwnProperty.call(w,E)&&(b[E]=w[E])},f(g,m)};return function(g,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");f(g,m);function b(){this.constructor=g}g.prototype=m===null?Object.create(m):(b.prototype=m.prototype,new b)}})();Object.defineProperty(l,"__esModule",{value:!0}),l.getTheme=l.defaultStyles=l.HtmlRowInput=l.FONT_ROW_RATIO=void 0,l.FONT_ROW_RATIO=1.15;var c=(function(f){h(g,f);function g(m){var b=f.call(this)||this;return b._element=m,b}return g})(Array);l.HtmlRowInput=c;function d(f){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/f,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}l.defaultStyles=d;function p(f){var g={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return g[f]}l.getTheme=p}),259:(function(o,l,h){Object.defineProperty(l,"__esModule",{value:!0}),l.parseCss=void 0;var c=h(200);function d(b,w,E,C,F){var L={},D=1.3333333333333333,S=f(w,function(K){return F.getComputedStyle(K).backgroundColor});S!=null&&(L.fillColor=S);var A=f(w,function(K){return F.getComputedStyle(K).color});A!=null&&(L.textColor=A);var O=f(w,function(K){return F.getComputedStyle(K).borderTopColor});O!=null&&(L.lineColor=O);var U=m(C,E);U&&(L.cellPadding=U);var R=parseInt(C.borderTopWidth||"");R=R/D/E,R&&(L.lineWidth=R);var k=["left","right","center","justify"];k.indexOf(C.textAlign)!==-1&&(L.halign=C.textAlign),k=["middle","bottom","top"],k.indexOf(C.verticalAlign)!==-1&&(L.valign=C.verticalAlign);var M=parseInt(C.fontSize||"");isNaN(M)||(L.fontSize=M/D);var V=p(C);V&&(L.fontStyle=V);var oe=(C.fontFamily||"").toLowerCase();return b.indexOf(oe)!==-1&&(L.font=oe),L}l.parseCss=d;function p(b){var w="";return(b.fontWeight==="bold"||b.fontWeight==="bolder"||parseInt(b.fontWeight)>=700)&&(w="bold"),(b.fontStyle==="italic"||b.fontStyle==="oblique")&&(w+="italic"),w}function f(b,w){var E=g(b,w);if(!E)return null;var C=E.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!C||!Array.isArray(C))return null;var F=[parseInt(C[1]),parseInt(C[2]),parseInt(C[3])],L=parseInt(C[4]);return L===0||isNaN(F[0])||isNaN(F[1])||isNaN(F[2])?null:F}function g(b,w){var E=w(b);return E==="rgba(0, 0, 0, 0)"||E==="transparent"||E==="initial"||E==="inherit"?b.parentElement==null?null:g(b.parentElement,w):E}function m(b,w){var E=[b.paddingTop,b.paddingRight,b.paddingBottom,b.paddingLeft],C=96/(72/w),F=(parseInt(b.lineHeight)-parseInt(b.fontSize))/w/2,L=E.map(function(S){return parseInt(S||"0")/C}),D=(0,c.parseSpacing)(L,0);return F>D.top&&(D.top=F),F>D.bottom&&(D.bottom=F),D}}),323:(function(o,l){Object.defineProperty(l,"__esModule",{value:!0}),l.DocHandler=void 0;var h={},c=(function(){function d(p){this.jsPDFDocument=p,this.userStyles={textColor:p.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:p.internal.getFontSize(),fontStyle:p.internal.getFont().fontStyle,font:p.internal.getFont().fontName,lineWidth:p.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:p.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return d.setDefaults=function(p,f){f===void 0&&(f=null),f?f.__autoTableDocumentDefaults=p:h=p},d.unifyColor=function(p){return Array.isArray(p)?p:typeof p=="number"?[p,p,p]:typeof p=="string"?[p]:null},d.prototype.applyStyles=function(p,f){var g,m,b;f===void 0&&(f=!1),p.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(p.fontStyle);var w=this.jsPDFDocument.internal.getFont(),E=w.fontStyle,C=w.fontName;if(p.font&&(C=p.font),p.fontStyle){E=p.fontStyle;var F=this.getFontList()[C];F&&F.indexOf(E)===-1&&(this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(F[0]),E=F[0])}if(this.jsPDFDocument.setFont(C,E),p.fontSize&&this.jsPDFDocument.setFontSize(p.fontSize),!f){var L=d.unifyColor(p.fillColor);L&&(g=this.jsPDFDocument).setFillColor.apply(g,L),L=d.unifyColor(p.textColor),L&&(m=this.jsPDFDocument).setTextColor.apply(m,L),L=d.unifyColor(p.lineColor),L&&(b=this.jsPDFDocument).setDrawColor.apply(b,L),typeof p.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(p.lineWidth)}},d.prototype.splitTextToSize=function(p,f,g){return this.jsPDFDocument.splitTextToSize(p,f,g)},d.prototype.rect=function(p,f,g,m,b){return this.jsPDFDocument.rect(p,f,g,m,b)},d.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},d.prototype.getTextWidth=function(p){return this.jsPDFDocument.getTextWidth(p)},d.prototype.getDocument=function(){return this.jsPDFDocument},d.prototype.setPage=function(p){this.jsPDFDocument.setPage(p)},d.prototype.addPage=function(){return this.jsPDFDocument.addPage()},d.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},d.prototype.getGlobalOptions=function(){return h||{}},d.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},d.prototype.pageSize=function(){var p=this.jsPDFDocument.internal.pageSize;return p.width==null&&(p={width:p.getWidth(),height:p.getHeight()}),p},d.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},d.prototype.pageNumber=function(){var p=this.jsPDFDocument.internal.getCurrentPageInfo();return p?p.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},d})();l.DocHandler=c}),148:(function(o,l,h){Object.defineProperty(l,"__esModule",{value:!0}),l.parseHtml=void 0;var c=h(259),d=h(913);function p(m,b,w,E,C){var F,L;E===void 0&&(E=!1),C===void 0&&(C=!1);var D;typeof b=="string"?D=w.document.querySelector(b):D=b;var S=Object.keys(m.getFontList()),A=m.scaleFactor(),O=[],U=[],R=[];if(!D)return console.error("Html table could not be found with input: ",b),{head:O,body:U,foot:R};for(var k=0;k<D.rows.length;k++){var M=D.rows[k],V=(L=(F=M?.parentElement)===null||F===void 0?void 0:F.tagName)===null||L===void 0?void 0:L.toLowerCase(),oe=f(S,A,w,M,E,C);oe&&(V==="thead"?O.push(oe):V==="tfoot"?R.push(oe):U.push(oe))}return{head:O,body:U,foot:R}}l.parseHtml=p;function f(m,b,w,E,C,F){for(var L=new d.HtmlRowInput(E),D=0;D<E.cells.length;D++){var S=E.cells[D],A=w.getComputedStyle(S);if(C||A.display!=="none"){var O=void 0;F&&(O=(0,c.parseCss)(m,S,b,A,w)),L.push({rowSpan:S.rowSpan,colSpan:S.colSpan,styles:O,_element:S,content:g(S)})}}var U=w.getComputedStyle(E);if(L.length>0&&(C||U.display!=="none"))return L}function g(m){var b=m.cloneNode(!0);return b.innerHTML=b.innerHTML.replace(/\n/g,"").replace(/ +/g," "),b.innerHTML=b.innerHTML.split(/\<br.*?\>/).map(function(w){return w.trim()}).join(`
`),b.innerText||b.textContent||""}}),587:(function(o,l,h){Object.defineProperty(l,"__esModule",{value:!0}),l.parseInput=void 0;var c=h(148),d=h(360),p=h(200),f=h(323),g=h(291);function m(D,S){var A=new f.DocHandler(D),O=A.getDocumentOptions(),U=A.getGlobalOptions();(0,g.default)(A,U,O,S);var R=(0,d.assign)({},U,O,S),k;typeof window<"u"&&(k=window);var M=b(U,O,S),V=w(U,O,S),oe=E(A,R),K=F(A,R,k);return{id:S.tableId,content:K,hooks:V,styles:M,settings:oe}}l.parseInput=m;function b(D,S,A){for(var O={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},U=function(V){if(V==="columnStyles"){var oe=D[V],K=S[V],Y=A[V];O.columnStyles=(0,d.assign)({},oe,K,Y)}else{var se=[D,S,A],q=se.map(function(fe){return fe[V]||{}});O[V]=(0,d.assign)({},q[0],q[1],q[2])}},R=0,k=Object.keys(O);R<k.length;R++){var M=k[R];U(M)}return O}function w(D,S,A){for(var O=[D,S,A],U={didParseCell:[],willDrawCell:[],didDrawCell:[],didDrawPage:[]},R=0,k=O;R<k.length;R++){var M=k[R];M.didParseCell&&U.didParseCell.push(M.didParseCell),M.willDrawCell&&U.willDrawCell.push(M.willDrawCell),M.didDrawCell&&U.didDrawCell.push(M.didDrawCell),M.didDrawPage&&U.didDrawPage.push(M.didDrawPage)}return U}function E(D,S){var A,O,U,R,k,M,V,oe,K,Y,se,q=(0,p.parseSpacing)(S.margin,40/D.scaleFactor()),fe=(A=C(D,S.startY))!==null&&A!==void 0?A:q.top,ge;S.showFoot===!0?ge="everyPage":S.showFoot===!1?ge="never":ge=(O=S.showFoot)!==null&&O!==void 0?O:"everyPage";var _;S.showHead===!0?_="everyPage":S.showHead===!1?_="never":_=(U=S.showHead)!==null&&U!==void 0?U:"everyPage";var P=(R=S.useCss)!==null&&R!==void 0?R:!1,N=S.theme||(P?"plain":"striped"),I=!!S.horizontalPageBreak,X=(k=S.horizontalPageBreakRepeat)!==null&&k!==void 0?k:null;return{includeHiddenHtml:(M=S.includeHiddenHtml)!==null&&M!==void 0?M:!1,useCss:P,theme:N,startY:fe,margin:q,pageBreak:(V=S.pageBreak)!==null&&V!==void 0?V:"auto",rowPageBreak:(oe=S.rowPageBreak)!==null&&oe!==void 0?oe:"auto",tableWidth:(K=S.tableWidth)!==null&&K!==void 0?K:"auto",showHead:_,showFoot:ge,tableLineWidth:(Y=S.tableLineWidth)!==null&&Y!==void 0?Y:0,tableLineColor:(se=S.tableLineColor)!==null&&se!==void 0?se:200,horizontalPageBreak:I,horizontalPageBreakRepeat:X}}function C(D,S){var A=D.getLastAutoTable(),O=D.scaleFactor(),U=D.pageNumber(),R=!1;if(A&&A.startPageNumber){var k=A.startPageNumber+A.pageNumber-1;R=k===U}return typeof S=="number"?S:(S==null||S===!1)&&R&&A?.finalY!=null?A.finalY+20/O:null}function F(D,S,A){var O=S.head||[],U=S.body||[],R=S.foot||[];if(S.html){var k=S.includeHiddenHtml;if(A){var M=(0,c.parseHtml)(D,S.html,A,k,S.useCss)||{};O=M.head||O,U=M.body||O,R=M.foot||O}else console.error("Cannot parse html in non browser environment")}var V=S.columns||L(O,U,R);return{columns:V,head:O,body:U,foot:R}}function L(D,S,A){var O=D[0]||S[0]||A[0]||[],U=[];return Object.keys(O).filter(function(R){return R!=="_element"}).forEach(function(R){var k=1,M;Array.isArray(O)?M=O[parseInt(R)]:M=O[R],typeof M=="object"&&!Array.isArray(M)&&(k=M?.colSpan||1);for(var V=0;V<k;V++){var oe=void 0;Array.isArray(O)?oe=U.length:oe=R+(V>0?"_".concat(V):"");var K={dataKey:oe};U.push(K)}}),U}}),291:(function(o,l){Object.defineProperty(l,"__esModule",{value:!0});function h(d,p,f,g){for(var m=function(C){C&&typeof C!="object"&&console.error("The options parameter should be of type object, is: "+typeof C),typeof C.extendWidth<"u"&&(C.tableWidth=C.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead.")),typeof C.margins<"u"&&(typeof C.margin>"u"&&(C.margin=C.margins),console.error("Use of deprecated option: margins, use margin instead.")),C.startY&&typeof C.startY!="number"&&(console.error("Invalid value for startY option",C.startY),delete C.startY),!C.didDrawPage&&(C.afterPageContent||C.beforePageContent||C.afterPageAdd)&&(console.error("The afterPageContent, beforePageContent and afterPageAdd hooks are deprecated. Use didDrawPage instead"),C.didDrawPage=function(R){d.applyStyles(d.userStyles),C.beforePageContent&&C.beforePageContent(R),d.applyStyles(d.userStyles),C.afterPageContent&&C.afterPageContent(R),d.applyStyles(d.userStyles),C.afterPageAdd&&R.pageNumber>1&&R.afterPageAdd(R),d.applyStyles(d.userStyles)}),["createdHeaderCell","drawHeaderRow","drawRow","drawHeaderCell"].forEach(function(R){C[R]&&console.error('The "'.concat(R,'" hook has changed in version 3.0, check the changelog for how to migrate.'))}),[["showFoot","showFooter"],["showHead","showHeader"],["didDrawPage","addPageContent"],["didParseCell","createdCell"],["headStyles","headerStyles"]].forEach(function(R){var k=R[0],M=R[1];C[M]&&(console.error("Use of deprecated option ".concat(M,". Use ").concat(k," instead")),C[k]=C[M])}),[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(R){var k=typeof R=="string"?R:R[0],M=typeof R=="string"?R:R[1];typeof C[k]<"u"&&(typeof C.styles[M]>"u"&&(C.styles[M]=C[k]),console.error("Use of deprecated option: "+k+", use the style "+M+" instead."))});for(var F=0,L=["styles","bodyStyles","headStyles","footStyles"];F<L.length;F++){var D=L[F];c(C[D]||{})}for(var S=C.columnStyles||{},A=0,O=Object.keys(S);A<O.length;A++){var U=O[A];c(S[U]||{})}},b=0,w=[p,f,g];b<w.length;b++){var E=w[b];m(E)}}l.default=h;function c(d){d.rowHeight?(console.error("Use of deprecated style rowHeight. It is renamed to minCellHeight."),d.minCellHeight||(d.minCellHeight=d.rowHeight)):d.columnWidth&&(console.error("Use of deprecated style columnWidth. It is renamed to cellWidth."),d.cellWidth||(d.cellWidth=d.columnWidth))}}),287:(function(o,l,h){Object.defineProperty(l,"__esModule",{value:!0}),l.Column=l.Cell=l.Row=l.Table=void 0;var c=h(913),d=h(662),p=h(200),f=(function(){function w(E,C){this.pageNumber=1,this.pageCount=1,this.id=E.id,this.settings=E.settings,this.styles=E.styles,this.hooks=E.hooks,this.columns=C.columns,this.head=C.head,this.body=C.body,this.foot=C.foot}return w.prototype.getHeadHeight=function(E){return this.head.reduce(function(C,F){return C+F.getMaxCellHeight(E)},0)},w.prototype.getFootHeight=function(E){return this.foot.reduce(function(C,F){return C+F.getMaxCellHeight(E)},0)},w.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},w.prototype.callCellHooks=function(E,C,F,L,D,S){for(var A=0,O=C;A<O.length;A++){var U=O[A],R=new d.CellHookData(E,this,F,L,D,S),k=U(R)===!1;if(F.text=Array.isArray(F.text)?F.text:[F.text],k)return!1}return!0},w.prototype.callEndPageHooks=function(E,C){E.applyStyles(E.userStyles);for(var F=0,L=this.hooks.didDrawPage;F<L.length;F++){var D=L[F];D(new d.HookData(E,this,C))}},w.prototype.getWidth=function(E){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var C=this.columns.reduce(function(L,D){return L+D.wrappedWidth},0);return C}else{var F=this.settings.margin;return E-F.left-F.right}},w})();l.Table=f;var g=(function(){function w(E,C,F,L,D){D===void 0&&(D=!1),this.height=0,this.raw=E,E instanceof c.HtmlRowInput&&(this.raw=E._element,this.element=E._element),this.index=C,this.section=F,this.cells=L,this.spansMultiplePages=D}return w.prototype.getMaxCellHeight=function(E){var C=this;return E.reduce(function(F,L){var D;return Math.max(F,((D=C.cells[L.index])===null||D===void 0?void 0:D.height)||0)},0)},w.prototype.hasRowSpan=function(E){var C=this;return E.filter(function(F){var L=C.cells[F.index];return L?L.rowSpan>1:!1}).length>0},w.prototype.canEntireRowFit=function(E,C){return this.getMaxCellHeight(C)<=E},w.prototype.getMinimumRowHeight=function(E,C){var F=this;return E.reduce(function(L,D){var S=F.cells[D.index];if(!S)return 0;var A=S.styles.fontSize/C.scaleFactor()*c.FONT_ROW_RATIO,O=S.padding("vertical"),U=O+A;return U>L?U:L},0)},w})();l.Row=g;var m=(function(){function w(E,C,F){var L,D;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=C,this.section=F,this.raw=E;var S=E;E!=null&&typeof E=="object"&&!Array.isArray(E)?(this.rowSpan=E.rowSpan||1,this.colSpan=E.colSpan||1,S=(D=(L=E.content)!==null&&L!==void 0?L:E.title)!==null&&D!==void 0?D:E,E._element&&(this.raw=E._element)):(this.rowSpan=1,this.colSpan=1);var A=S!=null?""+S:"",O=/\r\n|\r|\n/g;this.text=A.split(O)}return w.prototype.getTextPos=function(){var E;if(this.styles.valign==="top")E=this.y+this.padding("top");else if(this.styles.valign==="bottom")E=this.y+this.height-this.padding("bottom");else{var C=this.height-this.padding("vertical");E=this.y+C/2+this.padding("top")}var F;if(this.styles.halign==="right")F=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var L=this.width-this.padding("horizontal");F=this.x+L/2+this.padding("left")}else F=this.x+this.padding("left");return{x:F,y:E}},w.prototype.getContentHeight=function(E){var C=Array.isArray(this.text)?this.text.length:1,F=this.styles.fontSize/E*c.FONT_ROW_RATIO,L=C*F+this.padding("vertical");return Math.max(L,this.styles.minCellHeight)},w.prototype.padding=function(E){var C=(0,p.parseSpacing)(this.styles.cellPadding,0);return E==="vertical"?C.top+C.bottom:E==="horizontal"?C.left+C.right:C[E]},w})();l.Cell=m;var b=(function(){function w(E,C,F){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=E,this.raw=C,this.index=F}return w.prototype.getMaxCustomCellWidth=function(E){for(var C=0,F=0,L=E.allRows();F<L.length;F++){var D=L[F],S=D.cells[this.index];S&&typeof S.styles.cellWidth=="number"&&(C=Math.max(C,S.styles.cellWidth))}return C},w})();l.Column=b}),360:(function(o,l){Object.defineProperty(l,"__esModule",{value:!0}),l.assign=void 0;function h(c,d,p,f,g){if(c==null)throw new TypeError("Cannot convert undefined or null to object");for(var m=Object(c),b=1;b<arguments.length;b++){var w=arguments[b];if(w!=null)for(var E in w)Object.prototype.hasOwnProperty.call(w,E)&&(m[E]=w[E])}return m}l.assign=h}),858:(function(o,l,h){Object.defineProperty(l,"__esModule",{value:!0}),l.createTable=void 0;var c=h(323),d=h(287),p=h(189),f=h(913),g=h(360);function m(D,S){var A=new c.DocHandler(D),O=b(S,A.scaleFactor()),U=new d.Table(S,O);return(0,p.calculateWidths)(A,U),A.applyStyles(A.userStyles),U}l.createTable=m;function b(D,S){var A=D.content,O=F(A.columns);if(A.head.length===0){var U=E(O,"head");U&&A.head.push(U)}if(A.foot.length===0){var U=E(O,"foot");U&&A.foot.push(U)}var R=D.settings.theme,k=D.styles;return{columns:O,head:w("head",A.head,O,k,R,S),body:w("body",A.body,O,k,R,S),foot:w("foot",A.foot,O,k,R,S)}}function w(D,S,A,O,U,R){var k={},M=S.map(function(V,oe){for(var K=0,Y={},se=0,q=0,fe=0,ge=A;fe<ge.length;fe++){var _=ge[fe];if(k[_.index]==null||k[_.index].left===0)if(q===0){var P=void 0;Array.isArray(V)?P=V[_.index-se-K]:P=V[_.dataKey];var N={};typeof P=="object"&&!Array.isArray(P)&&(N=P?.styles||{});var I=L(D,_,oe,U,O,R,N),X=new d.Cell(P,I,D);Y[_.dataKey]=X,Y[_.index]=X,q=X.colSpan-1,k[_.index]={left:X.rowSpan-1,times:q}}else q--,se++;else k[_.index].left--,q=k[_.index].times,K++}return new d.Row(V,oe,D,Y)});return M}function E(D,S){var A={};return D.forEach(function(O){if(O.raw!=null){var U=C(S,O.raw);U!=null&&(A[O.dataKey]=U)}}),Object.keys(A).length>0?A:null}function C(D,S){if(D==="head"){if(typeof S=="object")return S.header||S.title||null;if(typeof S=="string"||typeof S=="number")return S}else if(D==="foot"&&typeof S=="object")return S.footer;return null}function F(D){return D.map(function(S,A){var O,U,R;return typeof S=="object"?R=(U=(O=S.dataKey)!==null&&O!==void 0?O:S.key)!==null&&U!==void 0?U:A:R=A,new d.Column(R,S,A)})}function L(D,S,A,O,U,R,k){var M=(0,f.getTheme)(O),V;D==="head"?V=U.headStyles:D==="body"?V=U.bodyStyles:D==="foot"&&(V=U.footStyles);var oe=(0,g.assign)({},M.table,M[D],U.styles,V),K=U.columnStyles[S.dataKey]||U.columnStyles[S.index]||{},Y=D==="body"?K:{},se=D==="body"&&A%2===0?(0,g.assign)({},M.alternateRow,U.alternateRowStyles):{},q=(0,f.defaultStyles)(R),fe=(0,g.assign)({},q,oe,se,Y);return(0,g.assign)(fe,k)}}),49:(function(o,l,h){Object.defineProperty(l,"__esModule",{value:!0}),l.addPage=l.drawTable=void 0;var c=h(913),d=h(200),p=h(287),f=h(323),g=h(360),m=h(938),b=h(435);function w(K,Y){var se=Y.settings,q=se.startY,fe=se.margin,ge={x:fe.left,y:q},_=Y.getHeadHeight(Y.columns)+Y.getFootHeight(Y.columns),P=q+fe.bottom+_;if(se.pageBreak==="avoid"){var N=Y.allRows(),I=N.reduce(function(ce,ue){return ce+ue.height},0);P+=I}var X=new f.DocHandler(K);(se.pageBreak==="always"||se.startY!=null&&P>X.pageSize().height)&&(oe(X),ge.y=fe.top);var he=(0,g.assign)({},ge);Y.startPageNumber=X.pageNumber(),se.horizontalPageBreak===!0?E(X,Y,he,ge):(X.applyStyles(X.userStyles),(se.showHead==="firstPage"||se.showHead==="everyPage")&&Y.head.forEach(function(ce){return U(X,Y,ce,ge,Y.columns)}),X.applyStyles(X.userStyles),Y.body.forEach(function(ce,ue){var be=ue===Y.body.length-1;O(X,Y,ce,be,he,ge,Y.columns)}),X.applyStyles(X.userStyles),(se.showFoot==="lastPage"||se.showFoot==="everyPage")&&Y.foot.forEach(function(ce){return U(X,Y,ce,ge,Y.columns)})),(0,d.addTableBorder)(X,Y,he,ge),Y.callEndPageHooks(X,ge),Y.finalY=ge.y,K.lastAutoTable=Y,K.previousAutoTable=Y,K.autoTable&&(K.autoTable.previous=Y),X.applyStyles(X.userStyles)}l.drawTable=w;function E(K,Y,se,q){var fe=b.default.calculateAllColumnsCanFitInPage(K,Y);fe.map(function(ge,_){K.applyStyles(K.userStyles),_>0?V(K,Y,se,q,ge.columns):C(K,Y,q,ge.columns),F(K,Y,se,q,ge.columns),L(K,Y,q,ge.columns)})}function C(K,Y,se,q){var fe=Y.settings;K.applyStyles(K.userStyles),(fe.showHead==="firstPage"||fe.showHead==="everyPage")&&Y.head.forEach(function(ge){return U(K,Y,ge,se,q)})}function F(K,Y,se,q,fe){K.applyStyles(K.userStyles),Y.body.forEach(function(ge,_){var P=_===Y.body.length-1;O(K,Y,ge,P,se,q,fe)})}function L(K,Y,se,q){var fe=Y.settings;K.applyStyles(K.userStyles),(fe.showFoot==="lastPage"||fe.showFoot==="everyPage")&&Y.foot.forEach(function(ge){return U(K,Y,ge,se,q)})}function D(K,Y,se){var q=K.styles.fontSize/se.scaleFactor()*c.FONT_ROW_RATIO,fe=K.padding("vertical"),ge=Math.floor((Y-fe)/q);return Math.max(0,ge)}function S(K,Y,se,q){var fe={};K.spansMultiplePages=!0,K.height=0;for(var ge=0,_=0,P=se.columns;_<P.length;_++){var N=P[_],I=K.cells[N.index];if(I){Array.isArray(I.text)||(I.text=[I.text]);var X=new p.Cell(I.raw,I.styles,I.section);X=(0,g.assign)(X,I),X.text=[];var he=D(I,Y,q);I.text.length>he&&(X.text=I.text.splice(he,I.text.length));var ce=q.scaleFactor();I.contentHeight=I.getContentHeight(ce),I.contentHeight>=Y&&(I.contentHeight=Y,X.styles.minCellHeight-=Y),I.contentHeight>K.height&&(K.height=I.contentHeight),X.contentHeight=X.getContentHeight(ce),X.contentHeight>ge&&(ge=X.contentHeight),fe[N.index]=X}}var ue=new p.Row(K.raw,-1,K.section,fe,!0);ue.height=ge;for(var be=0,Le=se.columns;be<Le.length;be++){var N=Le[be],X=ue.cells[N.index];X&&(X.height=ue.height);var I=K.cells[N.index];I&&(I.height=K.height)}return ue}function A(K,Y,se,q){var fe=K.pageSize().height,ge=q.settings.margin,_=ge.top+ge.bottom,P=fe-_;Y.section==="body"&&(P-=q.getHeadHeight(q.columns)+q.getFootHeight(q.columns));var N=Y.getMinimumRowHeight(q.columns,K),I=N<se;if(N>P)return console.error("Will not be able to print row ".concat(Y.index," correctly since it's minimum height is larger than page height")),!0;if(!I)return!1;var X=Y.hasRowSpan(q.columns),he=Y.getMaxCellHeight(q.columns)>P;return he?(X&&console.error("The content of row ".concat(Y.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(X||q.settings.rowPageBreak==="avoid")}function O(K,Y,se,q,fe,ge,_){var P=M(K,Y,q,ge);if(se.canEntireRowFit(P,_))U(K,Y,se,ge,_);else if(A(K,se,P,Y)){var N=S(se,P,Y,K);U(K,Y,se,ge,_),V(K,Y,fe,ge,_),O(K,Y,N,q,fe,ge,_)}else V(K,Y,fe,ge,_),O(K,Y,se,q,fe,ge,_)}function U(K,Y,se,q,fe){q.x=Y.settings.margin.left;for(var ge=0,_=fe;ge<_.length;ge++){var P=_[ge],N=se.cells[P.index];if(!N){q.x+=P.width;continue}K.applyStyles(N.styles),N.x=q.x,N.y=q.y;var I=Y.callCellHooks(K,Y.hooks.willDrawCell,N,se,P,q);if(I===!1){q.x+=P.width;continue}R(K,N,q);var X=N.getTextPos();(0,m.default)(N.text,X.x,X.y,{halign:N.styles.halign,valign:N.styles.valign,maxWidth:Math.ceil(N.width-N.padding("left")-N.padding("right"))},K.getDocument()),Y.callCellHooks(K,Y.hooks.didDrawCell,N,se,P,q),q.x+=P.width}q.y+=se.height}function R(K,Y,se){var q=Y.styles;if(K.getDocument().setFillColor(K.getDocument().getFillColor()),typeof q.lineWidth=="number"){var fe=(0,d.getFillStyle)(q.lineWidth,q.fillColor);fe&&K.rect(Y.x,se.y,Y.width,Y.height,fe)}else if(typeof q.lineWidth=="object"){K.rect(Y.x,se.y,Y.width,Y.height,"F");var ge=Object.keys(q.lineWidth),_=q.lineWidth;ge.map(function(P){var N=(0,d.getFillStyle)(_[P],q.fillColor);k(K,Y,se,P,N||"S",_[P])})}}function k(K,Y,se,q,fe,ge){var _,P,N,I;switch(q){case"top":_=se.x,P=se.y,N=se.x+Y.width,I=se.y;break;case"left":_=se.x,P=se.y,N=se.x,I=se.y+Y.height;break;case"right":_=se.x+Y.width,P=se.y,N=se.x+Y.width,I=se.y+Y.height;break;default:_=se.x,P=se.y+Y.height-ge,N=se.x+Y.width,I=se.y+Y.height-ge;break}K.getDocument().setLineWidth(ge),K.getDocument().line(_,P,N,I,fe)}function M(K,Y,se,q){var fe=Y.settings.margin.bottom,ge=Y.settings.showFoot;return(ge==="everyPage"||ge==="lastPage"&&se)&&(fe+=Y.getFootHeight(Y.columns)),K.pageSize().height-q.y-fe}function V(K,Y,se,q,fe){fe===void 0&&(fe=[]),K.applyStyles(K.userStyles),Y.settings.showFoot==="everyPage"&&Y.foot.forEach(function(_){return U(K,Y,_,q,fe)}),Y.callEndPageHooks(K,q);var ge=Y.settings.margin;(0,d.addTableBorder)(K,Y,se,q),oe(K),Y.pageNumber++,Y.pageCount++,q.x=ge.left,q.y=ge.top,se.y=ge.top,Y.settings.showHead==="everyPage"&&Y.head.forEach(function(_){return U(K,Y,_,q,fe)})}l.addPage=V;function oe(K){var Y=K.pageNumber();K.setPage(Y+1);var se=K.pageNumber();se===Y&&K.addPage()}}),435:(function(o,l,h){Object.defineProperty(l,"__esModule",{value:!0});var c=h(200),d=function(g,m){var b=(0,c.parseSpacing)(m.settings.margin,0),w=g.pageSize().width-(b.left+b.right);return w},p=function(g,m,b){b===void 0&&(b={});var w=d(g,m),E=w,C=m.settings.horizontalPageBreakRepeat,F=null,L=[],D=[],S=m.columns.length,A=b&&b.start?b.start:0;for(C!=null&&(F=m.columns.find(function(U){return U.dataKey===C||U.index===C}),F&&(L.push(F.index),D.push(m.columns[F.index]),E=E-F.wrappedWidth));A<S;){if(F?.index===A){A++;continue}var O=m.columns[A].wrappedWidth;if(E<O){(A===0||A===b.start)&&(L.push(A),D.push(m.columns[A]));break}L.push(A),D.push(m.columns[A]),E=E-O,A++}return{colIndexes:L,columns:D,lastIndex:A}},f=function(g,m){for(var b=[],w=0,E=m.columns.length;w<E;){var C=p(g,m,{start:w===0?0:w});C&&C.columns&&C.columns.length?(w=C.lastIndex,b.push(C)):w++}return b};l.default={getColumnsCanFitInPage:p,calculateAllColumnsCanFitInPage:f,getPageAvailableWidth:d}}),189:(function(o,l,h){Object.defineProperty(l,"__esModule",{value:!0}),l.ellipsize=l.resizeColumns=l.calculateWidths=void 0;var c=h(200),d=h(435);function p(F,L){f(F,L);var D=[],S=0;L.columns.forEach(function(O){var U=O.getMaxCustomCellWidth(L);U?O.width=U:(O.width=O.wrappedWidth,D.push(O)),S+=O.width});var A=L.getWidth(F.pageSize().width)-S;A&&(A=g(D,A,function(O){return Math.max(O.minReadableWidth,O.minWidth)})),A&&(A=g(D,A,function(O){return O.minWidth})),A=Math.abs(A),!L.settings.horizontalPageBreak&&A>.1/F.scaleFactor()&&(A=A<1?A:Math.round(A),console.error("Of the table content, ".concat(A," units width could not fit page"))),b(L),w(L,F),m(L)}l.calculateWidths=p;function f(F,L){var D=F.scaleFactor(),S=L.settings.horizontalPageBreak,A=d.default.getPageAvailableWidth(F,L);L.allRows().forEach(function(O){for(var U=0,R=L.columns;U<R.length;U++){var k=R[U],M=O.cells[k.index];if(M){var V=L.hooks.didParseCell;L.callCellHooks(F,V,M,O,k,null);var oe=M.padding("horizontal");M.contentWidth=(0,c.getStringWidth)(M.text,M.styles,F)+oe;var K=(0,c.getStringWidth)(M.text.join(" ").split(/\s+/),M.styles,F);if(M.minReadableWidth=K+M.padding("horizontal"),typeof M.styles.cellWidth=="number")M.minWidth=M.styles.cellWidth,M.wrappedWidth=M.styles.cellWidth;else if(M.styles.cellWidth==="wrap"||S===!0)M.contentWidth>A?(M.minWidth=A,M.wrappedWidth=A):(M.minWidth=M.contentWidth,M.wrappedWidth=M.contentWidth);else{var Y=10/D;M.minWidth=M.styles.minCellWidth||Y,M.wrappedWidth=M.contentWidth,M.minWidth>M.wrappedWidth&&(M.wrappedWidth=M.minWidth)}}}}),L.allRows().forEach(function(O){for(var U=0,R=L.columns;U<R.length;U++){var k=R[U],M=O.cells[k.index];if(M&&M.colSpan===1)k.wrappedWidth=Math.max(k.wrappedWidth,M.wrappedWidth),k.minWidth=Math.max(k.minWidth,M.minWidth),k.minReadableWidth=Math.max(k.minReadableWidth,M.minReadableWidth);else{var V=L.styles.columnStyles[k.dataKey]||L.styles.columnStyles[k.index]||{},oe=V.cellWidth||V.minCellWidth;oe&&typeof oe=="number"&&(k.minWidth=oe,k.wrappedWidth=oe)}M&&(M.colSpan>1&&!k.minWidth&&(k.minWidth=M.minWidth),M.colSpan>1&&!k.wrappedWidth&&(k.wrappedWidth=M.minWidth))}})}function g(F,L,D){for(var S=L,A=F.reduce(function(Y,se){return Y+se.wrappedWidth},0),O=0;O<F.length;O++){var U=F[O],R=U.wrappedWidth/A,k=S*R,M=U.width+k,V=D(U),oe=M<V?V:M;L-=oe-U.width,U.width=oe}if(L=Math.round(L*1e10)/1e10,L){var K=F.filter(function(Y){return L<0?Y.width>D(Y):!0});K.length&&(L=g(K,L,D))}return L}l.resizeColumns=g;function m(F){for(var L={},D=1,S=F.allRows(),A=0;A<S.length;A++)for(var O=S[A],U=0,R=F.columns;U<R.length;U++){var k=R[U],M=L[k.index];if(D>1)D--,delete O.cells[k.index];else if(M)M.cell.height+=O.height,D=M.cell.colSpan,delete O.cells[k.index],M.left--,M.left<=1&&delete L[k.index];else{var V=O.cells[k.index];if(!V)continue;if(V.height=O.height,V.rowSpan>1){var oe=S.length-A,K=V.rowSpan>oe?oe:V.rowSpan;L[k.index]={cell:V,left:K,row:O}}}}}function b(F){for(var L=F.allRows(),D=0;D<L.length;D++)for(var S=L[D],A=null,O=0,U=0,R=0;R<F.columns.length;R++){var k=F.columns[R];if(U-=1,U>1&&F.columns[R+1])O+=k.width,delete S.cells[k.index];else if(A){var M=A;delete S.cells[k.index],A=null,M.width=k.width+O}else{var M=S.cells[k.index];if(!M)continue;if(U=M.colSpan,O=0,M.colSpan>1){A=M,O+=k.width;continue}M.width=k.width+O}}}function w(F,L){for(var D={count:0,height:0},S=0,A=F.allRows();S<A.length;S++){for(var O=A[S],U=0,R=F.columns;U<R.length;U++){var k=R[U],M=O.cells[k.index];if(M){L.applyStyles(M.styles,!0);var V=M.width-M.padding("horizontal");if(M.styles.overflow==="linebreak")M.text=L.splitTextToSize(M.text,V+1/L.scaleFactor(),{fontSize:M.styles.fontSize});else if(M.styles.overflow==="ellipsize")M.text=E(M.text,V,M.styles,L,"...");else if(M.styles.overflow==="hidden")M.text=E(M.text,V,M.styles,L,"");else if(typeof M.styles.overflow=="function"){var oe=M.styles.overflow(M.text,V);typeof oe=="string"?M.text=[oe]:M.text=oe}M.contentHeight=M.getContentHeight(L.scaleFactor());var K=M.contentHeight/M.rowSpan;M.rowSpan>1&&D.count*D.height<K*M.rowSpan?D={height:K,count:M.rowSpan}:D&&D.count>0&&D.height>K&&(K=D.height),K>O.height&&(O.height=K)}}D.count--}}function E(F,L,D,S,A){return F.map(function(O){return C(O,L,D,S,A)})}l.ellipsize=E;function C(F,L,D,S,A){var O=1e4*S.scaleFactor();if(L=Math.ceil(L*O)/O,L>=(0,c.getStringWidth)(F,D,S))return F;for(;L<(0,c.getStringWidth)(F+A,D,S)&&!(F.length<=1);)F=F.substring(0,F.length-1);return F.trim()+A}}),84:(function(o){if(typeof t>"u"){var l=new Error("Cannot find module 'undefined'");throw l.code="MODULE_NOT_FOUND",l}o.exports=t})},n={};function s(o){var l=n[o];if(l!==void 0)return l.exports;var h=n[o]={exports:{}};return i[o].call(h.exports,h,h.exports,s),h.exports}var a={};return(function(){var o=a;Object.defineProperty(o,"__esModule",{value:!0}),o.Cell=o.Column=o.Row=o.Table=o.CellHookData=o.__drawTable=o.__createTable=o.applyPlugin=void 0;var l=s(790),h=s(587),c=s(49),d=s(858),p=s(287);Object.defineProperty(o,"Table",{enumerable:!0,get:function(){return p.Table}});var f=s(662);Object.defineProperty(o,"CellHookData",{enumerable:!0,get:function(){return f.CellHookData}});var g=s(287);Object.defineProperty(o,"Cell",{enumerable:!0,get:function(){return g.Cell}}),Object.defineProperty(o,"Column",{enumerable:!0,get:function(){return g.Column}}),Object.defineProperty(o,"Row",{enumerable:!0,get:function(){return g.Row}});function m(F){(0,l.default)(F)}o.applyPlugin=m;function b(F,L){var D=(0,h.parseInput)(F,L),S=(0,d.createTable)(F,D);(0,c.drawTable)(F,S)}function w(F,L){var D=(0,h.parseInput)(F,L);return(0,d.createTable)(F,D)}o.__createTable=w;function E(F,L){(0,c.drawTable)(F,L)}o.__drawTable=E;try{var C=s(84);C.jsPDF&&(C=C.jsPDF),m(C)}catch{}o.default=b})(),a})()})})(Ec)),Ec.exports}Xy();/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var ql={};ql.version="0.18.5";var tn=1200,Da=1252,Ky=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],vd={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},iu=function(r){Ky.indexOf(r)!=-1&&(Da=vd[0]=r)};function Yy(){iu(1252)}var xn=function(r){tn=r,iu(r)};function nu(){xn(1200),Yy()}function Nc(r){for(var e=[],t=0,i=r.length;t<i;++t)e[t]=r.charCodeAt(t);return e}function $y(r){for(var e=[],t=0;t<r.length>>1;++t)e[t]=String.fromCharCode(r.charCodeAt(2*t)+(r.charCodeAt(2*t+1)<<8));return e.join("")}function Pg(r){for(var e=[],t=0;t<r.length>>1;++t)e[t]=String.fromCharCode(r.charCodeAt(2*t+1)+(r.charCodeAt(2*t)<<8));return e.join("")}var Fo=function(r){var e=r.charCodeAt(0),t=r.charCodeAt(1);return e==255&&t==254?$y(r.slice(2)):e==254&&t==255?Pg(r.slice(2)):e==65279?r.slice(1):r},_l=function(e){return String.fromCharCode(e)},Kf=function(e){return String.fromCharCode(e)},jt;function Jy(r){jt=r,xn=function(e){tn=e,iu(e)},Fo=function(e){return e.charCodeAt(0)===255&&e.charCodeAt(1)===254?jt.utils.decode(1200,Nc(e.slice(2))):e},_l=function(t){return tn===1200?String.fromCharCode(t):jt.utils.decode(tn,[t&255,t>>8])[0]},Kf=function(t){return jt.utils.decode(Da,[t])[0]},l1()}var Zs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Xl(r){for(var e="",t=0,i=0,n=0,s=0,a=0,o=0,l=0,h=0;h<r.length;)t=r.charCodeAt(h++),s=t>>2,i=r.charCodeAt(h++),a=(t&3)<<4|i>>4,n=r.charCodeAt(h++),o=(i&15)<<2|n>>6,l=n&63,isNaN(i)?o=l=64:isNaN(n)&&(l=64),e+=Zs.charAt(s)+Zs.charAt(a)+Zs.charAt(o)+Zs.charAt(l);return e}function rn(r){var e="",t=0,i=0,n=0,s=0,a=0,o=0,l=0;r=r.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<r.length;)s=Zs.indexOf(r.charAt(h++)),a=Zs.indexOf(r.charAt(h++)),t=s<<2|a>>4,e+=String.fromCharCode(t),o=Zs.indexOf(r.charAt(h++)),i=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(i)),l=Zs.indexOf(r.charAt(h++)),n=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(n));return e}var Ot=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Ts=(function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function sa(r){return Ot?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function Rp(r){return Ot?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var Qi=function(e){return Ot?Ts(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function uh(r){if(typeof ArrayBuffer>"u")return Qi(r);for(var e=new ArrayBuffer(r.length),t=new Uint8Array(e),i=0;i!=r.length;++i)t[i]=r.charCodeAt(i)&255;return e}function ha(r){if(Array.isArray(r))return r.map(function(i){return String.fromCharCode(i)}).join("");for(var e=[],t=0;t<r.length;++t)e[t]=String.fromCharCode(r[t]);return e.join("")}function Zy(r){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(r)}function bd(r){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(r instanceof ArrayBuffer)return bd(new Uint8Array(r));for(var e=new Array(r.length),t=0;t<r.length;++t)e[t]=r[t];return e}var ii=Ot?function(r){return Buffer.concat(r.map(function(e){return Buffer.isBuffer(e)?e:Ts(e)}))}:function(r){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<r.length;++e)t+=r[e].length;var i=new Uint8Array(t),n=0;for(e=0,t=0;e<r.length;t+=n,++e)if(n=r[e].length,r[e]instanceof Uint8Array)i.set(r[e],t);else{if(typeof r[e]=="string")throw"wtf";i.set(new Uint8Array(r[e]),t)}return i}return[].concat.apply([],r.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Qy(r){for(var e=[],t=0,i=r.length+250,n=sa(r.length+255),s=0;s<r.length;++s){var a=r.charCodeAt(s);if(a<128)n[t++]=a;else if(a<2048)n[t++]=192|a>>6&31,n[t++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=r.charCodeAt(++s)&1023;n[t++]=240|a>>8&7,n[t++]=128|a>>2&63,n[t++]=128|o>>6&15|(a&3)<<4,n[t++]=128|o&63}else n[t++]=224|a>>12&15,n[t++]=128|a>>6&63,n[t++]=128|a&63;t>i&&(e.push(n.slice(0,t)),t=0,n=sa(65535),i=65530)}return e.push(n.slice(0,t)),ii(e)}var _i=/\u0000/g,kl=/[\u0001-\u0006]/g;function Lo(r){for(var e="",t=r.length-1;t>=0;)e+=r.charAt(t--);return e}function Bn(r,e){var t=""+r;return t.length>=e?t:Sr("0",e-t.length)+t}function wd(r,e){var t=""+r;return t.length>=e?t:Sr(" ",e-t.length)+t}function Pc(r,e){var t=""+r;return t.length>=e?t:t+Sr(" ",e-t.length)}function eE(r,e){var t=""+Math.round(r);return t.length>=e?t:Sr("0",e-t.length)+t}function tE(r,e){var t=""+r;return t.length>=e?t:Sr("0",e-t.length)+t}var Lp=Math.pow(2,32);function wo(r,e){if(r>Lp||r<-Lp)return eE(r,e);var t=Math.round(r);return tE(t,e)}function Dc(r,e){return e=e||0,r.length>=7+e&&(r.charCodeAt(e)|32)===103&&(r.charCodeAt(e+1)|32)===101&&(r.charCodeAt(e+2)|32)===110&&(r.charCodeAt(e+3)|32)===101&&(r.charCodeAt(e+4)|32)===114&&(r.charCodeAt(e+5)|32)===97&&(r.charCodeAt(e+6)|32)===108}var Np=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],pf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function rE(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"/ "hh""mm""ss" "',r}var vt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Pp={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},iE={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Mc(r,e,t){for(var i=r<0?-1:1,n=r*i,s=0,a=1,o=0,l=1,h=0,c=0,d=Math.floor(n);h<e&&(d=Math.floor(n),o=d*a+s,c=d*h+l,!(n-d<5e-8));)n=1/(n-d),s=a,a=o,l=h,h=c;if(c>e&&(h>e?(c=l,o=s):(c=h,o=a)),!t)return[0,i*o,c];var p=Math.floor(i*o/c);return[p,i*o-p*c,c]}function Qs(r,e,t){if(r>2958465||r<0)return null;var i=r|0,n=Math.floor(86400*(r-i)),s=0,a=[],o={D:i,T:n,u:86400*(r-i)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(i+=1462),o.u>.9999&&(o.u=0,++n==86400&&(o.T=n=0,++i,++o.D)),i===60)a=t?[1317,10,29]:[1900,2,29],s=3;else if(i===0)a=t?[1317,8,29]:[1900,1,0],s=6;else{i>60&&--i;var l=new Date(1900,0,1);l.setDate(l.getDate()+i-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),i<60&&(s=(s+6)%7),t&&(s=hE(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=n%60,n=Math.floor(n/60),o.M=n%60,n=Math.floor(n/60),o.H=n,o.q=s,o}var Dg=new Date(1899,11,31,0,0,0),nE=Dg.getTime(),sE=new Date(1900,2,1,0,0,0);function Mg(r,e){var t=r.getTime();return e?t-=1461*24*60*60*1e3:r>=sE&&(t+=1440*60*1e3),(t-(nE+(r.getTimezoneOffset()-Dg.getTimezoneOffset())*6e4))/(1440*60*1e3)}function xd(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function aE(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function oE(r){var e=r<0?12:11,t=xd(r.toFixed(12));return t.length<=e||(t=r.toPrecision(10),t.length<=e)?t:r.toExponential(5)}function lE(r){var e=xd(r.toFixed(11));return e.length>(r<0?12:11)||e==="0"||e==="-0"?r.toPrecision(6):e}function Kl(r){var e=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),t;return e>=-4&&e<=-1?t=r.toPrecision(10+e):Math.abs(e)<=9?t=oE(r):e===10?t=r.toFixed(10).substr(0,12):t=lE(r),xd(aE(t.toUpperCase()))}function Ma(r,e){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):Kl(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return nn(14,Mg(r,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+r)}function hE(r,e){e[0]-=581;var t=r.getDay();return r<60&&(t=(t+6)%7),t}function cE(r,e,t,i){var n="",s=0,a=0,o=t.y,l,h=0;switch(r){case 98:o=t.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,h=2;break;default:l=o%1e4,h=4;break}break;case 109:switch(e.length){case 1:case 2:l=t.m,h=e.length;break;case 3:return pf[t.m-1][1];case 5:return pf[t.m-1][0];default:return pf[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=t.d,h=e.length;break;case 3:return Np[t.q][0];default:return Np[t.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(t.H+11)%12,h=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=t.H,h=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=t.M,h=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?Bn(t.S,e.length):(i>=2?a=i===3?1e3:100:a=i===1?10:1,s=Math.round(a*(t.S+t.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(n=Bn(s,2+i),e==="ss"?n.substr(0,2):"."+n.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=t.D*24+t.H;break;case"[m]":case"[mm]":l=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":l=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}h=e.length===3?1:2;break;case 101:l=o,h=1;break}var c=h>0?Bn(l,h):"";return c}function ea(r){var e=3;if(r.length<=e)return r;for(var t=r.length%e,i=r.substr(0,t);t!=r.length;t+=e)i+=(i.length>0?",":"")+r.substr(t,e);return i}var Og=/%/g;function uE(r,e,t){var i=e.replace(Og,""),n=e.length-i.length;return ks(r,i,t*Math.pow(10,2*n))+Sr("%",n)}function fE(r,e,t){for(var i=e.length-1;e.charCodeAt(i-1)===44;)--i;return ks(r,e.substr(0,i),t/Math.pow(10,3*(e.length-i)))}function Ig(r,e){var t,i=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Ig(r,-e);var n=r.indexOf(".");n===-1&&(n=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%n;if(s<0&&(s+=n),t=(e/Math.pow(10,s)).toPrecision(i+1+(n+s)%n),t.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,n)+"."+t.substr(2+n),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,h,c){return l+h+c.substr(0,(n+s)%n)+"."+c.substr(s)+"E"})}else t=e.toExponential(i);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Bg=/# (\?+)( ?)\/( ?)(\d+)/;function dE(r,e,t){var i=parseInt(r[4],10),n=Math.round(e*i),s=Math.floor(n/i),a=n-s*i,o=i;return t+(s===0?"":""+s)+" "+(a===0?Sr(" ",r[1].length+1+r[4].length):wd(a,r[1].length)+r[2]+"/"+r[3]+Bn(o,r[4].length))}function pE(r,e,t){return t+(e===0?"":""+e)+Sr(" ",r[1].length+2+r[4].length)}var Hg=/^#*0*\.([0#]+)/,zg=/\).*[0#]/,jg=/\(###\) ###\\?-####/;function Fi(r){for(var e="",t,i=0;i!=r.length;++i)switch(t=r.charCodeAt(i)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function Dp(r,e){var t=Math.pow(10,e);return""+Math.round(r*t)/t}function Mp(r,e){var t=r-Math.floor(r),i=Math.pow(10,e);return e<(""+Math.round(t*i)).length?0:Math.round(t*i)}function mE(r,e){return e<(""+Math.round((r-Math.floor(r))*Math.pow(10,e))).length?1:0}function gE(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function pn(r,e,t){if(r.charCodeAt(0)===40&&!e.match(zg)){var i=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?pn("n",i,t):"("+pn("n",i,-t)+")"}if(e.charCodeAt(e.length-1)===44)return fE(r,e,t);if(e.indexOf("%")!==-1)return uE(r,e,t);if(e.indexOf("E")!==-1)return Ig(e,t);if(e.charCodeAt(0)===36)return"$"+pn(r,e.substr(e.charAt(1)==" "?2:1),t);var n,s,a,o,l=Math.abs(t),h=t<0?"-":"";if(e.match(/^00+$/))return h+wo(l,e.length);if(e.match(/^[#?]+$/))return n=wo(t,0),n==="0"&&(n=""),n.length>e.length?n:Fi(e.substr(0,e.length-n.length))+n;if(s=e.match(Bg))return dE(s,l,h);if(e.match(/^#+0+$/))return h+wo(l,e.length-e.indexOf("0"));if(s=e.match(Hg))return n=Dp(t,s[1].length).replace(/^([^\.]+)$/,"$1."+Fi(s[1])).replace(/\.$/,"."+Fi(s[1])).replace(/\.(\d*)$/,function(g,m){return"."+m+Sr("0",Fi(s[1]).length-m.length)}),e.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return h+Dp(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return h+ea(wo(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+pn(r,e,-t):ea(""+(Math.floor(t)+mE(t,s[1].length)))+"."+Bn(Mp(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return pn(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Lo(pn(r,e.replace(/[\\-]/g,""),t)),a=0,Lo(Lo(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<n.length?n.charAt(a++):g==="0"?"0":""}));if(e.match(jg))return n=pn(r,"##########",t),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var c="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Mc(l,Math.pow(10,a)-1,!1),n=""+h,c=ks("n",s[1],o[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),n+=c+s[2]+"/"+s[3],c=Pc(o[2],a),c.length<s[4].length&&(c=Fi(s[4].substr(s[4].length-c.length))+c),n+=c,n;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Mc(l,Math.pow(10,a)-1,!0),h+(o[0]||(o[1]?"":"0"))+" "+(o[1]?wd(o[1],a)+s[2]+"/"+s[3]+Pc(o[2],a):Sr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return n=wo(t,0),e.length<=n.length?n:Fi(e.substr(0,e.length-n.length))+n;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){n=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=n.indexOf(".");var d=e.indexOf(".")-a,p=e.length-n.length-d;return Fi(e.substr(0,d)+n+e.substr(e.length-p))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=Mp(t,s[1].length),t<0?"-"+pn(r,e,-t):ea(gE(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Bn(0,3-g.length):"")+g})+"."+Bn(a,s[1].length);switch(e){case"###,##0.00":return pn(r,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var f=ea(wo(l,0));return f!=="0"?h+f:"";case"###,###.00":return pn(r,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return pn(r,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function vE(r,e,t){for(var i=e.length-1;e.charCodeAt(i-1)===44;)--i;return ks(r,e.substr(0,i),t/Math.pow(10,3*(e.length-i)))}function bE(r,e,t){var i=e.replace(Og,""),n=e.length-i.length;return ks(r,i,t*Math.pow(10,2*n))+Sr("%",n)}function Wg(r,e){var t,i=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Wg(r,-e);var n=r.indexOf(".");n===-1&&(n=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%n;if(s<0&&(s+=n),t=(e/Math.pow(10,s)).toPrecision(i+1+(n+s)%n),!t.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,h,c){return l+h+c.substr(0,(n+s)%n)+"."+c.substr(s)+"E"})}else t=e.toExponential(i);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Qn(r,e,t){if(r.charCodeAt(0)===40&&!e.match(zg)){var i=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Qn("n",i,t):"("+Qn("n",i,-t)+")"}if(e.charCodeAt(e.length-1)===44)return vE(r,e,t);if(e.indexOf("%")!==-1)return bE(r,e,t);if(e.indexOf("E")!==-1)return Wg(e,t);if(e.charCodeAt(0)===36)return"$"+Qn(r,e.substr(e.charAt(1)==" "?2:1),t);var n,s,a,o,l=Math.abs(t),h=t<0?"-":"";if(e.match(/^00+$/))return h+Bn(l,e.length);if(e.match(/^[#?]+$/))return n=""+t,t===0&&(n=""),n.length>e.length?n:Fi(e.substr(0,e.length-n.length))+n;if(s=e.match(Bg))return pE(s,l,h);if(e.match(/^#+0+$/))return h+Bn(l,e.length-e.indexOf("0"));if(s=e.match(Hg))return n=(""+t).replace(/^([^\.]+)$/,"$1."+Fi(s[1])).replace(/\.$/,"."+Fi(s[1])),n=n.replace(/\.(\d*)$/,function(g,m){return"."+m+Sr("0",Fi(s[1]).length-m.length)}),e.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return h+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return h+ea(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Qn(r,e,-t):ea(""+t)+"."+Sr("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Qn(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Lo(Qn(r,e.replace(/[\\-]/g,""),t)),a=0,Lo(Lo(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<n.length?n.charAt(a++):g==="0"?"0":""}));if(e.match(jg))return n=Qn(r,"##########",t),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var c="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Mc(l,Math.pow(10,a)-1,!1),n=""+h,c=ks("n",s[1],o[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),n+=c+s[2]+"/"+s[3],c=Pc(o[2],a),c.length<s[4].length&&(c=Fi(s[4].substr(s[4].length-c.length))+c),n+=c,n;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Mc(l,Math.pow(10,a)-1,!0),h+(o[0]||(o[1]?"":"0"))+" "+(o[1]?wd(o[1],a)+s[2]+"/"+s[3]+Pc(o[2],a):Sr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return n=""+t,e.length<=n.length?n:Fi(e.substr(0,e.length-n.length))+n;if(s=e.match(/^([#0]+)\.([#0]+)$/)){n=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=n.indexOf(".");var d=e.indexOf(".")-a,p=e.length-n.length-d;return Fi(e.substr(0,d)+n+e.substr(e.length-p))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Qn(r,e,-t):ea(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Bn(0,3-g.length):"")+g})+"."+Bn(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var f=ea(""+l);return f!=="0"?h+f:"";default:if(e.match(/\.[0#?]*$/))return Qn(r,e.slice(0,e.lastIndexOf(".")),t)+Fi(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function ks(r,e,t){return(t|0)===t?Qn(r,e,t):pn(r,e,t)}function wE(r){for(var e=[],t=!1,i=0,n=0;i<r.length;++i)switch(r.charCodeAt(i)){case 34:t=!t;break;case 95:case 42:case 92:++i;break;case 59:e[e.length]=r.substr(n,i-n),n=i+1}if(e[e.length]=r.substr(n),t===!0)throw new Error("Format |"+r+"| unterminated string ");return e}var Ug=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Wa(r){for(var e=0,t="",i="";e<r.length;)switch(t=r.charAt(e)){case"G":Dc(r,e)&&(e+=6),e++;break;case'"':for(;r.charCodeAt(++e)!==34&&e<r.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(r.charAt(e+1)==="1"||r.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(r.substr(e,3).toUpperCase()==="A/P"||r.substr(e,5).toUpperCase()==="AM/PM"||r.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(i=t;r.charAt(e++)!=="]"&&e<r.length;)i+=r.charAt(e);if(i.match(Ug))return!0;break;case".":case"0":case"#":for(;e<r.length&&("0#?.,E+-%".indexOf(t=r.charAt(++e))>-1||t=="\\"&&r.charAt(e+1)=="-"&&"0#".indexOf(r.charAt(e+2))>-1););break;case"?":for(;r.charAt(++e)===t;);break;case"*":++e,(r.charAt(e)==" "||r.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<r.length&&"0123456789".indexOf(r.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function xE(r,e,t,i){for(var n=[],s="",a=0,o="",l="t",h,c,d,p="H";a<r.length;)switch(o=r.charAt(a)){case"G":if(!Dc(r,a))throw new Error("unrecognized character "+o+" in "+r);n[n.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(d=r.charCodeAt(++a))!==34&&a<r.length;)s+=String.fromCharCode(d);n[n.length]={t:"t",v:s},++a;break;case"\\":var f=r.charAt(++a),g=f==="("||f===")"?f:"t";n[n.length]={t:g,v:f},++a;break;case"_":n[n.length]={t:"t",v:" "},a+=2;break;case"@":n[n.length]={t:"T",v:e},++a;break;case"B":case"b":if(r.charAt(a+1)==="1"||r.charAt(a+1)==="2"){if(h==null&&(h=Qs(e,t,r.charAt(a+1)==="2"),h==null))return"";n[n.length]={t:"X",v:r.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||h==null&&(h=Qs(e,t),h==null))return"";for(s=o;++a<r.length&&r.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=p),n[n.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var m={t:o,v:o};if(h==null&&(h=Qs(e,t)),r.substr(a,3).toUpperCase()==="A/P"?(h!=null&&(m.v=h.H>=12?"P":"A"),m.t="T",p="h",a+=3):r.substr(a,5).toUpperCase()==="AM/PM"?(h!=null&&(m.v=h.H>=12?"PM":"AM"),m.t="T",a+=5,p="h"):r.substr(a,5).toUpperCase()==="/"?(h!=null&&(m.v=h.H>=12?"":""),m.t="T",a+=5,p="h"):(m.t="t",++a),h==null&&m.t==="T")return"";n[n.length]=m,l=o;break;case"[":for(s=o;r.charAt(a++)!=="]"&&a<r.length;)s+=r.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Ug)){if(h==null&&(h=Qs(e,t),h==null))return"";n[n.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Wa(r)||(n[n.length]={t:"t",v:s}));break;case".":if(h!=null){for(s=o;++a<r.length&&(o=r.charAt(a))==="0";)s+=o;n[n.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<r.length&&"0#?.,E+-%".indexOf(o=r.charAt(a))>-1;)s+=o;n[n.length]={t:"n",v:s};break;case"?":for(s=o;r.charAt(++a)===o;)s+=o;n[n.length]={t:o,v:s},l=o;break;case"*":++a,(r.charAt(a)==" "||r.charAt(a)=="*")&&++a;break;case"(":case")":n[n.length]={t:i===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<r.length&&"0123456789".indexOf(r.charAt(++a))>-1;)s+=r.charAt(a);n[n.length]={t:"D",v:s};break;case" ":n[n.length]={t:o,v:o},++a;break;case"$":n[n.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+r);n[n.length]={t:"t",v:o},++a;break}var b=0,w=0,E;for(a=n.length-1,l="t";a>=0;--a)switch(n[a].t){case"h":case"H":n[a].t=p,l="h",b<1&&(b=1);break;case"s":(E=n[a].v.match(/\.0+$/))&&(w=Math.max(w,E[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":l=n[a].t;break;case"m":l==="s"&&(n[a].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&n[a].v.match(/[Hh]/)&&(b=1),b<2&&n[a].v.match(/[Mm]/)&&(b=2),b<3&&n[a].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var C="",F;for(a=0;a<n.length;++a)switch(n[a].t){case"t":case"T":case" ":case"D":break;case"X":n[a].v="",n[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[a].v=cE(n[a].t.charCodeAt(0),n[a].v,h,w),n[a].t="t";break;case"n":case"?":for(F=a+1;n[F]!=null&&((o=n[F].t)==="?"||o==="D"||(o===" "||o==="t")&&n[F+1]!=null&&(n[F+1].t==="?"||n[F+1].t==="t"&&n[F+1].v==="/")||n[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(n[F].v==="/"||n[F].v===" "&&n[F+1]!=null&&n[F+1].t=="?"));)n[a].v+=n[F].v,n[F]={v:"",t:";"},++F;C+=n[a].v,a=F-1;break;case"G":n[a].t="t",n[a].v=Ma(e,t);break}var L="",D,S;if(C.length>0){C.charCodeAt(0)==40?(D=e<0&&C.charCodeAt(0)===45?-e:e,S=ks("n",C,D)):(D=e<0&&i>1?-e:e,S=ks("n",C,D),D<0&&n[0]&&n[0].t=="t"&&(S=S.substr(1),n[0].v="-"+n[0].v)),F=S.length-1;var A=n.length;for(a=0;a<n.length;++a)if(n[a]!=null&&n[a].t!="t"&&n[a].v.indexOf(".")>-1){A=a;break}var O=n.length;if(A===n.length&&S.indexOf("E")===-1){for(a=n.length-1;a>=0;--a)n[a]==null||"n?".indexOf(n[a].t)===-1||(F>=n[a].v.length-1?(F-=n[a].v.length,n[a].v=S.substr(F+1,n[a].v.length)):F<0?n[a].v="":(n[a].v=S.substr(0,F+1),F=-1),n[a].t="t",O=a);F>=0&&O<n.length&&(n[O].v=S.substr(0,F+1)+n[O].v)}else if(A!==n.length&&S.indexOf("E")===-1){for(F=S.indexOf(".")-1,a=A;a>=0;--a)if(!(n[a]==null||"n?".indexOf(n[a].t)===-1)){for(c=n[a].v.indexOf(".")>-1&&a===A?n[a].v.indexOf(".")-1:n[a].v.length-1,L=n[a].v.substr(c+1);c>=0;--c)F>=0&&(n[a].v.charAt(c)==="0"||n[a].v.charAt(c)==="#")&&(L=S.charAt(F--)+L);n[a].v=L,n[a].t="t",O=a}for(F>=0&&O<n.length&&(n[O].v=S.substr(0,F+1)+n[O].v),F=S.indexOf(".")+1,a=A;a<n.length;++a)if(!(n[a]==null||"n?(".indexOf(n[a].t)===-1&&a!==A)){for(c=n[a].v.indexOf(".")>-1&&a===A?n[a].v.indexOf(".")+1:0,L=n[a].v.substr(0,c);c<n[a].v.length;++c)F<S.length&&(L+=S.charAt(F++));n[a].v=L,n[a].t="t",O=a}}}for(a=0;a<n.length;++a)n[a]!=null&&"n?".indexOf(n[a].t)>-1&&(D=i>1&&e<0&&a>0&&n[a-1].v==="-"?-e:e,n[a].v=ks(n[a].t,n[a].v,D),n[a].t="t");var U="";for(a=0;a!==n.length;++a)n[a]!=null&&(U+=n[a].v);return U}var Op=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Ip(r,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(r==t)return!0;break;case">":if(r>t)return!0;break;case"<":if(r<t)return!0;break;case"<>":if(r!=t)return!0;break;case">=":if(r>=t)return!0;break;case"<=":if(r<=t)return!0;break}return!1}function yE(r,e){var t=wE(r),i=t.length,n=t[i-1].indexOf("@");if(i<4&&n>-1&&--i,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||n>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=n>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=n>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=n>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[i,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var a=t[0].match(Op),o=t[1].match(Op);return Ip(e,a)?[i,t[0]]:Ip(e,o)?[i,t[1]]:[i,t[a!=null&&o!=null?2:1]]}return[i,s]}function nn(r,e,t){t==null&&(t={});var i="";switch(typeof r){case"string":r=="m/d/yy"&&t.dateNF?i=t.dateNF:i=r;break;case"number":r==14&&t.dateNF?i=t.dateNF:i=(t.table!=null?t.table:vt)[r],i==null&&(i=t.table&&t.table[Pp[r]]||vt[Pp[r]]),i==null&&(i=iE[r]||"General");break}if(Dc(i,0))return Ma(e,t);e instanceof Date&&(e=Mg(e,t.date1904));var n=yE(i,e);if(Dc(n[1]))return Ma(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return xE(n[1],e,t,n[0])}function as(r,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(vt[t]==null){e<0&&(e=t);continue}if(vt[t]==r){e=t;break}}e<0&&(e=391)}return vt[e]=r,e}function fh(r){for(var e=0;e!=392;++e)r[e]!==void 0&&as(r[e],e)}function jo(){vt=rE()}var Vg={format:nn,load:as,_table:vt,load_table:fh,parse_date_code:Qs,is_date:Wa,get_table:function(){return Vg._table=vt}},EE={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Gg=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function CE(r){var e=typeof r=="number"?vt[r]:r;return e=e.replace(Gg,"(\\d+)"),new RegExp("^"+e+"$")}function _E(r,e,t){var i=-1,n=-1,s=-1,a=-1,o=-1,l=-1;(e.match(Gg)||[]).forEach(function(d,p){var f=parseInt(t[p+1],10);switch(d.toLowerCase().charAt(0)){case"y":i=f;break;case"d":s=f;break;case"h":a=f;break;case"s":l=f;break;case"m":a>=0?o=f:n=f;break}}),l>=0&&o==-1&&n>=0&&(o=n,n=-1);var h=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var c=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?h:i==-1&&n==-1&&s==-1?c:h+"T"+c}var kE=(function(){var r={};r.version="1.2.0";function e(){for(var S=0,A=new Array(256),O=0;O!=256;++O)S=O,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,A[O]=S;return typeof Int32Array<"u"?new Int32Array(A):A}var t=e();function i(S){var A=0,O=0,U=0,R=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(U=0;U!=256;++U)R[U]=S[U];for(U=0;U!=256;++U)for(O=S[U],A=256+U;A<4096;A+=256)O=R[A]=O>>>8^S[O&255];var k=[];for(U=1;U!=16;++U)k[U-1]=typeof Int32Array<"u"?R.subarray(U*256,U*256+256):R.slice(U*256,U*256+256);return k}var n=i(t),s=n[0],a=n[1],o=n[2],l=n[3],h=n[4],c=n[5],d=n[6],p=n[7],f=n[8],g=n[9],m=n[10],b=n[11],w=n[12],E=n[13],C=n[14];function F(S,A){for(var O=A^-1,U=0,R=S.length;U<R;)O=O>>>8^t[(O^S.charCodeAt(U++))&255];return~O}function L(S,A){for(var O=A^-1,U=S.length-15,R=0;R<U;)O=C[S[R++]^O&255]^E[S[R++]^O>>8&255]^w[S[R++]^O>>16&255]^b[S[R++]^O>>>24]^m[S[R++]]^g[S[R++]]^f[S[R++]]^p[S[R++]]^d[S[R++]]^c[S[R++]]^h[S[R++]]^l[S[R++]]^o[S[R++]]^a[S[R++]]^s[S[R++]]^t[S[R++]];for(U+=15;R<U;)O=O>>>8^t[(O^S[R++])&255];return~O}function D(S,A){for(var O=A^-1,U=0,R=S.length,k=0,M=0;U<R;)k=S.charCodeAt(U++),k<128?O=O>>>8^t[(O^k)&255]:k<2048?(O=O>>>8^t[(O^(192|k>>6&31))&255],O=O>>>8^t[(O^(128|k&63))&255]):k>=55296&&k<57344?(k=(k&1023)+64,M=S.charCodeAt(U++)&1023,O=O>>>8^t[(O^(240|k>>8&7))&255],O=O>>>8^t[(O^(128|k>>2&63))&255],O=O>>>8^t[(O^(128|M>>6&15|(k&3)<<4))&255],O=O>>>8^t[(O^(128|M&63))&255]):(O=O>>>8^t[(O^(224|k>>12&15))&255],O=O>>>8^t[(O^(128|k>>6&63))&255],O=O>>>8^t[(O^(128|k&63))&255]);return~O}return r.table=t,r.bstr=F,r.buf=L,r.str=D,r})(),ut=(function(){var e={};e.version="1.2.1";function t(j,ne){for(var Q=j.split("/"),ee=ne.split("/"),ie=0,ae=0,Ee=Math.min(Q.length,ee.length);ie<Ee;++ie){if(ae=Q[ie].length-ee[ie].length)return ae;if(Q[ie]!=ee[ie])return Q[ie]<ee[ie]?-1:1}return Q.length-ee.length}function i(j){if(j.charAt(j.length-1)=="/")return j.slice(0,-1).indexOf("/")===-1?j:i(j.slice(0,-1));var ne=j.lastIndexOf("/");return ne===-1?j:j.slice(0,ne+1)}function n(j){if(j.charAt(j.length-1)=="/")return n(j.slice(0,-1));var ne=j.lastIndexOf("/");return ne===-1?j:j.slice(ne+1)}function s(j,ne){typeof ne=="string"&&(ne=new Date(ne));var Q=ne.getHours();Q=Q<<6|ne.getMinutes(),Q=Q<<5|ne.getSeconds()>>>1,j.write_shift(2,Q);var ee=ne.getFullYear()-1980;ee=ee<<4|ne.getMonth()+1,ee=ee<<5|ne.getDate(),j.write_shift(2,ee)}function a(j){var ne=j.read_shift(2)&65535,Q=j.read_shift(2)&65535,ee=new Date,ie=Q&31;Q>>>=5;var ae=Q&15;Q>>>=4,ee.setMilliseconds(0),ee.setFullYear(Q+1980),ee.setMonth(ae-1),ee.setDate(ie);var Ee=ne&31;ne>>>=5;var Fe=ne&63;return ne>>>=6,ee.setHours(ne),ee.setMinutes(Fe),ee.setSeconds(Ee<<1),ee}function o(j){oi(j,0);for(var ne={},Q=0;j.l<=j.length-4;){var ee=j.read_shift(2),ie=j.read_shift(2),ae=j.l+ie,Ee={};switch(ee){case 21589:Q=j.read_shift(1),Q&1&&(Ee.mtime=j.read_shift(4)),ie>5&&(Q&2&&(Ee.atime=j.read_shift(4)),Q&4&&(Ee.ctime=j.read_shift(4))),Ee.mtime&&(Ee.mt=new Date(Ee.mtime*1e3));break}j.l=ae,ne[ee]=Ee}return ne}var l;function h(){return l||(l={})}function c(j,ne){if(j[0]==80&&j[1]==75)return pr(j,ne);if((j[0]|32)==109&&(j[1]|32)==105)return on(j,ne);if(j.length<512)throw new Error("CFB file size "+j.length+" < 512");var Q=3,ee=512,ie=0,ae=0,Ee=0,Fe=0,ye=0,ke=[],Te=j.slice(0,512);oi(Te,0);var je=d(Te);switch(Q=je[0],Q){case 3:ee=512;break;case 4:ee=4096;break;case 0:if(je[1]==0)return pr(j,ne);default:throw new Error("Major Version: Expected 3 or 4 saw "+Q)}ee!==512&&(Te=j.slice(0,ee),oi(Te,28));var Xe=j.slice(0,ee);p(Te,Q);var nt=Te.read_shift(4,"i");if(Q===3&&nt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+nt);Te.l+=4,Ee=Te.read_shift(4,"i"),Te.l+=4,Te.chk("00100000","Mini Stream Cutoff Size: "),Fe=Te.read_shift(4,"i"),ie=Te.read_shift(4,"i"),ye=Te.read_shift(4,"i"),ae=Te.read_shift(4,"i");for(var Ge=-1,it=0;it<109&&(Ge=Te.read_shift(4,"i"),!(Ge<0));++it)ke[it]=Ge;var Ct=f(j,ee);b(ye,ae,Ct,ee,ke);var Yt=E(Ct,Ee,ke,ee);Yt[Ee].name="!Directory",ie>0&&Fe!==M&&(Yt[Fe].name="!MiniFAT"),Yt[ke[0]].name="!FAT",Yt.fat_addrs=ke,Yt.ssz=ee;var ir={},Hr=[],_n=[],fs=[];C(Ee,Yt,Ct,Hr,ie,ir,_n,Fe),g(_n,fs,Hr),Hr.shift();var Gn={FileIndex:_n,FullPaths:fs};return ne&&ne.raw&&(Gn.raw={header:Xe,sectors:Ct}),Gn}function d(j){if(j[j.l]==80&&j[j.l+1]==75)return[0,0];j.chk(V,"Header Signature: "),j.l+=16;var ne=j.read_shift(2,"u");return[j.read_shift(2,"u"),ne]}function p(j,ne){var Q=9;switch(j.l+=2,Q=j.read_shift(2)){case 9:if(ne!=3)throw new Error("Sector Shift: Expected 9 saw "+Q);break;case 12:if(ne!=4)throw new Error("Sector Shift: Expected 12 saw "+Q);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Q)}j.chk("0600","Mini Sector Shift: "),j.chk("000000000000","Reserved: ")}function f(j,ne){for(var Q=Math.ceil(j.length/ne)-1,ee=[],ie=1;ie<Q;++ie)ee[ie-1]=j.slice(ie*ne,(ie+1)*ne);return ee[Q-1]=j.slice(Q*ne),ee}function g(j,ne,Q){for(var ee=0,ie=0,ae=0,Ee=0,Fe=0,ye=Q.length,ke=[],Te=[];ee<ye;++ee)ke[ee]=Te[ee]=ee,ne[ee]=Q[ee];for(;Fe<Te.length;++Fe)ee=Te[Fe],ie=j[ee].L,ae=j[ee].R,Ee=j[ee].C,ke[ee]===ee&&(ie!==-1&&ke[ie]!==ie&&(ke[ee]=ke[ie]),ae!==-1&&ke[ae]!==ae&&(ke[ee]=ke[ae])),Ee!==-1&&(ke[Ee]=ee),ie!==-1&&ee!=ke[ee]&&(ke[ie]=ke[ee],Te.lastIndexOf(ie)<Fe&&Te.push(ie)),ae!==-1&&ee!=ke[ee]&&(ke[ae]=ke[ee],Te.lastIndexOf(ae)<Fe&&Te.push(ae));for(ee=1;ee<ye;++ee)ke[ee]===ee&&(ae!==-1&&ke[ae]!==ae?ke[ee]=ke[ae]:ie!==-1&&ke[ie]!==ie&&(ke[ee]=ke[ie]));for(ee=1;ee<ye;++ee)if(j[ee].type!==0){if(Fe=ee,Fe!=ke[Fe])do Fe=ke[Fe],ne[ee]=ne[Fe]+"/"+ne[ee];while(Fe!==0&&ke[Fe]!==-1&&Fe!=ke[Fe]);ke[ee]=-1}for(ne[0]+="/",ee=1;ee<ye;++ee)j[ee].type!==2&&(ne[ee]+="/")}function m(j,ne,Q){for(var ee=j.start,ie=j.size,ae=[],Ee=ee;Q&&ie>0&&Ee>=0;)ae.push(ne.slice(Ee*k,Ee*k+k)),ie-=k,Ee=ya(Q,Ee*4);return ae.length===0?Pe(0):ii(ae).slice(0,j.size)}function b(j,ne,Q,ee,ie){var ae=M;if(j===M){if(ne!==0)throw new Error("DIFAT chain shorter than expected")}else if(j!==-1){var Ee=Q[j],Fe=(ee>>>2)-1;if(!Ee)return;for(var ye=0;ye<Fe&&(ae=ya(Ee,ye*4))!==M;++ye)ie.push(ae);b(ya(Ee,ee-4),ne-1,Q,ee,ie)}}function w(j,ne,Q,ee,ie){var ae=[],Ee=[];ie||(ie=[]);var Fe=ee-1,ye=0,ke=0;for(ye=ne;ye>=0;){ie[ye]=!0,ae[ae.length]=ye,Ee.push(j[ye]);var Te=Q[Math.floor(ye*4/ee)];if(ke=ye*4&Fe,ee<4+ke)throw new Error("FAT boundary crossed: "+ye+" 4 "+ee);if(!j[Te])break;ye=ya(j[Te],ke)}return{nodes:ae,data:Yp([Ee])}}function E(j,ne,Q,ee){var ie=j.length,ae=[],Ee=[],Fe=[],ye=[],ke=ee-1,Te=0,je=0,Xe=0,nt=0;for(Te=0;Te<ie;++Te)if(Fe=[],Xe=Te+ne,Xe>=ie&&(Xe-=ie),!Ee[Xe]){ye=[];var Ge=[];for(je=Xe;je>=0;){Ge[je]=!0,Ee[je]=!0,Fe[Fe.length]=je,ye.push(j[je]);var it=Q[Math.floor(je*4/ee)];if(nt=je*4&ke,ee<4+nt)throw new Error("FAT boundary crossed: "+je+" 4 "+ee);if(!j[it]||(je=ya(j[it],nt),Ge[je]))break}ae[Xe]={nodes:Fe,data:Yp([ye])}}return ae}function C(j,ne,Q,ee,ie,ae,Ee,Fe){for(var ye=0,ke=ee.length?2:0,Te=ne[j].data,je=0,Xe=0,nt;je<Te.length;je+=128){var Ge=Te.slice(je,je+128);oi(Ge,64),Xe=Ge.read_shift(2),nt=lu(Ge,0,Xe-ke),ee.push(nt);var it={name:nt,type:Ge.read_shift(1),color:Ge.read_shift(1),L:Ge.read_shift(4,"i"),R:Ge.read_shift(4,"i"),C:Ge.read_shift(4,"i"),clsid:Ge.read_shift(16),state:Ge.read_shift(4,"i"),start:0,size:0},Ct=Ge.read_shift(2)+Ge.read_shift(2)+Ge.read_shift(2)+Ge.read_shift(2);Ct!==0&&(it.ct=F(Ge,Ge.l-8));var Yt=Ge.read_shift(2)+Ge.read_shift(2)+Ge.read_shift(2)+Ge.read_shift(2);Yt!==0&&(it.mt=F(Ge,Ge.l-8)),it.start=Ge.read_shift(4,"i"),it.size=Ge.read_shift(4,"i"),it.size<0&&it.start<0&&(it.size=it.type=0,it.start=M,it.name=""),it.type===5?(ye=it.start,ie>0&&ye!==M&&(ne[ye].name="!StreamData")):it.size>=4096?(it.storage="fat",ne[it.start]===void 0&&(ne[it.start]=w(Q,it.start,ne.fat_addrs,ne.ssz)),ne[it.start].name=it.name,it.content=ne[it.start].data.slice(0,it.size)):(it.storage="minifat",it.size<0?it.size=0:ye!==M&&it.start!==M&&ne[ye]&&(it.content=m(it,ne[ye].data,(ne[Fe]||{}).data))),it.content&&oi(it.content,0),ae[nt]=it,Ee.push(it)}}function F(j,ne){return new Date((ri(j,ne+4)/1e7*Math.pow(2,32)+ri(j,ne)/1e7-11644473600)*1e3)}function L(j,ne){return h(),c(l.readFileSync(j),ne)}function D(j,ne){var Q=ne&&ne.type;switch(Q||Ot&&Buffer.isBuffer(j)&&(Q="buffer"),Q||"base64"){case"file":return L(j,ne);case"base64":return c(Qi(rn(j)),ne);case"binary":return c(Qi(j),ne)}return c(j,ne)}function S(j,ne){var Q=ne||{},ee=Q.root||"Root Entry";if(j.FullPaths||(j.FullPaths=[]),j.FileIndex||(j.FileIndex=[]),j.FullPaths.length!==j.FileIndex.length)throw new Error("inconsistent CFB structure");j.FullPaths.length===0&&(j.FullPaths[0]=ee+"/",j.FileIndex[0]={name:ee,type:5}),Q.CLSID&&(j.FileIndex[0].clsid=Q.CLSID),A(j)}function A(j){var ne="Sh33tJ5";if(!ut.find(j,"/"+ne)){var Q=Pe(4);Q[0]=55,Q[1]=Q[3]=50,Q[2]=54,j.FileIndex.push({name:ne,type:2,content:Q,size:4,L:69,R:69,C:69}),j.FullPaths.push(j.FullPaths[0]+ne),O(j)}}function O(j,ne){S(j);for(var Q=!1,ee=!1,ie=j.FullPaths.length-1;ie>=0;--ie){var ae=j.FileIndex[ie];switch(ae.type){case 0:ee?Q=!0:(j.FileIndex.pop(),j.FullPaths.pop());break;case 1:case 2:case 5:ee=!0,isNaN(ae.R*ae.L*ae.C)&&(Q=!0),ae.R>-1&&ae.L>-1&&ae.R==ae.L&&(Q=!0);break;default:Q=!0;break}}if(!(!Q&&!ne)){var Ee=new Date(1987,1,19),Fe=0,ye=Object.create?Object.create(null):{},ke=[];for(ie=0;ie<j.FullPaths.length;++ie)ye[j.FullPaths[ie]]=!0,j.FileIndex[ie].type!==0&&ke.push([j.FullPaths[ie],j.FileIndex[ie]]);for(ie=0;ie<ke.length;++ie){var Te=i(ke[ie][0]);ee=ye[Te],ee||(ke.push([Te,{name:n(Te).replace("/",""),type:1,clsid:K,ct:Ee,mt:Ee,content:null}]),ye[Te]=!0)}for(ke.sort(function(nt,Ge){return t(nt[0],Ge[0])}),j.FullPaths=[],j.FileIndex=[],ie=0;ie<ke.length;++ie)j.FullPaths[ie]=ke[ie][0],j.FileIndex[ie]=ke[ie][1];for(ie=0;ie<ke.length;++ie){var je=j.FileIndex[ie],Xe=j.FullPaths[ie];if(je.name=n(Xe).replace("/",""),je.L=je.R=je.C=-(je.color=1),je.size=je.content?je.content.length:0,je.start=0,je.clsid=je.clsid||K,ie===0)je.C=ke.length>1?1:-1,je.size=0,je.type=5;else if(Xe.slice(-1)=="/"){for(Fe=ie+1;Fe<ke.length&&i(j.FullPaths[Fe])!=Xe;++Fe);for(je.C=Fe>=ke.length?-1:Fe,Fe=ie+1;Fe<ke.length&&i(j.FullPaths[Fe])!=i(Xe);++Fe);je.R=Fe>=ke.length?-1:Fe,je.type=1}else i(j.FullPaths[ie+1]||"")==i(Xe)&&(je.R=ie+1),je.type=2}}}function U(j,ne){var Q=ne||{};if(Q.fileType=="mad")return mt(j,Q);switch(O(j),Q.fileType){case"zip":return Cn(j,Q)}var ee=(function(nt){for(var Ge=0,it=0,Ct=0;Ct<nt.FileIndex.length;++Ct){var Yt=nt.FileIndex[Ct];if(Yt.content){var ir=Yt.content.length;ir>0&&(ir<4096?Ge+=ir+63>>6:it+=ir+511>>9)}}for(var Hr=nt.FullPaths.length+3>>2,_n=Ge+7>>3,fs=Ge+127>>7,Gn=_n+it+Hr+fs,kn=Gn+127>>7,qn=kn<=109?0:Math.ceil((kn-109)/127);Gn+kn+qn+127>>7>kn;)qn=++kn<=109?0:Math.ceil((kn-109)/127);var Xi=[1,qn,kn,fs,Hr,it,Ge,0];return nt.FileIndex[0].size=Ge<<6,Xi[7]=(nt.FileIndex[0].start=Xi[0]+Xi[1]+Xi[2]+Xi[3]+Xi[4]+Xi[5])+(Xi[6]+7>>3),Xi})(j),ie=Pe(ee[7]<<9),ae=0,Ee=0;{for(ae=0;ae<8;++ae)ie.write_shift(1,oe[ae]);for(ae=0;ae<8;++ae)ie.write_shift(2,0);for(ie.write_shift(2,62),ie.write_shift(2,3),ie.write_shift(2,65534),ie.write_shift(2,9),ie.write_shift(2,6),ae=0;ae<3;++ae)ie.write_shift(2,0);for(ie.write_shift(4,0),ie.write_shift(4,ee[2]),ie.write_shift(4,ee[0]+ee[1]+ee[2]+ee[3]-1),ie.write_shift(4,0),ie.write_shift(4,4096),ie.write_shift(4,ee[3]?ee[0]+ee[1]+ee[2]-1:M),ie.write_shift(4,ee[3]),ie.write_shift(-4,ee[1]?ee[0]-1:M),ie.write_shift(4,ee[1]),ae=0;ae<109;++ae)ie.write_shift(-4,ae<ee[2]?ee[1]+ae:-1)}if(ee[1])for(Ee=0;Ee<ee[1];++Ee){for(;ae<236+Ee*127;++ae)ie.write_shift(-4,ae<ee[2]?ee[1]+ae:-1);ie.write_shift(-4,Ee===ee[1]-1?M:Ee+1)}var Fe=function(nt){for(Ee+=nt;ae<Ee-1;++ae)ie.write_shift(-4,ae+1);nt&&(++ae,ie.write_shift(-4,M))};for(Ee=ae=0,Ee+=ee[1];ae<Ee;++ae)ie.write_shift(-4,Y.DIFSECT);for(Ee+=ee[2];ae<Ee;++ae)ie.write_shift(-4,Y.FATSECT);Fe(ee[3]),Fe(ee[4]);for(var ye=0,ke=0,Te=j.FileIndex[0];ye<j.FileIndex.length;++ye)Te=j.FileIndex[ye],Te.content&&(ke=Te.content.length,!(ke<4096)&&(Te.start=Ee,Fe(ke+511>>9)));for(Fe(ee[6]+7>>3);ie.l&511;)ie.write_shift(-4,Y.ENDOFCHAIN);for(Ee=ae=0,ye=0;ye<j.FileIndex.length;++ye)Te=j.FileIndex[ye],Te.content&&(ke=Te.content.length,!(!ke||ke>=4096)&&(Te.start=Ee,Fe(ke+63>>6)));for(;ie.l&511;)ie.write_shift(-4,Y.ENDOFCHAIN);for(ae=0;ae<ee[4]<<2;++ae){var je=j.FullPaths[ae];if(!je||je.length===0){for(ye=0;ye<17;++ye)ie.write_shift(4,0);for(ye=0;ye<3;++ye)ie.write_shift(4,-1);for(ye=0;ye<12;++ye)ie.write_shift(4,0);continue}Te=j.FileIndex[ae],ae===0&&(Te.start=Te.size?Te.start-1:M);var Xe=ae===0&&Q.root||Te.name;if(ke=2*(Xe.length+1),ie.write_shift(64,Xe,"utf16le"),ie.write_shift(2,ke),ie.write_shift(1,Te.type),ie.write_shift(1,Te.color),ie.write_shift(-4,Te.L),ie.write_shift(-4,Te.R),ie.write_shift(-4,Te.C),Te.clsid)ie.write_shift(16,Te.clsid,"hex");else for(ye=0;ye<4;++ye)ie.write_shift(4,0);ie.write_shift(4,Te.state||0),ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(4,Te.start),ie.write_shift(4,Te.size),ie.write_shift(4,0)}for(ae=1;ae<j.FileIndex.length;++ae)if(Te=j.FileIndex[ae],Te.size>=4096)if(ie.l=Te.start+1<<9,Ot&&Buffer.isBuffer(Te.content))Te.content.copy(ie,ie.l,0,Te.size),ie.l+=Te.size+511&-512;else{for(ye=0;ye<Te.size;++ye)ie.write_shift(1,Te.content[ye]);for(;ye&511;++ye)ie.write_shift(1,0)}for(ae=1;ae<j.FileIndex.length;++ae)if(Te=j.FileIndex[ae],Te.size>0&&Te.size<4096)if(Ot&&Buffer.isBuffer(Te.content))Te.content.copy(ie,ie.l,0,Te.size),ie.l+=Te.size+63&-64;else{for(ye=0;ye<Te.size;++ye)ie.write_shift(1,Te.content[ye]);for(;ye&63;++ye)ie.write_shift(1,0)}if(Ot)ie.l=ie.length;else for(;ie.l<ie.length;)ie.write_shift(1,0);return ie}function R(j,ne){var Q=j.FullPaths.map(function(ye){return ye.toUpperCase()}),ee=Q.map(function(ye){var ke=ye.split("/");return ke[ke.length-(ye.slice(-1)=="/"?2:1)]}),ie=!1;ne.charCodeAt(0)===47?(ie=!0,ne=Q[0].slice(0,-1)+ne):ie=ne.indexOf("/")!==-1;var ae=ne.toUpperCase(),Ee=ie===!0?Q.indexOf(ae):ee.indexOf(ae);if(Ee!==-1)return j.FileIndex[Ee];var Fe=!ae.match(kl);for(ae=ae.replace(_i,""),Fe&&(ae=ae.replace(kl,"!")),Ee=0;Ee<Q.length;++Ee)if((Fe?Q[Ee].replace(kl,"!"):Q[Ee]).replace(_i,"")==ae||(Fe?ee[Ee].replace(kl,"!"):ee[Ee]).replace(_i,"")==ae)return j.FileIndex[Ee];return null}var k=64,M=-2,V="d0cf11e0a1b11ae1",oe=[208,207,17,224,161,177,26,225],K="00000000000000000000000000000000",Y={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:M,FREESECT:-1,HEADER_SIGNATURE:V,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:K,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function se(j,ne,Q){h();var ee=U(j,Q);l.writeFileSync(ne,ee)}function q(j){for(var ne=new Array(j.length),Q=0;Q<j.length;++Q)ne[Q]=String.fromCharCode(j[Q]);return ne.join("")}function fe(j,ne){var Q=U(j,ne);switch(ne&&ne.type||"buffer"){case"file":return h(),l.writeFileSync(ne.filename,Q),Q;case"binary":return typeof Q=="string"?Q:q(Q);case"base64":return Xl(typeof Q=="string"?Q:q(Q));case"buffer":if(Ot)return Buffer.isBuffer(Q)?Q:Ts(Q);case"array":return typeof Q=="string"?Qi(Q):Q}return Q}var ge;function _(j){try{var ne=j.InflateRaw,Q=new ne;if(Q._processChunk(new Uint8Array([3,0]),Q._finishFlushFlag),Q.bytesRead)ge=j;else throw new Error("zlib does not expose bytesRead")}catch(ee){console.error("cannot use native zlib: "+(ee.message||ee))}}function P(j,ne){if(!ge)return Wt(j,ne);var Q=ge.InflateRaw,ee=new Q,ie=ee._processChunk(j.slice(j.l),ee._finishFlushFlag);return j.l+=ee.bytesRead,ie}function N(j){return ge?ge.deflateRawSync(j):tt(j)}var I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],he=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ce(j){var ne=(j<<1|j<<11)&139536|(j<<5|j<<15)&558144;return(ne>>16|ne>>8|ne)&255}for(var ue=typeof Uint8Array<"u",be=ue?new Uint8Array(256):[],Le=0;Le<256;++Le)be[Le]=ce(Le);function Z(j,ne){var Q=be[j&255];return ne<=8?Q>>>8-ne:(Q=Q<<8|be[j>>8&255],ne<=16?Q>>>16-ne:(Q=Q<<8|be[j>>16&255],Q>>>24-ne))}function Ue(j,ne){var Q=ne&7,ee=ne>>>3;return(j[ee]|(Q<=6?0:j[ee+1]<<8))>>>Q&3}function Ye(j,ne){var Q=ne&7,ee=ne>>>3;return(j[ee]|(Q<=5?0:j[ee+1]<<8))>>>Q&7}function Se(j,ne){var Q=ne&7,ee=ne>>>3;return(j[ee]|(Q<=4?0:j[ee+1]<<8))>>>Q&15}function re(j,ne){var Q=ne&7,ee=ne>>>3;return(j[ee]|(Q<=3?0:j[ee+1]<<8))>>>Q&31}function De(j,ne){var Q=ne&7,ee=ne>>>3;return(j[ee]|(Q<=1?0:j[ee+1]<<8))>>>Q&127}function Je(j,ne,Q){var ee=ne&7,ie=ne>>>3,ae=(1<<Q)-1,Ee=j[ie]>>>ee;return Q<8-ee||(Ee|=j[ie+1]<<8-ee,Q<16-ee)||(Ee|=j[ie+2]<<16-ee,Q<24-ee)||(Ee|=j[ie+3]<<24-ee),Ee&ae}function He(j,ne,Q){var ee=ne&7,ie=ne>>>3;return ee<=5?j[ie]|=(Q&7)<<ee:(j[ie]|=Q<<ee&255,j[ie+1]=(Q&7)>>8-ee),ne+3}function qe(j,ne,Q){var ee=ne&7,ie=ne>>>3;return Q=(Q&1)<<ee,j[ie]|=Q,ne+1}function Ze(j,ne,Q){var ee=ne&7,ie=ne>>>3;return Q<<=ee,j[ie]|=Q&255,Q>>>=8,j[ie+1]=Q,ne+8}function Qe(j,ne,Q){var ee=ne&7,ie=ne>>>3;return Q<<=ee,j[ie]|=Q&255,Q>>>=8,j[ie+1]=Q&255,j[ie+2]=Q>>>8,ne+16}function lt(j,ne){var Q=j.length,ee=2*Q>ne?2*Q:ne+5,ie=0;if(Q>=ne)return j;if(Ot){var ae=Rp(ee);if(j.copy)j.copy(ae);else for(;ie<j.length;++ie)ae[ie]=j[ie];return ae}else if(ue){var Ee=new Uint8Array(ee);if(Ee.set)Ee.set(j);else for(;ie<Q;++ie)Ee[ie]=j[ie];return Ee}return j.length=ee,j}function ht(j){for(var ne=new Array(j),Q=0;Q<j;++Q)ne[Q]=0;return ne}function bt(j,ne,Q){var ee=1,ie=0,ae=0,Ee=0,Fe=0,ye=j.length,ke=ue?new Uint16Array(32):ht(32);for(ae=0;ae<32;++ae)ke[ae]=0;for(ae=ye;ae<Q;++ae)j[ae]=0;ye=j.length;var Te=ue?new Uint16Array(ye):ht(ye);for(ae=0;ae<ye;++ae)ke[ie=j[ae]]++,ee<ie&&(ee=ie),Te[ae]=0;for(ke[0]=0,ae=1;ae<=ee;++ae)ke[ae+16]=Fe=Fe+ke[ae-1]<<1;for(ae=0;ae<ye;++ae)Fe=j[ae],Fe!=0&&(Te[ae]=ke[Fe+16]++);var je=0;for(ae=0;ae<ye;++ae)if(je=j[ae],je!=0)for(Fe=Z(Te[ae],ee)>>ee-je,Ee=(1<<ee+4-je)-1;Ee>=0;--Ee)ne[Fe|Ee<<je]=je&15|ae<<4;return ee}var Et=ue?new Uint16Array(512):ht(512),Mt=ue?new Uint16Array(32):ht(32);if(!ue){for(var St=0;St<512;++St)Et[St]=0;for(St=0;St<32;++St)Mt[St]=0}(function(){for(var j=[],ne=0;ne<32;ne++)j.push(5);bt(j,Mt,32);var Q=[];for(ne=0;ne<=143;ne++)Q.push(8);for(;ne<=255;ne++)Q.push(9);for(;ne<=279;ne++)Q.push(7);for(;ne<=287;ne++)Q.push(8);bt(Q,Et,288)})();var ct=(function(){for(var ne=ue?new Uint8Array(32768):[],Q=0,ee=0;Q<he.length-1;++Q)for(;ee<he[Q+1];++ee)ne[ee]=Q;for(;ee<32768;++ee)ne[ee]=29;var ie=ue?new Uint8Array(259):[];for(Q=0,ee=0;Q<X.length-1;++Q)for(;ee<X[Q+1];++ee)ie[ee]=Q;function ae(Fe,ye){for(var ke=0;ke<Fe.length;){var Te=Math.min(65535,Fe.length-ke),je=ke+Te==Fe.length;for(ye.write_shift(1,+je),ye.write_shift(2,Te),ye.write_shift(2,~Te&65535);Te-- >0;)ye[ye.l++]=Fe[ke++]}return ye.l}function Ee(Fe,ye){for(var ke=0,Te=0,je=ue?new Uint16Array(32768):[];Te<Fe.length;){var Xe=Math.min(65535,Fe.length-Te);if(Xe<10){for(ke=He(ye,ke,+(Te+Xe==Fe.length)),ke&7&&(ke+=8-(ke&7)),ye.l=ke/8|0,ye.write_shift(2,Xe),ye.write_shift(2,~Xe&65535);Xe-- >0;)ye[ye.l++]=Fe[Te++];ke=ye.l*8;continue}ke=He(ye,ke,+(Te+Xe==Fe.length)+2);for(var nt=0;Xe-- >0;){var Ge=Fe[Te];nt=(nt<<5^Ge)&32767;var it=-1,Ct=0;if((it=je[nt])&&(it|=Te&-32768,it>Te&&(it-=32768),it<Te))for(;Fe[it+Ct]==Fe[Te+Ct]&&Ct<250;)++Ct;if(Ct>2){Ge=ie[Ct],Ge<=22?ke=Ze(ye,ke,be[Ge+1]>>1)-1:(Ze(ye,ke,3),ke+=5,Ze(ye,ke,be[Ge-23]>>5),ke+=3);var Yt=Ge<8?0:Ge-4>>2;Yt>0&&(Qe(ye,ke,Ct-X[Ge]),ke+=Yt),Ge=ne[Te-it],ke=Ze(ye,ke,be[Ge]>>3),ke-=3;var ir=Ge<4?0:Ge-2>>1;ir>0&&(Qe(ye,ke,Te-it-he[Ge]),ke+=ir);for(var Hr=0;Hr<Ct;++Hr)je[nt]=Te&32767,nt=(nt<<5^Fe[Te])&32767,++Te;Xe-=Ct-1}else Ge<=143?Ge=Ge+48:ke=qe(ye,ke,1),ke=Ze(ye,ke,be[Ge]),je[nt]=Te&32767,++Te}ke=Ze(ye,ke,0)-1}return ye.l=(ke+7)/8|0,ye.l}return function(ye,ke){return ye.length<8?ae(ye,ke):Ee(ye,ke)}})();function tt(j){var ne=Pe(50+Math.floor(j.length*1.1)),Q=ct(j,ne);return ne.slice(0,Q)}var Ve=ue?new Uint16Array(32768):ht(32768),$t=ue?new Uint16Array(32768):ht(32768),pt=ue?new Uint16Array(128):ht(128),qr=1,Kt=1;function ur(j,ne){var Q=re(j,ne)+257;ne+=5;var ee=re(j,ne)+1;ne+=5;var ie=Se(j,ne)+4;ne+=4;for(var ae=0,Ee=ue?new Uint8Array(19):ht(19),Fe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ye=1,ke=ue?new Uint8Array(8):ht(8),Te=ue?new Uint8Array(8):ht(8),je=Ee.length,Xe=0;Xe<ie;++Xe)Ee[I[Xe]]=ae=Ye(j,ne),ye<ae&&(ye=ae),ke[ae]++,ne+=3;var nt=0;for(ke[0]=0,Xe=1;Xe<=ye;++Xe)Te[Xe]=nt=nt+ke[Xe-1]<<1;for(Xe=0;Xe<je;++Xe)(nt=Ee[Xe])!=0&&(Fe[Xe]=Te[nt]++);var Ge=0;for(Xe=0;Xe<je;++Xe)if(Ge=Ee[Xe],Ge!=0){nt=be[Fe[Xe]]>>8-Ge;for(var it=(1<<7-Ge)-1;it>=0;--it)pt[nt|it<<Ge]=Ge&7|Xe<<3}var Ct=[];for(ye=1;Ct.length<Q+ee;)switch(nt=pt[De(j,ne)],ne+=nt&7,nt>>>=3){case 16:for(ae=3+Ue(j,ne),ne+=2,nt=Ct[Ct.length-1];ae-- >0;)Ct.push(nt);break;case 17:for(ae=3+Ye(j,ne),ne+=3;ae-- >0;)Ct.push(0);break;case 18:for(ae=11+De(j,ne),ne+=7;ae-- >0;)Ct.push(0);break;default:Ct.push(nt),ye<nt&&(ye=nt);break}var Yt=Ct.slice(0,Q),ir=Ct.slice(Q);for(Xe=Q;Xe<286;++Xe)Yt[Xe]=0;for(Xe=ee;Xe<30;++Xe)ir[Xe]=0;return qr=bt(Yt,Ve,286),Kt=bt(ir,$t,30),ne}function sn(j,ne){if(j[0]==3&&!(j[1]&3))return[sa(ne),2];for(var Q=0,ee=0,ie=Rp(ne||1<<18),ae=0,Ee=ie.length>>>0,Fe=0,ye=0;(ee&1)==0;){if(ee=Ye(j,Q),Q+=3,ee>>>1)ee>>1==1?(Fe=9,ye=5):(Q=ur(j,Q),Fe=qr,ye=Kt);else{Q&7&&(Q+=8-(Q&7));var ke=j[Q>>>3]|j[(Q>>>3)+1]<<8;if(Q+=32,ke>0)for(!ne&&Ee<ae+ke&&(ie=lt(ie,ae+ke),Ee=ie.length);ke-- >0;)ie[ae++]=j[Q>>>3],Q+=8;continue}for(;;){!ne&&Ee<ae+32767&&(ie=lt(ie,ae+32767),Ee=ie.length);var Te=Je(j,Q,Fe),je=ee>>>1==1?Et[Te]:Ve[Te];if(Q+=je&15,je>>>=4,(je>>>8&255)===0)ie[ae++]=je;else{if(je==256)break;je-=257;var Xe=je<8?0:je-4>>2;Xe>5&&(Xe=0);var nt=ae+X[je];Xe>0&&(nt+=Je(j,Q,Xe),Q+=Xe),Te=Je(j,Q,ye),je=ee>>>1==1?Mt[Te]:$t[Te],Q+=je&15,je>>>=4;var Ge=je<4?0:je-2>>1,it=he[je];for(Ge>0&&(it+=Je(j,Q,Ge),Q+=Ge),!ne&&Ee<nt&&(ie=lt(ie,nt+100),Ee=ie.length);ae<nt;)ie[ae]=ie[ae-it],++ae}}}return ne?[ie,Q+7>>>3]:[ie.slice(0,ae),Q+7>>>3]}function Wt(j,ne){var Q=j.slice(j.l||0),ee=sn(Q,ne);return j.l+=ee[1],ee[0]}function Vn(j,ne){if(j)typeof console<"u"&&console.error(ne);else throw new Error(ne)}function pr(j,ne){var Q=j;oi(Q,0);var ee=[],ie=[],ae={FileIndex:ee,FullPaths:ie};S(ae,{root:ne.root});for(var Ee=Q.length-4;(Q[Ee]!=80||Q[Ee+1]!=75||Q[Ee+2]!=5||Q[Ee+3]!=6)&&Ee>=0;)--Ee;Q.l=Ee+4,Q.l+=4;var Fe=Q.read_shift(2);Q.l+=6;var ye=Q.read_shift(4);for(Q.l=ye,Ee=0;Ee<Fe;++Ee){Q.l+=20;var ke=Q.read_shift(4),Te=Q.read_shift(4),je=Q.read_shift(2),Xe=Q.read_shift(2),nt=Q.read_shift(2);Q.l+=8;var Ge=Q.read_shift(4),it=o(Q.slice(Q.l+je,Q.l+je+Xe));Q.l+=je+Xe+nt;var Ct=Q.l;Q.l=Ge+4,Gi(Q,ke,Te,ae,it),Q.l=Ct}return ae}function Gi(j,ne,Q,ee,ie){j.l+=2;var ae=j.read_shift(2),Ee=j.read_shift(2),Fe=a(j);if(ae&8257)throw new Error("Unsupported ZIP encryption");for(var ye=j.read_shift(4),ke=j.read_shift(4),Te=j.read_shift(4),je=j.read_shift(2),Xe=j.read_shift(2),nt="",Ge=0;Ge<je;++Ge)nt+=String.fromCharCode(j[j.l++]);if(Xe){var it=o(j.slice(j.l,j.l+Xe));(it[21589]||{}).mt&&(Fe=it[21589].mt),((ie||{})[21589]||{}).mt&&(Fe=ie[21589].mt)}j.l+=Xe;var Ct=j.slice(j.l,j.l+ke);switch(Ee){case 8:Ct=P(j,Te);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ee)}var Yt=!1;ae&8&&(ye=j.read_shift(4),ye==134695760&&(ye=j.read_shift(4),Yt=!0),ke=j.read_shift(4),Te=j.read_shift(4)),ke!=ne&&Vn(Yt,"Bad compressed size: "+ne+" != "+ke),Te!=Q&&Vn(Yt,"Bad uncompressed size: "+Q+" != "+Te),Pi(ee,nt,Ct,{unsafe:!0,mt:Fe})}function Cn(j,ne){var Q=ne||{},ee=[],ie=[],ae=Pe(1),Ee=Q.compression?8:0,Fe=0,ye=0,ke=0,Te=0,je=0,Xe=j.FullPaths[0],nt=Xe,Ge=j.FileIndex[0],it=[],Ct=0;for(ye=1;ye<j.FullPaths.length;++ye)if(nt=j.FullPaths[ye].slice(Xe.length),Ge=j.FileIndex[ye],!(!Ge.size||!Ge.content||nt=="Sh33tJ5")){var Yt=Te,ir=Pe(nt.length);for(ke=0;ke<nt.length;++ke)ir.write_shift(1,nt.charCodeAt(ke)&127);ir=ir.slice(0,ir.l),it[je]=kE.buf(Ge.content,0);var Hr=Ge.content;Ee==8&&(Hr=N(Hr)),ae=Pe(30),ae.write_shift(4,67324752),ae.write_shift(2,20),ae.write_shift(2,Fe),ae.write_shift(2,Ee),Ge.mt?s(ae,Ge.mt):ae.write_shift(4,0),ae.write_shift(-4,it[je]),ae.write_shift(4,Hr.length),ae.write_shift(4,Ge.content.length),ae.write_shift(2,ir.length),ae.write_shift(2,0),Te+=ae.length,ee.push(ae),Te+=ir.length,ee.push(ir),Te+=Hr.length,ee.push(Hr),ae=Pe(46),ae.write_shift(4,33639248),ae.write_shift(2,0),ae.write_shift(2,20),ae.write_shift(2,Fe),ae.write_shift(2,Ee),ae.write_shift(4,0),ae.write_shift(-4,it[je]),ae.write_shift(4,Hr.length),ae.write_shift(4,Ge.content.length),ae.write_shift(2,ir.length),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(4,0),ae.write_shift(4,Yt),Ct+=ae.l,ie.push(ae),Ct+=ir.length,ie.push(ir),++je}return ae=Pe(22),ae.write_shift(4,101010256),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,je),ae.write_shift(2,je),ae.write_shift(4,Ct),ae.write_shift(4,Te),ae.write_shift(2,0),ii([ii(ee),ii(ie),ae])}var ar={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function _t(j,ne){if(j.ctype)return j.ctype;var Q=j.name||"",ee=Q.match(/\.([^\.]+)$/);return ee&&ar[ee[1]]||ne&&(ee=(Q=ne).match(/[\.\\]([^\.\\])+$/),ee&&ar[ee[1]])?ar[ee[1]]:"application/octet-stream"}function Gt(j){for(var ne=Xl(j),Q=[],ee=0;ee<ne.length;ee+=76)Q.push(ne.slice(ee,ee+76));return Q.join(`\r
`)+`\r
`}function us(j){var ne=j.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ke){var Te=ke.charCodeAt(0).toString(16).toUpperCase();return"="+(Te.length==1?"0"+Te:Te)});ne=ne.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ne.charAt(0)==`
`&&(ne="=0D"+ne.slice(1)),ne=ne.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Q=[],ee=ne.split(`\r
`),ie=0;ie<ee.length;++ie){var ae=ee[ie];if(ae.length==0){Q.push("");continue}for(var Ee=0;Ee<ae.length;){var Fe=76,ye=ae.slice(Ee,Ee+Fe);ye.charAt(Fe-1)=="="?Fe--:ye.charAt(Fe-2)=="="?Fe-=2:ye.charAt(Fe-3)=="="&&(Fe-=3),ye=ae.slice(Ee,Ee+Fe),Ee+=Fe,Ee<ae.length&&(ye+="="),Q.push(ye)}}return Q.join(`\r
`)}function Xr(j){for(var ne=[],Q=0;Q<j.length;++Q){for(var ee=j[Q];Q<=j.length&&ee.charAt(ee.length-1)=="=";)ee=ee.slice(0,ee.length-1)+j[++Q];ne.push(ee)}for(var ie=0;ie<ne.length;++ie)ne[ie]=ne[ie].replace(/[=][0-9A-Fa-f]{2}/g,function(ae){return String.fromCharCode(parseInt(ae.slice(1),16))});return Qi(ne.join(`\r
`))}function an(j,ne,Q){for(var ee="",ie="",ae="",Ee,Fe=0;Fe<10;++Fe){var ye=ne[Fe];if(!ye||ye.match(/^\s*$/))break;var ke=ye.match(/^(.*?):\s*([^\s].*)$/);if(ke)switch(ke[1].toLowerCase()){case"content-location":ee=ke[2].trim();break;case"content-type":ae=ke[2].trim();break;case"content-transfer-encoding":ie=ke[2].trim();break}}switch(++Fe,ie.toLowerCase()){case"base64":Ee=Qi(rn(ne.slice(Fe).join("")));break;case"quoted-printable":Ee=Xr(ne.slice(Fe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ie)}var Te=Pi(j,ee.slice(Q.length),Ee,{unsafe:!0});ae&&(Te.ctype=ae)}function on(j,ne){if(q(j.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Q=ne&&ne.root||"",ee=(Ot&&Buffer.isBuffer(j)?j.toString("binary"):q(j)).split(`\r
`),ie=0,ae="";for(ie=0;ie<ee.length;++ie)if(ae=ee[ie],!!/^Content-Location:/i.test(ae)&&(ae=ae.slice(ae.indexOf("file")),Q||(Q=ae.slice(0,ae.lastIndexOf("/")+1)),ae.slice(0,Q.length)!=Q))for(;Q.length>0&&(Q=Q.slice(0,Q.length-1),Q=Q.slice(0,Q.lastIndexOf("/")+1),ae.slice(0,Q.length)!=Q););var Ee=(ee[1]||"").match(/boundary="(.*?)"/);if(!Ee)throw new Error("MAD cannot find boundary");var Fe="--"+(Ee[1]||""),ye=[],ke=[],Te={FileIndex:ye,FullPaths:ke};S(Te);var je,Xe=0;for(ie=0;ie<ee.length;++ie){var nt=ee[ie];nt!==Fe&&nt!==Fe+"--"||(Xe++&&an(Te,ee.slice(je,ie),Q),je=ie)}return Te}function mt(j,ne){var Q=ne||{},ee=Q.boundary||"SheetJS";ee="------="+ee;for(var ie=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ee.slice(2)+'"',"","",""],ae=j.FullPaths[0],Ee=ae,Fe=j.FileIndex[0],ye=1;ye<j.FullPaths.length;++ye)if(Ee=j.FullPaths[ye].slice(ae.length),Fe=j.FileIndex[ye],!(!Fe.size||!Fe.content||Ee=="Sh33tJ5")){Ee=Ee.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ct){return"_x"+Ct.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ct){return"_u"+Ct.charCodeAt(0).toString(16)+"_"});for(var ke=Fe.content,Te=Ot&&Buffer.isBuffer(ke)?ke.toString("binary"):q(ke),je=0,Xe=Math.min(1024,Te.length),nt=0,Ge=0;Ge<=Xe;++Ge)(nt=Te.charCodeAt(Ge))>=32&&nt<128&&++je;var it=je>=Xe*4/5;ie.push(ee),ie.push("Content-Location: "+(Q.root||"file:///C:/SheetJS/")+Ee),ie.push("Content-Transfer-Encoding: "+(it?"quoted-printable":"base64")),ie.push("Content-Type: "+_t(Fe,Ee)),ie.push(""),ie.push(it?us(Te):Gt(Te))}return ie.push(ee+`--\r
`),ie.join(`\r
`)}function qi(j){var ne={};return S(ne,j),ne}function Pi(j,ne,Q,ee){var ie=ee&&ee.unsafe;ie||S(j);var ae=!ie&&ut.find(j,ne);if(!ae){var Ee=j.FullPaths[0];ne.slice(0,Ee.length)==Ee?Ee=ne:(Ee.slice(-1)!="/"&&(Ee+="/"),Ee=(Ee+ne).replace("//","/")),ae={name:n(ne),type:2},j.FileIndex.push(ae),j.FullPaths.push(Ee),ie||ut.utils.cfb_gc(j)}return ae.content=Q,ae.size=Q?Q.length:0,ee&&(ee.CLSID&&(ae.clsid=ee.CLSID),ee.mt&&(ae.mt=ee.mt),ee.ct&&(ae.ct=ee.ct)),ae}function ci(j,ne){S(j);var Q=ut.find(j,ne);if(Q){for(var ee=0;ee<j.FileIndex.length;++ee)if(j.FileIndex[ee]==Q)return j.FileIndex.splice(ee,1),j.FullPaths.splice(ee,1),!0}return!1}function Rr(j,ne,Q){S(j);var ee=ut.find(j,ne);if(ee){for(var ie=0;ie<j.FileIndex.length;++ie)if(j.FileIndex[ie]==ee)return j.FileIndex[ie].name=n(Q),j.FullPaths[ie]=Q,!0}return!1}function Er(j){O(j,!0)}return e.find=R,e.read=D,e.parse=c,e.write=fe,e.writeFile=se,e.utils={cfb_new:qi,cfb_add:Pi,cfb_del:ci,cfb_mov:Rr,cfb_gc:Er,ReadShift:Ml,CheckField:h1,prep_blob:oi,bconcat:ii,use_zlib:_,_deflateRaw:tt,_inflateRaw:Wt,consts:Y},e})();let ta;function SE(r){ta=r}function TE(r){return typeof r=="string"?uh(r):Array.isArray(r)?Zy(r):r}function dh(r,e,t){if(typeof ta<"u"&&ta.writeFileSync)return t?ta.writeFileSync(r,e,t):ta.writeFileSync(r,e);if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=uh(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(r,e)}var i=t=="utf8"?ns(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(i,r);if(typeof Blob<"u"){var n=new Blob([TE(i)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,r);if(typeof saveAs<"u")return saveAs(n,r);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:r,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=r,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(r);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=ha(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+r)}function AE(r){if(typeof ta<"u")return ta.readFileSync(r);if(typeof Deno<"u")return Deno.readFileSync(r);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(r);e.open("r"),e.encoding="binary";var t=e.read();return e.close(),t}catch(i){if(!i.message||!i.message.match(/onstruct/))throw i}throw new Error("Cannot access file "+r)}function Fr(r){for(var e=Object.keys(r),t=[],i=0;i<e.length;++i)Object.prototype.hasOwnProperty.call(r,e[i])&&t.push(e[i]);return t}function Bp(r,e){for(var t=[],i=Fr(r),n=0;n!==i.length;++n)t[r[i[n]][e]]==null&&(t[r[i[n]][e]]=i[n]);return t}function su(r){for(var e=[],t=Fr(r),i=0;i!==t.length;++i)e[r[t[i]]]=t[i];return e}function au(r){for(var e=[],t=Fr(r),i=0;i!==t.length;++i)e[r[t[i]]]=parseInt(t[i],10);return e}function FE(r){for(var e=[],t=Fr(r),i=0;i!==t.length;++i)e[r[t[i]]]==null&&(e[r[t[i]]]=[]),e[r[t[i]]].push(t[i]);return e}var Oc=new Date(1899,11,30,0,0,0);function Jr(r,e){var t=r.getTime(),i=Oc.getTime()+(r.getTimezoneOffset()-Oc.getTimezoneOffset())*6e4;return(t-i)/(1440*60*1e3)}var qg=new Date,RE=Oc.getTime()+(qg.getTimezoneOffset()-Oc.getTimezoneOffset())*6e4,Hp=qg.getTimezoneOffset();function ou(r){var e=new Date;return e.setTime(r*24*60*60*1e3+RE),e.getTimezoneOffset()!==Hp&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Hp)*6e4),e}function LE(r){var e=0,t=0,i=!1,n=r.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+r+"| is not an ISO8601 Duration");for(var s=1;s!=n.length;++s)if(n[s]){switch(t=1,s>3&&(i=!0),n[s].slice(n[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[s].slice(n[s].length-1));case"D":t*=24;case"H":t*=60;case"M":if(i)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=t*parseInt(n[s],10)}return e}var zp=new Date("2017-02-19T19:06:09.000Z"),Xg=isNaN(zp.getFullYear())?new Date("2/19/17"):zp,NE=Xg.getFullYear()==2017;function br(r,e){var t=new Date(r);if(NE)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(r instanceof Date)return r;if(Xg.getFullYear()==1917&&!isNaN(t.getFullYear())){var i=t.getFullYear();return r.indexOf(""+i)>-1||t.setFullYear(t.getFullYear()+100),t}var n=r.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return r.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Oa(r,e){if(Ot&&Buffer.isBuffer(r)){if(e){if(r[0]==255&&r[1]==254)return ns(r.slice(2).toString("utf16le"));if(r[1]==254&&r[2]==255)return ns(Pg(r.slice(2).toString("binary")))}return r.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(r[0]==255&&r[1]==254)return ns(new TextDecoder("utf-16le").decode(r.slice(2)));if(r[0]==254&&r[1]==255)return ns(new TextDecoder("utf-16be").decode(r.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[]/g,function(s){return t[s]||s})}catch{}for(var i=[],n=0;n!=r.length;++n)i.push(String.fromCharCode(r[n]));return i.join("")}function cr(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var e={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=cr(r[t]));return e}function Sr(r,e){for(var t="";t.length<e;)t+=r;return t}function Hn(r){var e=Number(r);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(r))return e;var t=1,i=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(i))||(i=i.replace(/[(](.*)[)]/,function(n,s){return t=-t,s}),!isNaN(e=Number(i)))?e/t:e}var PE=["january","february","march","april","may","june","july","august","september","october","november","december"];function Oo(r){var e=new Date(r),t=new Date(NaN),i=e.getYear(),n=e.getMonth(),s=e.getDate();if(isNaN(s))return t;var a=r.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&PE.indexOf(a)==-1)return t}else if(a.match(/[a-z]/))return t;return i<0||i>8099?t:(n>0||s>1)&&i!=101?e:r.match(/[^-0-9:,\/\\]/)?t:e}var DE=(function(){var r="abacaba".split(/(:?b)/i).length==5;return function(t,i,n){if(r||typeof i=="string")return t.split(i);for(var s=t.split(i),a=[s[0]],o=1;o<s.length;++o)a.push(n),a.push(s[o]);return a}})();function Kg(r){return r?r.content&&r.type?Oa(r.content,!0):r.data?Fo(r.data):r.asNodeBuffer&&Ot?Fo(r.asNodeBuffer().toString("binary")):r.asBinary?Fo(r.asBinary()):r._data&&r._data.getContent?Fo(Oa(Array.prototype.slice.call(r._data.getContent(),0))):null:null}function Yg(r){if(!r)return null;if(r.data)return Nc(r.data);if(r.asNodeBuffer&&Ot)return r.asNodeBuffer();if(r._data&&r._data.getContent){var e=r._data.getContent();return typeof e=="string"?Nc(e):Array.prototype.slice.call(e)}return r.content&&r.type?r.content:null}function ME(r){return r&&r.name.slice(-4)===".bin"?Yg(r):Kg(r)}function bn(r,e){for(var t=r.FullPaths||Fr(r.files),i=e.toLowerCase().replace(/[\/]/g,"\\"),n=i.replace(/\\/g,"/"),s=0;s<t.length;++s){var a=t[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(i==a||n==a)return r.files?r.files[t[s]]:r.FileIndex[s]}return null}function yd(r,e){var t=bn(r,e);if(t==null)throw new Error("Cannot find file "+e+" in zip");return t}function Vr(r,e,t){if(!t)return ME(yd(r,e));if(!e)return null;try{return Vr(r,e)}catch{return null}}function en(r,e,t){if(!t)return Kg(yd(r,e));if(!e)return null;try{return en(r,e)}catch{return null}}function OE(r,e,t){return Yg(yd(r,e))}function jp(r){for(var e=r.FullPaths||Fr(r.files),t=[],i=0;i<e.length;++i)e[i].slice(-1)!="/"&&t.push(e[i].replace(/^Root Entry[\/]/,""));return t.sort()}function Nt(r,e,t){if(r.FullPaths){if(typeof t=="string"){var i;return Ot?i=Ts(t):i=Qy(t),ut.utils.cfb_add(r,e,i)}ut.utils.cfb_add(r,e,t)}else r.file(e,t)}function Ed(){return ut.utils.cfb_new()}function $g(r,e){switch(e.type){case"base64":return ut.read(r,{type:"base64"});case"binary":return ut.read(r,{type:"binary"});case"buffer":case"array":return ut.read(r,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Sl(r,e){if(r.charAt(0)=="/")return r.slice(1);var t=e.split("/");e.slice(-1)!="/"&&t.pop();for(var i=r.split("/");i.length!==0;){var n=i.shift();n===".."?t.pop():n!=="."&&t.push(n)}return t.join("/")}var Br=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,IE=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Wp=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,BE=/<[^>]*>/g,Ti=Br.match(Wp)?Wp:BE,HE=/<\w*:/,zE=/<(\/?)\w+:/;function yt(r,e,t){for(var i={},n=0,s=0;n!==r.length&&!((s=r.charCodeAt(n))===32||s===10||s===13);++n);if(e||(i[0]=r.slice(0,n)),n===r.length)return i;var a=r.match(IE),o=0,l="",h=0,c="",d="",p=1;if(a)for(h=0;h!=a.length;++h){for(d=a[h],s=0;s!=d.length&&d.charCodeAt(s)!==61;++s);for(c=d.slice(0,s).trim();d.charCodeAt(s+1)==32;)++s;for(p=(n=d.charCodeAt(s+1))==34||n==39?1:0,l=d.slice(s+1+p,d.length-p),o=0;o!=c.length&&c.charCodeAt(o)!==58;++o);if(o===c.length)c.indexOf("_")>0&&(c=c.slice(0,c.indexOf("_"))),i[c]=l,i[c.toLowerCase()]=l;else{var f=(o===5&&c.slice(0,5)==="xmlns"?"xmlns":"")+c.slice(o+1);if(i[f]&&c.slice(o-3,o)=="ext")continue;i[f]=l,i[f.toLowerCase()]=l}}return i}function hs(r){return r.replace(zE,"<$1")}var Jg={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Cd=su(Jg),Vt=(function(){var r=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function t(i){var n=i+"",s=n.indexOf("<![CDATA[");if(s==-1)return n.replace(r,function(o,l){return Jg[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=n.indexOf("]]>");return t(n.slice(0,s))+n.slice(s+9,a)+t(n.slice(a+3))}})(),_d=/[&<>'"]/g,jE=/[\u0000-\u0008\u000b-\u001f]/g;function rr(r){var e=r+"";return e.replace(_d,function(t){return Cd[t]}).replace(jE,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Up(r){return rr(r).replace(/ /g,"_x0020_")}var Zg=/[\u0000-\u001f]/g;function kd(r){var e=r+"";return e.replace(_d,function(t){return Cd[t]}).replace(/\n/g,"<br/>").replace(Zg,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function WE(r){var e=r+"";return e.replace(_d,function(t){return Cd[t]}).replace(Zg,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}var Vp=(function(){var r=/&#(\d+);/g;function e(t,i){return String.fromCharCode(parseInt(i,10))}return function(i){return i.replace(r,e)}})();function UE(r){return r.replace(/(\r\n|[\r\n])/g,"&#10;")}function mr(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function mf(r){for(var e="",t=0,i=0,n=0,s=0,a=0,o=0;t<r.length;){if(i=r.charCodeAt(t++),i<128){e+=String.fromCharCode(i);continue}if(n=r.charCodeAt(t++),i>191&&i<224){a=(i&31)<<6,a|=n&63,e+=String.fromCharCode(a);continue}if(s=r.charCodeAt(t++),i<240){e+=String.fromCharCode((i&15)<<12|(n&63)<<6|s&63);continue}a=r.charCodeAt(t++),o=((i&7)<<18|(n&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function Gp(r){var e=sa(2*r.length),t,i,n=1,s=0,a=0,o;for(i=0;i<r.length;i+=n)n=1,(o=r.charCodeAt(i))<128?t=o:o<224?(t=(o&31)*64+(r.charCodeAt(i+1)&63),n=2):o<240?(t=(o&15)*4096+(r.charCodeAt(i+1)&63)*64+(r.charCodeAt(i+2)&63),n=3):(n=4,t=(o&7)*262144+(r.charCodeAt(i+1)&63)*4096+(r.charCodeAt(i+2)&63)*64+(r.charCodeAt(i+3)&63),t-=65536,a=55296+(t>>>10&1023),t=56320+(t&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function qp(r){return Ts(r,"binary").toString("utf8")}var hc="foo bar baz",sr=Ot&&(qp(hc)==mf(hc)&&qp||Gp(hc)==mf(hc)&&Gp)||mf,ns=Ot?function(r){return Ts(r,"utf8").toString("binary")}:function(r){for(var e=[],t=0,i=0,n=0;t<r.length;)switch(i=r.charCodeAt(t++),!0){case i<128:e.push(String.fromCharCode(i));break;case i<2048:e.push(String.fromCharCode(192+(i>>6))),e.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,n=r.charCodeAt(t++)-56320+(i<<10),e.push(String.fromCharCode(240+(n>>18&7))),e.push(String.fromCharCode(144+(n>>12&63))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)));break;default:e.push(String.fromCharCode(224+(i>>12))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)))}return e.join("")},Yl=(function(){var r={};return function(t,i){var n=t+"|"+(i||"");return r[n]?r[n]:r[n]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",i||"")}})(),Qg=(function(){var r=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var i=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<r.length;++n)i=i.replace(r[n][0],r[n][1]);return i}})(),VE=(function(){var r={};return function(t){return r[t]!==void 0?r[t]:r[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}})(),GE=/<\/?(?:vt:)?variant>/g,qE=/<(?:vt:)([^>]*)>([\s\S]*)</;function Xp(r,e){var t=yt(r),i=r.match(VE(t.baseType))||[],n=[];if(i.length!=t.size){if(e.WTF)throw new Error("unexpected vector length "+i.length+" != "+t.size);return n}return i.forEach(function(s){var a=s.replace(GE,"").match(qE);a&&n.push({v:sr(a[2]),t:a[1]})}),n}var e1=/(^\s|\s$|\n)/;function li(r,e){return"<"+r+(e.match(e1)?' xml:space="preserve"':"")+">"+e+"</"+r+">"}function $l(r){return Fr(r).map(function(e){return" "+e+'="'+r[e]+'"'}).join("")}function Ke(r,e,t){return"<"+r+(t!=null?$l(t):"")+(e!=null?(e.match(e1)?' xml:space="preserve"':"")+">"+e+"</"+r:"/")+">"}function Yf(r,e){try{return r.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function XE(r,e){switch(typeof r){case"string":var t=Ke("vt:lpwstr",rr(r));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return Ke((r|0)==r?"vt:i4":"vt:r8",rr(String(r)));case"boolean":return Ke("vt:bool",r?"true":"false")}if(r instanceof Date)return Ke("vt:filetime",Yf(r));throw new Error("Unable to serialize "+r)}function Sd(r){if(Ot&&Buffer.isBuffer(r))return r.toString("utf8");if(typeof r=="string")return r;if(typeof Uint8Array<"u"&&r instanceof Uint8Array)return sr(ha(bd(r)));throw new Error("Bad input format: expected Buffer or string")}var Jl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,$r={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ua=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Zi={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function KE(r,e){for(var t=1-2*(r[e+7]>>>7),i=((r[e+7]&127)<<4)+(r[e+6]>>>4&15),n=r[e+6]&15,s=5;s>=0;--s)n=n*256+r[e+s];return i==2047?n==0?t*(1/0):NaN:(i==0?i=-1022:(i-=1023,n+=Math.pow(2,52)),t*Math.pow(2,i-52)*n)}function YE(r,e,t){var i=(e<0||1/e==-1/0?1:0)<<7,n=0,s=0,a=i?-e:e;isFinite(a)?a==0?n=s=0:(n=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-n),n<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?n=-1022:(s-=Math.pow(2,52),n+=1023)):(n=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)r[t+o]=s&255;r[t+6]=(n&15)<<4|s&15,r[t+7]=n>>4|i}var Kp=function(r){for(var e=[],t=10240,i=0;i<r[0].length;++i)if(r[0][i])for(var n=0,s=r[0][i].length;n<s;n+=t)e.push.apply(e,r[0][i].slice(n,n+t));return e},Yp=Ot?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(e){return Buffer.isBuffer(e)?e:Ts(e)})):Kp(r)}:Kp,$p=function(r,e,t){for(var i=[],n=e;n<t;n+=2)i.push(String.fromCharCode(_s(r,n)));return i.join("").replace(_i,"")},lu=Ot?function(r,e,t){return Buffer.isBuffer(r)?r.toString("utf16le",e,t).replace(_i,""):$p(r,e,t)}:$p,Jp=function(r,e,t){for(var i=[],n=e;n<e+t;++n)i.push(("0"+r[n].toString(16)).slice(-2));return i.join("")},t1=Ot?function(r,e,t){return Buffer.isBuffer(r)?r.toString("hex",e,e+t):Jp(r,e,t)}:Jp,Zp=function(r,e,t){for(var i=[],n=e;n<t;n++)i.push(String.fromCharCode(_o(r,n)));return i.join("")},Wo=Ot?function(e,t,i){return Buffer.isBuffer(e)?e.toString("utf8",t,i):Zp(e,t,i)}:Zp,r1=function(r,e){var t=ri(r,e);return t>0?Wo(r,e+4,e+4+t-1):""},Td=r1,i1=function(r,e){var t=ri(r,e);return t>0?Wo(r,e+4,e+4+t-1):""},Ad=i1,n1=function(r,e){var t=2*ri(r,e);return t>0?Wo(r,e+4,e+4+t-1):""},Fd=n1,s1=function(e,t){var i=ri(e,t);return i>0?lu(e,t+4,t+4+i):""},Rd=s1,a1=function(r,e){var t=ri(r,e);return t>0?Wo(r,e+4,e+4+t):""},Ld=a1,o1=function(r,e){return KE(r,e)},Ic=o1,Nd=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Ot&&(Td=function(e,t){if(!Buffer.isBuffer(e))return r1(e,t);var i=e.readUInt32LE(t);return i>0?e.toString("utf8",t+4,t+4+i-1):""},Ad=function(e,t){if(!Buffer.isBuffer(e))return i1(e,t);var i=e.readUInt32LE(t);return i>0?e.toString("utf8",t+4,t+4+i-1):""},Fd=function(e,t){if(!Buffer.isBuffer(e))return n1(e,t);var i=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+i-1)},Rd=function(e,t){if(!Buffer.isBuffer(e))return s1(e,t);var i=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+i)},Ld=function(e,t){if(!Buffer.isBuffer(e))return a1(e,t);var i=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+i)},Ic=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):o1(e,t)},Nd=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});function l1(){lu=function(r,e,t){return jt.utils.decode(1200,r.slice(e,t)).replace(_i,"")},Wo=function(r,e,t){return jt.utils.decode(65001,r.slice(e,t))},Td=function(r,e){var t=ri(r,e);return t>0?jt.utils.decode(Da,r.slice(e+4,e+4+t-1)):""},Ad=function(r,e){var t=ri(r,e);return t>0?jt.utils.decode(tn,r.slice(e+4,e+4+t-1)):""},Fd=function(r,e){var t=2*ri(r,e);return t>0?jt.utils.decode(1200,r.slice(e+4,e+4+t-1)):""},Rd=function(r,e){var t=ri(r,e);return t>0?jt.utils.decode(1200,r.slice(e+4,e+4+t)):""},Ld=function(r,e){var t=ri(r,e);return t>0?jt.utils.decode(65001,r.slice(e+4,e+4+t)):""}}typeof jt<"u"&&l1();var _o=function(r,e){return r[e]},_s=function(r,e){return r[e+1]*256+r[e]},$E=function(r,e){var t=r[e+1]*256+r[e];return t<32768?t:(65535-t+1)*-1},ri=function(r,e){return r[e+3]*(1<<24)+(r[e+2]<<16)+(r[e+1]<<8)+r[e]},ya=function(r,e){return r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]},JE=function(r,e){return r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]};function Ml(r,e){var t="",i,n,s=[],a,o,l,h;switch(e){case"dbcs":if(h=this.l,Ot&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*r).toString("utf16le");else for(l=0;l<r;++l)t+=String.fromCharCode(_s(this,h)),h+=2;r*=2;break;case"utf8":t=Wo(this,this.l,this.l+r);break;case"utf16le":r*=2,t=lu(this,this.l,this.l+r);break;case"wstr":if(typeof jt<"u")t=jt.utils.decode(tn,this.slice(this.l,this.l+2*r));else return Ml.call(this,r,"dbcs");r=2*r;break;case"lpstr-ansi":t=Td(this,this.l),r=4+ri(this,this.l);break;case"lpstr-cp":t=Ad(this,this.l),r=4+ri(this,this.l);break;case"lpwstr":t=Fd(this,this.l),r=4+2*ri(this,this.l);break;case"lpp4":r=4+ri(this,this.l),t=Rd(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+ri(this,this.l),t=Ld(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,t="";(a=_o(this,this.l+r++))!==0;)s.push(_l(a));t=s.join("");break;case"_wstr":for(r=0,t="";(a=_s(this,this.l+r))!==0;)s.push(_l(a)),r+=2;r+=2,t=s.join("");break;case"dbcs-cont":for(t="",h=this.l,l=0;l<r;++l){if(this.lens&&this.lens.indexOf(h)!==-1)return a=_o(this,h),this.l=h+1,o=Ml.call(this,r-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(_l(_s(this,h))),h+=2}t=s.join(""),r*=2;break;case"cpstr":if(typeof jt<"u"){t=jt.utils.decode(tn,this.slice(this.l,this.l+r));break}case"sbcs-cont":for(t="",h=this.l,l=0;l!=r;++l){if(this.lens&&this.lens.indexOf(h)!==-1)return a=_o(this,h),this.l=h+1,o=Ml.call(this,r-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(_l(_o(this,h))),h+=1}t=s.join("");break;default:switch(r){case 1:return i=_o(this,this.l),this.l++,i;case 2:return i=(e==="i"?$E:_s)(this,this.l),this.l+=2,i;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(i=(r>0?ya:JE)(this,this.l),this.l+=4,i):(n=ri(this,this.l),this.l+=4,n);case 8:case-8:if(e==="f")return r==8?n=Ic(this,this.l):n=Ic([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;r=8;case 16:t=t1(this,this.l,r);break}}return this.l+=r,t}var ZE=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255,r[t+2]=e>>>16&255,r[t+3]=e>>>24&255},QE=function(r,e,t){r[t]=e&255,r[t+1]=e>>8&255,r[t+2]=e>>16&255,r[t+3]=e>>24&255},eC=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255};function tC(r,e,t){var i=0,n=0;if(t==="dbcs"){for(n=0;n!=e.length;++n)eC(this,e.charCodeAt(n),this.l+2*n);i=2*e.length}else if(t==="sbcs"){if(typeof jt<"u"&&Da==874)for(n=0;n!=e.length;++n){var s=jt.utils.encode(Da,e.charAt(n));this[this.l+n]=s[0]}else for(e=e.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=e.length;++n)this[this.l+n]=e.charCodeAt(n)&255;i=e.length}else if(t==="hex"){for(;n<r;++n)this[this.l++]=parseInt(e.slice(2*n,2*n+2),16)||0;return this}else if(t==="utf16le"){var a=Math.min(this.l+r,this.length);for(n=0;n<Math.min(e.length,r);++n){var o=e.charCodeAt(n);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(r){case 1:i=1,this[this.l]=e&255;break;case 2:i=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:i=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:i=4,ZE(this,e,this.l);break;case 8:if(i=8,t==="f"){YE(this,e,this.l);break}case 16:break;case-4:i=4,QE(this,e,this.l);break}return this.l+=i,this}function h1(r,e){var t=t1(this,this.l,r.length>>1);if(t!==r)throw new Error(e+"Expected "+r+" saw "+t);this.l+=r.length>>1}function oi(r,e){r.l=e,r.read_shift=Ml,r.chk=h1,r.write_shift=tC}function Si(r,e){r.l+=e}function Pe(r){var e=sa(r);return oi(e,0),e}function As(r,e,t){if(r){var i,n,s;oi(r,r.l||0);for(var a=r.length,o=0,l=0;r.l<a;){o=r.read_shift(1),o&128&&(o=(o&127)+((r.read_shift(1)&127)<<7));var h=ih[o]||ih[65535];for(i=r.read_shift(1),s=i&127,n=1;n<4&&i&128;++n)s+=((i=r.read_shift(1))&127)<<7*n;l=r.l+s;var c=h.f&&h.f(r,s,t);if(r.l=l,e(c,h,o))return}}}function Ui(){var r=[],e=Ot?256:2048,t=function(h){var c=Pe(h);return oi(c,0),c},i=t(e),n=function(){i&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&r.push(i),i=null)},s=function(h){return i&&h<i.length-i.l?i:(n(),i=t(Math.max(h+1,e)))},a=function(){return n(),ii(r)},o=function(h){n(),i=h,i.l==null&&(i.l=i.length),s(e)};return{next:s,push:o,end:a,_bufs:r}}function Be(r,e,t,i){var n=+e,s;if(!isNaN(n)){i||(i=ih[n].p||(t||[]).length||0),s=1+(n>=128?1:0)+1,i>=128&&++s,i>=16384&&++s,i>=2097152&&++s;var a=r.next(s);n<=127?a.write_shift(1,n):(a.write_shift(1,(n&127)+128),a.write_shift(1,n>>7));for(var o=0;o!=4;++o)if(i>=128)a.write_shift(1,(i&127)+128),i>>=7;else{a.write_shift(1,i);break}i>0&&Nd(t)&&r.push(t)}}function Ol(r,e,t){var i=cr(r);if(e.s?(i.cRel&&(i.c+=e.s.c),i.rRel&&(i.r+=e.s.r)):(i.cRel&&(i.c+=e.c),i.rRel&&(i.r+=e.r)),!t||t.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function Qp(r,e,t){var i=cr(r);return i.s=Ol(i.s,e.s,t),i.e=Ol(i.e,e.s,t),i}function Il(r,e){if(r.cRel&&r.c<0)for(r=cr(r);r.c<0;)r.c+=e>8?16384:256;if(r.rRel&&r.r<0)for(r=cr(r);r.r<0;)r.r+=e>8?1048576:e>5?65536:16384;var t=xt(r);return!r.cRel&&r.cRel!=null&&(t=nC(t)),!r.rRel&&r.rRel!=null&&(t=rC(t)),t}function gf(r,e){return r.s.r==0&&!r.s.rRel&&r.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+vr(r.s.c)+":"+(r.e.cRel?"":"$")+vr(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(e.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+Tr(r.s.r)+":"+(r.e.rRel?"":"$")+Tr(r.e.r):Il(r.s,e.biff)+":"+Il(r.e,e.biff)}function Pd(r){return parseInt(iC(r),10)-1}function Tr(r){return""+(r+1)}function rC(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function iC(r){return r.replace(/\$(\d+)$/,"$1")}function Dd(r){for(var e=sC(r),t=0,i=0;i!==e.length;++i)t=26*t+e.charCodeAt(i)-64;return t-1}function vr(r){if(r<0)throw new Error("invalid column "+r);var e="";for(++r;r;r=Math.floor((r-1)/26))e=String.fromCharCode((r-1)%26+65)+e;return e}function nC(r){return r.replace(/^([A-Z])/,"$$$1")}function sC(r){return r.replace(/^\$([A-Z])/,"$1")}function aC(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function yr(r){for(var e=0,t=0,i=0;i<r.length;++i){var n=r.charCodeAt(i);n>=48&&n<=57?e=10*e+(n-48):n>=65&&n<=90&&(t=26*t+(n-64))}return{c:t-1,r:e-1}}function xt(r){for(var e=r.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(r.r+1)}function Ni(r){var e=r.indexOf(":");return e==-1?{s:yr(r),e:yr(r)}:{s:yr(r.slice(0,e)),e:yr(r.slice(e+1))}}function Lt(r,e){return typeof e>"u"||typeof e=="number"?Lt(r.s,r.e):(typeof r!="string"&&(r=xt(r)),typeof e!="string"&&(e=xt(e)),r==e?r:r+":"+e)}function Ht(r){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,i=0,n=0,s=r.length;for(t=0;i<s&&!((n=r.charCodeAt(i)-64)<1||n>26);++i)t=26*t+n;for(e.s.c=--t,t=0;i<s&&!((n=r.charCodeAt(i)-48)<0||n>9);++i)t=10*t+n;if(e.s.r=--t,i===s||n!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++i,t=0;i!=s&&!((n=r.charCodeAt(i)-64)<1||n>26);++i)t=26*t+n;for(e.e.c=--t,t=0;i!=s&&!((n=r.charCodeAt(i)-48)<0||n>9);++i)t=10*t+n;return e.e.r=--t,e}function em(r,e){var t=r.t=="d"&&e instanceof Date;if(r.z!=null)try{return r.w=nn(r.z,t?Jr(e):e)}catch{}try{return r.w=nn((r.XF||{}).numFmtId||(t?14:0),t?Jr(e):e)}catch{return""+e}}function os(r,e,t){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&t&&t.dateNF&&(r.z=t.dateNF),r.t=="e"?Fs[r.v]||r.v:e==null?em(r,r.v):em(r,e))}function ca(r,e){var t=e&&e.sheet?e.sheet:"Sheet1",i={};return i[t]=r,{SheetNames:[t],Sheets:i}}function c1(r,e,t){var i=t||{},n=r?Array.isArray(r):i.dense,s=r||(n?[]:{}),a=0,o=0;if(s&&i.origin!=null){if(typeof i.origin=="number")a=i.origin;else{var l=typeof i.origin=="string"?yr(i.origin):i.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var c=Ht(s["!ref"]);h.s.c=c.s.c,h.s.r=c.s.r,h.e.c=Math.max(h.e.c,c.e.c),h.e.r=Math.max(h.e.r,c.e.r),a==-1&&(h.e.r=a=c.e.r+1)}for(var d=0;d!=e.length;++d)if(e[d]){if(!Array.isArray(e[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=e[d].length;++p)if(!(typeof e[d][p]>"u")){var f={v:e[d][p]},g=a+d,m=o+p;if(h.s.r>g&&(h.s.r=g),h.s.c>m&&(h.s.c=m),h.e.r<g&&(h.e.r=g),h.e.c<m&&(h.e.c=m),e[d][p]&&typeof e[d][p]=="object"&&!Array.isArray(e[d][p])&&!(e[d][p]instanceof Date))f=e[d][p];else if(Array.isArray(f.v)&&(f.f=e[d][p][1],f.v=f.v[0]),f.v===null)if(f.f)f.t="n";else if(i.nullError)f.t="e",f.v=0;else if(i.sheetStubs)f.t="z";else continue;else typeof f.v=="number"?f.t="n":typeof f.v=="boolean"?f.t="b":f.v instanceof Date?(f.z=i.dateNF||vt[14],i.cellDates?(f.t="d",f.w=nn(f.z,Jr(f.v))):(f.t="n",f.v=Jr(f.v),f.w=nn(f.z,f.v))):f.t="s";if(n)s[g]||(s[g]=[]),s[g][m]&&s[g][m].z&&(f.z=s[g][m].z),s[g][m]=f;else{var b=xt({c:m,r:g});s[b]&&s[b].z&&(f.z=s[b].z),s[b]=f}}}return h.s.c<1e7&&(s["!ref"]=Lt(h)),s}function Uo(r,e){return c1(null,r,e)}function oC(r){return r.read_shift(4,"i")}function zn(r,e){return e||(e=Pe(4)),e.write_shift(4,r),e}function ki(r){var e=r.read_shift(4);return e===0?"":r.read_shift(e,"dbcs")}function ni(r,e){var t=!1;return e==null&&(t=!0,e=Pe(4+2*r.length)),e.write_shift(4,r.length),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}function lC(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function hC(r,e){return e||(e=Pe(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Md(r,e){var t=r.l,i=r.read_shift(1),n=ki(r),s=[],a={t:n,h:n};if((i&1)!==0){for(var o=r.read_shift(4),l=0;l!=o;++l)s.push(lC(r));a.r=s}else a.r=[{ich:0,ifnt:0}];return r.l=t+e,a}function cC(r,e){var t=!1;return e==null&&(t=!0,e=Pe(15+4*r.t.length)),e.write_shift(1,0),ni(r.t,e),t?e.slice(0,e.l):e}var uC=Md;function fC(r,e){var t=!1;return e==null&&(t=!0,e=Pe(23+4*r.t.length)),e.write_shift(1,1),ni(r.t,e),e.write_shift(4,1),hC({},e),t?e.slice(0,e.l):e}function En(r){var e=r.read_shift(4),t=r.read_shift(2);return t+=r.read_shift(1)<<16,r.l++,{c:e,iStyleRef:t}}function Va(r,e){return e==null&&(e=Pe(8)),e.write_shift(-4,r.c),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}function Ga(r){var e=r.read_shift(2);return e+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:e}}function qa(r,e){return e==null&&(e=Pe(4)),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}var dC=ki,u1=ni;function Od(r){var e=r.read_shift(4);return e===0||e===4294967295?"":r.read_shift(e,"dbcs")}function Bc(r,e){var t=!1;return e==null&&(t=!0,e=Pe(127)),e.write_shift(4,r.length>0?r.length:4294967295),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}var pC=ki,$f=Od,Id=Bc;function Bd(r){var e=r.slice(r.l,r.l+4),t=e[0]&1,i=e[0]&2;r.l+=4;var n=i===0?Ic([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):ya(e,0)>>2;return t?n/100:n}function f1(r,e){e==null&&(e=Pe(4));var t=0,i=0,n=r*100;if(r==(r|0)&&r>=-536870912&&r<1<<29?i=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(i=1,t=1),i)e.write_shift(-4,((t?n:r)<<2)+(t+2));else throw new Error("unsupported RkNumber "+r)}function d1(r){var e={s:{},e:{}};return e.s.r=r.read_shift(4),e.e.r=r.read_shift(4),e.s.c=r.read_shift(4),e.e.c=r.read_shift(4),e}function mC(r,e){return e||(e=Pe(16)),e.write_shift(4,r.s.r),e.write_shift(4,r.e.r),e.write_shift(4,r.s.c),e.write_shift(4,r.e.c),e}var Xa=d1,Vo=mC;function Ci(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function Ia(r,e){return(e||Pe(8)).write_shift(8,r,"f")}function gC(r){var e={},t=r.read_shift(1),i=t>>>1,n=r.read_shift(1),s=r.read_shift(2,"i"),a=r.read_shift(1),o=r.read_shift(1),l=r.read_shift(1);switch(r.l++,i){case 0:e.auto=1;break;case 1:e.index=n;var h=Fa[n];h&&(e.rgb=Ql(h));break;case 2:e.rgb=Ql([a,o,l]);break;case 3:e.theme=n;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function Hc(r,e){if(e||(e=Pe(8)),!r||r.auto)return e.write_shift(4,0),e.write_shift(4,0),e;r.index!=null?(e.write_shift(1,2),e.write_shift(1,r.index)):r.theme!=null?(e.write_shift(1,6),e.write_shift(1,r.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=r.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!r.rgb||r.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var i=r.rgb||"FFFFFF";typeof i=="number"&&(i=("000000"+i.toString(16)).slice(-6)),e.write_shift(1,parseInt(i.slice(0,2),16)),e.write_shift(1,parseInt(i.slice(2,4),16)),e.write_shift(1,parseInt(i.slice(4,6),16)),e.write_shift(1,255)}return e}function vC(r){var e=r.read_shift(1);r.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function bC(r,e){e||(e=Pe(2));var t=(r.italic?2:0)|(r.strike?8:0)|(r.outline?16:0)|(r.shadow?32:0)|(r.condense?64:0)|(r.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}function p1(r,e){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},i=r.read_shift(4);switch(i){case 0:return"";case 4294967295:case 4294967294:return t[r.read_shift(4)]||""}if(i>400)throw new Error("Unsupported Clipboard: "+i.toString(16));return r.l-=4,r.read_shift(0,e==1?"lpstr":"lpwstr")}function wC(r){return p1(r,1)}function xC(r){return p1(r,2)}var Hd=2,Hi=3,cc=11,tm=12,zc=19,uc=64,yC=65,EC=71,CC=4108,_C=4126,ti=80,m1=81,kC=[ti,m1],Jf={1:{n:"CodePage",t:Hd},2:{n:"Category",t:ti},3:{n:"PresentationFormat",t:ti},4:{n:"ByteCount",t:Hi},5:{n:"LineCount",t:Hi},6:{n:"ParagraphCount",t:Hi},7:{n:"SlideCount",t:Hi},8:{n:"NoteCount",t:Hi},9:{n:"HiddenCount",t:Hi},10:{n:"MultimediaClipCount",t:Hi},11:{n:"ScaleCrop",t:cc},12:{n:"HeadingPairs",t:CC},13:{n:"TitlesOfParts",t:_C},14:{n:"Manager",t:ti},15:{n:"Company",t:ti},16:{n:"LinksUpToDate",t:cc},17:{n:"CharacterCount",t:Hi},19:{n:"SharedDoc",t:cc},22:{n:"HyperlinksChanged",t:cc},23:{n:"AppVersion",t:Hi,p:"version"},24:{n:"DigSig",t:yC},26:{n:"ContentType",t:ti},27:{n:"ContentStatus",t:ti},28:{n:"Language",t:ti},29:{n:"Version",t:ti},255:{},2147483648:{n:"Locale",t:zc},2147483651:{n:"Behavior",t:zc},1919054434:{}},Zf={1:{n:"CodePage",t:Hd},2:{n:"Title",t:ti},3:{n:"Subject",t:ti},4:{n:"Author",t:ti},5:{n:"Keywords",t:ti},6:{n:"Comments",t:ti},7:{n:"Template",t:ti},8:{n:"LastAuthor",t:ti},9:{n:"RevNumber",t:ti},10:{n:"EditTime",t:uc},11:{n:"LastPrinted",t:uc},12:{n:"CreatedDate",t:uc},13:{n:"ModifiedDate",t:uc},14:{n:"PageCount",t:Hi},15:{n:"WordCount",t:Hi},16:{n:"CharCount",t:Hi},17:{n:"Thumbnail",t:EC},18:{n:"Application",t:ti},19:{n:"DocSecurity",t:Hi},255:{},2147483648:{n:"Locale",t:zc},2147483651:{n:"Behavior",t:zc},1919054434:{}},rm={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},SC=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function TC(r){return r.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var AC=TC([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Fa=cr(AC),Fs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},g1={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Qf={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},fc={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function zd(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function FC(r){var e=zd();if(!r||!r.match)return e;var t={};if((r.match(Ti)||[]).forEach(function(i){var n=yt(i);switch(n[0].replace(HE,"<")){case"<?xml":break;case"<Types":e.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[n.Extension]=n.ContentType;break;case"<Override":e[Qf[n.ContentType]]!==void 0&&e[Qf[n.ContentType]].push(n.PartName);break}}),e.xmlns!==$r.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=t,delete e.calcchains,e}function v1(r,e){var t=FE(Qf),i=[],n;i[i.length]=Br,i[i.length]=Ke("Types",null,{xmlns:$r.CT,"xmlns:xsd":$r.xsd,"xmlns:xsi":$r.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Ke("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){r[l]&&r[l].length>0&&(n=r[l][0],i[i.length]=Ke("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:fc[l][e.bookType]||fc[l].xlsx}))},a=function(l){(r[l]||[]).forEach(function(h){i[i.length]=Ke("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:fc[l][e.bookType]||fc[l].xlsx})})},o=function(l){(r[l]||[]).forEach(function(h){i[i.length]=Ke("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:t[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var It={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Zl(r){var e=r.lastIndexOf("/");return r.slice(0,e+1)+"_rels/"+r.slice(e+1)+".rels"}function Bl(r,e){var t={"!id":{}};if(!r)return t;e.charAt(0)!=="/"&&(e="/"+e);var i={};return(r.match(Ti)||[]).forEach(function(n){var s=yt(n);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Sl(s.Target,e);t[o]=a,i[s.Id]=a}}),t["!id"]=i,t}function No(r){var e=[Br,Ke("Relationships",null,{xmlns:$r.RELS})];return Fr(r["!id"]).forEach(function(t){e[e.length]=Ke("Relationship",null,r["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function er(r,e,t,i,n,s){if(n||(n={}),r["!id"]||(r["!id"]={}),r["!idx"]||(r["!idx"]=1),e<0)for(e=r["!idx"];r["!id"]["rId"+e];++e);if(r["!idx"]=e+1,n.Id="rId"+e,n.Type=i,n.Target=t,[It.HLINK,It.XPATH,It.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),r["!id"][n.Id])throw new Error("Cannot rewrite rId "+e);return r["!id"][n.Id]=n,r[("/"+n.Target).replace("//","/")]=n,e}var RC="application/vnd.oasis.opendocument.spreadsheet";function LC(r,e){for(var t=Sd(r),i,n;i=Jl.exec(t);)switch(i[3]){case"manifest":break;case"file-entry":if(n=yt(i[0],!1),n.path=="/"&&n.type!==RC)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw i}}function NC(r){var e=[Br];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<r.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+r[t][0]+'" manifest:media-type="'+r[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function im(r,e,t){return['  <rdf:Description rdf:about="'+r+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function PC(r,e){return['  <rdf:Description rdf:about="'+r+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function DC(r){var e=[Br];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=r.length;++t)e.push(im(r[t][0],r[t][1])),e.push(PC("",r[t][0]));return e.push(im("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function b1(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+ql.version+"</meta:generator></office:meta></office:document-meta>"}var yn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],MC=(function(){for(var r=new Array(yn.length),e=0;e<yn.length;++e){var t=yn[e],i="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);r[e]=new RegExp("<"+i+"[^>]*>([\\s\\S]*?)</"+i+">")}return r})();function w1(r){var e={};r=sr(r);for(var t=0;t<yn.length;++t){var i=yn[t],n=r.match(MC[t]);n!=null&&n.length>0&&(e[i[1]]=Vt(n[1])),i[2]==="date"&&e[i[1]]&&(e[i[1]]=br(e[i[1]]))}return e}function vf(r,e,t,i,n){n[r]!=null||e==null||e===""||(n[r]=e,e=rr(e),i[i.length]=t?Ke(r,e,t):li(r,e))}function x1(r,e){var t=e||{},i=[Br,Ke("cp:coreProperties",null,{"xmlns:cp":$r.CORE_PROPS,"xmlns:dc":$r.dc,"xmlns:dcterms":$r.dcterms,"xmlns:dcmitype":$r.dcmitype,"xmlns:xsi":$r.xsi})],n={};if(!r&&!t.Props)return i.join("");r&&(r.CreatedDate!=null&&vf("dcterms:created",typeof r.CreatedDate=="string"?r.CreatedDate:Yf(r.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},i,n),r.ModifiedDate!=null&&vf("dcterms:modified",typeof r.ModifiedDate=="string"?r.ModifiedDate:Yf(r.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},i,n));for(var s=0;s!=yn.length;++s){var a=yn[s],o=t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:r?r[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&vf(a[0],o,null,i,n)}return i.length>2&&(i[i.length]="</cp:coreProperties>",i[1]=i[1].replace("/>",">")),i.join("")}var Ra=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],y1=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function E1(r,e,t,i){var n=[];if(typeof r=="string")n=Xp(r,i);else for(var s=0;s<r.length;++s)n=n.concat(r[s].map(function(c){return{v:c}}));var a=typeof e=="string"?Xp(e,i).map(function(c){return c.v}):e,o=0,l=0;if(a.length>0)for(var h=0;h!==n.length;h+=2){switch(l=+n[h+1].v,n[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=l,t.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=l,t.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":t.Chartsheets=l,t.ChartNames=a.slice(o,o+l);break}o+=l}}function OC(r,e,t){var i={};return e||(e={}),r=sr(r),Ra.forEach(function(n){var s=(r.match(Yl(n[0]))||[])[1];switch(n[2]){case"string":s&&(e[n[1]]=Vt(s));break;case"bool":e[n[1]]=s==="true";break;case"raw":var a=r.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));a&&a.length>0&&(i[n[1]]=a[1]);break}}),i.HeadingPairs&&i.TitlesOfParts&&E1(i.HeadingPairs,i.TitlesOfParts,e,t),e}function C1(r){var e=[],t=Ke;return r||(r={}),r.Application="SheetJS",e[e.length]=Br,e[e.length]=Ke("Properties",null,{xmlns:$r.EXT_PROPS,"xmlns:vt":$r.vt}),Ra.forEach(function(i){if(r[i[1]]!==void 0){var n;switch(i[2]){case"string":n=rr(String(r[i[1]]));break;case"bool":n=r[i[1]]?"true":"false";break}n!==void 0&&(e[e.length]=t(i[0],n))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",r.SheetNames.map(function(i){return"<vt:lpstr>"+rr(i)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var IC=/<[^>]+>[^<]*/g;function BC(r,e){var t={},i="",n=r.match(IC);if(n)for(var s=0;s!=n.length;++s){var a=n[s],o=yt(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":i=Vt(o.name);break;case"</property>":i=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),h=l[0].slice(4),c=l[1];switch(h){case"lpstr":case"bstr":case"lpwstr":t[i]=Vt(c);break;case"bool":t[i]=mr(c);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[i]=parseInt(c,10);break;case"r4":case"r8":case"decimal":t[i]=parseFloat(c);break;case"filetime":case"date":t[i]=br(c);break;case"cy":case"error":t[i]=Vt(c);break;default:if(h.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,h,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return t}function _1(r){var e=[Br,Ke("Properties",null,{xmlns:$r.CUST_PROPS,"xmlns:vt":$r.vt})];if(!r)return e.join("");var t=1;return Fr(r).forEach(function(n){++t,e[e.length]=Ke("property",XE(r[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:rr(n)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var ed={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},bf;function HC(r,e,t){bf||(bf=su(ed)),e=bf[e]||e,r[e]=t}function zC(r,e){var t=[];return Fr(ed).map(function(i){for(var n=0;n<yn.length;++n)if(yn[n][1]==i)return yn[n];for(n=0;n<Ra.length;++n)if(Ra[n][1]==i)return Ra[n];throw i}).forEach(function(i){if(r[i[1]]!=null){var n=e&&e.Props&&e.Props[i[1]]!=null?e.Props[i[1]]:r[i[1]];switch(i[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),t.push(li(ed[i[1]]||i[1],n))}}),Ke("DocumentProperties",t.join(""),{xmlns:Zi.o})}function jC(r,e){var t=["Worksheets","SheetNames"],i="CustomDocumentProperties",n=[];return r&&Fr(r).forEach(function(s){if(Object.prototype.hasOwnProperty.call(r,s)){for(var a=0;a<yn.length;++a)if(s==yn[a][1])return;for(a=0;a<Ra.length;++a)if(s==Ra[a][1])return;for(a=0;a<t.length;++a)if(s==t[a])return;var o=r[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),n.push(Ke(Up(s),o,{"dt:dt":l}))}}),e&&Fr(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(r&&Object.prototype.hasOwnProperty.call(r,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),n.push(Ke(Up(s),a,{"dt:dt":o}))}}),"<"+i+' xmlns="'+Zi.o+'">'+n.join("")+"</"+i+">"}function jd(r){var e=r.read_shift(4),t=r.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function WC(r){var e=typeof r=="string"?new Date(Date.parse(r)):r,t=e.getTime()/1e3+11644473600,i=t%Math.pow(2,32),n=(t-i)/Math.pow(2,32);i*=1e7,n*=1e7;var s=i/Math.pow(2,32)|0;s>0&&(i=i%Math.pow(2,32),n+=s);var a=Pe(8);return a.write_shift(4,i),a.write_shift(4,n),a}function k1(r,e,t){var i=r.l,n=r.read_shift(0,"lpstr-cp");if(t)for(;r.l-i&3;)++r.l;return n}function S1(r,e,t){var i=r.read_shift(0,"lpwstr");return i}function T1(r,e,t){return e===31?S1(r):k1(r,e,t)}function td(r,e,t){return T1(r,e,t===!1?0:4)}function UC(r,e){if(!e)throw new Error("VtUnalignedString must have positive length");return T1(r,e,0)}function VC(r){for(var e=r.read_shift(4),t=[],i=0;i!=e;++i){var n=r.l;t[i]=r.read_shift(0,"lpwstr").replace(_i,""),r.l-n&2&&(r.l+=2)}return t}function GC(r){for(var e=r.read_shift(4),t=[],i=0;i!=e;++i)t[i]=r.read_shift(0,"lpstr-cp").replace(_i,"");return t}function qC(r){var e=r.l,t=jc(r,m1);r[r.l]==0&&r[r.l+1]==0&&r.l-e&2&&(r.l+=2);var i=jc(r,Hi);return[t,i]}function XC(r){for(var e=r.read_shift(4),t=[],i=0;i<e/2;++i)t.push(qC(r));return t}function nm(r,e){for(var t=r.read_shift(4),i={},n=0;n!=t;++n){var s=r.read_shift(4),a=r.read_shift(4);i[s]=r.read_shift(a,e===1200?"utf16le":"utf8").replace(_i,"").replace(kl,"!"),e===1200&&a%2&&(r.l+=2)}return r.l&3&&(r.l=r.l>>3<<2),i}function A1(r){var e=r.read_shift(4),t=r.slice(r.l,r.l+e);return r.l+=e,(e&3)>0&&(r.l+=4-(e&3)&3),t}function KC(r){var e={};return e.Size=r.read_shift(4),r.l+=e.Size+3-(e.Size-1)%4,e}function jc(r,e,t){var i=r.read_shift(2),n,s=t||{};if(r.l+=2,e!==tm&&i!==e&&kC.indexOf(e)===-1&&!((e&65534)==4126&&(i&65534)==4126))throw new Error("Expected type "+e+" saw "+i);switch(e===tm?i:e){case 2:return n=r.read_shift(2,"i"),s.raw||(r.l+=2),n;case 3:return n=r.read_shift(4,"i"),n;case 11:return r.read_shift(4)!==0;case 19:return n=r.read_shift(4),n;case 30:return k1(r,i,4).replace(_i,"");case 31:return S1(r);case 64:return jd(r);case 65:return A1(r);case 71:return KC(r);case 80:return td(r,i,!s.raw).replace(_i,"");case 81:return UC(r,i).replace(_i,"");case 4108:return XC(r);case 4126:case 4127:return i==4127?VC(r):GC(r);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+i)}}function sm(r,e){var t=Pe(4),i=Pe(4);switch(t.write_shift(4,r==80?31:r),r){case 3:i.write_shift(-4,e);break;case 5:i=Pe(8),i.write_shift(8,e,"f");break;case 11:i.write_shift(4,e?1:0);break;case 64:i=WC(e);break;case 31:case 80:for(i=Pe(4+2*(e.length+1)+(e.length%2?0:2)),i.write_shift(4,e.length+1),i.write_shift(0,e,"dbcs");i.l!=i.length;)i.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+e)}return ii([t,i])}function am(r,e){var t=r.l,i=r.read_shift(4),n=r.read_shift(4),s=[],a=0,o=0,l=-1,h={};for(a=0;a!=n;++a){var c=r.read_shift(4),d=r.read_shift(4);s[a]=[c,d+t]}s.sort(function(E,C){return E[1]-C[1]});var p={};for(a=0;a!=n;++a){if(r.l!==s[a][1]){var f=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:r.l+2===s[a][1]&&(r.l+=2,f=!1);break;case 80:r.l<=s[a][1]&&(r.l=s[a][1],f=!1);break;case 4108:r.l<=s[a][1]&&(r.l=s[a][1],f=!1);break}if((!e||a==0)&&r.l<=s[a][1]&&(f=!1,r.l=s[a][1]),f)throw new Error("Read Error: Expected address "+s[a][1]+" at "+r.l+" :"+a)}if(e){var g=e[s[a][0]];if(p[g.n]=jc(r,g.t,{raw:!0}),g.p==="version"&&(p[g.n]=String(p[g.n]>>16)+"."+("0000"+String(p[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(p[g.n]){case 0:p[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:xn(o=p[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[g.n])}}else if(s[a][0]===1){if(o=p.CodePage=jc(r,Hd),xn(o),l!==-1){var m=r.l;r.l=s[l][1],h=nm(r,o),r.l=m}}else if(s[a][0]===0){if(o===0){l=a,r.l=s[a+1][1];continue}h=nm(r,o)}else{var b=h[s[a][0]],w;switch(r[r.l]){case 65:r.l+=4,w=A1(r);break;case 30:r.l+=4,w=td(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 31:r.l+=4,w=td(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 3:r.l+=4,w=r.read_shift(4,"i");break;case 19:r.l+=4,w=r.read_shift(4);break;case 5:r.l+=4,w=r.read_shift(8,"f");break;case 11:r.l+=4,w=Pr(r,4);break;case 64:r.l+=4,w=br(jd(r));break;default:throw new Error("unparsed value: "+r[r.l])}p[b]=w}}return r.l=t+i,p}var F1=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function YC(r){switch(typeof r){case"boolean":return 11;case"number":return(r|0)==r?3:5;case"string":return 31;case"object":if(r instanceof Date)return 64;break}return-1}function om(r,e,t){var i=Pe(8),n=[],s=[],a=8,o=0,l=Pe(8),h=Pe(8);if(l.write_shift(4,2),l.write_shift(4,1200),h.write_shift(4,1),s.push(l),n.push(h),a+=8+l.length,!e){h=Pe(8),h.write_shift(4,0),n.unshift(h);var c=[Pe(4)];for(c[0].write_shift(4,r.length),o=0;o<r.length;++o){var d=r[o][0];for(l=Pe(8+2*(d.length+1)+(d.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,d.length+1),l.write_shift(0,d,"dbcs");l.l!=l.length;)l.write_shift(1,0);c.push(l)}l=ii(c),s.unshift(l),a+=8+l.length}for(o=0;o<r.length;++o)if(!(e&&!e[r[o][0]])&&!(F1.indexOf(r[o][0])>-1||y1.indexOf(r[o][0])>-1)&&r[o][1]!=null){var p=r[o][1],f=0;if(e){f=+e[r[o][0]];var g=t[f];if(g.p=="version"&&typeof p=="string"){var m=p.split(".");p=(+m[0]<<16)+(+m[1]||0)}l=sm(g.t,p)}else{var b=YC(p);b==-1&&(b=31,p=String(p)),l=sm(b,p)}s.push(l),h=Pe(8),h.write_shift(4,e?f:2+o),n.push(h),a+=8+l.length}var w=8*(s.length+1);for(o=0;o<s.length;++o)n[o].write_shift(4,w),w+=s[o].length;return i.write_shift(4,a),i.write_shift(4,s.length),ii([i].concat(n).concat(s))}function lm(r,e,t){var i=r.content;if(!i)return{};oi(i,0);var n,s,a,o,l=0;i.chk("feff","Byte Order: "),i.read_shift(2);var h=i.read_shift(4),c=i.read_shift(16);if(c!==ut.utils.consts.HEADER_CLSID&&c!==t)throw new Error("Bad PropertySet CLSID "+c);if(n=i.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(s=i.read_shift(16),o=i.read_shift(4),n===1&&o!==i.l)throw new Error("Length mismatch: "+o+" !== "+i.l);n===2&&(a=i.read_shift(16),l=i.read_shift(4));var d=am(i,e),p={SystemIdentifier:h};for(var f in d)p[f]=d[f];if(p.FMTID=s,n===1)return p;if(l-i.l==2&&(i.l+=2),i.l!==l)throw new Error("Length mismatch 2: "+i.l+" !== "+l);var g;try{g=am(i,null)}catch{}for(f in g)p[f]=g[f];return p.FMTID=[s,a],p}function hm(r,e,t,i,n,s){var a=Pe(n?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,ut.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,n?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,n?68:48);var l=om(r,t,i);if(o.push(l),n){var h=om(n,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(h)}return ii(o)}function Ks(r,e){return r.read_shift(e),null}function $C(r,e){e||(e=Pe(r));for(var t=0;t<r;++t)e.write_shift(1,0);return e}function JC(r,e,t){for(var i=[],n=r.l+e;r.l<n;)i.push(t(r,n-r.l));if(n!==r.l)throw new Error("Slurp error");return i}function Pr(r,e){return r.read_shift(e)===1}function Ri(r,e){return e||(e=Pe(2)),e.write_shift(2,+!!r),e}function Gr(r){return r.read_shift(2,"u")}function wn(r,e){return e||(e=Pe(2)),e.write_shift(2,r),e}function R1(r,e){return JC(r,e,Gr)}function ZC(r){var e=r.read_shift(1),t=r.read_shift(1);return t===1?e:e===1}function L1(r,e,t){return t||(t=Pe(2)),t.write_shift(1,e=="e"?+r:+!!r),t.write_shift(1,e=="e"?1:0),t}function ph(r,e,t){var i=r.read_shift(t&&t.biff>=12?2:1),n="sbcs-cont",s=tn;if(t&&t.biff>=8&&(tn=1200),!t||t.biff==8){var a=r.read_shift(1);a&&(n="dbcs-cont")}else t.biff==12&&(n="wstr");t.biff>=2&&t.biff<=5&&(n="cpstr");var o=i?r.read_shift(i,n):"";return tn=s,o}function QC(r){var e=tn;tn=1200;var t=r.read_shift(2),i=r.read_shift(1),n=i&4,s=i&8,a=1+(i&1),o=0,l,h={};s&&(o=r.read_shift(2)),n&&(l=r.read_shift(4));var c=a==2?"dbcs-cont":"sbcs-cont",d=t===0?"":r.read_shift(t,c);return s&&(r.l+=4*o),n&&(r.l+=l),h.t=d,s||(h.raw="<t>"+h.t+"</t>",h.r=h.t),tn=e,h}function e4(r){var e=r.t||"",t=Pe(3);t.write_shift(2,e.length),t.write_shift(1,1);var i=Pe(2*e.length);i.write_shift(2*e.length,e,"utf16le");var n=[t,i];return ii(n)}function Ba(r,e,t){var i;if(t){if(t.biff>=2&&t.biff<=5)return r.read_shift(e,"cpstr");if(t.biff>=12)return r.read_shift(e,"dbcs-cont")}var n=r.read_shift(1);return n===0?i=r.read_shift(e,"sbcs-cont"):i=r.read_shift(e,"dbcs-cont"),i}function mh(r,e,t){var i=r.read_shift(t&&t.biff==2?1:2);return i===0?(r.l++,""):Ba(r,i,t)}function Ka(r,e,t){if(t.biff>5)return mh(r,e,t);var i=r.read_shift(1);return i===0?(r.l++,""):r.read_shift(i,t.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function N1(r,e,t){return t||(t=Pe(3+2*r.length)),t.write_shift(2,r.length),t.write_shift(1,1),t.write_shift(31,r,"utf16le"),t}function t4(r){var e=r.read_shift(1);r.l++;var t=r.read_shift(2);return r.l+=2,[e,t]}function r4(r){var e=r.read_shift(4),t=r.l,i=!1;e>24&&(r.l+=e-24,r.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(i=!0),r.l=t);var n=r.read_shift((i?e-24:e)>>1,"utf16le").replace(_i,"");return i&&(r.l+=24),n}function i4(r){for(var e=r.read_shift(2),t="";e-- >0;)t+="../";var i=r.read_shift(0,"lpstr-ansi");if(r.l+=2,r.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=r.read_shift(4);if(n===0)return t+i.replace(/\\/g,"/");var s=r.read_shift(4);if(r.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=r.read_shift(s>>1,"utf16le").replace(_i,"");return t+a}function n4(r,e){var t=r.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return r4(r);case"0303000000000000c000000000000046":return i4(r);default:throw new Error("Unsupported Moniker "+t)}}function dc(r){var e=r.read_shift(4),t=e>0?r.read_shift(e,"utf16le").replace(_i,""):"";return t}function cm(r,e){e||(e=Pe(6+r.length*2)),e.write_shift(4,1+r.length);for(var t=0;t<r.length;++t)e.write_shift(2,r.charCodeAt(t));return e.write_shift(2,0),e}function s4(r,e){var t=r.l+e,i=r.read_shift(4);if(i!==2)throw new Error("Unrecognized streamVersion: "+i);var n=r.read_shift(2);r.l+=2;var s,a,o,l,h="",c,d;n&16&&(s=dc(r,t-r.l)),n&128&&(a=dc(r,t-r.l)),(n&257)===257&&(o=dc(r,t-r.l)),(n&257)===1&&(l=n4(r,t-r.l)),n&8&&(h=dc(r,t-r.l)),n&32&&(c=r.read_shift(16)),n&64&&(d=jd(r)),r.l=t;var p=a||o||l||"";p&&h&&(p+="#"+h),p||(p="#"+h),n&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var f={Target:p};return c&&(f.guid=c),d&&(f.time=d),s&&(f.Tooltip=s),f}function a4(r){var e=Pe(512),t=0,i=r.Target;i.slice(0,7)=="file://"&&(i=i.slice(7));var n=i.indexOf("#"),s=n>-1?31:23;switch(i.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(t=0;t<a.length;++t)e.write_shift(4,a[t]);if(s==28)i=i.slice(1),cm(i,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));var o=n>-1?i.slice(0,n):i;for(e.write_shift(4,2*(o.length+1)),t=0;t<o.length;++t)e.write_shift(2,o.charCodeAt(t));e.write_shift(2,0),s&8&&cm(n>-1?i.slice(n+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));for(var l=0;i.slice(l*3,l*3+3)=="../"||i.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,i.length-3*l+1),t=0;t<i.length-3*l;++t)e.write_shift(1,i.charCodeAt(t+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function P1(r){var e=r.read_shift(1),t=r.read_shift(1),i=r.read_shift(1),n=r.read_shift(1);return[e,t,i,n]}function D1(r,e){var t=P1(r);return t[3]=0,t}function cs(r){var e=r.read_shift(2),t=r.read_shift(2),i=r.read_shift(2);return{r:e,c:t,ixfe:i}}function Ha(r,e,t,i){return i||(i=Pe(6)),i.write_shift(2,r),i.write_shift(2,e),i.write_shift(2,t||0),i}function o4(r){var e=r.read_shift(2),t=r.read_shift(2);return r.l+=8,{type:e,flags:t}}function l4(r,e,t){return e===0?"":Ka(r,e,t)}function h4(r,e,t){var i=t.biff>8?4:2,n=r.read_shift(i),s=r.read_shift(i,"i"),a=r.read_shift(i,"i");return[n,s,a]}function M1(r){var e=r.read_shift(2),t=Bd(r);return[e,t]}function c4(r,e,t){r.l+=4,e-=4;var i=r.l+e,n=ph(r,e,t),s=r.read_shift(2);if(i-=r.l,s!==i)throw new Error("Malformed AddinUdf: padding = "+i+" != "+s);return r.l+=s,n}function hu(r){var e=r.read_shift(2),t=r.read_shift(2),i=r.read_shift(2),n=r.read_shift(2);return{s:{c:i,r:e},e:{c:n,r:t}}}function O1(r,e){return e||(e=Pe(8)),e.write_shift(2,r.s.r),e.write_shift(2,r.e.r),e.write_shift(2,r.s.c),e.write_shift(2,r.e.c),e}function I1(r){var e=r.read_shift(2),t=r.read_shift(2),i=r.read_shift(1),n=r.read_shift(1);return{s:{c:i,r:e},e:{c:n,r:t}}}var u4=I1;function B1(r){r.l+=4;var e=r.read_shift(2),t=r.read_shift(2),i=r.read_shift(2);return r.l+=12,[t,e,i]}function f4(r){var e={};return r.l+=4,r.l+=16,e.fSharedNote=r.read_shift(2),r.l+=4,e}function d4(r){var e={};return r.l+=4,r.cf=r.read_shift(2),e}function vi(r){r.l+=2,r.l+=r.read_shift(2)}var p4={0:vi,4:vi,5:vi,6:vi,7:d4,8:vi,9:vi,10:vi,11:vi,12:vi,13:f4,14:vi,15:vi,16:vi,17:vi,18:vi,19:vi,20:vi,21:B1};function m4(r,e){for(var t=r.l+e,i=[];r.l<t;){var n=r.read_shift(2);r.l-=2;try{i.push(p4[n](r,t-r.l))}catch{return r.l=t,i}}return r.l!=t&&(r.l=t),i}function pc(r,e){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=r.read_shift(2),e-=2,e>=2&&(t.dt=r.read_shift(2),r.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return r.read_shift(e),t}function Wd(r,e,t){var i=1536,n=16;switch(t.bookType){case"biff8":break;case"biff5":i=1280,n=8;break;case"biff4":i=4,n=6;break;case"biff3":i=3,n=6;break;case"biff2":i=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Pe(n);return s.write_shift(2,i),s.write_shift(2,e),n>4&&s.write_shift(2,29282),n>6&&s.write_shift(2,1997),n>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function g4(r,e){return e===0||r.read_shift(2),1200}function v4(r,e,t){if(t.enc)return r.l+=e,"";var i=r.l,n=Ka(r,0,t);return r.read_shift(e+i-r.l),n}function b4(r,e){var t=!e||e.biff==8,i=Pe(t?112:54);for(i.write_shift(e.biff==8?2:1,7),t&&i.write_shift(1,0),i.write_shift(4,859007059),i.write_shift(4,5458548|(t?0:536870912));i.l<i.length;)i.write_shift(1,t?0:32);return i}function w4(r,e,t){var i=t&&t.biff==8||e==2?r.read_shift(2):(r.l+=e,0);return{fDialog:i&16,fBelow:i&64,fRight:i&128}}function x4(r,e,t){var i=r.read_shift(4),n=r.read_shift(1)&3,s=r.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=ph(r,0,t);return a.length===0&&(a="Sheet1"),{pos:i,hs:n,dt:s,name:a}}function y4(r,e){var t=!e||e.biff>=8?2:1,i=Pe(8+t*r.name.length);i.write_shift(4,r.pos),i.write_shift(1,r.hs||0),i.write_shift(1,r.dt),i.write_shift(1,r.name.length),e.biff>=8&&i.write_shift(1,1),i.write_shift(t*r.name.length,r.name,e.biff<8?"sbcs":"utf16le");var n=i.slice(0,i.l);return n.l=i.l,n}function E4(r,e){for(var t=r.l+e,i=r.read_shift(4),n=r.read_shift(4),s=[],a=0;a!=n&&r.l<t;++a)s.push(QC(r));return s.Count=i,s.Unique=n,s}function C4(r,e){var t=Pe(8);t.write_shift(4,r.Count),t.write_shift(4,r.Unique);for(var i=[],n=0;n<r.length;++n)i[n]=e4(r[n]);var s=ii([t].concat(i));return s.parts=[t.length].concat(i.map(function(a){return a.length})),s}function _4(r,e){var t={};return t.dsst=r.read_shift(2),r.l+=e-2,t}function k4(r){var e={};e.r=r.read_shift(2),e.c=r.read_shift(2),e.cnt=r.read_shift(2)-e.c;var t=r.read_shift(2);r.l+=4;var i=r.read_shift(1);return r.l+=3,i&7&&(e.level=i&7),i&32&&(e.hidden=!0),i&64&&(e.hpt=t/20),e}function S4(r){var e=o4(r);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var t=r.read_shift(4);return t!==0}function T4(r){return r.read_shift(2),r.read_shift(4)}function um(r,e,t){var i=0;t&&t.biff==2||(i=r.read_shift(2));var n=r.read_shift(2);t&&t.biff==2&&(i=1-(n>>15),n&=32767);var s={Unsynced:i&1,DyZero:(i&2)>>1,ExAsc:(i&4)>>2,ExDsc:(i&8)>>3};return[s,n]}function A4(r){var e=r.read_shift(2),t=r.read_shift(2),i=r.read_shift(2),n=r.read_shift(2),s=r.read_shift(2),a=r.read_shift(2),o=r.read_shift(2),l=r.read_shift(2),h=r.read_shift(2);return{Pos:[e,t],Dim:[i,n],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:h}}function F4(){var r=Pe(18);return r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,29280),r.write_shift(2,17600),r.write_shift(2,56),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,1),r.write_shift(2,500),r}function R4(r,e,t){if(t&&t.biff>=2&&t.biff<5)return{};var i=r.read_shift(2);return{RTL:i&64}}function L4(r){var e=Pe(18),t=1718;return r&&r.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function N4(){}function P4(r,e,t){var i={dyHeight:r.read_shift(2),fl:r.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:r.l+=2;break;default:r.l+=10;break}return i.name=ph(r,0,t),i}function D4(r,e){var t=r.name||"Arial",i=e&&e.biff==5,n=i?15+t.length:16+2*t.length,s=Pe(n);return s.write_shift(2,r.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,t.length),i||s.write_shift(1,1),s.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le"),s}function M4(r){var e=cs(r);return e.isst=r.read_shift(4),e}function O4(r,e,t,i){var n=Pe(10);return Ha(r,e,i,n),n.write_shift(4,t),n}function I4(r,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var i=r.l+e,n=cs(r);t.biff==2&&r.l++;var s=mh(r,i-r.l,t);return n.val=s,n}function B4(r,e,t,i,n){var s=!n||n.biff==8,a=Pe(8+ +s+(1+s)*t.length);return Ha(r,e,i,a),a.write_shift(2,t.length),s&&a.write_shift(1,1),a.write_shift((1+s)*t.length,t,s?"utf16le":"sbcs"),a}function H4(r,e,t){var i=r.read_shift(2),n=Ka(r,0,t);return[i,n]}function z4(r,e,t,i){var n=t&&t.biff==5;i||(i=Pe(n?3+e.length:5+2*e.length)),i.write_shift(2,r),i.write_shift(n?1:2,e.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*e.length,e,n?"sbcs":"utf16le");var s=i.length>i.l?i.slice(0,i.l):i;return s.l==null&&(s.l=s.length),s}var j4=Ka;function fm(r,e,t){var i=r.l+e,n=t.biff==8||!t.biff?4:2,s=r.read_shift(n),a=r.read_shift(n),o=r.read_shift(2),l=r.read_shift(2);return r.l=i,{s:{r:s,c:o},e:{r:a,c:l}}}function W4(r,e){var t=e.biff==8||!e.biff?4:2,i=Pe(2*t+6);return i.write_shift(t,r.s.r),i.write_shift(t,r.e.r+1),i.write_shift(2,r.s.c),i.write_shift(2,r.e.c+1),i.write_shift(2,0),i}function U4(r){var e=r.read_shift(2),t=r.read_shift(2),i=M1(r);return{r:e,c:t,ixfe:i[0],rknum:i[1]}}function V4(r,e){for(var t=r.l+e-2,i=r.read_shift(2),n=r.read_shift(2),s=[];r.l<t;)s.push(M1(r));if(r.l!==t)throw new Error("MulRK read error");var a=r.read_shift(2);if(s.length!=a-n+1)throw new Error("MulRK length mismatch");return{r:i,c:n,C:a,rkrec:s}}function G4(r,e){for(var t=r.l+e-2,i=r.read_shift(2),n=r.read_shift(2),s=[];r.l<t;)s.push(r.read_shift(2));if(r.l!==t)throw new Error("MulBlank read error");var a=r.read_shift(2);if(s.length!=a-n+1)throw new Error("MulBlank length mismatch");return{r:i,c:n,C:a,ixfe:s}}function q4(r,e,t,i){var n={},s=r.read_shift(4),a=r.read_shift(4),o=r.read_shift(4),l=r.read_shift(2);return n.patternType=SC[o>>26],i.cellStyles&&(n.alc=s&7,n.fWrap=s>>3&1,n.alcV=s>>4&7,n.fJustLast=s>>7&1,n.trot=s>>8&255,n.cIndent=s>>16&15,n.fShrinkToFit=s>>20&1,n.iReadOrder=s>>22&2,n.fAtrNum=s>>26&1,n.fAtrFnt=s>>27&1,n.fAtrAlc=s>>28&1,n.fAtrBdr=s>>29&1,n.fAtrPat=s>>30&1,n.fAtrProt=s>>31&1,n.dgLeft=a&15,n.dgRight=a>>4&15,n.dgTop=a>>8&15,n.dgBottom=a>>12&15,n.icvLeft=a>>16&127,n.icvRight=a>>23&127,n.grbitDiag=a>>30&3,n.icvTop=o&127,n.icvBottom=o>>7&127,n.icvDiag=o>>14&127,n.dgDiag=o>>21&15,n.icvFore=l&127,n.icvBack=l>>7&127,n.fsxButton=l>>14&1),n}function X4(r,e,t){var i={};return i.ifnt=r.read_shift(2),i.numFmtId=r.read_shift(2),i.flags=r.read_shift(2),i.fStyle=i.flags>>2&1,e-=6,i.data=q4(r,e,i.fStyle,t),i}function dm(r,e,t,i){var n=t&&t.biff==5;i||(i=Pe(n?16:20)),i.write_shift(2,0),r.style?(i.write_shift(2,r.numFmtId||0),i.write_shift(2,65524)):(i.write_shift(2,r.numFmtId||0),i.write_shift(2,e<<4));var s=0;return r.numFmtId>0&&n&&(s|=1024),i.write_shift(4,s),i.write_shift(4,0),n||i.write_shift(4,0),i.write_shift(2,0),i}function K4(r){r.l+=4;var e=[r.read_shift(2),r.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function Y4(r){var e=Pe(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function pm(r,e,t){var i=cs(r);(t.biff==2||e==9)&&++r.l;var n=ZC(r);return i.val=n,i.t=n===!0||n===!1?"b":"e",i}function $4(r,e,t,i,n,s){var a=Pe(8);return Ha(r,e,i,a),L1(t,s,a),a}function J4(r,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var i=cs(r),n=Ci(r);return i.val=n,i}function Z4(r,e,t,i){var n=Pe(14);return Ha(r,e,i,n),Ia(t,n),n}var mm=l4;function Q4(r,e,t){var i=r.l+e,n=r.read_shift(2),s=r.read_shift(2);if(t.sbcch=s,s==1025||s==14849)return[s,n];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=Ba(r,s),o=[];i>r.l;)o.push(mh(r));return[s,n,a,o]}function gm(r,e,t){var i=r.read_shift(2),n,s={fBuiltIn:i&1,fWantAdvise:i>>>1&1,fWantPict:i>>>2&1,fOle:i>>>3&1,fOleLink:i>>>4&1,cf:i>>>5&1023,fIcon:i>>>15&1};return t.sbcch===14849&&(n=c4(r,e-2,t)),s.body=n||r.read_shift(e-2),typeof n=="string"&&(s.Name=n),s}var e3=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function vm(r,e,t){var i=r.l+e,n=r.read_shift(2),s=r.read_shift(1),a=r.read_shift(1),o=r.read_shift(t&&t.biff==2?1:2),l=0;(!t||t.biff>=5)&&(t.biff!=5&&(r.l+=2),l=r.read_shift(2),t.biff==5&&(r.l+=2),r.l+=4);var h=Ba(r,a,t);n&32&&(h=e3[h.charCodeAt(0)]);var c=i-r.l;t&&t.biff==2&&--c;var d=i==r.l||o===0||!(c>0)?[]:mT(r,c,t,o);return{chKey:s,Name:h,itab:l,rgce:d}}function H1(r,e,t){if(t.biff<8)return t3(r,e,t);for(var i=[],n=r.l+e,s=r.read_shift(t.biff>8?4:2);s--!==0;)i.push(h4(r,t.biff>8?12:6,t));if(r.l!=n)throw new Error("Bad ExternSheet: "+r.l+" != "+n);return i}function t3(r,e,t){r[r.l+1]==3&&r[r.l]++;var i=ph(r,e,t);return i.charCodeAt(0)==3?i.slice(1):i}function r3(r,e,t){if(t.biff<8){r.l+=e;return}var i=r.read_shift(2),n=r.read_shift(2),s=Ba(r,i,t),a=Ba(r,n,t);return[s,a]}function i3(r,e,t){var i=I1(r);r.l++;var n=r.read_shift(1);return e-=8,[gT(r,e,t),n,i]}function bm(r,e,t){var i=u4(r);switch(t.biff){case 2:r.l++,e-=7;break;case 3:case 4:r.l+=2,e-=8;break;default:r.l+=6,e-=12}return[i,dT(r,e,t)]}function n3(r){var e=r.read_shift(4)!==0,t=r.read_shift(4)!==0,i=r.read_shift(4);return[e,t,i]}function s3(r,e,t){if(!(t.biff<8)){var i=r.read_shift(2),n=r.read_shift(2),s=r.read_shift(2),a=r.read_shift(2),o=Ka(r,0,t);return t.biff<8&&r.read_shift(1),[{r:i,c:n},o,a,s]}}function a3(r,e,t){return s3(r,e,t)}function o3(r,e){for(var t=[],i=r.read_shift(2);i--;)t.push(hu(r));return t}function l3(r){var e=Pe(2+r.length*8);e.write_shift(2,r.length);for(var t=0;t<r.length;++t)O1(r[t],e);return e}function h3(r,e,t){if(t&&t.biff<8)return u3(r,e,t);var i=B1(r),n=m4(r,e-22,i[1]);return{cmo:i,ft:n}}var c3={8:function(r,e){var t=r.l+e;r.l+=10;var i=r.read_shift(2);r.l+=4,r.l+=2,r.l+=2,r.l+=2,r.l+=4;var n=r.read_shift(1);return r.l+=n,r.l=t,{fmt:i}}};function u3(r,e,t){r.l+=4;var i=r.read_shift(2),n=r.read_shift(2),s=r.read_shift(2);r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=6,e-=36;var a=[];return a.push((c3[i]||Si)(r,e,t)),{cmo:[n,i,s],ft:a}}function f3(r,e,t){var i=r.l,n="";try{r.l+=4;var s=(t.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?r.l+=6:a=t4(r,6,t);var o=r.read_shift(2);r.read_shift(2),Gr(r,2);var l=r.read_shift(2);r.l+=l;for(var h=1;h<r.lens.length-1;++h){if(r.l-i!=r.lens[h])throw new Error("TxO: bad continue record");var c=r[r.l],d=Ba(r,r.lens[h+1]-r.lens[h]-1);if(n+=d,n.length>=(c?o:2*o))break}if(n.length!==o&&n.length!==o*2)throw new Error("cchText: "+o+" != "+n.length);return r.l=i+e,{t:n}}catch{return r.l=i+e,{t:n}}}function d3(r,e){var t=hu(r);r.l+=16;var i=s4(r,e-24);return[t,i]}function p3(r){var e=Pe(24),t=yr(r[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var i="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)e.write_shift(1,parseInt(i[n],16));return ii([e,a4(r[1])])}function m3(r,e){r.read_shift(2);var t=hu(r),i=r.read_shift((e-10)/2,"dbcs-cont");return i=i.replace(_i,""),[t,i]}function g3(r){var e=r[1].Tooltip,t=Pe(10+2*(e.length+1));t.write_shift(2,2048);var i=yr(r[0]);t.write_shift(2,i.r),t.write_shift(2,i.r),t.write_shift(2,i.c),t.write_shift(2,i.c);for(var n=0;n<e.length;++n)t.write_shift(2,e.charCodeAt(n));return t.write_shift(2,0),t}function v3(r){var e=[0,0],t;return t=r.read_shift(2),e[0]=rm[t]||t,t=r.read_shift(2),e[1]=rm[t]||t,e}function b3(r){return r||(r=Pe(4)),r.write_shift(2,1),r.write_shift(2,1),r}function w3(r){for(var e=r.read_shift(2),t=[];e-- >0;)t.push(D1(r));return t}function x3(r){for(var e=r.read_shift(2),t=[];e-- >0;)t.push(D1(r));return t}function y3(r){r.l+=2;var e={cxfs:0,crc:0};return e.cxfs=r.read_shift(2),e.crc=r.read_shift(4),e}function z1(r,e,t){if(!t.cellStyles)return Si(r,e);var i=t&&t.biff>=12?4:2,n=r.read_shift(i),s=r.read_shift(i),a=r.read_shift(i),o=r.read_shift(i),l=r.read_shift(2);i==2&&(r.l+=2);var h={s:n,e:s,w:a,ixfe:o,flags:l};return(t.biff>=5||!t.biff)&&(h.level=l>>8&7),h}function E3(r,e){var t=Pe(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,r.width*256),t.write_shift(2,0);var i=0;return r.hidden&&(i|=1),t.write_shift(1,i),i=r.level||0,t.write_shift(1,i),t.write_shift(2,0),t}function C3(r,e){var t={};return e<32||(r.l+=16,t.header=Ci(r),t.footer=Ci(r),r.l+=2),t}function _3(r,e,t){var i={area:!1};if(t.biff!=5)return r.l+=e,i;var n=r.read_shift(1);return r.l+=3,n&16&&(i.area=!0),i}function k3(r){for(var e=Pe(2*r),t=0;t<r;++t)e.write_shift(2,t+1);return e}var S3=cs,T3=R1,A3=mh;function F3(r){var e=r.read_shift(2),t=r.read_shift(2),i=r.read_shift(4),n={fmt:e,env:t,len:i,data:r.slice(r.l,r.l+i)};return r.l+=i,n}function R3(r,e,t){t.biffguess&&t.biff==5&&(t.biff=2);var i=cs(r);++r.l;var n=Ka(r,e-7,t);return i.t="str",i.val=n,i}function L3(r){var e=cs(r);++r.l;var t=Ci(r);return e.t="n",e.val=t,e}function N3(r,e,t){var i=Pe(15);return wh(i,r,e),i.write_shift(8,t,"f"),i}function P3(r){var e=cs(r);++r.l;var t=r.read_shift(2);return e.t="n",e.val=t,e}function D3(r,e,t){var i=Pe(9);return wh(i,r,e),i.write_shift(2,t),i}function M3(r){var e=r.read_shift(1);return e===0?(r.l++,""):r.read_shift(e,"sbcs-cont")}function O3(r,e){r.l+=6,r.l+=2,r.l+=1,r.l+=3,r.l+=1,r.l+=e-13}function I3(r,e,t){var i=r.l+e,n=cs(r),s=r.read_shift(2),a=Ba(r,s,t);return r.l=i,n.t="str",n.val=a,n}var B3=[2,3,48,49,131,139,140,245],rd=(function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=su({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,l){var h=[],c=sa(1);switch(l.type){case"base64":c=Qi(rn(o));break;case"binary":c=Qi(o);break;case"buffer":case"array":c=o;break}oi(c,0);var d=c.read_shift(1),p=!!(d&136),f=!1,g=!1;switch(d){case 2:break;case 3:break;case 48:f=!0,p=!0;break;case 49:f=!0,p=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var m=0,b=521;d==2&&(m=c.read_shift(2)),c.l+=3,d!=2&&(m=c.read_shift(4)),m>1048576&&(m=1e6),d!=2&&(b=c.read_shift(2));var w=c.read_shift(2),E=l.codepage||1252;d!=2&&(c.l+=16,c.read_shift(1),c[c.l]!==0&&(E=r[c[c.l]]),c.l+=1,c.l+=2),g&&(c.l+=36);for(var C=[],F={},L=Math.min(c.length,d==2?521:b-10-(f?264:0)),D=g?32:11;c.l<L&&c[c.l]!=13;)switch(F={},F.name=jt.utils.decode(E,c.slice(c.l,c.l+D)).replace(/[\u0000\r\n].*$/g,""),c.l+=D,F.type=String.fromCharCode(c.read_shift(1)),d!=2&&!g&&(F.offset=c.read_shift(4)),F.len=c.read_shift(1),d==2&&(F.offset=c.read_shift(2)),F.dec=c.read_shift(1),F.name.length&&C.push(F),d!=2&&(c.l+=g?13:14),F.type){case"B":(!f||F.len!=8)&&l.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+F.type)}if(c[c.l]!==13&&(c.l=b-1),c.read_shift(1)!==13)throw new Error("DBF Terminator not found "+c.l+" "+c[c.l]);c.l=b;var S=0,A=0;for(h[0]=[],A=0;A!=C.length;++A)h[0][A]=C[A].name;for(;m-- >0;){if(c[c.l]===42){c.l+=w;continue}for(++c.l,h[++S]=[],A=0,A=0;A!=C.length;++A){var O=c.slice(c.l,c.l+C[A].len);c.l+=C[A].len,oi(O,0);var U=jt.utils.decode(E,O);switch(C[A].type){case"C":U.trim().length&&(h[S][A]=U.replace(/\s+$/,""));break;case"D":U.length===8?h[S][A]=new Date(+U.slice(0,4),+U.slice(4,6)-1,+U.slice(6,8)):h[S][A]=U;break;case"F":h[S][A]=parseFloat(U.trim());break;case"+":case"I":h[S][A]=g?O.read_shift(-4,"i")^2147483648:O.read_shift(4,"i");break;case"L":switch(U.trim().toUpperCase()){case"Y":case"T":h[S][A]=!0;break;case"N":case"F":h[S][A]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+U+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));h[S][A]="##MEMO##"+(g?parseInt(U.trim(),10):O.read_shift(4));break;case"N":U=U.replace(/\u0000/g,"").trim(),U&&U!="."&&(h[S][A]=+U||0);break;case"@":h[S][A]=new Date(O.read_shift(-8,"f")-621356832e5);break;case"T":h[S][A]=new Date((O.read_shift(4)-2440588)*864e5+O.read_shift(4));break;case"Y":h[S][A]=O.read_shift(4,"i")/1e4+O.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[S][A]=-O.read_shift(-8,"f");break;case"B":if(f&&C[A].len==8){h[S][A]=O.read_shift(8,"f");break}case"G":case"P":O.l+=C[A].len;break;case"0":if(C[A].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[A].type)}}}if(d!=2&&c.l<c.length&&c[c.l++]!=26)throw new Error("DBF EOF Marker missing "+(c.l-1)+" of "+c.length+" "+c[c.l-1].toString(16));return l&&l.sheetRows&&(h=h.slice(0,l.sheetRows)),l.DBF=C,h}function i(o,l){var h=l||{};h.dateNF||(h.dateNF="yyyymmdd");var c=Uo(t(o,h),h);return c["!cols"]=h.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete h.DBF,c}function n(o,l){try{return ca(i(o,l),l)}catch(h){if(l&&l.WTF)throw h}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var h=l||{};if(+h.codepage>=0&&xn(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var c=Ui(),d=Gc(o,{header:1,raw:!0,cellDates:!0}),p=d[0],f=d.slice(1),g=o["!cols"]||[],m=0,b=0,w=0,E=1;for(m=0;m<p.length;++m){if(((g[m]||{}).DBF||{}).name){p[m]=g[m].DBF.name,++w;continue}if(p[m]!=null){if(++w,typeof p[m]=="number"&&(p[m]=p[m].toString(10)),typeof p[m]!="string")throw new Error("DBF Invalid column name "+p[m]+" |"+typeof p[m]+"|");if(p.indexOf(p[m])!==m){for(b=0;b<1024;++b)if(p.indexOf(p[m]+"_"+b)==-1){p[m]+="_"+b;break}}}}var C=Ht(o["!ref"]),F=[],L=[],D=[];for(m=0;m<=C.e.c-C.s.c;++m){var S="",A="",O=0,U=[];for(b=0;b<f.length;++b)f[b][m]!=null&&U.push(f[b][m]);if(U.length==0||p[m]==null){F[m]="?";continue}for(b=0;b<U.length;++b){switch(typeof U[b]){case"number":A="B";break;case"string":A="C";break;case"boolean":A="L";break;case"object":A=U[b]instanceof Date?"D":"C";break;default:A="C"}O=Math.max(O,String(U[b]).length),S=S&&S!=A?"C":A}O>250&&(O=250),A=((g[m]||{}).DBF||{}).type,A=="C"&&g[m].DBF.len>O&&(O=g[m].DBF.len),S=="B"&&A=="N"&&(S="N",D[m]=g[m].DBF.dec,O=g[m].DBF.len),L[m]=S=="C"||A=="N"?O:s[S]||0,E+=L[m],F[m]=S}var R=c.next(32);for(R.write_shift(4,318902576),R.write_shift(4,f.length),R.write_shift(2,296+32*w),R.write_shift(2,E),m=0;m<4;++m)R.write_shift(4,0);for(R.write_shift(4,0|(+e[Da]||3)<<8),m=0,b=0;m<p.length;++m)if(p[m]!=null){var k=c.next(32),M=(p[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);k.write_shift(1,M,"sbcs"),k.write_shift(1,F[m]=="?"?"C":F[m],"sbcs"),k.write_shift(4,b),k.write_shift(1,L[m]||s[F[m]]||0),k.write_shift(1,D[m]||0),k.write_shift(1,2),k.write_shift(4,0),k.write_shift(1,0),k.write_shift(4,0),k.write_shift(4,0),b+=L[m]||s[F[m]]||0}var V=c.next(264);for(V.write_shift(4,13),m=0;m<65;++m)V.write_shift(4,0);for(m=0;m<f.length;++m){var oe=c.next(E);for(oe.write_shift(1,0),b=0;b<p.length;++b)if(p[b]!=null)switch(F[b]){case"L":oe.write_shift(1,f[m][b]==null?63:f[m][b]?84:70);break;case"B":oe.write_shift(8,f[m][b]||0,"f");break;case"N":var K="0";for(typeof f[m][b]=="number"&&(K=f[m][b].toFixed(D[b]||0)),w=0;w<L[b]-K.length;++w)oe.write_shift(1,32);oe.write_shift(1,K,"sbcs");break;case"D":f[m][b]?(oe.write_shift(4,("0000"+f[m][b].getFullYear()).slice(-4),"sbcs"),oe.write_shift(2,("00"+(f[m][b].getMonth()+1)).slice(-2),"sbcs"),oe.write_shift(2,("00"+f[m][b].getDate()).slice(-2),"sbcs")):oe.write_shift(8,"00000000","sbcs");break;case"C":var Y=String(f[m][b]!=null?f[m][b]:"").slice(0,L[b]);for(oe.write_shift(1,Y,"sbcs"),w=0;w<L[b]-Y.length;++w)oe.write_shift(1,32);break}}return c.next(1).write_shift(1,26),c.end()}return{to_workbook:n,to_sheet:i,from_sheet:a}})(),j1=(function(){var r={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Fr(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(p,f){var g=r[f];return typeof g=="number"?Kf(g):g},i=function(p,f,g){var m=f.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return m==59?p:Kf(m)};r["|"]=254;function n(p,f){switch(f.type){case"base64":return s(rn(p),f);case"binary":return s(p,f);case"buffer":return s(Ot&&Buffer.isBuffer(p)?p.toString("binary"):ha(p),f);case"array":return s(Oa(p),f)}throw new Error("Unrecognized type "+f.type)}function s(p,f){var g=p.split(/[\n\r]+/),m=-1,b=-1,w=0,E=0,C=[],F=[],L=null,D={},S=[],A=[],O=[],U=0,R;for(+f.codepage>=0&&xn(+f.codepage);w!==g.length;++w){U=0;var k=g[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(e,t),M=k.replace(/;;/g,"\0").split(";").map(function(I){return I.replace(/\u0000/g,";")}),V=M[0],oe;if(k.length>0)switch(V){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":M[1].charAt(0)=="P"&&F.push(k.slice(3).replace(/;;/g,";"));break;case"C":var K=!1,Y=!1,se=!1,q=!1,fe=-1,ge=-1;for(E=1;E<M.length;++E)switch(M[E].charAt(0)){case"A":break;case"X":b=parseInt(M[E].slice(1))-1,Y=!0;break;case"Y":for(m=parseInt(M[E].slice(1))-1,Y||(b=0),R=C.length;R<=m;++R)C[R]=[];break;case"K":oe=M[E].slice(1),oe.charAt(0)==='"'?oe=oe.slice(1,oe.length-1):oe==="TRUE"?oe=!0:oe==="FALSE"?oe=!1:isNaN(Hn(oe))?isNaN(Oo(oe).getDate())||(oe=br(oe)):(oe=Hn(oe),L!==null&&Wa(L)&&(oe=ou(oe))),typeof jt<"u"&&typeof oe=="string"&&(f||{}).type!="string"&&(f||{}).codepage&&(oe=jt.utils.decode(f.codepage,oe)),K=!0;break;case"E":q=!0;var _=Po(M[E].slice(1),{r:m,c:b});C[m][b]=[C[m][b],_];break;case"S":se=!0,C[m][b]=[C[m][b],"S5S"];break;case"G":break;case"R":fe=parseInt(M[E].slice(1))-1;break;case"C":ge=parseInt(M[E].slice(1))-1;break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+k)}if(K&&(C[m][b]&&C[m][b].length==2?C[m][b][0]=oe:C[m][b]=oe,L=null),se){if(q)throw new Error("SYLK shared formula cannot have own formula");var P=fe>-1&&C[fe][ge];if(!P||!P[1])throw new Error("SYLK shared formula cannot find base");C[m][b][1]=sv(P[1],{r:m-fe,c:b-ge})}break;case"F":var N=0;for(E=1;E<M.length;++E)switch(M[E].charAt(0)){case"X":b=parseInt(M[E].slice(1))-1,++N;break;case"Y":for(m=parseInt(M[E].slice(1))-1,R=C.length;R<=m;++R)C[R]=[];break;case"M":U=parseInt(M[E].slice(1))/20;break;case"F":break;case"G":break;case"P":L=F[parseInt(M[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(O=M[E].slice(1).split(" "),R=parseInt(O[0],10);R<=parseInt(O[1],10);++R)U=parseInt(O[2],10),A[R-1]=U===0?{hidden:!0}:{wch:U},aa(A[R-1]);break;case"C":b=parseInt(M[E].slice(1))-1,A[b]||(A[b]={});break;case"R":m=parseInt(M[E].slice(1))-1,S[m]||(S[m]={}),U>0?(S[m].hpt=U,S[m].hpx=Bo(U)):U===0&&(S[m].hidden=!0);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+k)}N<1&&(L=null);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+k)}}return S.length>0&&(D["!rows"]=S),A.length>0&&(D["!cols"]=A),f&&f.sheetRows&&(C=C.slice(0,f.sheetRows)),[C,D]}function a(p,f){var g=n(p,f),m=g[0],b=g[1],w=Uo(m,f);return Fr(b).forEach(function(E){w[E]=b[E]}),w}function o(p,f){return ca(a(p,f),f)}function l(p,f,g,m){var b="C;Y"+(g+1)+";X"+(m+1)+";K";switch(p.t){case"n":b+=p.v||0,p.f&&!p.F&&(b+=";E"+Kd(p.f,{r:g,c:m}));break;case"b":b+=p.v?"TRUE":"FALSE";break;case"e":b+=p.w||p.v;break;case"d":b+='"'+(p.w||p.v)+'"';break;case"s":b+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function h(p,f){f.forEach(function(g,m){var b="F;W"+(m+1)+" "+(m+1)+" ";g.hidden?b+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=eh(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=th(g.wpx)),typeof g.wch=="number"&&(b+=Math.round(g.wch))),b.charAt(b.length-1)!=" "&&p.push(b)})}function c(p,f){f.forEach(function(g,m){var b="F;";g.hidden?b+="M0;":g.hpt?b+="M"+20*g.hpt+";":g.hpx&&(b+="M"+20*rh(g.hpx)+";"),b.length>2&&p.push(b+"R"+(m+1))})}function d(p,f){var g=["ID;PWXL;N;E"],m=[],b=Ht(p["!ref"]),w,E=Array.isArray(p),C=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),p["!cols"]&&h(g,p["!cols"]),p["!rows"]&&c(g,p["!rows"]),g.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var F=b.s.r;F<=b.e.r;++F)for(var L=b.s.c;L<=b.e.c;++L){var D=xt({r:F,c:L});w=E?(p[F]||[])[L]:p[D],!(!w||w.v==null&&(!w.f||w.F))&&m.push(l(w,p,F,L))}return g.join(C)+C+m.join(C)+C+"E"+C}return{to_workbook:o,to_sheet:a,from_sheet:d}})(),W1=(function(){function r(s,a){switch(a.type){case"base64":return e(rn(s),a);case"binary":return e(s,a);case"buffer":return e(Ot&&Buffer.isBuffer(s)?s.toString("binary"):ha(s),a);case"array":return e(Oa(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,h=-1,c=0,d=[];c!==o.length;++c){if(o[c].trim()==="BOT"){d[++l]=[],h=0;continue}if(!(l<0)){var p=o[c].trim().split(","),f=p[0],g=p[1];++c;for(var m=o[c]||"";(m.match(/["]/g)||[]).length&1&&c<o.length-1;)m+=`
`+o[++c];switch(m=m.trim(),+f){case-1:if(m==="BOT"){d[++l]=[],h=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?d[l][h]=!0:m==="FALSE"?d[l][h]=!1:isNaN(Hn(g))?isNaN(Oo(g).getDate())?d[l][h]=g:d[l][h]=br(g):d[l][h]=Hn(g),++h;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),d[l][h++]=m!==""?m:null;break}if(m==="EOD")break}}return a&&a.sheetRows&&(d=d.slice(0,a.sheetRows)),d}function t(s,a){return Uo(r(s,a),a)}function i(s,a){return ca(t(s,a),a)}var n=(function(){var s=function(l,h,c,d,p){l.push(h),l.push(c+","+d),l.push('"'+p.replace(/"/g,'""')+'"')},a=function(l,h,c,d){l.push(h+","+c),l.push(h==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var h=[],c=Ht(l["!ref"]),d,p=Array.isArray(l);s(h,"TABLE",0,1,"sheetjs"),s(h,"VECTORS",0,c.e.r-c.s.r+1,""),s(h,"TUPLES",0,c.e.c-c.s.c+1,""),s(h,"DATA",0,0,"");for(var f=c.s.r;f<=c.e.r;++f){a(h,-1,0,"BOT");for(var g=c.s.c;g<=c.e.c;++g){var m=xt({r:f,c:g});if(d=p?(l[f]||[])[g]:l[m],!d){a(h,1,0,"");continue}switch(d.t){case"n":var b=d.w;!b&&d.v!=null&&(b=d.v),b==null?d.f&&!d.F?a(h,1,0,"="+d.f):a(h,1,0,""):a(h,0,b,"V");break;case"b":a(h,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":a(h,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=nn(d.z||vt[14],Jr(br(d.v)))),a(h,0,d.w,"V");break;default:a(h,1,0,"")}}}a(h,-1,0,"EOD");var w=`\r
`,E=h.join(w);return E}})();return{to_workbook:i,to_sheet:t,from_sheet:n}})(),U1=(function(){function r(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(d,p){for(var f=d.split(`
`),g=-1,m=-1,b=0,w=[];b!==f.length;++b){var E=f[b].trim().split(":");if(E[0]==="cell"){var C=yr(E[1]);if(w.length<=C.r)for(g=w.length;g<=C.r;++g)w[g]||(w[g]=[]);switch(g=C.r,m=C.c,E[2]){case"t":w[g][m]=r(E[3]);break;case"v":w[g][m]=+E[3];break;case"vtf":var F=E[E.length-1];case"vtc":switch(E[3]){case"nl":w[g][m]=!!+E[4];break;default:w[g][m]=+E[4];break}E[2]=="vtf"&&(w[g][m]=[w[g][m],F])}}}return p&&p.sheetRows&&(w=w.slice(0,p.sheetRows)),w}function i(d,p){return Uo(t(d,p),p)}function n(d,p){return ca(i(d,p),p)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function h(d){if(!d||!d["!ref"])return"";for(var p=[],f=[],g,m="",b=Ni(d["!ref"]),w=Array.isArray(d),E=b.s.r;E<=b.e.r;++E)for(var C=b.s.c;C<=b.e.c;++C)if(m=xt({r:E,c:C}),g=w?(d[E]||[])[C]:d[m],!(!g||g.v==null||g.t==="z")){switch(f=["cell",m,"t"],g.t){case"s":case"str":f.push(e(g.v));break;case"n":g.f?(f[2]="vtf",f[3]="n",f[4]=g.v,f[5]=e(g.f)):(f[2]="v",f[3]=g.v);break;case"b":f[2]="vt"+(g.f?"f":"c"),f[3]="nl",f[4]=g.v?"1":"0",f[5]=e(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var F=Jr(br(g.v));f[2]="vtc",f[3]="nd",f[4]=""+F,f[5]=g.w||nn(g.z||vt[14],F);break;case"e":continue}p.push(f.join(":"))}return p.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function c(d){return[s,a,o,a,h(d),l].join(`
`)}return{to_workbook:n,to_sheet:i,from_sheet:c}})(),Io=(function(){function r(c,d,p,f,g){g.raw?d[p][f]=c:c===""||(c==="TRUE"?d[p][f]=!0:c==="FALSE"?d[p][f]=!1:isNaN(Hn(c))?isNaN(Oo(c).getDate())?d[p][f]=c:d[p][f]=br(c):d[p][f]=Hn(c))}function e(c,d){var p=d||{},f=[];if(!c||c.length===0)return f;for(var g=c.split(/[\r\n]/),m=g.length-1;m>=0&&g[m].length===0;)--m;for(var b=10,w=0,E=0;E<=m;++E)w=g[E].indexOf(" "),w==-1?w=g[E].length:w++,b=Math.max(b,w);for(E=0;E<=m;++E){f[E]=[];var C=0;for(r(g[E].slice(0,b).trim(),f,E,C,p),C=1;C<=(g[E].length-b)/10+1;++C)r(g[E].slice(b+(C-1)*10,b+C*10).trim(),f,E,C,p)}return p.sheetRows&&(f=f.slice(0,p.sheetRows)),f}var t={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function n(c){for(var d={},p=!1,f=0,g=0;f<c.length;++f)(g=c.charCodeAt(f))==34?p=!p:!p&&g in t&&(d[g]=(d[g]||0)+1);g=[];for(f in d)Object.prototype.hasOwnProperty.call(d,f)&&g.push([d[f],f]);if(!g.length){d=i;for(f in d)Object.prototype.hasOwnProperty.call(d,f)&&g.push([d[f],f])}return g.sort(function(m,b){return m[0]-b[0]||i[m[1]]-i[b[1]]}),t[g.pop()[1]]||44}function s(c,d){var p=d||{},f="",g=p.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};c.slice(0,4)=="sep="?c.charCodeAt(5)==13&&c.charCodeAt(6)==10?(f=c.charAt(4),c=c.slice(7)):c.charCodeAt(5)==13||c.charCodeAt(5)==10?(f=c.charAt(4),c=c.slice(6)):f=n(c.slice(0,1024)):p&&p.FS?f=p.FS:f=n(c.slice(0,1024));var b=0,w=0,E=0,C=0,F=0,L=f.charCodeAt(0),D=!1,S=0,A=c.charCodeAt(0);c=c.replace(/\r\n/mg,`
`);var O=p.dateNF!=null?CE(p.dateNF):null;function U(){var R=c.slice(C,F),k={};if(R.charAt(0)=='"'&&R.charAt(R.length-1)=='"'&&(R=R.slice(1,-1).replace(/""/g,'"')),R.length===0)k.t="z";else if(p.raw)k.t="s",k.v=R;else if(R.trim().length===0)k.t="s",k.v=R;else if(R.charCodeAt(0)==61)R.charCodeAt(1)==34&&R.charCodeAt(R.length-1)==34?(k.t="s",k.v=R.slice(2,-1).replace(/""/g,'"')):Qk(R)?(k.t="n",k.f=R.slice(1)):(k.t="s",k.v=R);else if(R=="TRUE")k.t="b",k.v=!0;else if(R=="FALSE")k.t="b",k.v=!1;else if(!isNaN(E=Hn(R)))k.t="n",p.cellText!==!1&&(k.w=R),k.v=E;else if(!isNaN(Oo(R).getDate())||O&&R.match(O)){k.z=p.dateNF||vt[14];var M=0;O&&R.match(O)&&(R=_E(R,p.dateNF,R.match(O)||[]),M=1),p.cellDates?(k.t="d",k.v=br(R,M)):(k.t="n",k.v=Jr(br(R,M))),p.cellText!==!1&&(k.w=nn(k.z,k.v instanceof Date?Jr(k.v):k.v)),p.cellNF||delete k.z}else k.t="s",k.v=R;if(k.t=="z"||(p.dense?(g[b]||(g[b]=[]),g[b][w]=k):g[xt({c:w,r:b})]=k),C=F+1,A=c.charCodeAt(C),m.e.c<w&&(m.e.c=w),m.e.r<b&&(m.e.r=b),S==L)++w;else if(w=0,++b,p.sheetRows&&p.sheetRows<=b)return!0}e:for(;F<c.length;++F)switch(S=c.charCodeAt(F)){case 34:A===34&&(D=!D);break;case L:case 10:case 13:if(!D&&U())break e;break}return F-C>0&&U(),g["!ref"]=Lt(m),g}function a(c,d){return!(d&&d.PRN)||d.FS||c.slice(0,4)=="sep="||c.indexOf("	")>=0||c.indexOf(",")>=0||c.indexOf(";")>=0?s(c,d):Uo(e(c,d),d)}function o(c,d){var p="",f=d.type=="string"?[0,0,0,0]:i0(c,d);switch(d.type){case"base64":p=rn(c);break;case"binary":p=c;break;case"buffer":d.codepage==65001?p=c.toString("utf8"):d.codepage&&typeof jt<"u"?p=jt.utils.decode(d.codepage,c):p=Ot&&Buffer.isBuffer(c)?c.toString("binary"):ha(c);break;case"array":p=Oa(c);break;case"string":p=c;break;default:throw new Error("Unrecognized type "+d.type)}return f[0]==239&&f[1]==187&&f[2]==191?p=sr(p.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?p=sr(p):d.type=="binary"&&typeof jt<"u"&&d.codepage&&(p=jt.utils.decode(d.codepage,jt.utils.encode(28591,p))),p.slice(0,19)=="socialcalc:version:"?U1.to_sheet(d.type=="string"?p:sr(p),d):a(p,d)}function l(c,d){return ca(o(c,d),d)}function h(c){for(var d=[],p=Ht(c["!ref"]),f,g=Array.isArray(c),m=p.s.r;m<=p.e.r;++m){for(var b=[],w=p.s.c;w<=p.e.c;++w){var E=xt({r:m,c:w});if(f=g?(c[m]||[])[w]:c[E],!f||f.v==null){b.push("          ");continue}for(var C=(f.w||(os(f),f.w)||"").slice(0,10);C.length<10;)C+=" ";b.push(C+(w===0?" ":""))}d.push(b.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:h}})();function H3(r,e){var t=e||{},i=!!t.WTF;t.WTF=!0;try{var n=j1.to_workbook(r,t);return t.WTF=i,n}catch(s){if(t.WTF=i,!s.message.match(/SYLK bad record ID/)&&i)throw s;return Io.to_workbook(r,e)}}var La=(function(){function r(_,P,N){if(_){oi(_,_.l||0);for(var I=N.Enum||fe;_.l<_.length;){var X=_.read_shift(2),he=I[X]||I[65535],ce=_.read_shift(2),ue=_.l+ce,be=he.f&&he.f(_,ce,N);if(_.l=ue,P(be,he,X))return}}}function e(_,P){switch(P.type){case"base64":return t(Qi(rn(_)),P);case"binary":return t(Qi(_),P);case"buffer":case"array":return t(_,P)}throw"Unsupported type "+P.type}function t(_,P){if(!_)return _;var N=P||{},I=N.dense?[]:{},X="Sheet1",he="",ce=0,ue={},be=[],Le=[],Z={s:{r:0,c:0},e:{r:0,c:0}},Ue=N.sheetRows||0;if(_[2]==0&&(_[3]==8||_[3]==9)&&_.length>=16&&_[14]==5&&_[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(_[2]==2)N.Enum=fe,r(_,function(De,Je,He){switch(He){case 0:N.vers=De,De>=4096&&(N.qpro=!0);break;case 6:Z=De;break;case 204:De&&(he=De);break;case 222:he=De;break;case 15:case 51:N.qpro||(De[1].v=De[1].v.slice(1));case 13:case 14:case 16:He==14&&(De[2]&112)==112&&(De[2]&15)>1&&(De[2]&15)<15&&(De[1].z=N.dateNF||vt[14],N.cellDates&&(De[1].t="d",De[1].v=ou(De[1].v))),N.qpro&&De[3]>ce&&(I["!ref"]=Lt(Z),ue[X]=I,be.push(X),I=N.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},ce=De[3],X=he||"Sheet"+(ce+1),he="");var qe=N.dense?(I[De[0].r]||[])[De[0].c]:I[xt(De[0])];if(qe){qe.t=De[1].t,qe.v=De[1].v,De[1].z!=null&&(qe.z=De[1].z),De[1].f!=null&&(qe.f=De[1].f);break}N.dense?(I[De[0].r]||(I[De[0].r]=[]),I[De[0].r][De[0].c]=De[1]):I[xt(De[0])]=De[1];break}},N);else if(_[2]==26||_[2]==14)N.Enum=ge,_[2]==14&&(N.qpro=!0,_.l=0),r(_,function(De,Je,He){switch(He){case 204:X=De;break;case 22:De[1].v=De[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(De[3]>ce&&(I["!ref"]=Lt(Z),ue[X]=I,be.push(X),I=N.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},ce=De[3],X="Sheet"+(ce+1)),Ue>0&&De[0].r>=Ue)break;N.dense?(I[De[0].r]||(I[De[0].r]=[]),I[De[0].r][De[0].c]=De[1]):I[xt(De[0])]=De[1],Z.e.c<De[0].c&&(Z.e.c=De[0].c),Z.e.r<De[0].r&&(Z.e.r=De[0].r);break;case 27:De[14e3]&&(Le[De[14e3][0]]=De[14e3][1]);break;case 1537:Le[De[0]]=De[1],De[0]==ce&&(X=De[1]);break}},N);else throw new Error("Unrecognized LOTUS BOF "+_[2]);if(I["!ref"]=Lt(Z),ue[he||X]=I,be.push(he||X),!Le.length)return{SheetNames:be,Sheets:ue};for(var Ye={},Se=[],re=0;re<Le.length;++re)ue[be[re]]?(Se.push(Le[re]||be[re]),Ye[Le[re]]=ue[Le[re]]||ue[be[re]]):(Se.push(Le[re]),Ye[Le[re]]={"!ref":"A1"});return{SheetNames:Se,Sheets:Ye}}function i(_,P){var N=P||{};if(+N.codepage>=0&&xn(+N.codepage),N.type=="string")throw new Error("Cannot write WK1 to JS string");var I=Ui(),X=Ht(_["!ref"]),he=Array.isArray(_),ce=[];$e(I,0,s(1030)),$e(I,6,l(X));for(var ue=Math.min(X.e.r,8191),be=X.s.r;be<=ue;++be)for(var Le=Tr(be),Z=X.s.c;Z<=X.e.c;++Z){be===X.s.r&&(ce[Z]=vr(Z));var Ue=ce[Z]+Le,Ye=he?(_[be]||[])[Z]:_[Ue];if(!(!Ye||Ye.t=="z"))if(Ye.t=="n")(Ye.v|0)==Ye.v&&Ye.v>=-32768&&Ye.v<=32767?$e(I,13,f(be,Z,Ye.v)):$e(I,14,m(be,Z,Ye.v));else{var Se=os(Ye);$e(I,15,d(be,Z,Se.slice(0,239)))}}return $e(I,1),I.end()}function n(_,P){var N=P||{};if(+N.codepage>=0&&xn(+N.codepage),N.type=="string")throw new Error("Cannot write WK3 to JS string");var I=Ui();$e(I,0,a(_));for(var X=0,he=0;X<_.SheetNames.length;++X)(_.Sheets[_.SheetNames[X]]||{})["!ref"]&&$e(I,27,q(_.SheetNames[X],he++));var ce=0;for(X=0;X<_.SheetNames.length;++X){var ue=_.Sheets[_.SheetNames[X]];if(!(!ue||!ue["!ref"])){for(var be=Ht(ue["!ref"]),Le=Array.isArray(ue),Z=[],Ue=Math.min(be.e.r,8191),Ye=be.s.r;Ye<=Ue;++Ye)for(var Se=Tr(Ye),re=be.s.c;re<=be.e.c;++re){Ye===be.s.r&&(Z[re]=vr(re));var De=Z[re]+Se,Je=Le?(ue[Ye]||[])[re]:ue[De];if(!(!Je||Je.t=="z"))if(Je.t=="n")$e(I,23,U(Ye,re,ce,Je.v));else{var He=os(Je);$e(I,22,S(Ye,re,ce,He.slice(0,239)))}}++ce}}return $e(I,1),I.end()}function s(_){var P=Pe(2);return P.write_shift(2,_),P}function a(_){var P=Pe(26);P.write_shift(2,4096),P.write_shift(2,4),P.write_shift(4,0);for(var N=0,I=0,X=0,he=0;he<_.SheetNames.length;++he){var ce=_.SheetNames[he],ue=_.Sheets[ce];if(!(!ue||!ue["!ref"])){++X;var be=Ni(ue["!ref"]);N<be.e.r&&(N=be.e.r),I<be.e.c&&(I=be.e.c)}}return N>8191&&(N=8191),P.write_shift(2,N),P.write_shift(1,X),P.write_shift(1,I),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(1,1),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(4,0),P}function o(_,P,N){var I={s:{c:0,r:0},e:{c:0,r:0}};return P==8&&N.qpro?(I.s.c=_.read_shift(1),_.l++,I.s.r=_.read_shift(2),I.e.c=_.read_shift(1),_.l++,I.e.r=_.read_shift(2),I):(I.s.c=_.read_shift(2),I.s.r=_.read_shift(2),P==12&&N.qpro&&(_.l+=2),I.e.c=_.read_shift(2),I.e.r=_.read_shift(2),P==12&&N.qpro&&(_.l+=2),I.s.c==65535&&(I.s.c=I.e.c=I.s.r=I.e.r=0),I)}function l(_){var P=Pe(8);return P.write_shift(2,_.s.c),P.write_shift(2,_.s.r),P.write_shift(2,_.e.c),P.write_shift(2,_.e.r),P}function h(_,P,N){var I=[{c:0,r:0},{t:"n",v:0},0,0];return N.qpro&&N.vers!=20768?(I[0].c=_.read_shift(1),I[3]=_.read_shift(1),I[0].r=_.read_shift(2),_.l+=2):(I[2]=_.read_shift(1),I[0].c=_.read_shift(2),I[0].r=_.read_shift(2)),I}function c(_,P,N){var I=_.l+P,X=h(_,P,N);if(X[1].t="s",N.vers==20768){_.l++;var he=_.read_shift(1);return X[1].v=_.read_shift(he,"utf8"),X}return N.qpro&&_.l++,X[1].v=_.read_shift(I-_.l,"cstr"),X}function d(_,P,N){var I=Pe(7+N.length);I.write_shift(1,255),I.write_shift(2,P),I.write_shift(2,_),I.write_shift(1,39);for(var X=0;X<I.length;++X){var he=N.charCodeAt(X);I.write_shift(1,he>=128?95:he)}return I.write_shift(1,0),I}function p(_,P,N){var I=h(_,P,N);return I[1].v=_.read_shift(2,"i"),I}function f(_,P,N){var I=Pe(7);return I.write_shift(1,255),I.write_shift(2,P),I.write_shift(2,_),I.write_shift(2,N,"i"),I}function g(_,P,N){var I=h(_,P,N);return I[1].v=_.read_shift(8,"f"),I}function m(_,P,N){var I=Pe(13);return I.write_shift(1,255),I.write_shift(2,P),I.write_shift(2,_),I.write_shift(8,N,"f"),I}function b(_,P,N){var I=_.l+P,X=h(_,P,N);if(X[1].v=_.read_shift(8,"f"),N.qpro)_.l=I;else{var he=_.read_shift(2);F(_.slice(_.l,_.l+he),X),_.l+=he}return X}function w(_,P,N){var I=P&32768;return P&=-32769,P=(I?_:0)+(P>=8192?P-16384:P),(I?"":"$")+(N?vr(P):Tr(P))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function F(_,P){oi(_,0);for(var N=[],I=0,X="",he="",ce="",ue="";_.l<_.length;){var be=_[_.l++];switch(be){case 0:N.push(_.read_shift(8,"f"));break;case 1:he=w(P[0].c,_.read_shift(2),!0),X=w(P[0].r,_.read_shift(2),!1),N.push(he+X);break;case 2:{var Le=w(P[0].c,_.read_shift(2),!0),Z=w(P[0].r,_.read_shift(2),!1);he=w(P[0].c,_.read_shift(2),!0),X=w(P[0].r,_.read_shift(2),!1),N.push(Le+Z+":"+he+X)}break;case 3:if(_.l<_.length){console.error("WK1 premature formula end");return}break;case 4:N.push("("+N.pop()+")");break;case 5:N.push(_.read_shift(2));break;case 6:{for(var Ue="";be=_[_.l++];)Ue+=String.fromCharCode(be);N.push('"'+Ue.replace(/"/g,'""')+'"')}break;case 8:N.push("-"+N.pop());break;case 23:N.push("+"+N.pop());break;case 22:N.push("NOT("+N.pop()+")");break;case 20:case 21:ue=N.pop(),ce=N.pop(),N.push(["AND","OR"][be-20]+"("+ce+","+ue+")");break;default:if(be<32&&C[be])ue=N.pop(),ce=N.pop(),N.push(ce+C[be]+ue);else if(E[be]){if(I=E[be][1],I==69&&(I=_[_.l++]),I>N.length){console.error("WK1 bad formula parse 0x"+be.toString(16)+":|"+N.join("|")+"|");return}var Ye=N.slice(-I);N.length-=I,N.push(E[be][0]+"("+Ye.join(",")+")")}else return be<=7?console.error("WK1 invalid opcode "+be.toString(16)):be<=24?console.error("WK1 unsupported op "+be.toString(16)):be<=30?console.error("WK1 invalid opcode "+be.toString(16)):be<=115?console.error("WK1 unsupported function opcode "+be.toString(16)):console.error("WK1 unrecognized opcode "+be.toString(16))}}N.length==1?P[1].f=""+N[0]:console.error("WK1 bad formula parse |"+N.join("|")+"|")}function L(_){var P=[{c:0,r:0},{t:"n",v:0},0];return P[0].r=_.read_shift(2),P[3]=_[_.l++],P[0].c=_[_.l++],P}function D(_,P){var N=L(_);return N[1].t="s",N[1].v=_.read_shift(P-4,"cstr"),N}function S(_,P,N,I){var X=Pe(6+I.length);X.write_shift(2,_),X.write_shift(1,N),X.write_shift(1,P),X.write_shift(1,39);for(var he=0;he<I.length;++he){var ce=I.charCodeAt(he);X.write_shift(1,ce>=128?95:ce)}return X.write_shift(1,0),X}function A(_,P){var N=L(_);N[1].v=_.read_shift(2);var I=N[1].v>>1;if(N[1].v&1)switch(I&7){case 0:I=(I>>3)*5e3;break;case 1:I=(I>>3)*500;break;case 2:I=(I>>3)/20;break;case 3:I=(I>>3)/200;break;case 4:I=(I>>3)/2e3;break;case 5:I=(I>>3)/2e4;break;case 6:I=(I>>3)/16;break;case 7:I=(I>>3)/64;break}return N[1].v=I,N}function O(_,P){var N=L(_),I=_.read_shift(4),X=_.read_shift(4),he=_.read_shift(2);if(he==65535)return I===0&&X===3221225472?(N[1].t="e",N[1].v=15):I===0&&X===3489660928?(N[1].t="e",N[1].v=42):N[1].v=0,N;var ce=he&32768;return he=(he&32767)-16446,N[1].v=(1-ce*2)*(X*Math.pow(2,he+32)+I*Math.pow(2,he)),N}function U(_,P,N,I){var X=Pe(14);if(X.write_shift(2,_),X.write_shift(1,N),X.write_shift(1,P),I==0)return X.write_shift(4,0),X.write_shift(4,0),X.write_shift(2,65535),X;var he=0,ce=0,ue=0,be=0;return I<0&&(he=1,I=-I),ce=Math.log2(I)|0,I/=Math.pow(2,ce-31),be=I>>>0,(be&2147483648)==0&&(I/=2,++ce,be=I>>>0),I-=be,be|=2147483648,be>>>=0,I*=Math.pow(2,32),ue=I>>>0,X.write_shift(4,ue),X.write_shift(4,be),ce+=16383+(he?32768:0),X.write_shift(2,ce),X}function R(_,P){var N=O(_);return _.l+=P-14,N}function k(_,P){var N=L(_),I=_.read_shift(4);return N[1].v=I>>6,N}function M(_,P){var N=L(_),I=_.read_shift(8,"f");return N[1].v=I,N}function V(_,P){var N=M(_);return _.l+=P-10,N}function oe(_,P){return _[_.l+P-1]==0?_.read_shift(P,"cstr"):""}function K(_,P){var N=_[_.l++];N>P-1&&(N=P-1);for(var I="";I.length<N;)I+=String.fromCharCode(_[_.l++]);return I}function Y(_,P,N){if(!(!N.qpro||P<21)){var I=_.read_shift(1);_.l+=17,_.l+=1,_.l+=2;var X=_.read_shift(P-21,"cstr");return[I,X]}}function se(_,P){for(var N={},I=_.l+P;_.l<I;){var X=_.read_shift(2);if(X==14e3){for(N[X]=[0,""],N[X][0]=_.read_shift(2);_[_.l];)N[X][1]+=String.fromCharCode(_[_.l]),_.l++;_.l++}}return N}function q(_,P){var N=Pe(5+_.length);N.write_shift(2,14e3),N.write_shift(2,P);for(var I=0;I<_.length;++I){var X=_.charCodeAt(I);N[N.l++]=X>127?95:X}return N[N.l++]=0,N}var fe={0:{n:"BOF",f:Gr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:c},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:c},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:oe},222:{n:"SHEETNAMELP",f:K},65535:{n:""}},ge={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:D},23:{n:"NUMBER17",f:O},24:{n:"NUMBER18",f:A},25:{n:"FORMULA19",f:R},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:se},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:k},38:{n:"??"},39:{n:"NUMBER27",f:M},40:{n:"FORMULA28",f:V},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:oe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Y},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:i,book_to_wk3:n,to_workbook:e}})();function z3(r){var e={},t=r.match(Ti),i=0,n=!1;if(t)for(;i!=t.length;++i){var s=yt(t[i]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=vd[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(s[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+s[0])}}return e}var j3=(function(){var r=Yl("t"),e=Yl("rPr");function t(s){var a=s.match(r);if(!a)return{t:"s",v:""};var o={t:"s",v:Vt(a[1])},l=s.match(e);return l&&(o.s=z3(l[1])),o}var i=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(a){return a.replace(i,"").split(n).map(t).filter(function(o){return o.v})}})(),W3=(function(){var e=/(\r\n|\n)/g;function t(n,s,a){var o=[];n.u&&o.push("text-decoration: underline;"),n.uval&&o.push("text-underline-style:"+n.uval+";"),n.sz&&o.push("font-size:"+n.sz+"pt;"),n.outline&&o.push("text-effect: outline;"),n.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),n.b&&(s.push("<b>"),a.push("</b>")),n.i&&(s.push("<i>"),a.push("</i>")),n.strike&&(s.push("<s>"),a.push("</s>"));var l=n.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),n}function i(n){var s=[[],n.v,[]];return n.v?(n.s&&t(n.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(i).join("")}})(),U3=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,V3=/<(?:\w+:)?r>/,G3=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Ud(r,e){var t=e?e.cellHTML:!0,i={};return r?(r.match(/^\s*<(?:\w+:)?t[^>]*>/)?(i.t=Vt(sr(r.slice(r.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),i.r=sr(r),t&&(i.h=kd(i.t))):r.match(V3)&&(i.r=sr(r),i.t=Vt(sr((r.replace(G3,"").match(U3)||[]).join("").replace(Ti,""))),t&&(i.h=W3(j3(i.r)))),i):{t:""}}var q3=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,X3=/<(?:\w+:)?(?:si|sstItem)>/g,K3=/<\/(?:\w+:)?(?:si|sstItem)>/;function Y3(r,e){var t=[],i="";if(!r)return t;var n=r.match(q3);if(n){i=n[2].replace(X3,"").split(K3);for(var s=0;s!=i.length;++s){var a=Ud(i[s].trim(),e);a!=null&&(t[t.length]=a)}n=yt(n[1]),t.Count=n.count,t.Unique=n.uniqueCount}return t}var $3=/^\s|\s$|[\t\n\r]/;function V1(r,e){if(!e.bookSST)return"";var t=[Br];t[t.length]=Ke("sst",null,{xmlns:Ua[0],count:r.Count,uniqueCount:r.Unique});for(var i=0;i!=r.length;++i)if(r[i]!=null){var n=r[i],s="<si>";n.r?s+=n.r:(s+="<t",n.t||(n.t=""),n.t.match($3)&&(s+=' xml:space="preserve"'),s+=">"+rr(n.t)+"</t>"),s+="</si>",t[t.length]=s}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function J3(r){return[r.read_shift(4),r.read_shift(4)]}function Z3(r,e){var t=[],i=!1;return As(r,function(s,a,o){switch(o){case 159:t.Count=s[0],t.Unique=s[1];break;case 19:t.push(s);break;case 160:return!0;case 35:i=!0;break;case 36:i=!1;break;default:if(a.T,!i||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),t}function Q3(r,e){return e||(e=Pe(8)),e.write_shift(4,r.Count),e.write_shift(4,r.Unique),e}var e_=cC;function t_(r){var e=Ui();Be(e,159,Q3(r));for(var t=0;t<r.length;++t)Be(e,19,e_(r[t]));return Be(e,160),e.end()}function G1(r){if(typeof jt<"u")return jt.utils.encode(Da,r);for(var e=[],t=r.split(""),i=0;i<t.length;++i)e[i]=t[i].charCodeAt(0);return e}function Ss(r,e){var t={};return t.Major=r.read_shift(2),t.Minor=r.read_shift(2),e>=4&&(r.l+=e-4),t}function r_(r){var e={};return e.id=r.read_shift(0,"lpp4"),e.R=Ss(r,4),e.U=Ss(r,4),e.W=Ss(r,4),e}function i_(r){for(var e=r.read_shift(4),t=r.l+e-4,i={},n=r.read_shift(4),s=[];n-- >0;)s.push({t:r.read_shift(4),v:r.read_shift(0,"lpp4")});if(i.name=r.read_shift(0,"lpp4"),i.comps=s,r.l!=t)throw new Error("Bad DataSpaceMapEntry: "+r.l+" != "+t);return i}function n_(r){var e=[];r.l+=4;for(var t=r.read_shift(4);t-- >0;)e.push(i_(r));return e}function s_(r){var e=[];r.l+=4;for(var t=r.read_shift(4);t-- >0;)e.push(r.read_shift(0,"lpp4"));return e}function a_(r){var e={};return r.read_shift(4),r.l+=4,e.id=r.read_shift(0,"lpp4"),e.name=r.read_shift(0,"lpp4"),e.R=Ss(r,4),e.U=Ss(r,4),e.W=Ss(r,4),e}function o_(r){var e=a_(r);if(e.ename=r.read_shift(0,"8lpp4"),e.blksz=r.read_shift(4),e.cmode=r.read_shift(4),r.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function q1(r,e){var t=r.l+e,i={};i.Flags=r.read_shift(4)&63,r.l+=4,i.AlgID=r.read_shift(4);var n=!1;switch(i.AlgID){case 26126:case 26127:case 26128:n=i.Flags==36;break;case 26625:n=i.Flags==4;break;case 0:n=i.Flags==16||i.Flags==4||i.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+i.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return i.AlgIDHash=r.read_shift(4),i.KeySize=r.read_shift(4),i.ProviderType=r.read_shift(4),r.l+=8,i.CSPName=r.read_shift(t-r.l>>1,"utf16le"),r.l=t,i}function X1(r,e){var t={},i=r.l+e;return r.l+=4,t.Salt=r.slice(r.l,r.l+16),r.l+=16,t.Verifier=r.slice(r.l,r.l+16),r.l+=16,r.read_shift(4),t.VerifierHash=r.slice(r.l,i),r.l=i,t}function l_(r){var e=Ss(r);switch(e.Minor){case 2:return[e.Minor,h_(r)];case 3:return[e.Minor,c_()];case 4:return[e.Minor,u_(r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function h_(r){var e=r.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var t=r.read_shift(4),i=q1(r,t),n=X1(r,r.length-r.l);return{t:"Std",h:i,v:n}}function c_(){throw new Error("File is password-protected: ECMA-376 Extensible")}function u_(r){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];r.l+=4;var t=r.read_shift(r.length-r.l,"utf8"),i={};return t.replace(Ti,function(s){var a=yt(s);switch(hs(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){i[o]=a[o]});break;case"<dataIntegrity":i.encryptedHmacKey=a.encryptedHmacKey,i.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":i.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":i.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":i.encs.push(a);break;default:throw a[0]}}),i}function f_(r,e){var t={},i=t.EncryptionVersionInfo=Ss(r,4);if(e-=4,i.Minor!=2)throw new Error("unrecognized minor version code: "+i.Minor);if(i.Major>4||i.Major<2)throw new Error("unrecognized major version code: "+i.Major);t.Flags=r.read_shift(4),e-=4;var n=r.read_shift(4);return e-=4,t.EncryptionHeader=q1(r,n),e-=n,t.EncryptionVerifier=X1(r,e),t}function d_(r){var e={},t=e.EncryptionVersionInfo=Ss(r,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return e.Salt=r.read_shift(16),e.EncryptedVerifier=r.read_shift(16),e.EncryptedVerifierHash=r.read_shift(16),e}function Vd(r){var e=0,t,i=G1(r),n=i.length+1,s,a,o,l,h;for(t=sa(n),t[0]=i.length,s=1;s!=n;++s)t[s]=i[s-1];for(s=n-1;s>=0;--s)a=t[s],o=(e&16384)===0?0:1,l=e<<1&32767,h=o|l,e=h^a;return e^52811}var K1=(function(){var r=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],i=function(a){return(a/2|a*128)&255},n=function(a,o){return i(a^o)},s=function(a){for(var o=e[a.length-1],l=104,h=a.length-1;h>=0;--h)for(var c=a[h],d=0;d!=7;++d)c&64&&(o^=t[l]),c*=2,--l;return o};return function(a){for(var o=G1(a),l=s(o),h=o.length,c=sa(16),d=0;d!=16;++d)c[d]=0;var p,f,g;for((h&1)===1&&(p=l>>8,c[h]=n(r[0],p),--h,p=l&255,f=o[o.length-1],c[h]=n(f,p));h>0;)--h,p=l>>8,c[h]=n(o[h],p),--h,p=l&255,c[h]=n(o[h],p);for(h=15,g=15-o.length;g>0;)p=l>>8,c[h]=n(r[g],p),--h,--g,p=l&255,c[h]=n(o[h],p),--h,--g;return c}})(),p_=function(r,e,t,i,n){n||(n=e),i||(i=K1(r));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=i[t],a=(a>>5|a<<3)&255,n[s]=a,++t;return[n,t,i]},m_=function(r){var e=0,t=K1(r);return function(i){var n=p_("",i,e,t);return e=n[1],n[0]}};function g_(r,e,t,i){var n={key:Gr(r),verificationBytes:Gr(r)};return t.password&&(n.verifier=Vd(t.password)),i.valid=n.verificationBytes===n.verifier,i.valid&&(i.insitu=m_(t.password)),n}function v_(r,e,t){var i=t||{};return i.Info=r.read_shift(2),r.l-=2,i.Info===1?i.Data=d_(r):i.Data=f_(r,e),i}function b_(r,e,t){var i={Type:t.biff>=8?r.read_shift(2):0};return i.Type?v_(r,e-2,i):g_(r,t.biff>=8?e:e-2,t,i),i}var Y1=(function(){function r(n,s){switch(s.type){case"base64":return e(rn(n),s);case"binary":return e(n,s);case"buffer":return e(Ot&&Buffer.isBuffer(n)?n.toString("binary"):ha(n),s);case"array":return e(Oa(n),s)}throw new Error("Unrecognized type "+s.type)}function e(n,s){var a=s||{},o=a.dense?[]:{},l=n.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(c,d){Array.isArray(o)&&(o[d]=[]);for(var p=/\\\w+\b/g,f=0,g,m=-1;g=p.exec(c);){switch(g[0]){case"\\cell":var b=c.slice(f,p.lastIndex-g[0].length);if(b[0]==" "&&(b=b.slice(1)),++m,b.length){var w={v:b,t:"s"};Array.isArray(o)?o[d][m]=w:o[xt({r:d,c:m})]=w}break}f=p.lastIndex}m>h.e.c&&(h.e.c=m)}),o["!ref"]=Lt(h),o}function t(n,s){return ca(r(n,s),s)}function i(n){for(var s=["{\\rtf1\\ansi"],a=Ht(n["!ref"]),o,l=Array.isArray(n),h=a.s.r;h<=a.e.r;++h){s.push("\\trowd\\trautofit1");for(var c=a.s.c;c<=a.e.c;++c)s.push("\\cellx"+(c+1));for(s.push("\\pard\\intbl"),c=a.s.c;c<=a.e.c;++c){var d=xt({r:h,c});o=l?(n[h]||[])[c]:n[d],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(os(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:r,from_sheet:i}})();function w_(r){var e=r.slice(r[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Ql(r){for(var e=0,t=1;e!=3;++e)t=t*256+(r[e]>255?255:r[e]<0?0:r[e]);return t.toString(16).toUpperCase().slice(1)}function x_(r){var e=r[0]/255,t=r[1]/255,i=r[2]/255,n=Math.max(e,t,i),s=Math.min(e,t,i),a=n-s;if(a===0)return[0,0,e];var o=0,l=0,h=n+s;switch(l=a/(h>1?2-h:h),n){case e:o=((t-i)/a+6)%6;break;case t:o=(i-e)/a+2;break;case i:o=(e-t)/a+4;break}return[o/6,l,h/2]}function y_(r){var e=r[0],t=r[1],i=r[2],n=t*2*(i<.5?i:1-i),s=i-n/2,a=[s,s,s],o=6*e,l;if(t!==0)switch(o|0){case 0:case 6:l=n*o,a[0]+=n,a[1]+=l;break;case 1:l=n*(2-o),a[0]+=l,a[1]+=n;break;case 2:l=n*(o-2),a[1]+=n,a[2]+=l;break;case 3:l=n*(4-o),a[1]+=l,a[2]+=n;break;case 4:l=n*(o-4),a[2]+=n,a[0]+=l;break;case 5:l=n*(6-o),a[2]+=l,a[0]+=n;break}for(var h=0;h!=3;++h)a[h]=Math.round(a[h]*255);return a}function Wc(r,e){if(e===0)return r;var t=x_(w_(r));return e<0?t[2]=t[2]*(1+e):t[2]=1-(1-t[2])*(1-e),Ql(y_(t))}var $1=6,E_=15,C_=1,yi=$1;function eh(r){return Math.floor((r+Math.round(128/yi)/256)*yi)}function th(r){return Math.floor((r-5)/yi*100+.5)/100}function Uc(r){return Math.round((r*yi+5)/yi*256)/256}function wf(r){return Uc(th(eh(r)))}function Gd(r){var e=Math.abs(r-wf(r)),t=yi;if(e>.005)for(yi=C_;yi<E_;++yi)Math.abs(r-wf(r))<=e&&(e=Math.abs(r-wf(r)),t=yi);yi=t}function aa(r){r.width?(r.wpx=eh(r.width),r.wch=th(r.wpx),r.MDW=yi):r.wpx?(r.wch=th(r.wpx),r.width=Uc(r.wch),r.MDW=yi):typeof r.wch=="number"&&(r.width=Uc(r.wch),r.wpx=eh(r.width),r.MDW=yi),r.customWidth&&delete r.customWidth}var __=96,J1=__;function rh(r){return r*96/J1}function Bo(r){return r*J1/96}var k_={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function S_(r,e,t,i){e.Borders=[];var n={},s=!1;(r[0].match(Ti)||[]).forEach(function(a){var o=yt(a);switch(hs(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},o.diagonalUp&&(n.diagonalUp=mr(o.diagonalUp)),o.diagonalDown&&(n.diagonalDown=mr(o.diagonalDown)),e.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i&&i.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function T_(r,e,t,i){e.Fills=[];var n={},s=!1;(r[0].match(Ti)||[]).forEach(function(a){var o=yt(a);switch(hs(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},e.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":o.patternType&&(n.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),o.indexed&&(n.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(n.bgColor.theme=parseInt(o.theme,10)),o.tint&&(n.bgColor.tint=parseFloat(o.tint)),o.rgb&&(n.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),o.theme&&(n.fgColor.theme=parseInt(o.theme,10)),o.tint&&(n.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(n.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i&&i.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function A_(r,e,t,i){e.Fonts=[];var n={},s=!1;(r[0].match(Ti)||[]).forEach(function(a){var o=yt(a);switch(hs(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(n),n={};break;case"<name":o.val&&(n.name=sr(o.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=o.val?mr(o.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=o.val?mr(o.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(o.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=o.val?mr(o.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=o.val?mr(o.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=o.val?mr(o.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=o.val?mr(o.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=o.val?mr(o.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":o.val&&(n.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(n.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(n.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(n.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=vd[parseInt(o.val,10)];break;case"<color":if(n.color||(n.color={}),o.auto&&(n.color.auto=mr(o.auto)),o.rgb)n.color.rgb=o.rgb.slice(-6);else if(o.indexed){n.color.index=parseInt(o.indexed,10);var l=Fa[n.color.index];n.color.index==81&&(l=Fa[1]),l||(l=Fa[1]),n.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(n.color.theme=parseInt(o.theme,10),o.tint&&(n.color.tint=parseFloat(o.tint)),o.theme&&t.themeElements&&t.themeElements.clrScheme&&(n.color.rgb=Wc(t.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i&&i.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function F_(r,e,t){e.NumberFmt=[];for(var i=Fr(vt),n=0;n<i.length;++n)e.NumberFmt[i[n]]=vt[i[n]];var s=r[0].match(Ti);if(s)for(n=0;n<s.length;++n){var a=yt(s[n]);switch(hs(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Vt(sr(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}as(o,l)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function R_(r){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var i=t[0];i<=t[1];++i)r[i]!=null&&(e[e.length]=Ke("numFmt",null,{numFmtId:i,formatCode:rr(r[i])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Ke("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var mc=["numFmtId","fillId","fontId","borderId","xfId"],gc=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function L_(r,e,t){e.CellXf=[];var i,n=!1;(r[0].match(Ti)||[]).forEach(function(s){var a=yt(s),o=0;switch(hs(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(i=a,delete i[0],o=0;o<mc.length;++o)i[mc[o]]&&(i[mc[o]]=parseInt(i[mc[o]],10));for(o=0;o<gc.length;++o)i[gc[o]]&&(i[gc[o]]=mr(i[gc[o]]));if(e.NumberFmt&&i.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[i.numFmtId]==e.NumberFmt[o]){i.numFmtId=o;break}}e.CellXf.push(i);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=mr(a.wrapText)),i.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(t&&t.WTF&&!n)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function N_(r){var e=[];return e[e.length]=Ke("cellXfs",null),r.forEach(function(t){e[e.length]=Ke("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Ke("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var P_=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,i=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,h){var c={};if(!o)return c;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(e))&&F_(d,c,h),(d=o.match(n))&&A_(d,c,l,h),(d=o.match(i))&&T_(d,c,l,h),(d=o.match(s))&&S_(d,c,l,h),(d=o.match(t))&&L_(d,c,h),c}})();function Z1(r,e){var t=[Br,Ke("styleSheet",null,{xmlns:Ua[0],"xmlns:vt":$r.vt})],i;return r.SSF&&(i=R_(r.SSF))!=null&&(t[t.length]=i),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=N_(e.cellXfs))&&(t[t.length]=i),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function D_(r,e){var t=r.read_shift(2),i=ki(r);return[t,i]}function M_(r,e,t){t||(t=Pe(6+4*e.length)),t.write_shift(2,r),ni(e,t);var i=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),i}function O_(r,e,t){var i={};i.sz=r.read_shift(2)/20;var n=vC(r);n.fItalic&&(i.italic=1),n.fCondense&&(i.condense=1),n.fExtend&&(i.extend=1),n.fShadow&&(i.shadow=1),n.fOutline&&(i.outline=1),n.fStrikeout&&(i.strike=1);var s=r.read_shift(2);switch(s===700&&(i.bold=1),r.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var a=r.read_shift(1);a!=0&&(i.underline=a);var o=r.read_shift(1);o>0&&(i.family=o);var l=r.read_shift(1);switch(l>0&&(i.charset=l),r.l++,i.color=gC(r),r.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=ki(r),i}function I_(r,e){e||(e=Pe(153)),e.write_shift(2,r.sz*20),bC(r,e),e.write_shift(2,r.bold?700:400);var t=0;r.vertAlign=="superscript"?t=1:r.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,r.underline||0),e.write_shift(1,r.family||0),e.write_shift(1,r.charset||0),e.write_shift(1,0),Hc(r.color,e);var i=0;return i=2,e.write_shift(1,i),ni(r.name,e),e.length>e.l?e.slice(0,e.l):e}var B_=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],xf,H_=Si;function wm(r,e){e||(e=Pe(84)),xf||(xf=su(B_));var t=xf[r.patternType];t==null&&(t=40),e.write_shift(4,t);var i=0;if(t!=40)for(Hc({auto:1},e),Hc({auto:1},e);i<12;++i)e.write_shift(4,0);else{for(;i<4;++i)e.write_shift(4,0);for(;i<12;++i)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function z_(r,e){var t=r.l+e,i=r.read_shift(2),n=r.read_shift(2);return r.l=t,{ixfe:i,numFmtId:n}}function Q1(r,e,t){t||(t=Pe(16)),t.write_shift(2,e||0),t.write_shift(2,r.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var i=0;return t.write_shift(1,i),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function Cl(r,e){return e||(e=Pe(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var j_=Si;function W_(r,e){return e||(e=Pe(51)),e.write_shift(1,0),Cl(null,e),Cl(null,e),Cl(null,e),Cl(null,e),Cl(null,e),e.length>e.l?e.slice(0,e.l):e}function U_(r,e){return e||(e=Pe(52)),e.write_shift(4,r.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Bc(r.name||"",e),e.length>e.l?e.slice(0,e.l):e}function V_(r,e,t){var i=Pe(2052);return i.write_shift(4,r),Bc(e,i),Bc(t,i),i.length>i.l?i.slice(0,i.l):i}function G_(r,e,t){var i={};i.NumberFmt=[];for(var n in vt)i.NumberFmt[n]=vt[n];i.CellXf=[],i.Fonts=[];var s=[],a=!1;return As(r,function(l,h,c){switch(c){case 44:i.NumberFmt[l[0]]=l[1],as(l[1],l[0]);break;case 43:i.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=Wc(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&i.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(c),a=!0;break;case 38:s.pop(),a=!1;break;default:if(h.T>0)s.push(c);else if(h.T<0)s.pop();else if(!a||t.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+c.toString(16))}}),i}function q_(r,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var n=i[0];n<=i[1];++n)e[n]!=null&&++t}),t!=0&&(Be(r,615,zn(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var n=i[0];n<=i[1];++n)e[n]!=null&&Be(r,44,M_(n,e[n]))}),Be(r,616))}}function X_(r){var e=1;Be(r,611,zn(e)),Be(r,43,I_({sz:12,color:{theme:1},name:"Calibri",family:2})),Be(r,612)}function K_(r){var e=2;Be(r,603,zn(e)),Be(r,45,wm({patternType:"none"})),Be(r,45,wm({patternType:"gray125"})),Be(r,604)}function Y_(r){var e=1;Be(r,613,zn(e)),Be(r,46,W_()),Be(r,614)}function $_(r){var e=1;Be(r,626,zn(e)),Be(r,47,Q1({numFmtId:0},65535)),Be(r,627)}function J_(r,e){Be(r,617,zn(e.length)),e.forEach(function(t){Be(r,47,Q1(t,0))}),Be(r,618)}function Z_(r){var e=1;Be(r,619,zn(e)),Be(r,48,U_({xfId:0,name:"Normal"})),Be(r,620)}function Q_(r){var e=0;Be(r,505,zn(e)),Be(r,506)}function ek(r){var e=0;Be(r,508,V_(e,"TableStyleMedium9","PivotStyleMedium4")),Be(r,509)}function tk(r,e){var t=Ui();return Be(t,278),q_(t,r.SSF),X_(t),K_(t),Y_(t),$_(t),J_(t,e.cellXfs),Z_(t),Q_(t),ek(t),Be(t,279),t.end()}var rk=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function ik(r,e,t){e.themeElements.clrScheme=[];var i={};(r[0].match(Ti)||[]).forEach(function(n){var s=yt(n);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":i.rgb=s.val;break;case"<a:sysClr":i.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[rk.indexOf(s[0])]=i,i={}):i.name=s[0].slice(3,s[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function nk(){}function sk(){}var ak=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,ok=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,lk=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function hk(r,e,t){e.themeElements={};var i;[["clrScheme",ak,ik],["fontScheme",ok,nk],["fmtScheme",lk,sk]].forEach(function(n){if(!(i=r.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](i,e,t)})}var ck=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function ev(r,e){(!r||r.length===0)&&(r=qd());var t,i={};if(!(t=r.match(ck)))throw new Error("themeElements not found in theme");return hk(t[0],i,e),i.raw=r,i}function qd(r,e){if(e&&e.themeXLSX)return e.themeXLSX;if(r&&typeof r.raw=="string")return r.raw;var t=[Br];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function uk(r,e,t){var i=r.l+e,n=r.read_shift(4);if(n!==124226){if(!t.cellStyles){r.l=i;return}var s=r.slice(r.l);r.l=i;var a;try{a=$g(s,{type:"array"})}catch{return}var o=en(a,"theme/theme/theme1.xml",!0);if(o)return ev(o,t)}}function fk(r){return r.read_shift(4)}function dk(r){var e={};switch(e.xclrType=r.read_shift(2),e.nTintShade=r.read_shift(2),e.xclrType){case 0:r.l+=4;break;case 1:e.xclrValue=pk(r,4);break;case 2:e.xclrValue=P1(r);break;case 3:e.xclrValue=fk(r);break;case 4:r.l+=4;break}return r.l+=8,e}function pk(r,e){return Si(r,e)}function mk(r,e){return Si(r,e)}function gk(r){var e=r.read_shift(2),t=r.read_shift(2)-4,i=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:i[1]=dk(r);break;case 6:i[1]=mk(r,t);break;case 14:case 15:i[1]=r.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+t)}return i}function vk(r,e){var t=r.l+e;r.l+=2;var i=r.read_shift(2);r.l+=2;for(var n=r.read_shift(2),s=[];n-- >0;)s.push(gk(r,t-r.l));return{ixfe:i,ext:s}}function bk(r,e){e.forEach(function(t){t[0]})}function wk(r,e){return{flags:r.read_shift(4),version:r.read_shift(4),name:ki(r)}}function xk(r){var e=Pe(12+2*r.name.length);return e.write_shift(4,r.flags),e.write_shift(4,r.version),ni(r.name,e),e.slice(0,e.l)}function yk(r){for(var e=[],t=r.read_shift(4);t-- >0;)e.push([r.read_shift(4),r.read_shift(4)]);return e}function Ek(r){var e=Pe(4+8*r.length);e.write_shift(4,r.length);for(var t=0;t<r.length;++t)e.write_shift(4,r[t][0]),e.write_shift(4,r[t][1]);return e}function Ck(r,e){var t=Pe(8+2*e.length);return t.write_shift(4,r),ni(e,t),t.slice(0,t.l)}function _k(r){return r.l+=4,r.read_shift(4)!=0}function kk(r,e){var t=Pe(8);return t.write_shift(4,r),t.write_shift(4,1),t}function Sk(r,e,t){var i={Types:[],Cell:[],Value:[]},n=t||{},s=[],a=!1,o=2;return As(r,function(l,h,c){switch(c){case 335:i.Types.push({name:l.name});break;case 51:l.forEach(function(d){o==1?i.Cell.push({type:i.Types[d[0]-1].name,index:d[1]}):o==0&&i.Value.push({type:i.Types[d[0]-1].name,index:d[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(c),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!h.T){if(!a||n.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+c.toString(16))}}}),i}function Tk(){var r=Ui();return Be(r,332),Be(r,334,zn(1)),Be(r,335,xk({name:"XLDAPR",version:12e4,flags:3496657072})),Be(r,336),Be(r,339,Ck(1,"XLDAPR")),Be(r,52),Be(r,35,zn(514)),Be(r,4096,zn(0)),Be(r,4097,wn(1)),Be(r,36),Be(r,53),Be(r,340),Be(r,337,kk(1)),Be(r,51,Ek([[1,0]])),Be(r,338),Be(r,333),r.end()}function Ak(r,e,t){var i={Types:[],Cell:[],Value:[]};if(!r)return i;var n=!1,s=2,a;return r.replace(Ti,function(o){var l=yt(o);switch(hs(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":i.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<i.Types.length;++h)i.Types[h].name==l.name&&(a=i.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?i.Cell.push({type:i.Types[l.t-1].name,index:+l.v}):s==0&&i.Value.push({type:i.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),i}function tv(){var r=[Br];return r.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),r.join("")}function Fk(r){var e=[];if(!r)return e;var t=1;return(r.match(Ti)||[]).forEach(function(i){var n=yt(i);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?t=n.i:n.i=t,e.push(n);break}}),e}function Rk(r){var e={};e.i=r.read_shift(4);var t={};t.r=r.read_shift(4),t.c=r.read_shift(4),e.r=xt(t);var i=r.read_shift(1);return i&2&&(e.l="1"),i&8&&(e.a="1"),e}function Lk(r,e,t){var i=[];return As(r,function(s,a,o){switch(o){case 63:i.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),i}function Nk(r,e,t,i){if(!r)return r;var n=i||{},s=!1;As(r,function(o,l,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||n.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},n)}function Pk(r,e){if(!r)return"??";var t=(r.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][t].Target}var Ro=1024;function rv(r,e){for(var t=[21600,21600],i=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),n=[Ke("xml",null,{"xmlns:v":Zi.v,"xmlns:o":Zi.o,"xmlns:x":Zi.x,"xmlns:mv":Zi.mv}).replace(/\/>/,">"),Ke("o:shapelayout",Ke("o:idmap",null,{"v:ext":"edit",data:r}),{"v:ext":"edit"}),Ke("v:shapetype",[Ke("v:stroke",null,{joinstyle:"miter"}),Ke("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:i})];Ro<r*1e3;)Ro+=1e3;return e.forEach(function(s){var a=yr(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?Ke("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=Ke("v:fill",l,o),c={on:"t",obscured:"t"};++Ro,n=n.concat(["<v:shape"+$l({id:"_x0000_s"+Ro,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,Ke("v:shadow",null,c),Ke("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",li("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),li("x:AutoFill","False"),li("x:Row",String(a.r)),li("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function xm(r,e,t,i){var n=Array.isArray(r),s;e.forEach(function(a){var o=yr(a.ref);if(n?(r[o.r]||(r[o.r]=[]),s=r[o.r][o.c]):s=r[a.ref],!s){s={t:"z"},n?r[o.r][o.c]=s:r[a.ref]=s;var l=Ht(r["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var h=Lt(l);h!==r["!ref"]&&(r["!ref"]=h)}s.c||(s.c=[]);var c={a:a.author,t:a.t,r:a.r,T:t};a.h&&(c.h=a.h);for(var d=s.c.length-1;d>=0;--d){if(!t&&s.c[d].T)return;t&&!s.c[d].T&&s.c.splice(d,1)}if(t&&i){for(d=0;d<i.length;++d)if(c.a==i[d].id){c.a=i[d].name||c.a;break}}s.c.push(c)})}function Dk(r,e){if(r.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],i=[],n=r.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&t.push(o[1])}});var s=r.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=yt(o[0]),h={author:l.authorId&&t[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},c=yr(l.ref);if(!(e.sheetRows&&e.sheetRows<=c.r)){var d=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!d&&!!d[1]&&Ud(d[1])||{r:"",t:"",h:""};h.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),h.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(h.h=p.h),i.push(h)}}}}),i}function iv(r){var e=[Br,Ke("comments",null,{xmlns:Ua[0]})],t=[];return e.push("<authors>"),r.forEach(function(i){i[1].forEach(function(n){var s=rr(n.a);t.indexOf(s)==-1&&(t.push(s),e.push("<author>"+s+"</author>")),n.T&&n.ID&&t.indexOf("tc="+n.ID)==-1&&(t.push("tc="+n.ID),e.push("<author>tc="+n.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),r.forEach(function(i){var n=0,s=[];if(i[1][0]&&i[1][0].T&&i[1][0].ID?n=t.indexOf("tc="+i[1][0].ID):i[1].forEach(function(l){l.a&&(n=t.indexOf(rr(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+i[0]+'" authorId="'+n+'"><text>'),s.length<=1)e.push(li("t",rr(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(li("t",rr(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function Mk(r,e){var t=[],i=!1,n={},s=0;return r.replace(Ti,function(o,l){var h=yt(o);switch(hs(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":n.t!=null&&t.push(n);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":n.t=r.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":i=!0;break;case"</mentions>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(!i&&e.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return o}),t}function Ok(r,e,t){var i=[Br,Ke("ThreadedComments",null,{xmlns:$r.TCMNT}).replace(/[\/]>/,">")];return r.forEach(function(n){var s="";(n[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),i.push(Ke("threadedComment",li("text",a.t||""),l))})}),i.push("</ThreadedComments>"),i.join("")}function Ik(r,e){var t=[],i=!1;return r.replace(Ti,function(s){var a=yt(s);switch(hs(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(!i&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),t}function Bk(r){var e=[Br,Ke("personList",null,{xmlns:$r.TCMNT,"xmlns:x":Ua[0]}).replace(/[\/]>/,">")];return r.forEach(function(t,i){e.push(Ke("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function Hk(r){var e={};e.iauthor=r.read_shift(4);var t=Xa(r);return e.rfx=t.s,e.ref=xt(t.s),r.l+=16,e}function zk(r,e){return e==null&&(e=Pe(36)),e.write_shift(4,r[1].iauthor),Vo(r[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var jk=ki;function Wk(r){return ni(r.slice(0,54))}function Uk(r,e){var t=[],i=[],n={},s=!1;return As(r,function(o,l,h){switch(h){case 632:i.push(o);break;case 635:n=o;break;case 637:n.t=o.t,n.h=o.h,n.r=o.r;break;case 636:if(n.author=i[n.iauthor],delete n.iauthor,e.sheetRows&&n.rfx&&e.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,t.push(n);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),t}function Vk(r){var e=Ui(),t=[];return Be(e,628),Be(e,630),r.forEach(function(i){i[1].forEach(function(n){t.indexOf(n.a)>-1||(t.push(n.a.slice(0,54)),Be(e,632,Wk(n.a)))})}),Be(e,631),Be(e,633),r.forEach(function(i){i[1].forEach(function(n){n.iauthor=t.indexOf(n.a);var s={s:yr(i[0]),e:yr(i[0])};Be(e,635,zk([s,n])),n.t&&n.t.length>0&&Be(e,637,fC(n)),Be(e,636),delete n.iauthor})}),Be(e,634),Be(e,629),e.end()}var Gk="application/vnd.ms-office.vbaProject";function qk(r){var e=ut.utils.cfb_new({root:"R"});return r.FullPaths.forEach(function(t,i){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var n=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");ut.utils.cfb_add(e,n,r.FileIndex[i].content)}}),ut.write(e)}function Xk(r,e){e.FullPaths.forEach(function(t,i){if(i!=0){var n=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&ut.utils.cfb_add(r,n,e.FileIndex[i].content)}})}var nv=["xlsb","xlsm","xlam","biff8","xla"];function Kk(){return{"!type":"dialog"}}function Yk(){return{"!type":"dialog"}}function $k(){return{"!type":"macro"}}function Jk(){return{"!type":"macro"}}var Po=(function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(i,n,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var h=s.length>0?parseInt(s,10)|0:0,c=a.length>0?parseInt(a,10)|0:0;return o?c+=e.c:--c,l?h+=e.r:--h,n+(o?"":"$")+vr(c)+(l?"":"$")+Tr(h)}return function(n,s){return e=s,n.replace(r,t)}})(),Xd=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Kd=(function(){return function(e,t){return e.replace(Xd,function(i,n,s,a,o,l){var h=Dd(a)-(s?0:t.c),c=Pd(l)-(o?0:t.r),d=c==0?"":o?c+1:"["+c+"]",p=h==0?"":s?h+1:"["+h+"]";return n+"R"+d+"C"+p})}})();function sv(r,e){return r.replace(Xd,function(t,i,n,s,a,o){return i+(n=="$"?n+s:vr(Dd(s)+e.c))+(a=="$"?a+o:Tr(Pd(o)+e.r))})}function Zk(r,e,t){var i=Ni(e),n=i.s,s=yr(t),a={r:s.r-n.r,c:s.c-n.c};return sv(r,a)}function Qk(r){return r.length!=1}function ym(r){return r.replace(/_xlfn\./g,"")}function Ur(r){r.l+=1}function oa(r,e){var t=r.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function av(r,e,t){var i=2;if(t){if(t.biff>=2&&t.biff<=5)return ov(r);t.biff==12&&(i=4)}var n=r.read_shift(i),s=r.read_shift(i),a=oa(r),o=oa(r);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function ov(r){var e=oa(r),t=oa(r),i=r.read_shift(1),n=r.read_shift(1);return{s:{r:e[0],c:i,cRel:e[1],rRel:e[2]},e:{r:t[0],c:n,cRel:t[1],rRel:t[2]}}}function eS(r,e,t){if(t.biff<8)return ov(r);var i=r.read_shift(t.biff==12?4:2),n=r.read_shift(t.biff==12?4:2),s=oa(r),a=oa(r);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:n,c:a[0],cRel:a[1],rRel:a[2]}}}function lv(r,e,t){if(t&&t.biff>=2&&t.biff<=5)return tS(r);var i=r.read_shift(t&&t.biff==12?4:2),n=oa(r);return{r:i,c:n[0],cRel:n[1],rRel:n[2]}}function tS(r){var e=oa(r),t=r.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function rS(r){var e=r.read_shift(2),t=r.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function iS(r,e,t){var i=t&&t.biff?t.biff:8;if(i>=2&&i<=5)return nS(r);var n=r.read_shift(i>=12?4:2),s=r.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;n>524287;)n-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:n,c:s,cRel:a,rRel:o}}function nS(r){var e=r.read_shift(2),t=r.read_shift(1),i=(e&32768)>>15,n=(e&16384)>>14;return e&=16383,i==1&&e>=8192&&(e=e-16384),n==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:n,rRel:i}}function sS(r,e,t){var i=(r[r.l++]&96)>>5,n=av(r,t.biff>=2&&t.biff<=5?6:8,t);return[i,n]}function aS(r,e,t){var i=(r[r.l++]&96)>>5,n=r.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}var a=av(r,s,t);return[i,n,a]}function oS(r,e,t){var i=(r[r.l++]&96)>>5;return r.l+=t&&t.biff>8?12:t.biff<8?6:8,[i]}function lS(r,e,t){var i=(r[r.l++]&96)>>5,n=r.read_shift(2),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}return r.l+=s,[i,n]}function hS(r,e,t){var i=(r[r.l++]&96)>>5,n=eS(r,e-1,t);return[i,n]}function cS(r,e,t){var i=(r[r.l++]&96)>>5;return r.l+=t.biff==2?6:t.biff==12?14:7,[i]}function Em(r){var e=r[r.l+1]&1,t=1;return r.l+=4,[e,t]}function uS(r,e,t){r.l+=2;for(var i=r.read_shift(t&&t.biff==2?1:2),n=[],s=0;s<=i;++s)n.push(r.read_shift(t&&t.biff==2?1:2));return n}function fS(r,e,t){var i=r[r.l+1]&255?1:0;return r.l+=2,[i,r.read_shift(t&&t.biff==2?1:2)]}function dS(r,e,t){var i=r[r.l+1]&255?1:0;return r.l+=2,[i,r.read_shift(t&&t.biff==2?1:2)]}function pS(r){var e=r[r.l+1]&255?1:0;return r.l+=2,[e,r.read_shift(2)]}function mS(r,e,t){var i=r[r.l+1]&255?1:0;return r.l+=t&&t.biff==2?3:4,[i]}function hv(r){var e=r.read_shift(1),t=r.read_shift(1);return[e,t]}function gS(r){return r.read_shift(2),hv(r)}function vS(r){return r.read_shift(2),hv(r)}function bS(r,e,t){var i=(r[r.l]&96)>>5;r.l+=1;var n=lv(r,0,t);return[i,n]}function wS(r,e,t){var i=(r[r.l]&96)>>5;r.l+=1;var n=iS(r,0,t);return[i,n]}function xS(r,e,t){var i=(r[r.l]&96)>>5;r.l+=1;var n=r.read_shift(2);t&&t.biff==5&&(r.l+=12);var s=lv(r,0,t);return[i,n,s]}function yS(r,e,t){var i=(r[r.l]&96)>>5;r.l+=1;var n=r.read_shift(t&&t.biff<=3?1:2);return[_T[n],fv[n],i]}function ES(r,e,t){var i=r[r.l++],n=r.read_shift(1),s=t&&t.biff<=3?[i==88?-1:0,r.read_shift(1)]:CS(r);return[n,(s[0]===0?fv:CT)[s[1]]]}function CS(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function _S(r,e,t){r.l+=t&&t.biff==2?3:4}function kS(r,e,t){if(r.l++,t&&t.biff==12)return[r.read_shift(4,"i"),0];var i=r.read_shift(2),n=r.read_shift(t&&t.biff==2?1:2);return[i,n]}function SS(r){return r.l++,Fs[r.read_shift(1)]}function TS(r){return r.l++,r.read_shift(2)}function AS(r){return r.l++,r.read_shift(1)!==0}function FS(r){return r.l++,Ci(r)}function RS(r,e,t){return r.l++,ph(r,e-1,t)}function LS(r,e){var t=[r.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Pr(r,1)?"TRUE":"FALSE",e!=12&&(r.l+=7);break;case 37:case 16:t[1]=Fs[r[r.l]],r.l+=e==12?4:8;break;case 0:r.l+=8;break;case 1:t[1]=Ci(r);break;case 2:t[1]=Ka(r,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function NS(r,e,t){for(var i=r.read_shift(t.biff==12?4:2),n=[],s=0;s!=i;++s)n.push((t.biff==12?Xa:hu)(r));return n}function PS(r,e,t){var i=0,n=0;t.biff==12?(i=r.read_shift(4),n=r.read_shift(4)):(n=1+r.read_shift(1),i=1+r.read_shift(2)),t.biff>=2&&t.biff<8&&(--i,--n==0&&(n=256));for(var s=0,a=[];s!=i&&(a[s]=[]);++s)for(var o=0;o!=n;++o)a[s][o]=LS(r,t.biff);return a}function DS(r,e,t){var i=r.read_shift(1)>>>5&3,n=!t||t.biff>=8?4:2,s=r.read_shift(n);switch(t.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[i,0,s]}function MS(r,e,t){if(t.biff==5)return OS(r);var i=r.read_shift(1)>>>5&3,n=r.read_shift(2),s=r.read_shift(4);return[i,n,s]}function OS(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2,"i");r.l+=8;var i=r.read_shift(2);return r.l+=12,[e,t,i]}function IS(r,e,t){var i=r.read_shift(1)>>>5&3;r.l+=t&&t.biff==2?3:4;var n=r.read_shift(t&&t.biff==2?1:2);return[i,n]}function BS(r,e,t){var i=r.read_shift(1)>>>5&3,n=r.read_shift(t&&t.biff==2?1:2);return[i,n]}function HS(r,e,t){var i=r.read_shift(1)>>>5&3;return r.l+=4,t.biff<8&&r.l--,t.biff==12&&(r.l+=2),[i]}function zS(r,e,t){var i=(r[r.l++]&96)>>5,n=r.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return r.l+=s,[i,n]}var jS=Si,WS=Si,US=Si;function gh(r,e,t){return r.l+=2,[rS(r)]}function Yd(r){return r.l+=6,[]}var VS=gh,GS=Yd,qS=Yd,XS=gh;function cv(r){return r.l+=2,[Gr(r),r.read_shift(2)&1]}var KS=gh,YS=cv,$S=Yd,JS=gh,ZS=gh,QS=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function eT(r){r.l+=2;var e=r.read_shift(2),t=r.read_shift(2),i=r.read_shift(4),n=r.read_shift(2),s=r.read_shift(2),a=QS[t>>2&31];return{ixti:e,coltype:t&3,rt:a,idx:i,c:n,C:s}}function tT(r){return r.l+=2,[r.read_shift(4)]}function rT(r,e,t){return r.l+=5,r.l+=2,r.l+=t.biff==2?1:4,["PTGSHEET"]}function iT(r,e,t){return r.l+=t.biff==2?4:5,["PTGENDSHEET"]}function nT(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function sT(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function aT(r){return r.l+=4,[0,0]}var Cm={1:{n:"PtgExp",f:kS},2:{n:"PtgTbl",f:US},3:{n:"PtgAdd",f:Ur},4:{n:"PtgSub",f:Ur},5:{n:"PtgMul",f:Ur},6:{n:"PtgDiv",f:Ur},7:{n:"PtgPower",f:Ur},8:{n:"PtgConcat",f:Ur},9:{n:"PtgLt",f:Ur},10:{n:"PtgLe",f:Ur},11:{n:"PtgEq",f:Ur},12:{n:"PtgGe",f:Ur},13:{n:"PtgGt",f:Ur},14:{n:"PtgNe",f:Ur},15:{n:"PtgIsect",f:Ur},16:{n:"PtgUnion",f:Ur},17:{n:"PtgRange",f:Ur},18:{n:"PtgUplus",f:Ur},19:{n:"PtgUminus",f:Ur},20:{n:"PtgPercent",f:Ur},21:{n:"PtgParen",f:Ur},22:{n:"PtgMissArg",f:Ur},23:{n:"PtgStr",f:RS},26:{n:"PtgSheet",f:rT},27:{n:"PtgEndSheet",f:iT},28:{n:"PtgErr",f:SS},29:{n:"PtgBool",f:AS},30:{n:"PtgInt",f:TS},31:{n:"PtgNum",f:FS},32:{n:"PtgArray",f:cS},33:{n:"PtgFunc",f:yS},34:{n:"PtgFuncVar",f:ES},35:{n:"PtgName",f:DS},36:{n:"PtgRef",f:bS},37:{n:"PtgArea",f:sS},38:{n:"PtgMemArea",f:IS},39:{n:"PtgMemErr",f:jS},40:{n:"PtgMemNoMem",f:WS},41:{n:"PtgMemFunc",f:BS},42:{n:"PtgRefErr",f:HS},43:{n:"PtgAreaErr",f:oS},44:{n:"PtgRefN",f:wS},45:{n:"PtgAreaN",f:hS},46:{n:"PtgMemAreaN",f:nT},47:{n:"PtgMemNoMemN",f:sT},57:{n:"PtgNameX",f:MS},58:{n:"PtgRef3d",f:xS},59:{n:"PtgArea3d",f:aS},60:{n:"PtgRefErr3d",f:zS},61:{n:"PtgAreaErr3d",f:lS},255:{}},oT={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},lT={1:{n:"PtgElfLel",f:cv},2:{n:"PtgElfRw",f:JS},3:{n:"PtgElfCol",f:VS},6:{n:"PtgElfRwV",f:ZS},7:{n:"PtgElfColV",f:XS},10:{n:"PtgElfRadical",f:KS},11:{n:"PtgElfRadicalS",f:$S},13:{n:"PtgElfColS",f:GS},15:{n:"PtgElfColSV",f:qS},16:{n:"PtgElfRadicalLel",f:YS},25:{n:"PtgList",f:eT},29:{n:"PtgSxName",f:tT},255:{}},hT={0:{n:"PtgAttrNoop",f:aT},1:{n:"PtgAttrSemi",f:mS},2:{n:"PtgAttrIf",f:dS},4:{n:"PtgAttrChoose",f:uS},8:{n:"PtgAttrGoto",f:fS},16:{n:"PtgAttrSum",f:_S},32:{n:"PtgAttrBaxcel",f:Em},33:{n:"PtgAttrBaxcel",f:Em},64:{n:"PtgAttrSpace",f:gS},65:{n:"PtgAttrSpaceSemi",f:vS},128:{n:"PtgAttrIfError",f:pS},255:{}};function vh(r,e,t,i){if(i.biff<8)return Si(r,e);for(var n=r.l+e,s=[],a=0;a!==t.length;++a)switch(t[a][0]){case"PtgArray":t[a][1]=PS(r,0,i),s.push(t[a][1]);break;case"PtgMemArea":t[a][2]=NS(r,t[a][1],i),s.push(t[a][2]);break;case"PtgExp":i&&i.biff==12&&(t[a][1][1]=r.read_shift(4),s.push(t[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[a][0]}return e=n-r.l,e!==0&&s.push(Si(r,e)),s}function bh(r,e,t){for(var i=r.l+e,n,s,a=[];i!=r.l;)e=i-r.l,s=r[r.l],n=Cm[s]||Cm[oT[s]],(s===24||s===25)&&(n=(s===24?lT:hT)[r[r.l+1]]),!n||!n.f?Si(r,e):a.push([n.n,n.f(r,e,t)]);return a}function cT(r){for(var e=[],t=0;t<r.length;++t){for(var i=r[t],n=[],s=0;s<i.length;++s){var a=i[s];if(a)switch(a[0]){case 2:n.push('"'+a[1].replace(/"/g,'""')+'"');break;default:n.push(a[1])}else n.push("")}e.push(n.join(","))}return e.join(";")}var uT={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function fT(r,e){if(!r&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r+"'":r}function uv(r,e,t){if(!r)return"SH33TJSERR0";if(t.biff>8&&(!r.XTI||!r.XTI[e]))return r.SheetNames[e];if(!r.XTI)return"SH33TJSERR6";var i=r.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":r.XTI[e-1];if(!i)return"SH33TJSERR1";var n="";if(t.biff>8)switch(r[i[0]][0]){case 357:return n=i[1]==-1?"#REF":r.SheetNames[i[1]],i[1]==i[2]?n:n+":"+r.SheetNames[i[2]];case 358:return t.SID!=null?r.SheetNames[t.SID]:"SH33TJSSAME"+r[i[0]][0];case 355:default:return"SH33TJSSRC"+r[i[0]][0]}switch(r[i[0]][0][0]){case 1025:return n=i[1]==-1?"#REF":r.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?n:n+":"+r.SheetNames[i[2]];case 14849:return r[i[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return r[i[0]][0][3]?(n=i[1]==-1?"#REF":r[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?n:n+":"+r[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function _m(r,e,t){var i=uv(r,e,t);return i=="#REF"?i:fT(i,t)}function xi(r,e,t,i,n){var s=n&&n.biff||8,a={s:{c:0,r:0}},o=[],l,h,c,d=0,p=0,f,g="";if(!r[0]||!r[0][0])return"";for(var m=-1,b="",w=0,E=r[0].length;w<E;++w){var C=r[0][w];switch(C[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),h=o.pop(),m>=0){switch(r[0][m][1][0]){case 0:b=Sr(" ",r[0][m][1][1]);break;case 1:b=Sr("\r",r[0][m][1][1]);break;default:if(b="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][m][1][0])}h=h+b,m=-1}o.push(h+uT[C[0]]+l);break;case"PtgIsect":l=o.pop(),h=o.pop(),o.push(h+" "+l);break;case"PtgUnion":l=o.pop(),h=o.pop(),o.push(h+","+l);break;case"PtgRange":l=o.pop(),h=o.pop(),o.push(h+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":c=Ol(C[1][1],a,n),o.push(Il(c,s));break;case"PtgRefN":c=t?Ol(C[1][1],t,n):C[1][1],o.push(Il(c,s));break;case"PtgRef3d":d=C[1][1],c=Ol(C[1][2],a,n),g=_m(i,d,n),o.push(g+"!"+Il(c,s));break;case"PtgFunc":case"PtgFuncVar":var F=C[1][0],L=C[1][1];F||(F=0),F&=127;var D=F==0?[]:o.slice(-F);o.length-=F,L==="User"&&(L=D.shift()),o.push(L+"("+D.join(",")+")");break;case"PtgBool":o.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(C[1]);break;case"PtgNum":o.push(String(C[1]));break;case"PtgStr":o.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(C[1]);break;case"PtgAreaN":f=Qp(C[1][1],t?{s:t}:a,n),o.push(gf(f,n));break;case"PtgArea":f=Qp(C[1][1],a,n),o.push(gf(f,n));break;case"PtgArea3d":d=C[1][1],f=C[1][2],g=_m(i,d,n),o.push(g+"!"+gf(f,n));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=C[1][2];var S=(i.names||[])[p-1]||(i[0]||[])[p],A=S?S.Name:"SH33TJSNAME"+String(p);A&&A.slice(0,6)=="_xlfn."&&!n.xlfn&&(A=A.slice(6)),o.push(A);break;case"PtgNameX":var O=C[1][1];p=C[1][2];var U;if(n.biff<=5)O<0&&(O=-O),i[O]&&(U=i[O][p]);else{var R="";if(((i[O]||[])[0]||[])[0]==14849||(((i[O]||[])[0]||[])[0]==1025?i[O][p]&&i[O][p].itab>0&&(R=i.SheetNames[i[O][p].itab-1]+"!"):R=i.SheetNames[p-1]+"!"),i[O]&&i[O][p])R+=i[O][p].Name;else if(i[0]&&i[0][p])R+=i[0][p].Name;else{var k=(uv(i,O,n)||"").split(";;");k[p-1]?R=k[p-1]:R+="SH33TJSERRX"}o.push(R);break}U||(U={Name:"SH33TJSERRY"}),o.push(U.Name);break;case"PtgParen":var M="(",V=")";if(m>=0){switch(b="",r[0][m][1][0]){case 2:M=Sr(" ",r[0][m][1][1])+M;break;case 3:M=Sr("\r",r[0][m][1][1])+M;break;case 4:V=Sr(" ",r[0][m][1][1])+V;break;case 5:V=Sr("\r",r[0][m][1][1])+V;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][m][1][0])}m=-1}o.push(M+o.pop()+V);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":c={c:C[1][1],r:C[1][0]};var oe={c:t.c,r:t.r};if(i.sharedf[xt(c)]){var K=i.sharedf[xt(c)];o.push(xi(K,a,oe,i,n))}else{var Y=!1;for(l=0;l!=i.arrayf.length;++l)if(h=i.arrayf[l],!(c.c<h[0].s.c||c.c>h[0].e.c)&&!(c.r<h[0].s.r||c.r>h[0].e.r)){o.push(xi(h[1],a,oe,i,n)),Y=!0;break}Y||o.push(C[1])}break;case"PtgArray":o.push("{"+cT(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var se=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&m>=0&&se.indexOf(r[0][w][0])==-1){C=r[0][m];var q=!0;switch(C[1][0]){case 4:q=!1;case 0:b=Sr(" ",C[1][1]);break;case 5:q=!1;case 1:b=Sr("\r",C[1][1]);break;default:if(b="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}o.push((q?b:"")+o.pop()+(q?"":b)),m=-1}}if(o.length>1&&n.WTF)throw new Error("bad formula stack");return o[0]}function dT(r,e,t){var i=r.l+e,n=t.biff==2?1:2,s,a=r.read_shift(n);if(a==65535)return[[],Si(r,e-2)];var o=bh(r,a,t);return e!==a+n&&(s=vh(r,e-a-n,o,t)),r.l=i,[o,s]}function pT(r,e,t){var i=r.l+e,n=t.biff==2?1:2,s,a=r.read_shift(n);if(a==65535)return[[],Si(r,e-2)];var o=bh(r,a,t);return e!==a+n&&(s=vh(r,e-a-n,o,t)),r.l=i,[o,s]}function mT(r,e,t,i){var n=r.l+e,s=bh(r,i,t),a;return n!==r.l&&(a=vh(r,n-r.l,s,t)),[s,a]}function gT(r,e,t){var i=r.l+e,n,s=r.read_shift(2),a=bh(r,s,t);return s==65535?[[],Si(r,e-2)]:(e!==s+2&&(n=vh(r,i-s-2,a,t)),[a,n])}function vT(r){var e;if(_s(r,r.l+6)!==65535)return[Ci(r),"n"];switch(r[r.l]){case 0:return r.l+=8,["String","s"];case 1:return e=r[r.l+2]===1,r.l+=8,[e,"b"];case 2:return e=r[r.l+2],r.l+=8,[e,"e"];case 3:return r.l+=8,["","s"]}return[]}function bT(r){if(r==null){var e=Pe(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof r=="number")return Ia(r);return Ia(0)}function yf(r,e,t){var i=r.l+e,n=cs(r);t.biff==2&&++r.l;var s=vT(r),a=r.read_shift(1);t.biff!=2&&(r.read_shift(1),t.biff>=5&&r.read_shift(4));var o=pT(r,i-r.l,t);return{cell:n,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function wT(r,e,t,i,n){var s=Ha(e,t,n),a=bT(r.v),o=Pe(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var h=Pe(r.bf.length),c=0;c<r.bf.length;++c)h[c]=r.bf[c];var d=ii([s,a,o,h]);return d}function cu(r,e,t){var i=r.read_shift(4),n=bh(r,i,t),s=r.read_shift(4),a=s>0?vh(r,s,n,t):null;return[n,a]}var xT=cu,uu=cu,yT=cu,ET=cu,CT={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},fv={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},_T={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function km(r){return r.slice(0,3)=="of:"&&(r=r.slice(3)),r.charCodeAt(0)==61&&(r=r.slice(1),r.charCodeAt(0)==61&&(r=r.slice(1))),r=r.replace(/COM\.MICROSOFT\./g,""),r=r.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")}),r=r.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),r.replace(/[;~]/g,",").replace(/\|/g,";")}function kT(r){var e="of:="+r.replace(Xd,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Ef(r){var e=r.split(":"),t=e[0].split(".")[0];return[t,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function ST(r){return r.replace(/\./,"!")}var Hl={},Do={},zl=typeof Map<"u";function $d(r,e,t){var i=0,n=r.length;if(t){if(zl?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var s=zl?t.get(e):t[e];i<s.length;++i)if(r[s[i]].t===e)return r.Count++,s[i]}}else for(;i<n;++i)if(r[i].t===e)return r.Count++,i;return r[n]={t:e},r.Count++,r.Unique++,t&&(zl?(t.has(e)||t.set(e,[]),t.get(e).push(n)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(n))),n}function fu(r,e){var t={min:r+1,max:r+1},i=-1;return e.MDW&&(yi=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?i=th(e.wpx):e.wch!=null&&(i=e.wch),i>-1?(t.width=Uc(i),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function Na(r,e){if(r){var t=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(t=[1,1,1,1,.5,.5]),r.left==null&&(r.left=t[0]),r.right==null&&(r.right=t[1]),r.top==null&&(r.top=t[2]),r.bottom==null&&(r.bottom=t[3]),r.header==null&&(r.header=t[4]),r.footer==null&&(r.footer=t[5])}}function ua(r,e,t){var i=t.revssf[e.z!=null?e.z:"General"],n=60,s=r.length;if(i==null&&t.ssf){for(;n<392;++n)if(t.ssf[n]==null){as(e.z,n),t.ssf[n]=e.z,t.revssf[e.z]=i=n;break}}for(n=0;n!=s;++n)if(r[n].numFmtId===i)return n;return r[s]={numFmtId:i,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function dv(r,e,t,i,n,s){try{i.cellNF&&(r.z=vt[e])}catch(o){if(i.WTF)throw o}if(!(r.t==="z"&&!i.cellStyles)){if(r.t==="d"&&typeof r.v=="string"&&(r.v=br(r.v)),(!i||i.cellText!==!1)&&r.t!=="z")try{if(vt[e]==null&&as(EE[e]||"General",e),r.t==="e")r.w=r.w||Fs[r.v];else if(e===0)if(r.t==="n")(r.v|0)===r.v?r.w=r.v.toString(10):r.w=Kl(r.v);else if(r.t==="d"){var a=Jr(r.v);(a|0)===a?r.w=a.toString(10):r.w=Kl(a)}else{if(r.v===void 0)return"";r.w=Ma(r.v,Do)}else r.t==="d"?r.w=nn(e,Jr(r.v),Do):r.w=nn(e,r.v,Do)}catch(o){if(i.WTF)throw o}if(i.cellStyles&&t!=null)try{r.s=s.Fills[t],r.s.fgColor&&r.s.fgColor.theme&&!r.s.fgColor.rgb&&(r.s.fgColor.rgb=Wc(n.themeElements.clrScheme[r.s.fgColor.theme].rgb,r.s.fgColor.tint||0),i.WTF&&(r.s.fgColor.raw_rgb=n.themeElements.clrScheme[r.s.fgColor.theme].rgb)),r.s.bgColor&&r.s.bgColor.theme&&(r.s.bgColor.rgb=Wc(n.themeElements.clrScheme[r.s.bgColor.theme].rgb,r.s.bgColor.tint||0),i.WTF&&(r.s.bgColor.raw_rgb=n.themeElements.clrScheme[r.s.bgColor.theme].rgb))}catch(o){if(i.WTF&&s.Fills)throw o}}}function TT(r,e,t){if(r&&r["!ref"]){var i=Ht(r["!ref"]);if(i.e.c<i.s.c||i.e.r<i.s.r)throw new Error("Bad range ("+t+"): "+r["!ref"])}}function AT(r,e){var t=Ht(e);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(r["!ref"]=Lt(t))}var FT=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,RT=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,LT=/<(?:\w:)?hyperlink [^>]*>/mg,NT=/"(\w*:\w*)"/,PT=/<(?:\w:)?col\b[^>]*[\/]?>/g,DT=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,MT=/<(?:\w:)?pageMargins[^>]*\/>/g,pv=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,OT=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,IT=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function BT(r,e,t,i,n,s,a){if(!r)return r;i||(i={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",c="",d=r.match(RT);d?(h=r.slice(0,d.index),c=r.slice(d.index+d[0].length)):h=c=r;var p=h.match(pv);p?Jd(p[0],o,n,t):(p=h.match(OT))&&zT(p[0],p[1]||"",o,n,t);var f=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var g=h.slice(f,f+50).match(NT);g&&AT(o,g[1])}var m=h.match(IT);m&&m[1]&&QT(m[1],n);var b=[];if(e.cellStyles){var w=h.match(PT);w&&KT(b,w)}d&&rA(d[1],o,e,l,s,a);var E=c.match(DT);E&&(o["!autofilter"]=$T(E[0]));var C=[],F=c.match(FT);if(F)for(f=0;f!=F.length;++f)C[f]=Ht(F[f].slice(F[f].indexOf('"')+1));var L=c.match(LT);L&&GT(o,L,i);var D=c.match(MT);if(D&&(o["!margins"]=qT(yt(D[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Lt(l)),e.sheetRows>0&&o["!ref"]){var S=Ht(o["!ref"]);e.sheetRows<=+S.e.r&&(S.e.r=e.sheetRows-1,S.e.r>l.e.r&&(S.e.r=l.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>l.e.c&&(S.e.c=l.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Lt(S))}return b.length>0&&(o["!cols"]=b),C.length>0&&(o["!merges"]=C),o}function HT(r){if(r.length===0)return"";for(var e='<mergeCells count="'+r.length+'">',t=0;t!=r.length;++t)e+='<mergeCell ref="'+Lt(r[t])+'"/>';return e+"</mergeCells>"}function Jd(r,e,t,i){var n=yt(r);t.Sheets[i]||(t.Sheets[i]={}),n.codeName&&(t.Sheets[i].CodeName=Vt(sr(n.codeName)))}function zT(r,e,t,i,n){Jd(r.slice(0,r.indexOf(">")),t,i,n)}function jT(r,e,t,i,n){var s=!1,a={},o=null;if(i.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[t];try{e.Workbook&&(l=e.Workbook.Sheets[t].CodeName||l)}catch{}s=!0,a.codeName=ns(rr(l))}if(r&&r["!outline"]){var h={summaryBelow:1,summaryRight:1};r["!outline"].above&&(h.summaryBelow=0),r["!outline"].left&&(h.summaryRight=0),o=(o||"")+Ke("outlinePr",null,h)}!s&&!o||(n[n.length]=Ke("sheetPr",o,a))}var WT=["objects","scenarios","selectLockedCells","selectUnlockedCells"],UT=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function VT(r){var e={sheet:1};return WT.forEach(function(t){r[t]!=null&&r[t]&&(e[t]="1")}),UT.forEach(function(t){r[t]!=null&&!r[t]&&(e[t]="0")}),r.password&&(e.password=Vd(r.password).toString(16).toUpperCase()),Ke("sheetProtection",null,e)}function GT(r,e,t){for(var i=Array.isArray(r),n=0;n!=e.length;++n){var s=yt(sr(e[n]),!0);if(!s.ref)return;var a=((t||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+Vt(s.location))):(s.Target="#"+Vt(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Ht(s.ref),l=o.s.r;l<=o.e.r;++l)for(var h=o.s.c;h<=o.e.c;++h){var c=xt({c:h,r:l});i?(r[l]||(r[l]=[]),r[l][h]||(r[l][h]={t:"z",v:void 0}),r[l][h].l=s):(r[c]||(r[c]={t:"z",v:void 0}),r[c].l=s)}}}function qT(r){var e={};return["left","right","top","bottom","header","footer"].forEach(function(t){r[t]&&(e[t]=parseFloat(r[t]))}),e}function XT(r){return Na(r),Ke("pageMargins",null,r)}function KT(r,e){for(var t=!1,i=0;i!=e.length;++i){var n=yt(e[i],!0);n.hidden&&(n.hidden=mr(n.hidden));var s=parseInt(n.min,10)-1,a=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!t&&n.width&&(t=!0,Gd(n.width)),aa(n);s<=a;)r[s++]=cr(n)}}function YT(r,e){for(var t=["<cols>"],i,n=0;n!=e.length;++n)(i=e[n])&&(t[t.length]=Ke("col",null,fu(n,i)));return t[t.length]="</cols>",t.join("")}function $T(r){var e={ref:(r.match(/ref="([^"]*)"/)||[])[1]};return e}function JT(r,e,t,i){var n=typeof r.ref=="string"?r.ref:Lt(r.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,a=Ni(n);a.s.r==a.e.r&&(a.e.r=Ni(e["!ref"]).e.r,n=Lt(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==i){l.Ref="'"+t.SheetNames[i]+"'!"+n;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+t.SheetNames[i]+"'!"+n}),Ke("autoFilter",null,{ref:n})}var ZT=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function QT(r,e){e.Views||(e.Views=[{}]),(r.match(ZT)||[]).forEach(function(t,i){var n=yt(t);e.Views[i]||(e.Views[i]={}),+n.zoomScale&&(e.Views[i].zoom=+n.zoomScale),mr(n.rightToLeft)&&(e.Views[i].RTL=!0)})}function eA(r,e,t,i){var n={workbookViewId:"0"};return(((i||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=i.Workbook.Views[0].RTL?"1":"0"),Ke("sheetViews",Ke("sheetView",null,n),{})}function tA(r,e,t,i){if(r.c&&t["!comments"].push([e,r.c]),r.v===void 0&&typeof r.f!="string"||r.t==="z"&&!r.f)return"";var n="",s=r.t,a=r.v;if(r.t!=="z")switch(r.t){case"b":n=r.v?"1":"0";break;case"n":n=""+r.v;break;case"e":n=Fs[r.v];break;case"d":i&&i.cellDates?n=br(r.v,-1).toISOString():(r=cr(r),r.t="n",n=""+(r.v=Jr(br(r.v)))),typeof r.z>"u"&&(r.z=vt[14]);break;default:n=r.v;break}var o=li("v",rr(n)),l={r:e},h=ua(i.cellXfs,r,i);switch(h!==0&&(l.s=h),r.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(r.v==null){delete r.t;break}if(r.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(i&&i.bookSST){o=li("v",""+$d(i.Strings,r.v,i.revStrings)),l.t="s";break}l.t="str";break}if(r.t!=s&&(r.t=s,r.v=a),typeof r.f=="string"&&r.f){var c=r.F&&r.F.slice(0,e.length)==e?{t:"array",ref:r.F}:null;o=Ke("f",rr(r.f),c)+(r.v!=null?o:"")}return r.l&&t["!links"].push([e,r.l]),r.D&&(l.cm=1),Ke("c",o,l)}var rA=(function(){var r=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,i=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,s=Yl("v"),a=Yl("f");return function(l,h,c,d,p,f){for(var g=0,m="",b=[],w=[],E=0,C=0,F=0,L="",D,S,A=0,O=0,U,R,k=0,M=0,V=Array.isArray(f.CellXf),oe,K=[],Y=[],se=Array.isArray(h),q=[],fe={},ge=!1,_=!!c.sheetStubs,P=l.split(e),N=0,I=P.length;N!=I;++N){m=P[N].trim();var X=m.length;if(X!==0){var he=0;e:for(g=0;g<X;++g)switch(m[g]){case">":if(m[g-1]!="/"){++g;break e}if(c&&c.cellStyles){if(S=yt(m.slice(he,g),!0),A=S.r!=null?parseInt(S.r,10):A+1,O=-1,c.sheetRows&&c.sheetRows<A)continue;fe={},ge=!1,S.ht&&(ge=!0,fe.hpt=parseFloat(S.ht),fe.hpx=Bo(fe.hpt)),S.hidden=="1"&&(ge=!0,fe.hidden=!0),S.outlineLevel!=null&&(ge=!0,fe.level=+S.outlineLevel),ge&&(q[A-1]=fe)}break;case"<":he=g;break}if(he>=g)break;if(S=yt(m.slice(he,g),!0),A=S.r!=null?parseInt(S.r,10):A+1,O=-1,!(c.sheetRows&&c.sheetRows<A)){d.s.r>A-1&&(d.s.r=A-1),d.e.r<A-1&&(d.e.r=A-1),c&&c.cellStyles&&(fe={},ge=!1,S.ht&&(ge=!0,fe.hpt=parseFloat(S.ht),fe.hpx=Bo(fe.hpt)),S.hidden=="1"&&(ge=!0,fe.hidden=!0),S.outlineLevel!=null&&(ge=!0,fe.level=+S.outlineLevel),ge&&(q[A-1]=fe)),b=m.slice(g).split(r);for(var ce=0;ce!=b.length&&b[ce].trim().charAt(0)=="<";++ce);for(b=b.slice(ce),g=0;g!=b.length;++g)if(m=b[g].trim(),m.length!==0){if(w=m.match(t),E=g,C=0,F=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,w!=null&&w.length===2){for(E=0,L=w[1],C=0;C!=L.length&&!((F=L.charCodeAt(C)-64)<1||F>26);++C)E=26*E+F;--E,O=E}else++O;for(C=0;C!=m.length&&m.charCodeAt(C)!==62;++C);if(++C,S=yt(m.slice(0,C),!0),S.r||(S.r=xt({r:A-1,c:O})),L=m.slice(C),D={t:""},(w=L.match(s))!=null&&w[1]!==""&&(D.v=Vt(w[1])),c.cellFormula){if((w=L.match(a))!=null&&w[1]!==""){if(D.f=Vt(sr(w[1])).replace(/\r\n/g,`
`),c.xlfn||(D.f=ym(D.f)),w[0].indexOf('t="array"')>-1)D.F=(L.match(n)||[])[1],D.F.indexOf(":")>-1&&K.push([Ht(D.F),D.F]);else if(w[0].indexOf('t="shared"')>-1){R=yt(w[0]);var ue=Vt(sr(w[1]));c.xlfn||(ue=ym(ue)),Y[parseInt(R.si,10)]=[R,ue,S.r]}}else(w=L.match(/<f[^>]*\/>/))&&(R=yt(w[0]),Y[R.si]&&(D.f=Zk(Y[R.si][1],Y[R.si][2],S.r)));var be=yr(S.r);for(C=0;C<K.length;++C)be.r>=K[C][0].s.r&&be.r<=K[C][0].e.r&&be.c>=K[C][0].s.c&&be.c<=K[C][0].e.c&&(D.F=K[C][1])}if(S.t==null&&D.v===void 0)if(D.f||D.F)D.v=0,D.t="n";else if(_)D.t="z";else continue;else D.t=S.t||"n";switch(d.s.c>O&&(d.s.c=O),d.e.c<O&&(d.e.c=O),D.t){case"n":if(D.v==""||D.v==null){if(!_)continue;D.t="z"}else D.v=parseFloat(D.v);break;case"s":if(typeof D.v>"u"){if(!_)continue;D.t="z"}else U=Hl[parseInt(D.v,10)],D.v=U.t,D.r=U.r,c.cellHTML&&(D.h=U.h);break;case"str":D.t="s",D.v=D.v!=null?sr(D.v):"",c.cellHTML&&(D.h=kd(D.v));break;case"inlineStr":w=L.match(i),D.t="s",w!=null&&(U=Ud(w[1]))?(D.v=U.t,c.cellHTML&&(D.h=U.h)):D.v="";break;case"b":D.v=mr(D.v);break;case"d":c.cellDates?D.v=br(D.v,1):(D.v=Jr(br(D.v,1)),D.t="n");break;case"e":(!c||c.cellText!==!1)&&(D.w=D.v),D.v=g1[D.v];break}if(k=M=0,oe=null,V&&S.s!==void 0&&(oe=f.CellXf[S.s],oe!=null&&(oe.numFmtId!=null&&(k=oe.numFmtId),c.cellStyles&&oe.fillId!=null&&(M=oe.fillId))),dv(D,k,M,c,p,f),c.cellDates&&V&&D.t=="n"&&Wa(vt[k])&&(D.t="d",D.v=ou(D.v)),S.cm&&c.xlmeta){var Le=(c.xlmeta.Cell||[])[+S.cm-1];Le&&Le.type=="XLDAPR"&&(D.D=!0)}if(se){var Z=yr(S.r);h[Z.r]||(h[Z.r]=[]),h[Z.r][Z.c]=D}else h[S.r]=D}}}}q.length>0&&(h["!rows"]=q)}})();function iA(r,e,t,i){var n=[],s=[],a=Ht(r["!ref"]),o="",l,h="",c=[],d=0,p=0,f=r["!rows"],g=Array.isArray(r),m={r:h},b,w=-1;for(p=a.s.c;p<=a.e.c;++p)c[p]=vr(p);for(d=a.s.r;d<=a.e.r;++d){for(s=[],h=Tr(d),p=a.s.c;p<=a.e.c;++p){l=c[p]+h;var E=g?(r[d]||[])[p]:r[l];E!==void 0&&(o=tA(E,l,r,e))!=null&&s.push(o)}(s.length>0||f&&f[d])&&(m={r:h},f&&f[d]&&(b=f[d],b.hidden&&(m.hidden=1),w=-1,b.hpx?w=rh(b.hpx):b.hpt&&(w=b.hpt),w>-1&&(m.ht=w,m.customHeight=1),b.level&&(m.outlineLevel=b.level)),n[n.length]=Ke("row",s.join(""),m))}if(f)for(;d<f.length;++d)f&&f[d]&&(m={r:d+1},b=f[d],b.hidden&&(m.hidden=1),w=-1,b.hpx?w=rh(b.hpx):b.hpt&&(w=b.hpt),w>-1&&(m.ht=w,m.customHeight=1),b.level&&(m.outlineLevel=b.level),n[n.length]=Ke("row","",m));return n.join("")}function mv(r,e,t,i){var n=[Br,Ke("worksheet",null,{xmlns:Ua[0],"xmlns:r":$r.r})],s=t.SheetNames[r],a=0,o="",l=t.Sheets[s];l==null&&(l={});var h=l["!ref"]||"A1",c=Ht(h);if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575),h=Lt(c)}i||(i={}),l["!comments"]=[];var d=[];jT(l,t,r,e,n),n[n.length]=Ke("dimension",null,{ref:h}),n[n.length]=eA(l,e,r,t),e.sheetFormat&&(n[n.length]=Ke("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(n[n.length]=YT(l,l["!cols"])),n[a=n.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=iA(l,e),o.length>0&&(n[n.length]=o)),n.length>a+1&&(n[n.length]="</sheetData>",n[a]=n[a].replace("/>",">")),l["!protect"]&&(n[n.length]=VT(l["!protect"])),l["!autofilter"]!=null&&(n[n.length]=JT(l["!autofilter"],l,t,r)),l["!merges"]!=null&&l["!merges"].length>0&&(n[n.length]=HT(l["!merges"]));var p=-1,f,g=-1;return l["!links"].length>0&&(n[n.length]="<hyperlinks>",l["!links"].forEach(function(m){m[1].Target&&(f={ref:m[0]},m[1].Target.charAt(0)!="#"&&(g=er(i,-1,rr(m[1].Target).replace(/#.*$/,""),It.HLINK),f["r:id"]="rId"+g),(p=m[1].Target.indexOf("#"))>-1&&(f.location=rr(m[1].Target.slice(p+1))),m[1].Tooltip&&(f.tooltip=rr(m[1].Tooltip)),n[n.length]=Ke("hyperlink",null,f))}),n[n.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(n[n.length]=XT(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(n[n.length]=li("ignoredErrors",Ke("ignoredError",null,{numberStoredAsText:1,sqref:h}))),d.length>0&&(g=er(i,-1,"../drawings/drawing"+(r+1)+".xml",It.DRAW),n[n.length]=Ke("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=d),l["!comments"].length>0&&(g=er(i,-1,"../drawings/vmlDrawing"+(r+1)+".vml",It.VML),n[n.length]=Ke("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function nA(r,e){var t={},i=r.l+e;t.r=r.read_shift(4),r.l+=4;var n=r.read_shift(2);r.l+=1;var s=r.read_shift(1);return r.l=i,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=n/20),t}function sA(r,e,t){var i=Pe(145),n=(t["!rows"]||[])[r]||{};i.write_shift(4,r),i.write_shift(4,0);var s=320;n.hpx?s=rh(n.hpx)*20:n.hpt&&(s=n.hpt*20),i.write_shift(2,s),i.write_shift(1,0);var a=0;n.level&&(a|=n.level),n.hidden&&(a|=16),(n.hpx||n.hpt)&&(a|=32),i.write_shift(1,a),i.write_shift(1,0);var o=0,l=i.l;i.l+=4;for(var h={r,c:0},c=0;c<16;++c)if(!(e.s.c>c+1<<10||e.e.c<c<<10)){for(var d=-1,p=-1,f=c<<10;f<c+1<<10;++f){h.c=f;var g=Array.isArray(t)?(t[h.r]||[])[h.c]:t[xt(h)];g&&(d<0&&(d=f),p=f)}d<0||(++o,i.write_shift(4,d),i.write_shift(4,p))}var m=i.l;return i.l=l,i.write_shift(4,o),i.l=m,i.length>i.l?i.slice(0,i.l):i}function aA(r,e,t,i){var n=sA(i,t,e);(n.length>17||(e["!rows"]||[])[i])&&Be(r,0,n)}var oA=Xa,lA=Vo;function hA(){}function cA(r,e){var t={},i=r[r.l];return++r.l,t.above=!(i&64),t.left=!(i&128),r.l+=18,t.name=dC(r),t}function uA(r,e,t){t==null&&(t=Pe(84+4*r.length));var i=192;e&&(e.above&&(i&=-65),e.left&&(i&=-129)),t.write_shift(1,i);for(var n=1;n<3;++n)t.write_shift(1,0);return Hc({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),u1(r,t),t.slice(0,t.l)}function fA(r){var e=En(r);return[e]}function dA(r,e,t){return t==null&&(t=Pe(8)),Va(e,t)}function pA(r){var e=Ga(r);return[e]}function mA(r,e,t){return t==null&&(t=Pe(4)),qa(e,t)}function gA(r){var e=En(r),t=r.read_shift(1);return[e,t,"b"]}function vA(r,e,t){return t==null&&(t=Pe(9)),Va(e,t),t.write_shift(1,r.v?1:0),t}function bA(r){var e=Ga(r),t=r.read_shift(1);return[e,t,"b"]}function wA(r,e,t){return t==null&&(t=Pe(5)),qa(e,t),t.write_shift(1,r.v?1:0),t}function xA(r){var e=En(r),t=r.read_shift(1);return[e,t,"e"]}function yA(r,e,t){return t==null&&(t=Pe(9)),Va(e,t),t.write_shift(1,r.v),t}function EA(r){var e=Ga(r),t=r.read_shift(1);return[e,t,"e"]}function CA(r,e,t){return t==null&&(t=Pe(8)),qa(e,t),t.write_shift(1,r.v),t.write_shift(2,0),t.write_shift(1,0),t}function _A(r){var e=En(r),t=r.read_shift(4);return[e,t,"s"]}function kA(r,e,t){return t==null&&(t=Pe(12)),Va(e,t),t.write_shift(4,e.v),t}function SA(r){var e=Ga(r),t=r.read_shift(4);return[e,t,"s"]}function TA(r,e,t){return t==null&&(t=Pe(8)),qa(e,t),t.write_shift(4,e.v),t}function AA(r){var e=En(r),t=Ci(r);return[e,t,"n"]}function FA(r,e,t){return t==null&&(t=Pe(16)),Va(e,t),Ia(r.v,t),t}function gv(r){var e=Ga(r),t=Ci(r);return[e,t,"n"]}function RA(r,e,t){return t==null&&(t=Pe(12)),qa(e,t),Ia(r.v,t),t}function LA(r){var e=En(r),t=Bd(r);return[e,t,"n"]}function NA(r,e,t){return t==null&&(t=Pe(12)),Va(e,t),f1(r.v,t),t}function PA(r){var e=Ga(r),t=Bd(r);return[e,t,"n"]}function DA(r,e,t){return t==null&&(t=Pe(8)),qa(e,t),f1(r.v,t),t}function MA(r){var e=En(r),t=Md(r);return[e,t,"is"]}function OA(r){var e=En(r),t=ki(r);return[e,t,"str"]}function IA(r,e,t){return t==null&&(t=Pe(12+4*r.v.length)),Va(e,t),ni(r.v,t),t.length>t.l?t.slice(0,t.l):t}function BA(r){var e=Ga(r),t=ki(r);return[e,t,"str"]}function HA(r,e,t){return t==null&&(t=Pe(8+4*r.v.length)),qa(e,t),ni(r.v,t),t.length>t.l?t.slice(0,t.l):t}function zA(r,e,t){var i=r.l+e,n=En(r);n.r=t["!row"];var s=r.read_shift(1),a=[n,s,"b"];if(t.cellFormula){r.l+=2;var o=uu(r,i-r.l,t);a[3]=xi(o,null,n,t.supbooks,t)}else r.l=i;return a}function jA(r,e,t){var i=r.l+e,n=En(r);n.r=t["!row"];var s=r.read_shift(1),a=[n,s,"e"];if(t.cellFormula){r.l+=2;var o=uu(r,i-r.l,t);a[3]=xi(o,null,n,t.supbooks,t)}else r.l=i;return a}function WA(r,e,t){var i=r.l+e,n=En(r);n.r=t["!row"];var s=Ci(r),a=[n,s,"n"];if(t.cellFormula){r.l+=2;var o=uu(r,i-r.l,t);a[3]=xi(o,null,n,t.supbooks,t)}else r.l=i;return a}function UA(r,e,t){var i=r.l+e,n=En(r);n.r=t["!row"];var s=ki(r),a=[n,s,"str"];if(t.cellFormula){r.l+=2;var o=uu(r,i-r.l,t);a[3]=xi(o,null,n,t.supbooks,t)}else r.l=i;return a}var VA=Xa,GA=Vo;function qA(r,e){return e==null&&(e=Pe(4)),e.write_shift(4,r),e}function XA(r,e){var t=r.l+e,i=Xa(r),n=Od(r),s=ki(r),a=ki(r),o=ki(r);r.l=t;var l={rfx:i,relId:n,loc:s,display:o};return a&&(l.Tooltip=a),l}function KA(r,e){var t=Pe(50+4*(r[1].Target.length+(r[1].Tooltip||"").length));Vo({s:yr(r[0]),e:yr(r[0])},t),Id("rId"+e,t);var i=r[1].Target.indexOf("#"),n=i==-1?"":r[1].Target.slice(i+1);return ni(n||"",t),ni(r[1].Tooltip||"",t),ni("",t),t.slice(0,t.l)}function YA(){}function $A(r,e,t){var i=r.l+e,n=d1(r),s=r.read_shift(1),a=[n];if(a[2]=s,t.cellFormula){var o=xT(r,i-r.l,t);a[1]=o}else r.l=i;return a}function JA(r,e,t){var i=r.l+e,n=Xa(r),s=[n];if(t.cellFormula){var a=ET(r,i-r.l,t);s[1]=a,r.l=i}else r.l=i;return s}function ZA(r,e,t){t==null&&(t=Pe(18));var i=fu(r,e);t.write_shift(-4,r),t.write_shift(-4,r),t.write_shift(4,(i.width||10)*256),t.write_shift(4,0);var n=0;return e.hidden&&(n|=1),typeof i.width=="number"&&(n|=2),e.level&&(n|=e.level<<8),t.write_shift(2,n),t}var vv=["left","right","top","bottom","header","footer"];function QA(r){var e={};return vv.forEach(function(t){e[t]=Ci(r)}),e}function e6(r,e){return e==null&&(e=Pe(48)),Na(r),vv.forEach(function(t){Ia(r[t],e)}),e}function t6(r){var e=r.read_shift(2);return r.l+=28,{RTL:e&32}}function r6(r,e,t){t==null&&(t=Pe(30));var i=924;return(((e||{}).Views||[])[0]||{}).RTL&&(i|=32),t.write_shift(2,i),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function i6(r){var e=Pe(24);return e.write_shift(4,4),e.write_shift(4,1),Vo(r,e),e}function n6(r,e){return e==null&&(e=Pe(66)),e.write_shift(2,r.password?Vd(r.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,r[t[0]]!=null&&!r[t[0]]?1:0):e.write_shift(4,r[t[0]]!=null&&r[t[0]]?0:1)}),e}function s6(){}function a6(){}function o6(r,e,t,i,n,s,a){if(!r)return r;var o=e||{};i||(i={"!id":{}});var l=o.dense?[]:{},h,c={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,p=!1,f,g,m,b,w,E,C,F,L,D=[];o.biff=12,o["!row"]=0;var S=0,A=!1,O=[],U={},R=o.supbooks||n.supbooks||[[]];if(R.sharedf=U,R.arrayf=O,R.SheetNames=n.SheetNames||n.Sheets.map(function(se){return se.name}),!o.supbooks&&(o.supbooks=R,n.Names))for(var k=0;k<n.Names.length;++k)R[0][k+1]=n.Names[k];var M=[],V=[],oe=!1;ih[16]={n:"BrtShortReal",f:gv};var K;if(As(r,function(q,fe,ge){if(!p)switch(ge){case 148:h=q;break;case 0:f=q,o.sheetRows&&o.sheetRows<=f.r&&(p=!0),F=Tr(b=f.r),o["!row"]=f.r,(q.hidden||q.hpt||q.level!=null)&&(q.hpt&&(q.hpx=Bo(q.hpt)),V[q.r]=q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:q[2]},q[2]){case"n":g.v=q[1];break;case"s":C=Hl[q[1]],g.v=C.t,g.r=C.r;break;case"b":g.v=!!q[1];break;case"e":g.v=q[1],o.cellText!==!1&&(g.w=Fs[g.v]);break;case"str":g.t="s",g.v=q[1];break;case"is":g.t="s",g.v=q[1].t;break}if((m=a.CellXf[q[0].iStyleRef])&&dv(g,m.numFmtId,null,o,s,a),w=q[0].c==-1?w+1:q[0].c,o.dense?(l[b]||(l[b]=[]),l[b][w]=g):l[vr(w)+F]=g,o.cellFormula){for(A=!1,S=0;S<O.length;++S){var _=O[S];f.r>=_[0].s.r&&f.r<=_[0].e.r&&w>=_[0].s.c&&w<=_[0].e.c&&(g.F=Lt(_[0]),A=!0)}!A&&q.length>3&&(g.f=q[3])}if(c.s.r>f.r&&(c.s.r=f.r),c.s.c>w&&(c.s.c=w),c.e.r<f.r&&(c.e.r=f.r),c.e.c<w&&(c.e.c=w),o.cellDates&&m&&g.t=="n"&&Wa(vt[m.numFmtId])){var P=Qs(g.v);P&&(g.t="d",g.v=new Date(P.y,P.m-1,P.d,P.H,P.M,P.S,P.u))}K&&(K.type=="XLDAPR"&&(g.D=!0),K=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;g={t:"z",v:void 0},w=q[0].c==-1?w+1:q[0].c,o.dense?(l[b]||(l[b]=[]),l[b][w]=g):l[vr(w)+F]=g,c.s.r>f.r&&(c.s.r=f.r),c.s.c>w&&(c.s.c=w),c.e.r<f.r&&(c.e.r=f.r),c.e.c<w&&(c.e.c=w),K&&(K.type=="XLDAPR"&&(g.D=!0),K=void 0);break;case 176:D.push(q);break;case 49:K=((o.xlmeta||{}).Cell||[])[q-1];break;case 494:var N=i["!id"][q.relId];for(N?(q.Target=N.Target,q.loc&&(q.Target+="#"+q.loc),q.Rel=N):q.relId==""&&(q.Target="#"+q.loc),b=q.rfx.s.r;b<=q.rfx.e.r;++b)for(w=q.rfx.s.c;w<=q.rfx.e.c;++w)o.dense?(l[b]||(l[b]=[]),l[b][w]||(l[b][w]={t:"z",v:void 0}),l[b][w].l=q):(E=xt({c:w,r:b}),l[E]||(l[E]={t:"z",v:void 0}),l[E].l=q);break;case 426:if(!o.cellFormula)break;O.push(q),L=o.dense?l[b][w]:l[vr(w)+F],L.f=xi(q[1],c,{r:f.r,c:w},R,o),L.F=Lt(q[0]);break;case 427:if(!o.cellFormula)break;U[xt(q[0].s)]=q[1],L=o.dense?l[b][w]:l[vr(w)+F],L.f=xi(q[1],c,{r:f.r,c:w},R,o);break;case 60:if(!o.cellStyles)break;for(;q.e>=q.s;)M[q.e--]={width:q.w/256,hidden:!!(q.flags&1),level:q.level},oe||(oe=!0,Gd(q.w/256)),aa(M[q.e+1]);break;case 161:l["!autofilter"]={ref:Lt(q)};break;case 476:l["!margins"]=q;break;case 147:n.Sheets[t]||(n.Sheets[t]={}),q.name&&(n.Sheets[t].CodeName=q.name),(q.above||q.left)&&(l["!outline"]={above:q.above,left:q.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),q.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!fe.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+ge.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(c.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(l["!ref"]=Lt(h||c)),o.sheetRows&&l["!ref"]){var Y=Ht(l["!ref"]);o.sheetRows<=+Y.e.r&&(Y.e.r=o.sheetRows-1,Y.e.r>c.e.r&&(Y.e.r=c.e.r),Y.e.r<Y.s.r&&(Y.s.r=Y.e.r),Y.e.c>c.e.c&&(Y.e.c=c.e.c),Y.e.c<Y.s.c&&(Y.s.c=Y.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Lt(Y))}return D.length>0&&(l["!merges"]=D),M.length>0&&(l["!cols"]=M),V.length>0&&(l["!rows"]=V),l}function l6(r,e,t,i,n,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=cr(e),e.z=e.z||vt[14],e.v=Jr(br(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r:t,c:i};switch(l.s=ua(n.cellXfs,e,n),e.l&&s["!links"].push([xt(l),e.l]),e.c&&s["!comments"].push([xt(l),e.c]),e.t){case"s":case"str":return n.bookSST?(o=$d(n.Strings,e.v,n.revStrings),l.t="s",l.v=o,a?Be(r,18,TA(e,l)):Be(r,7,kA(e,l))):(l.t="str",a?Be(r,17,HA(e,l)):Be(r,6,IA(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?Be(r,13,DA(e,l)):Be(r,2,NA(e,l)):a?Be(r,16,RA(e,l)):Be(r,5,FA(e,l)),!0;case"b":return l.t="b",a?Be(r,15,wA(e,l)):Be(r,4,vA(e,l)),!0;case"e":return l.t="e",a?Be(r,14,CA(e,l)):Be(r,3,yA(e,l)),!0}return a?Be(r,12,mA(e,l)):Be(r,1,dA(e,l)),!0}function h6(r,e,t,i){var n=Ht(e["!ref"]||"A1"),s,a="",o=[];Be(r,145);var l=Array.isArray(e),h=n.e.r;e["!rows"]&&(h=Math.max(n.e.r,e["!rows"].length-1));for(var c=n.s.r;c<=h;++c){a=Tr(c),aA(r,e,n,c);var d=!1;if(c<=n.e.r)for(var p=n.s.c;p<=n.e.c;++p){c===n.s.r&&(o[p]=vr(p)),s=o[p]+a;var f=l?(e[c]||[])[p]:e[s];if(!f){d=!1;continue}d=l6(r,f,c,p,i,e,d)}}Be(r,146)}function c6(r,e){!e||!e["!merges"]||(Be(r,177,qA(e["!merges"].length)),e["!merges"].forEach(function(t){Be(r,176,GA(t))}),Be(r,178))}function u6(r,e){!e||!e["!cols"]||(Be(r,390),e["!cols"].forEach(function(t,i){t&&Be(r,60,ZA(i,t))}),Be(r,391))}function f6(r,e){!e||!e["!ref"]||(Be(r,648),Be(r,649,i6(Ht(e["!ref"]))),Be(r,650))}function d6(r,e,t){e["!links"].forEach(function(i){if(i[1].Target){var n=er(t,-1,i[1].Target.replace(/#.*$/,""),It.HLINK);Be(r,494,KA(i,n))}}),delete e["!links"]}function p6(r,e,t,i){if(e["!comments"].length>0){var n=er(i,-1,"../drawings/vmlDrawing"+(t+1)+".vml",It.VML);Be(r,551,Id("rId"+n)),e["!legacy"]=n}}function m6(r,e,t,i){if(e["!autofilter"]){var n=e["!autofilter"],s=typeof n.ref=="string"?n.ref:Lt(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var a=t.Workbook.Names,o=Ni(s);o.s.r==o.e.r&&(o.e.r=Ni(e["!ref"]).e.r,s=Lt(o));for(var l=0;l<a.length;++l){var h=a[l];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==i){h.Ref="'"+t.SheetNames[i]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+t.SheetNames[i]+"'!"+s}),Be(r,161,Vo(Ht(s))),Be(r,162)}}function g6(r,e,t){Be(r,133),Be(r,137,r6(e,t)),Be(r,138),Be(r,134)}function v6(r,e){e["!protect"]&&Be(r,535,n6(e["!protect"]))}function b6(r,e,t,i){var n=Ui(),s=t.SheetNames[r],a=t.Sheets[s]||{},o=s;try{t&&t.Workbook&&(o=t.Workbook.Sheets[r].CodeName||o)}catch{}var l=Ht(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Be(n,129),(t.vbaraw||a["!outline"])&&Be(n,147,uA(o,a["!outline"])),Be(n,148,lA(l)),g6(n,a,t.Workbook),u6(n,a),h6(n,a,r,e),v6(n,a),m6(n,a,t,r),c6(n,a),d6(n,a,i),a["!margins"]&&Be(n,476,e6(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&f6(n,a),p6(n,a,r,i),Be(n,130),n.end()}function w6(r){var e=[],t=r.match(/^<c:numCache>/),i;(r.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=t?+a[2]:a[2])});var n=Vt((r.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(r.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){i=s.replace(/<.*?>/g,"")}),[e,n,i]}function x6(r,e,t,i,n,s){var a=s||{"!type":"chart"};if(!r)return s;var o=0,l=0,h="A",c={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(r.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var p=w6(d);c.s.r=c.s.c=0,c.e.c=o,h=vr(o),p[0].forEach(function(f,g){a[h+Tr(g)]={t:"n",v:f,z:p[1]},l=g}),c.e.r<l&&(c.e.r=l),++o}),o>0&&(a["!ref"]=Lt(c)),a}function y6(r,e,t,i,n){if(!r)return r;i||(i={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=r.match(pv);return o&&Jd(o[0],s,n,t),(a=r.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),i["!id"][s["!rel"]]&&(s["!drawel"]=i["!id"][s["!rel"]]),s}function E6(r,e){r.l+=10;var t=ki(r);return{name:t}}function C6(r,e,t,i,n){if(!r)return r;i||(i={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return As(r,function(l,h,c){switch(c){case 550:s["!rel"]=l;break;case 651:n.Sheets[t]||(n.Sheets[t]={}),l.name&&(n.Sheets[t].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}},e),i["!id"][s["!rel"]]&&(s["!drawel"]=i["!id"][s["!rel"]]),s}var Zd=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],_6=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],k6=[],S6=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Sm(r,e){for(var t=0;t!=r.length;++t)for(var i=r[t],n=0;n!=e.length;++n){var s=e[n];if(i[s[0]]==null)i[s[0]]=s[1];else switch(s[2]){case"bool":typeof i[s[0]]=="string"&&(i[s[0]]=mr(i[s[0]]));break;case"int":typeof i[s[0]]=="string"&&(i[s[0]]=parseInt(i[s[0]],10));break}}}function Tm(r,e){for(var t=0;t!=e.length;++t){var i=e[t];if(r[i[0]]==null)r[i[0]]=i[1];else switch(i[2]){case"bool":typeof r[i[0]]=="string"&&(r[i[0]]=mr(r[i[0]]));break;case"int":typeof r[i[0]]=="string"&&(r[i[0]]=parseInt(r[i[0]],10));break}}}function bv(r){Tm(r.WBProps,Zd),Tm(r.CalcPr,S6),Sm(r.WBView,_6),Sm(r.Sheets,k6),Do.date1904=mr(r.WBProps.date1904)}function T6(r){return!r.Workbook||!r.Workbook.WBProps?"false":mr(r.Workbook.WBProps.date1904)?"true":"false"}var A6="][*?/\\".split("");function wv(r,e){if(r.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return A6.forEach(function(i){if(r.indexOf(i)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function F6(r,e,t){r.forEach(function(i,n){wv(i);for(var s=0;s<n;++s)if(i==r[s])throw new Error("Duplicate Sheet Name: "+i);if(t){var a=e&&e[n]&&e[n].CodeName||i;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function xv(r){if(!r||!r.SheetNames||!r.Sheets)throw new Error("Invalid Workbook");if(!r.SheetNames.length)throw new Error("Workbook is empty");var e=r.Workbook&&r.Workbook.Sheets||[];F6(r.SheetNames,e,!!r.vbaraw);for(var t=0;t<r.SheetNames.length;++t)TT(r.Sheets[r.SheetNames[t]],r.SheetNames[t],t)}var R6=/<\w+:workbook/;function L6(r,e){if(!r)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},i=!1,n="xmlns",s={},a=0;if(r.replace(Ti,function(l,h){var c=yt(l);switch(hs(c[0])){case"<?xml":break;case"<workbook":l.match(R6)&&(n="xmlns"+l.match(/<(\w+):/)[1]),t.xmlns=c[n];break;case"</workbook>":break;case"<fileVersion":delete c[0],t.AppVersion=c;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Zd.forEach(function(d){if(c[d[0]]!=null)switch(d[2]){case"bool":t.WBProps[d[0]]=mr(c[d[0]]);break;case"int":t.WBProps[d[0]]=parseInt(c[d[0]],10);break;default:t.WBProps[d[0]]=c[d[0]]}}),c.codeName&&(t.WBProps.CodeName=sr(c.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete c[0],t.WBView.push(c);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=Vt(sr(c.name)),delete c[0],t.Sheets.push(c);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":i=!0;break;case"</definedNames>":i=!1;break;case"<definedName":s={},s.Name=sr(c.name),c.comment&&(s.Comment=c.comment),c.localSheetId&&(s.Sheet=+c.localSheetId),mr(c.hidden||"0")&&(s.Hidden=!0),a=h+l.length;break;case"</definedName>":s.Ref=Vt(sr(r.slice(a,h))),t.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete c[0],t.CalcPr=c;break;case"<calcPr/>":delete c[0],t.CalcPr=c;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":i=!0;break;case"</AlternateContent>":i=!1;break;case"<revisionPtr":break;default:if(!i&&e.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return l}),Ua.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return bv(t),t}function yv(r){var e=[Br];e[e.length]=Ke("workbook",null,{xmlns:Ua[0],"xmlns:r":$r.r});var t=r.Workbook&&(r.Workbook.Names||[]).length>0,i={codeName:"ThisWorkbook"};r.Workbook&&r.Workbook.WBProps&&(Zd.forEach(function(o){r.Workbook.WBProps[o[0]]!=null&&r.Workbook.WBProps[o[0]]!=o[1]&&(i[o[0]]=r.Workbook.WBProps[o[0]])}),r.Workbook.WBProps.CodeName&&(i.codeName=r.Workbook.WBProps.CodeName,delete i.CodeName)),e[e.length]=Ke("workbookPr",null,i);var n=r.Workbook&&r.Workbook.Sheets||[],s=0;if(n&&n[0]&&n[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=r.SheetNames.length&&!(!n[s]||!n[s].Hidden);++s);s==r.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=r.SheetNames.length;++s){var a={name:rr(r.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),n[s])switch(n[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=Ke("sheet",null,a)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",r.Workbook&&r.Workbook.Names&&r.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=Ke("definedName",rr(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function N6(r,e){var t={};return t.Hidden=r.read_shift(4),t.iTabID=r.read_shift(4),t.strRelID=$f(r),t.name=ki(r),t}function P6(r,e){return e||(e=Pe(127)),e.write_shift(4,r.Hidden),e.write_shift(4,r.iTabID),Id(r.strRelID,e),ni(r.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function D6(r,e){var t={},i=r.read_shift(4);t.defaultThemeVersion=r.read_shift(4);var n=e>8?ki(r):"";return n.length>0&&(t.CodeName=n),t.autoCompressPictures=!!(i&65536),t.backupFile=!!(i&64),t.checkCompatibility=!!(i&4096),t.date1904=!!(i&1),t.filterPrivacy=!!(i&8),t.hidePivotFieldList=!!(i&1024),t.promptedSolutions=!!(i&16),t.publishItems=!!(i&2048),t.refreshAllConnections=!!(i&262144),t.saveExternalLinkValues=!!(i&128),t.showBorderUnselectedTables=!!(i&4),t.showInkAnnotation=!!(i&32),t.showObjects=["all","placeholders","none"][i>>13&3],t.showPivotChartFilter=!!(i&32768),t.updateLinks=["userSet","never","always"][i>>8&3],t}function M6(r,e){e||(e=Pe(72));var t=0;return r&&r.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),u1(r&&r.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function O6(r,e){var t={};return r.read_shift(4),t.ArchID=r.read_shift(4),r.l+=e-8,t}function I6(r,e,t){var i=r.l+e;r.l+=4,r.l+=1;var n=r.read_shift(4),s=pC(r),a=yT(r,0,t),o=Od(r);r.l=i;var l={Name:s,Ptg:a};return n<268435455&&(l.Sheet=n),o&&(l.Comment=o),l}function B6(r,e){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},i=[],n=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],ih[16]={n:"BrtFRTArchID$",f:O6},As(r,function(l,h,c){switch(c){case 156:a.SheetNames.push(l.name),t.Sheets.push(l);break;case 153:t.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=xi(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([c,l]):a[0]=[c,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:i.push(c),n=!0;break;case 36:i.pop(),n=!1;break;case 37:i.push(c),n=!0;break;case 38:i.pop(),n=!1;break;case 16:break;default:if(!h.T){if(!n||e.WTF&&i[i.length-1]!=37&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+c.toString(16))}}},e),bv(t),t.Names=s,t.supbooks=a,t}function H6(r,e){Be(r,143);for(var t=0;t!=e.SheetNames.length;++t){var i=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,n={Hidden:i,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};Be(r,156,P6(n))}Be(r,144)}function z6(r,e){e||(e=Pe(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return ni("SheetJS",e),ni(ql.version,e),ni(ql.version,e),ni("7262",e),e.length>e.l?e.slice(0,e.l):e}function j6(r,e){e||(e=Pe(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,r),e.write_shift(4,r);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function W6(r,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,i=0,n=-1,s=-1;i<t.length;++i)!t[i]||!t[i].Hidden&&n==-1?n=i:t[i].Hidden==1&&s==-1&&(s=i);s>n||(Be(r,135),Be(r,158,j6(n)),Be(r,136))}}function U6(r,e){var t=Ui();return Be(t,131),Be(t,128,z6()),Be(t,153,M6(r.Workbook&&r.Workbook.WBProps||null)),W6(t,r),H6(t,r),Be(t,132),t.end()}function V6(r,e,t){return e.slice(-4)===".bin"?B6(r,t):L6(r,t)}function G6(r,e,t,i,n,s,a,o){return e.slice(-4)===".bin"?o6(r,i,t,n,s,a,o):BT(r,i,t,n,s,a,o)}function q6(r,e,t,i,n,s,a,o){return e.slice(-4)===".bin"?C6(r,i,t,n,s):y6(r,i,t,n,s)}function X6(r,e,t,i,n,s,a,o){return e.slice(-4)===".bin"?$k():Jk()}function K6(r,e,t,i,n,s,a,o){return e.slice(-4)===".bin"?Kk():Yk()}function Y6(r,e,t,i){return e.slice(-4)===".bin"?G_(r,t,i):P_(r,t,i)}function $6(r,e,t){return ev(r,t)}function J6(r,e,t){return e.slice(-4)===".bin"?Z3(r,t):Y3(r,t)}function Z6(r,e,t){return e.slice(-4)===".bin"?Uk(r,t):Dk(r,t)}function Q6(r,e,t){return e.slice(-4)===".bin"?Lk(r):Fk(r)}function eF(r,e,t,i){return t.slice(-4)===".bin"?Nk(r,e,t,i):void 0}function tF(r,e,t){return e.slice(-4)===".bin"?Sk(r,e,t):Ak(r,e,t)}function rF(r,e,t){return(e.slice(-4)===".bin"?U6:yv)(r)}function iF(r,e,t,i,n){return(e.slice(-4)===".bin"?b6:mv)(r,t,i,n)}function nF(r,e,t){return(e.slice(-4)===".bin"?tk:Z1)(r,t)}function sF(r,e,t){return(e.slice(-4)===".bin"?t_:V1)(r,t)}function aF(r,e,t){return(e.slice(-4)===".bin"?Vk:iv)(r)}function oF(r){return(r.slice(-4)===".bin"?Tk:tv)()}var Ev=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Cv=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function In(r,e){var t=r.split(/\s+/),i=[];if(i[0]=t[0],t.length===1)return i;var n=r.match(Ev),s,a,o,l;if(n)for(l=0;l!=n.length;++l)s=n[l].match(Cv),(a=s[1].indexOf(":"))===-1?i[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),i[o]=s[2].slice(1,s[2].length-1));return i}function lF(r){var e=r.split(/\s+/),t={};if(e.length===1)return t;var i=r.match(Ev),n,s,a,o;if(i)for(o=0;o!=i.length;++o)n=i[o].match(Cv),(s=n[1].indexOf(":"))===-1?t[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?a="xmlns"+n[1].slice(6):a=n[1].slice(s+1),t[a]=n[2].slice(1,n[2].length-1));return t}var jl;function hF(r,e){var t=jl[r]||Vt(r);return t==="General"?Ma(e):nn(t,e)}function cF(r,e,t,i){var n=i;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=mr(i);break;case"i2":case"int":n=parseInt(i,10);break;case"r4":case"float":n=parseFloat(i);break;case"date":case"dateTime.tz":n=br(i);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}r[Vt(e)]=n}function uF(r,e,t){if(r.t!=="z"){if(!t||t.cellText!==!1)try{r.t==="e"?r.w=r.w||Fs[r.v]:e==="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=Kl(r.v):r.w=Ma(r.v):r.w=hF(e||"General",r.v)}catch(s){if(t.WTF)throw s}try{var i=jl[e]||e||"General";if(t.cellNF&&(r.z=i),t.cellDates&&r.t=="n"&&Wa(i)){var n=Qs(r.v);n&&(r.t="d",r.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(s){if(t.WTF)throw s}}}function fF(r,e,t){if(t.cellStyles&&e.Interior){var i=e.Interior;i.Pattern&&(i.patternType=k_[i.Pattern]||i.Pattern)}r[e.ID]=e}function dF(r,e,t,i,n,s,a,o,l,h){var c="General",d=i.StyleID,p={};h=h||{};var f=[],g=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&a&&(d=a.StyleID);s[d]!==void 0&&(s[d].nf&&(c=s[d].nf),s[d].Interior&&f.push(s[d].Interior),!!s[d].Parent);)d=s[d].Parent;switch(t.Type){case"Boolean":i.t="b",i.v=mr(r);break;case"String":i.t="s",i.r=Vp(Vt(r)),i.v=r.indexOf("<")>-1?Vt(e||r).replace(/<.*?>/g,""):i.r;break;case"DateTime":r.slice(-1)!="Z"&&(r+="Z"),i.v=(br(r)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),i.v!==i.v?i.v=Vt(r):i.v<60&&(i.v=i.v-1),(!c||c=="General")&&(c="yyyy-mm-dd");case"Number":i.v===void 0&&(i.v=+r),i.t||(i.t="n");break;case"Error":i.t="e",i.v=g1[r],h.cellText!==!1&&(i.w=r);break;default:r==""&&e==""?i.t="z":(i.t="s",i.v=Vp(e||r));break}if(uF(i,c,h),h.cellFormula!==!1)if(i.Formula){var m=Vt(i.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),i.f=Po(m,n),delete i.Formula,i.ArrayRange=="RC"?i.F=Po("RC:RC",n):i.ArrayRange&&(i.F=Po(i.ArrayRange,n),l.push([Ht(i.F),i.F]))}else for(g=0;g<l.length;++g)n.r>=l[g][0].s.r&&n.r<=l[g][0].e.r&&n.c>=l[g][0].s.c&&n.c<=l[g][0].e.c&&(i.F=l[g][1]);h.cellStyles&&(f.forEach(function(b){!p.patternType&&b.patternType&&(p.patternType=b.patternType)}),i.s=p),i.StyleID!==void 0&&(i.ixfe=i.StyleID)}function pF(r){r.t=r.v||"",r.t=r.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.v=r.w=r.ixfe=void 0}function Cf(r,e){var t=e||{};jo();var i=Fo(Sd(r));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(typeof jt<"u"?i=jt.utils.decode(65001,Nc(i)):i=sr(i));var n=i.slice(0,1024).toLowerCase(),s=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var a=cr(t);return a.type="string",Io.to_workbook(i,a)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Je){n.indexOf("<"+Je)>=0&&(s=!0)}),s)return $F(i,t);jl={"General Number":"General","General Date":vt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":vt[15],"Short Date":vt[14],"Long Time":vt[19],"Medium Time":vt[18],"Short Time":vt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:vt[2],Standard:vt[4],Percent:vt[10],Scientific:vt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],h,c={},d=[],p=t.dense?[]:{},f="",g={},m={},b=In('<Data ss:Type="String">'),w=0,E=0,C=0,F={s:{r:2e6,c:2e6},e:{r:0,c:0}},L={},D={},S="",A=0,O=[],U={},R={},k=0,M=[],V=[],oe={},K=[],Y,se=!1,q=[],fe=[],ge={},_=0,P=0,N={Sheets:[],WBProps:{date1904:!1}},I={};Jl.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/mg,"");for(var X="";o=Jl.exec(i);)switch(o[3]=(X=o[3]).toLowerCase()){case"data":if(X=="data"){if(o[1]==="/"){if((h=l.pop())[0]!==o[3])throw new Error("Bad state: "+h.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?dF(i.slice(w,o.index),S,b,l[l.length-1][0]=="comment"?oe:g,{c:E,r:C},L,K[E],m,q,t):(S="",b=In(o[0]),w=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(V.length>0&&(g.c=V),(!t.sheetRows||t.sheetRows>C)&&g.v!==void 0&&(t.dense?(p[C]||(p[C]=[]),p[C][E]=g):p[vr(E)+Tr(C)]=g),g.HRef&&(g.l={Target:Vt(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(_=E+(parseInt(g.MergeAcross,10)|0),P=C+(parseInt(g.MergeDown,10)|0),O.push({s:{c:E,r:C},e:{c:_,r:P}})),!t.sheetStubs)g.MergeAcross?E=_+1:++E;else if(g.MergeAcross||g.MergeDown){for(var he=E;he<=_;++he)for(var ce=C;ce<=P;++ce)(he>E||ce>C)&&(t.dense?(p[ce]||(p[ce]=[]),p[ce][he]={t:"z"}):p[vr(he)+Tr(ce)]={t:"z"});E=_+1}else++E;else g=lF(o[0]),g.Index&&(E=+g.Index-1),E<F.s.c&&(F.s.c=E),E>F.e.c&&(F.e.c=E),o[0].slice(-2)==="/>"&&++E,V=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(C<F.s.r&&(F.s.r=C),C>F.e.r&&(F.e.r=C),o[0].slice(-2)==="/>"&&(m=In(o[0]),m.Index&&(C=+m.Index-1)),E=0,++C):(m=In(o[0]),m.Index&&(C=+m.Index-1),ge={},(m.AutoFitHeight=="0"||m.Height)&&(ge.hpx=parseInt(m.Height,10),ge.hpt=rh(ge.hpx),fe[C]=ge),m.Hidden=="1"&&(ge.hidden=!0,fe[C]=ge));break;case"worksheet":if(o[1]==="/"){if((h=l.pop())[0]!==o[3])throw new Error("Bad state: "+h.join("|"));d.push(f),F.s.r<=F.e.r&&F.s.c<=F.e.c&&(p["!ref"]=Lt(F),t.sheetRows&&t.sheetRows<=F.e.r&&(p["!fullref"]=p["!ref"],F.e.r=t.sheetRows-1,p["!ref"]=Lt(F))),O.length&&(p["!merges"]=O),K.length>0&&(p["!cols"]=K),fe.length>0&&(p["!rows"]=fe),c[f]=p}else F={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=E=0,l.push([o[3],!1]),h=In(o[0]),f=Vt(h.Name),p=t.dense?[]:{},O=[],q=[],fe=[],I={name:f,Hidden:0},N.Sheets.push(I);break;case"table":if(o[1]==="/"){if((h=l.pop())[0]!==o[3])throw new Error("Bad state: "+h.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),K=[],se=!1}break;case"style":o[1]==="/"?fF(L,D,t):D=In(o[0]);break;case"numberformat":D.nf=Vt(In(o[0]).Format||"General"),jl[D.nf]&&(D.nf=jl[D.nf]);for(var ue=0;ue!=392&&vt[ue]!=D.nf;++ue);if(ue==392){for(ue=57;ue!=392;++ue)if(vt[ue]==null){as(D.nf,ue);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(Y=In(o[0]),Y.Hidden&&(Y.hidden=!0,delete Y.Hidden),Y.Width&&(Y.wpx=parseInt(Y.Width,10)),!se&&Y.wpx>10){se=!0,yi=$1;for(var be=0;be<K.length;++be)K[be]&&aa(K[be])}se&&aa(Y),K[Y.Index-1||K.length]=Y;for(var Le=0;Le<+Y.Span;++Le)K[K.length]=cr(Y);break;case"namedrange":if(o[1]==="/")break;N.Names||(N.Names=[]);var Z=yt(o[0]),Ue={Name:Z.Name,Ref:Po(Z.RefersTo.slice(1),{r:0,c:0})};N.Sheets.length>0&&(Ue.Sheet=N.Sheets.length-1),N.Names.push(Ue);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?S+=i.slice(A,o.index):A=o.index+o[0].length;break;case"interior":if(!t.cellStyles)break;D.Interior=In(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?HC(U,X,i.slice(k,o.index)):k=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((h=l.pop())[0]!==o[3])throw new Error("Bad state: "+h.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((h=l.pop())[0]!==o[3])throw new Error("Bad state: "+h.join("|"));pF(oe),V.push(oe)}else l.push([o[3],!1]),h=In(o[0]),oe={a:h.Author};break;case"autofilter":if(o[1]==="/"){if((h=l.pop())[0]!==o[3])throw new Error("Bad state: "+h.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ye=In(o[0]);p["!autofilter"]={ref:Po(Ye.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((h=l.pop())[0]!==o[3])throw new Error("Bad state: "+h.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((h=l.pop())[0]!==o[3])throw new Error("Bad state: "+h.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Nm(i,t);var Se=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Se=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Se=!1}break;case"excelworkbook":switch(o[3]){case"date1904":N.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Se=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Se=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(i.slice(k,o.index)){case"SheetHidden":I.Hidden=1;break;case"SheetVeryHidden":I.Hidden=2;break}else k=o.index+o[0].length;break;case"header":p["!margins"]||Na(p["!margins"]={},"xlml"),isNaN(+yt(o[0]).Margin)||(p["!margins"].header=+yt(o[0]).Margin);break;case"footer":p["!margins"]||Na(p["!margins"]={},"xlml"),isNaN(+yt(o[0]).Margin)||(p["!margins"].footer=+yt(o[0]).Margin);break;case"pagemargins":var re=yt(o[0]);p["!margins"]||Na(p["!margins"]={},"xlml"),isNaN(+re.Top)||(p["!margins"].top=+re.Top),isNaN(+re.Left)||(p["!margins"].left=+re.Left),isNaN(+re.Right)||(p["!margins"].right=+re.Right),isNaN(+re.Bottom)||(p["!margins"].bottom=+re.Bottom);break;case"displayrighttoleft":N.Views||(N.Views=[]),N.Views[0]||(N.Views[0]={}),N.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Se=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Se=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Se=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Se=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Se=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Se=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Se=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Se=!1}break;case"smarttags":break;default:Se=!1;break}if(Se||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?cF(R,X,M,i.slice(k,o.index)):(M=o,k=o.index+o[0].length);break}if(t.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var De={};return!t.bookSheets&&!t.bookProps&&(De.Sheets=c),De.SheetNames=d,De.Workbook=N,De.SSF=cr(vt),De.Props=U,De.Custprops=R,De}function id(r,e){switch(t0(e=e||{}),e.type||"base64"){case"base64":return Cf(rn(r),e);case"binary":case"buffer":case"file":return Cf(r,e);case"array":return Cf(ha(r),e)}}function mF(r,e){var t=[];return r.Props&&t.push(zC(r.Props,e)),r.Custprops&&t.push(jC(r.Props,r.Custprops)),t.join("")}function gF(){return""}function vF(r,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(i,n){var s=[];s.push(Ke("NumberFormat",null,{"ss:Format":rr(vt[i.numFmtId])}));var a={"ss:ID":"s"+(21+n)};t.push(Ke("Style",s.join(""),a))}),Ke("Styles",t.join(""))}function _v(r){return Ke("NamedRange",null,{"ss:Name":r.Name,"ss:RefersTo":"="+Kd(r.Ref,{r:0,c:0})})}function bF(r){if(!((r||{}).Workbook||{}).Names)return"";for(var e=r.Workbook.Names,t=[],i=0;i<e.length;++i){var n=e[i];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||t.push(_v(n)))}return Ke("Names",t.join(""))}function wF(r,e,t,i){if(!r||!((i||{}).Workbook||{}).Names)return"";for(var n=i.Workbook.Names,s=[],a=0;a<n.length;++a){var o=n[a];o.Sheet==t&&(o.Name.match(/^_xlfn\./)||s.push(_v(o)))}return s.join("")}function xF(r,e,t,i){if(!r)return"";var n=[];if(r["!margins"]&&(n.push("<PageSetup>"),r["!margins"].header&&n.push(Ke("Header",null,{"x:Margin":r["!margins"].header})),r["!margins"].footer&&n.push(Ke("Footer",null,{"x:Margin":r["!margins"].footer})),n.push(Ke("PageMargins",null,{"x:Bottom":r["!margins"].bottom||"0.75","x:Left":r["!margins"].left||"0.7","x:Right":r["!margins"].right||"0.7","x:Top":r["!margins"].top||"0.75"})),n.push("</PageSetup>")),i&&i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[t])if(i.Workbook.Sheets[t].Hidden)n.push(Ke("Visible",i.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<t&&!(i.Workbook.Sheets[s]&&!i.Workbook.Sheets[s].Hidden);++s);s==t&&n.push("<Selected/>")}return((((i||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),r["!protect"]&&(n.push(li("ProtectContents","True")),r["!protect"].objects&&n.push(li("ProtectObjects","True")),r["!protect"].scenarios&&n.push(li("ProtectScenarios","True")),r["!protect"].selectLockedCells!=null&&!r["!protect"].selectLockedCells?n.push(li("EnableSelection","NoSelection")):r["!protect"].selectUnlockedCells!=null&&!r["!protect"].selectUnlockedCells&&n.push(li("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){r["!protect"][a[0]]&&n.push("<"+a[1]+"/>")})),n.length==0?"":Ke("WorksheetOptions",n.join(""),{xmlns:Zi.x})}function yF(r){return r.map(function(e){var t=UE(e.t||""),i=Ke("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ke("Comment",i,{"ss:Author":e.a})}).join("")}function EF(r,e,t,i,n,s,a){if(!r||r.v==null&&r.f==null)return"";var o={};if(r.f&&(o["ss:Formula"]="="+rr(Kd(r.f,a))),r.F&&r.F.slice(0,e.length)==e){var l=yr(r.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(r.l&&r.l.Target&&(o["ss:HRef"]=rr(r.l.Target),r.l.Tooltip&&(o["x:HRefScreenTip"]=rr(r.l.Tooltip))),t["!merges"])for(var h=t["!merges"],c=0;c!=h.length;++c)h[c].s.c!=a.c||h[c].s.r!=a.r||(h[c].e.c>h[c].s.c&&(o["ss:MergeAcross"]=h[c].e.c-h[c].s.c),h[c].e.r>h[c].s.r&&(o["ss:MergeDown"]=h[c].e.r-h[c].s.r));var d="",p="";switch(r.t){case"z":if(!i.sheetStubs)return"";break;case"n":d="Number",p=String(r.v);break;case"b":d="Boolean",p=r.v?"1":"0";break;case"e":d="Error",p=Fs[r.v];break;case"d":d="DateTime",p=new Date(r.v).toISOString(),r.z==null&&(r.z=r.z||vt[14]);break;case"s":d="String",p=WE(r.v||"");break}var f=ua(i.cellXfs,r,i);o["ss:StyleID"]="s"+(21+f),o["ss:Index"]=a.c+1;var g=r.v!=null?p:"",m=r.t=="z"?"":'<Data ss:Type="'+d+'">'+g+"</Data>";return(r.c||[]).length>0&&(m+=yF(r.c)),Ke("Cell",m,o)}function CF(r,e){var t='<Row ss:Index="'+(r+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Bo(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function _F(r,e,t,i){if(!r["!ref"])return"";var n=Ht(r["!ref"]),s=r["!merges"]||[],a=0,o=[];r["!cols"]&&r["!cols"].forEach(function(b,w){aa(b);var E=!!b.width,C=fu(w,b),F={"ss:Index":w+1};E&&(F["ss:Width"]=eh(C.width)),b.hidden&&(F["ss:Hidden"]="1"),o.push(Ke("Column",null,F))});for(var l=Array.isArray(r),h=n.s.r;h<=n.e.r;++h){for(var c=[CF(h,(r["!rows"]||[])[h])],d=n.s.c;d<=n.e.c;++d){var p=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>d)&&!(s[a].s.r>h)&&!(s[a].e.c<d)&&!(s[a].e.r<h)){(s[a].s.c!=d||s[a].s.r!=h)&&(p=!0);break}if(!p){var f={r:h,c:d},g=xt(f),m=l?(r[h]||[])[d]:r[g];c.push(EF(m,g,r,e,t,i,f))}}c.push("</Row>"),c.length>2&&o.push(c.join(""))}return o.join("")}function kF(r,e,t){var i=[],n=t.SheetNames[r],s=t.Sheets[n],a=s?wF(s,e,r,t):"";return a.length>0&&i.push("<Names>"+a+"</Names>"),a=s?_F(s,e,r,t):"",a.length>0&&i.push("<Table>"+a+"</Table>"),i.push(xF(s,e,r,t)),i.join("")}function SF(r,e){e||(e={}),r.SSF||(r.SSF=cr(vt)),r.SSF&&(jo(),fh(r.SSF),e.revssf=au(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF,e.cellXfs=[],ua(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(mF(r,e)),t.push(gF()),t.push(""),t.push("");for(var i=0;i<r.SheetNames.length;++i)t.push(Ke("Worksheet",kF(i,e,r),{"ss:Name":rr(r.SheetNames[i])}));return t[2]=vF(r,e),t[3]=bF(r),Br+Ke("Workbook",t.join(""),{xmlns:Zi.ss,"xmlns:o":Zi.o,"xmlns:x":Zi.x,"xmlns:ss":Zi.ss,"xmlns:dt":Zi.dt,"xmlns:html":Zi.html})}function TF(r){var e={},t=r.content;if(t.l=28,e.AnsiUserType=t.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=wC(t),t.length-t.l<=4)return e;var i=t.read_shift(4);if(i==0||i>40||(t.l-=4,e.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(i=t.read_shift(4),i!==1907505652)||(e.UnicodeClipboardFormat=xC(t),i=t.read_shift(4),i==0||i>40))return e;t.l-=4,e.Reserved2=t.read_shift(0,"lpwstr")}var AF=[60,1084,2066,2165,2175];function FF(r,e,t,i,n){var s=i,a=[],o=t.slice(t.l,t.l+s);if(n&&n.enc&&n.enc.insitu&&o.length>0)switch(r){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(o)}a.push(o),t.l+=s;for(var l=_s(t,t.l),h=nd[l],c=0;h!=null&&AF.indexOf(l)>-1;)s=_s(t,t.l+2),c=t.l+4,l==2066?c+=4:(l==2165||l==2175)&&(c+=12),o=t.slice(c,t.l+4+s),a.push(o),t.l+=4+s,h=nd[l=_s(t,t.l)];var d=ii(a);oi(d,0);var p=0;d.lens=[];for(var f=0;f<a.length;++f)d.lens.push(p),p+=a[f].length;if(d.length<i)throw"XLS Record 0x"+r.toString(16)+" Truncated: "+d.length+" < "+i;return e.f(d,d.length,n)}function Jn(r,e,t){if(r.t!=="z"&&r.XF){var i=0;try{i=r.z||r.XF.numFmtId||0,e.cellNF&&(r.z=vt[i])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{r.t==="e"?r.w=r.w||Fs[r.v]:i===0||i=="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=Kl(r.v):r.w=Ma(r.v):r.w=nn(i,r.v,{date1904:!!t,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&i&&r.t=="n"&&Wa(vt[i]||String(i))){var n=Qs(r.v);n&&(r.t="d",r.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function vc(r,e,t){return{v:r,ixfe:e,t}}function RF(r,e){var t={opts:{}},i={},n=e.dense?[]:{},s={},a={},o=null,l=[],h="",c={},d,p="",f,g,m,b,w={},E=[],C,F,L=[],D=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},A={},O=function(tt){return tt<8?Fa[tt]:tt<64&&D[tt-8]||Fa[tt]},U=function(tt,Ve,$t){var pt=Ve.XF.data;if(!(!pt||!pt.patternType||!$t||!$t.cellStyles)){Ve.s={},Ve.s.patternType=pt.patternType;var qr;(qr=Ql(O(pt.icvFore)))&&(Ve.s.fgColor={rgb:qr}),(qr=Ql(O(pt.icvBack)))&&(Ve.s.bgColor={rgb:qr})}},R=function(tt,Ve,$t){if(!(ge>1)&&!($t.sheetRows&&tt.r>=$t.sheetRows)){if($t.cellStyles&&Ve.XF&&Ve.XF.data&&U(tt,Ve,$t),delete Ve.ixfe,delete Ve.XF,d=tt,p=xt(tt),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),tt.r<a.s.r&&(a.s.r=tt.r),tt.c<a.s.c&&(a.s.c=tt.c),tt.r+1>a.e.r&&(a.e.r=tt.r+1),tt.c+1>a.e.c&&(a.e.c=tt.c+1),$t.cellFormula&&Ve.f){for(var pt=0;pt<E.length;++pt)if(!(E[pt][0].s.c>tt.c||E[pt][0].s.r>tt.r)&&!(E[pt][0].e.c<tt.c||E[pt][0].e.r<tt.r)){Ve.F=Lt(E[pt][0]),(E[pt][0].s.c!=tt.c||E[pt][0].s.r!=tt.r)&&delete Ve.f,Ve.f&&(Ve.f=""+xi(E[pt][1],a,tt,q,k));break}}$t.dense?(n[tt.r]||(n[tt.r]=[]),n[tt.r][tt.c]=Ve):n[p]=Ve}},k={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:E,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(k.password=e.password);var M,V=[],oe=[],K=[],Y=[],se=!1,q=[];q.SheetNames=k.snames,q.sharedf=k.sharedf,q.arrayf=k.arrayf,q.names=[],q.XTI=[];var fe=0,ge=0,_=0,P=[],N=[],I;k.codepage=1200,xn(1200);for(var X=!1;r.l<r.length-1;){var he=r.l,ce=r.read_shift(2);if(ce===0&&fe===10)break;var ue=r.l===r.length?0:r.read_shift(2),be=nd[ce];if(be&&be.f){if(e.bookSheets&&fe===133&&ce!==133)break;if(fe=ce,be.r===2||be.r==12){var Le=r.read_shift(2);if(ue-=2,!k.enc&&Le!==ce&&((Le&255)<<8|Le>>8)!==ce)throw new Error("rt mismatch: "+Le+"!="+ce);be.r==12&&(r.l+=10,ue-=10)}var Z={};if(ce===10?Z=be.f(r,ue,k):Z=FF(ce,be,r,ue,k),ge==0&&[9,521,1033,2057].indexOf(fe)===-1)continue;switch(ce){case 34:t.opts.Date1904=S.WBProps.date1904=Z;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(k.enc||(r.l=0),k.enc=Z,!e.password)throw new Error("File is password-protected");if(Z.valid==null)throw new Error("Encryption scheme unsupported");if(!Z.valid)throw new Error("Password is incorrect");break;case 92:k.lastuser=Z;break;case 66:var Ue=Number(Z);switch(Ue){case 21010:Ue=1200;break;case 32768:Ue=1e4;break;case 32769:Ue=1252;break}xn(k.codepage=Ue),X=!0;break;case 317:k.rrtabid=Z;break;case 25:k.winlocked=Z;break;case 439:t.opts.RefreshAll=Z;break;case 12:t.opts.CalcCount=Z;break;case 16:t.opts.CalcDelta=Z;break;case 17:t.opts.CalcIter=Z;break;case 13:t.opts.CalcMode=Z;break;case 14:t.opts.CalcPrecision=Z;break;case 95:t.opts.CalcSaveRecalc=Z;break;case 15:k.CalcRefMode=Z;break;case 2211:t.opts.FullCalc=Z;break;case 129:Z.fDialog&&(n["!type"]="dialog"),Z.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),Z.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:L.push(Z);break;case 430:q.push([Z]),q[q.length-1].XTI=[];break;case 35:case 547:q[q.length-1].push(Z);break;case 24:case 536:I={Name:Z.Name,Ref:xi(Z.rgce,a,null,q,k)},Z.itab>0&&(I.Sheet=Z.itab-1),q.names.push(I),q[0]||(q[0]=[],q[0].XTI=[]),q[q.length-1].push(Z),Z.Name=="_xlnm._FilterDatabase"&&Z.itab>0&&Z.rgce&&Z.rgce[0]&&Z.rgce[0][0]&&Z.rgce[0][0][0]=="PtgArea3d"&&(N[Z.itab-1]={ref:Lt(Z.rgce[0][0][1][2])});break;case 22:k.ExternCount=Z;break;case 23:q.length==0&&(q[0]=[],q[0].XTI=[]),q[q.length-1].XTI=q[q.length-1].XTI.concat(Z),q.XTI=q.XTI.concat(Z);break;case 2196:if(k.biff<8)break;I!=null&&(I.Comment=Z[1]);break;case 18:n["!protect"]=Z;break;case 19:Z!==0&&k.WTF&&console.error("Password verifier: "+Z);break;case 133:s[Z.pos]=Z,k.snames.push(Z.name);break;case 10:{if(--ge)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,n["!ref"]=Lt(a),e.sheetRows&&e.sheetRows<=a.e.r){var Ye=a.e.r;a.e.r=e.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=Lt(a),a.e.r=Ye}a.e.r++,a.e.c++}V.length>0&&(n["!merges"]=V),oe.length>0&&(n["!objects"]=oe),K.length>0&&(n["!cols"]=K),Y.length>0&&(n["!rows"]=Y),S.Sheets.push(A)}h===""?c=n:i[h]=n,n=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(k.biff===8&&(k.biff={9:2,521:3,1033:4}[ce]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Z.BIFFVer]||8),k.biffguess=Z.BIFFVer==0,Z.BIFFVer==0&&Z.dt==4096&&(k.biff=5,X=!0,xn(k.codepage=28591)),k.biff==8&&Z.BIFFVer==0&&Z.dt==16&&(k.biff=2),ge++)break;if(n=e.dense?[]:{},k.biff<8&&!X&&(X=!0,xn(k.codepage=e.codepage||1252)),k.biff<5||Z.BIFFVer==0&&Z.dt==4096){h===""&&(h="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var Se={pos:r.l-ue,name:h};s[Se.pos]=Se,k.snames.push(h)}else h=(s[he]||{name:""}).name;Z.dt==32&&(n["!type"]="chart"),Z.dt==64&&(n["!type"]="macro"),V=[],oe=[],k.arrayf=E=[],K=[],Y=[],se=!1,A={Hidden:(s[he]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(e.dense?(n[Z.r]||[])[Z.c]:n[xt({c:Z.c,r:Z.r})])&&++Z.c,C={ixfe:Z.ixfe,XF:L[Z.ixfe]||{},v:Z.val,t:"n"},_>0&&(C.z=P[C.ixfe>>8&63]),Jn(C,e,t.opts.Date1904),R({c:Z.c,r:Z.r},C,e);break;case 5:case 517:C={ixfe:Z.ixfe,XF:L[Z.ixfe],v:Z.val,t:Z.t},_>0&&(C.z=P[C.ixfe>>8&63]),Jn(C,e,t.opts.Date1904),R({c:Z.c,r:Z.r},C,e);break;case 638:C={ixfe:Z.ixfe,XF:L[Z.ixfe],v:Z.rknum,t:"n"},_>0&&(C.z=P[C.ixfe>>8&63]),Jn(C,e,t.opts.Date1904),R({c:Z.c,r:Z.r},C,e);break;case 189:for(var re=Z.c;re<=Z.C;++re){var De=Z.rkrec[re-Z.c][0];C={ixfe:De,XF:L[De],v:Z.rkrec[re-Z.c][1],t:"n"},_>0&&(C.z=P[C.ixfe>>8&63]),Jn(C,e,t.opts.Date1904),R({c:re,r:Z.r},C,e)}break;case 6:case 518:case 1030:{if(Z.val=="String"){o=Z;break}if(C=vc(Z.val,Z.cell.ixfe,Z.tt),C.XF=L[C.ixfe],e.cellFormula){var Je=Z.formula;if(Je&&Je[0]&&Je[0][0]&&Je[0][0][0]=="PtgExp"){var He=Je[0][0][1][0],qe=Je[0][0][1][1],Ze=xt({r:He,c:qe});w[Ze]?C.f=""+xi(Z.formula,a,Z.cell,q,k):C.F=((e.dense?(n[He]||[])[qe]:n[Ze])||{}).F}else C.f=""+xi(Z.formula,a,Z.cell,q,k)}_>0&&(C.z=P[C.ixfe>>8&63]),Jn(C,e,t.opts.Date1904),R(Z.cell,C,e),o=Z}break;case 7:case 519:if(o)o.val=Z,C=vc(Z,o.cell.ixfe,"s"),C.XF=L[C.ixfe],e.cellFormula&&(C.f=""+xi(o.formula,a,o.cell,q,k)),_>0&&(C.z=P[C.ixfe>>8&63]),Jn(C,e,t.opts.Date1904),R(o.cell,C,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{E.push(Z);var Qe=xt(Z[0].s);if(f=e.dense?(n[Z[0].s.r]||[])[Z[0].s.c]:n[Qe],e.cellFormula&&f){if(!o||!Qe||!f)break;f.f=""+xi(Z[1],a,Z[0],q,k),f.F=Lt(Z[0])}}break;case 1212:{if(!e.cellFormula)break;if(p){if(!o)break;w[xt(o.cell)]=Z[0],f=e.dense?(n[o.cell.r]||[])[o.cell.c]:n[xt(o.cell)],(f||{}).f=""+xi(Z[0],a,d,q,k)}}break;case 253:C=vc(l[Z.isst].t,Z.ixfe,"s"),l[Z.isst].h&&(C.h=l[Z.isst].h),C.XF=L[C.ixfe],_>0&&(C.z=P[C.ixfe>>8&63]),Jn(C,e,t.opts.Date1904),R({c:Z.c,r:Z.r},C,e);break;case 513:e.sheetStubs&&(C={ixfe:Z.ixfe,XF:L[Z.ixfe],t:"z"},_>0&&(C.z=P[C.ixfe>>8&63]),Jn(C,e,t.opts.Date1904),R({c:Z.c,r:Z.r},C,e));break;case 190:if(e.sheetStubs)for(var lt=Z.c;lt<=Z.C;++lt){var ht=Z.ixfe[lt-Z.c];C={ixfe:ht,XF:L[ht],t:"z"},_>0&&(C.z=P[C.ixfe>>8&63]),Jn(C,e,t.opts.Date1904),R({c:lt,r:Z.r},C,e)}break;case 214:case 516:case 4:C=vc(Z.val,Z.ixfe,"s"),C.XF=L[C.ixfe],_>0&&(C.z=P[C.ixfe>>8&63]),Jn(C,e,t.opts.Date1904),R({c:Z.c,r:Z.r},C,e);break;case 0:case 512:ge===1&&(a=Z);break;case 252:l=Z;break;case 1054:if(k.biff==4){P[_++]=Z[1];for(var bt=0;bt<_+163&&vt[bt]!=Z[1];++bt);bt>=163&&as(Z[1],_+163)}else as(Z[1],Z[0]);break;case 30:{P[_++]=Z;for(var Et=0;Et<_+163&&vt[Et]!=Z;++Et);Et>=163&&as(Z,_+163)}break;case 229:V=V.concat(Z);break;case 93:oe[Z.cmo[0]]=k.lastobj=Z;break;case 438:k.lastobj.TxO=Z;break;case 127:k.lastobj.ImData=Z;break;case 440:for(b=Z[0].s.r;b<=Z[0].e.r;++b)for(m=Z[0].s.c;m<=Z[0].e.c;++m)f=e.dense?(n[b]||[])[m]:n[xt({c:m,r:b})],f&&(f.l=Z[1]);break;case 2048:for(b=Z[0].s.r;b<=Z[0].e.r;++b)for(m=Z[0].s.c;m<=Z[0].e.c;++m)f=e.dense?(n[b]||[])[m]:n[xt({c:m,r:b})],f&&f.l&&(f.l.Tooltip=Z[1]);break;case 28:{if(k.biff<=5&&k.biff>=2)break;f=e.dense?(n[Z[0].r]||[])[Z[0].c]:n[xt(Z[0])];var Mt=oe[Z[2]];f||(e.dense?(n[Z[0].r]||(n[Z[0].r]=[]),f=n[Z[0].r][Z[0].c]={t:"z"}):f=n[xt(Z[0])]={t:"z"},a.e.r=Math.max(a.e.r,Z[0].r),a.s.r=Math.min(a.s.r,Z[0].r),a.e.c=Math.max(a.e.c,Z[0].c),a.s.c=Math.min(a.s.c,Z[0].c)),f.c||(f.c=[]),g={a:Z[1],t:Mt.TxO.t},f.c.push(g)}break;case 2173:bk(L[Z.ixfe],Z.ext);break;case 125:{if(!k.cellStyles)break;for(;Z.e>=Z.s;)K[Z.e--]={width:Z.w/256,level:Z.level||0,hidden:!!(Z.flags&1)},se||(se=!0,Gd(Z.w/256)),aa(K[Z.e+1])}break;case 520:{var St={};Z.level!=null&&(Y[Z.r]=St,St.level=Z.level),Z.hidden&&(Y[Z.r]=St,St.hidden=!0),Z.hpt&&(Y[Z.r]=St,St.hpt=Z.hpt,St.hpx=Bo(Z.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||Na(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ce]]=Z;break;case 161:n["!margins"]||Na(n["!margins"]={}),n["!margins"].header=Z.header,n["!margins"].footer=Z.footer;break;case 574:Z.RTL&&(S.Views[0].RTL=!0);break;case 146:D=Z;break;case 2198:M=Z;break;case 140:F=Z;break;case 442:h?A.CodeName=Z||A.name:S.WBProps.CodeName=Z||"ThisWorkbook";break}}else be||console.error("Missing Info for XLS Record 0x"+ce.toString(16)),r.l+=ue}return t.SheetNames=Fr(s).sort(function(ct,tt){return Number(ct)-Number(tt)}).map(function(ct){return s[ct].name}),e.bookSheets||(t.Sheets=i),!t.SheetNames.length&&c["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=c)):t.Preamble=c,t.Sheets&&N.forEach(function(ct,tt){t.Sheets[t.SheetNames[tt]]["!autofilter"]=ct}),t.Strings=l,t.SSF=cr(vt),k.enc&&(t.Encryption=k.enc),M&&(t.Themes=M),t.Metadata={},F!==void 0&&(t.Metadata.Country=F),q.names.length>0&&(S.Names=q.names),t.Workbook=S,t}var Wl={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function LF(r,e,t){var i=ut.find(r,"/!DocumentSummaryInformation");if(i&&i.size>0)try{var n=lm(i,Jf,Wl.DSI);for(var s in n)e[s]=n[s]}catch(h){if(t.WTF)throw h}var a=ut.find(r,"/!SummaryInformation");if(a&&a.size>0)try{var o=lm(a,Zf,Wl.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(h){if(t.WTF)throw h}e.HeadingPairs&&e.TitlesOfParts&&(E1(e.HeadingPairs,e.TitlesOfParts,e,t),delete e.HeadingPairs,delete e.TitlesOfParts)}function NF(r,e){var t=[],i=[],n=[],s=0,a,o=Bp(Jf,"n"),l=Bp(Zf,"n");if(r.Props)for(a=Fr(r.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?i:n).push([a[s],r.Props[a[s]]]);if(r.Custprops)for(a=Fr(r.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(r.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?i:n).push([a[s],r.Custprops[a[s]]]);var h=[];for(s=0;s<n.length;++s)F1.indexOf(n[s][0])>-1||y1.indexOf(n[s][0])>-1||n[s][1]!=null&&h.push(n[s]);i.length&&ut.utils.cfb_add(e,"/SummaryInformation",hm(i,Wl.SI,l,Zf)),(t.length||h.length)&&ut.utils.cfb_add(e,"/DocumentSummaryInformation",hm(t,Wl.DSI,o,Jf,h.length?h:null,Wl.UDI))}function Qd(r,e){e||(e={}),t0(e),nu(),e.codepage&&iu(e.codepage);var t,i;if(r.FullPaths){if(ut.find(r,"/encryption"))throw new Error("File is password-protected");t=ut.find(r,"!CompObj"),i=ut.find(r,"/Workbook")||ut.find(r,"/Book")}else{switch(e.type){case"base64":r=Qi(rn(r));break;case"binary":r=Qi(r);break;case"buffer":break;case"array":Array.isArray(r)||(r=Array.prototype.slice.call(r));break}oi(r,0),i={content:r}}var n,s;if(t&&TF(t),e.bookProps&&!e.bookSheets)n={};else{var a=Ot?"buffer":"array";if(i&&i.content)n=RF(i.content,e);else if((s=ut.find(r,"PerfectOffice_MAIN"))&&s.content)n=La.to_workbook(s.content,(e.type=a,e));else if((s=ut.find(r,"NativeContent_MAIN"))&&s.content)n=La.to_workbook(s.content,(e.type=a,e));else throw(s=ut.find(r,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&r.FullPaths&&ut.find(r,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=qk(r))}var o={};return r.FullPaths&&LF(r,o,e),n.Props=n.Custprops=o,e.bookFiles&&(n.cfb=r),n}function PF(r,e){var t=e||{},i=ut.utils.cfb_new({root:"R"}),n="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":n="/Workbook",t.biff=8;break;case"biff5":n="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return ut.utils.cfb_add(i,n,kv(r,t)),t.biff==8&&(r.Props||r.Custprops)&&NF(r,i),t.biff==8&&r.vbaraw&&Xk(i,ut.read(r.vbaraw,{type:typeof r.vbaraw=="string"?"binary":"buffer"})),i}var ih={0:{f:nA},1:{f:fA},2:{f:LA},3:{f:xA},4:{f:gA},5:{f:AA},6:{f:OA},7:{f:_A},8:{f:UA},9:{f:WA},10:{f:zA},11:{f:jA},12:{f:pA},13:{f:PA},14:{f:EA},15:{f:bA},16:{f:gv},17:{f:BA},18:{f:SA},19:{f:Md},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:I6},40:{},42:{},43:{f:O_},44:{f:D_},45:{f:H_},46:{f:j_},47:{f:z_},48:{},49:{f:oC},50:{},51:{f:yk},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:z1},62:{f:MA},63:{f:Rk},64:{f:s6},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Si,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:t6},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:cA},148:{f:oA,p:16},151:{f:YA},152:{},153:{f:D6},154:{},155:{},156:{f:N6},157:{},158:{},159:{T:1,f:J3},160:{T:-1},161:{T:1,f:Xa},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:VA},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:wk},336:{T:-1},337:{f:_k,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:$f},357:{},358:{},359:{},360:{T:1},361:{},362:{f:H1},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:$A},427:{f:JA},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:QA},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:hA},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:XA},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:$f},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:jk},633:{T:1},634:{T:-1},635:{T:1,f:Hk},636:{T:-1},637:{f:uC},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:E6},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:a6},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},nd={6:{f:yf},10:{f:Ks},12:{f:Gr},13:{f:Gr},14:{f:Pr},15:{f:Pr},16:{f:Ci},17:{f:Pr},18:{f:Pr},19:{f:Gr},20:{f:mm},21:{f:mm},23:{f:H1},24:{f:vm},25:{f:Pr},26:{},27:{},28:{f:a3},29:{},34:{f:Pr},35:{f:gm},38:{f:Ci},39:{f:Ci},40:{f:Ci},41:{f:Ci},42:{f:Pr},43:{f:Pr},47:{f:b_},49:{f:P4},51:{f:Gr},60:{},61:{f:A4},64:{f:Pr},65:{f:N4},66:{f:Gr},77:{},80:{},81:{},82:{},85:{f:Gr},89:{},90:{},91:{},92:{f:v4},93:{f:h3},94:{},95:{f:Pr},96:{},97:{},99:{f:Pr},125:{f:z1},128:{f:K4},129:{f:w4},130:{f:Gr},131:{f:Pr},132:{f:Pr},133:{f:x4},134:{},140:{f:v3},141:{f:Gr},144:{},146:{f:x3},151:{},152:{},153:{},154:{},155:{},156:{f:Gr},157:{},158:{},160:{f:T3},161:{f:C3},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:V4},190:{f:G4},193:{f:Ks},197:{},198:{},199:{},200:{},201:{},202:{f:Pr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Gr},220:{},221:{f:Pr},222:{},224:{f:X4},225:{f:g4},226:{f:Ks},227:{},229:{f:o3},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:E4},253:{f:M4},255:{f:_4},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:R1},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Pr},353:{f:Ks},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Q4},431:{f:Pr},432:{},433:{},434:{},437:{},438:{f:f3},439:{f:Pr},440:{f:d3},441:{},442:{f:mh},443:{},444:{f:Gr},445:{},446:{},448:{f:Ks},449:{f:T4,r:2},450:{f:Ks},512:{f:fm},513:{f:S3},515:{f:J4},516:{f:I4},517:{f:pm},519:{f:A3},520:{f:k4},523:{},545:{f:bm},549:{f:um},566:{},574:{f:R4},638:{f:U4},659:{},1048:{},1054:{f:H4},1084:{},1212:{f:i3},2048:{f:m3},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:pc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ks},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:y3,r:12},2173:{f:vk,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Pr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:r3,r:12},2197:{},2198:{f:uk,r:12},2199:{},2200:{},2201:{},2202:{f:n3,r:12},2203:{f:Ks},2204:{},2205:{},2206:{},2207:{},2211:{f:S4},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Gr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:_3},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:w3},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:fm},1:{},2:{f:P3},3:{f:L3},4:{f:R3},5:{f:pm},7:{f:M3},8:{},9:{f:pc},11:{},22:{f:Gr},30:{f:j4},31:{},32:{},33:{f:bm},36:{},37:{f:um},50:{f:O3},62:{},52:{},67:{},68:{f:Gr},69:{},86:{},126:{},127:{f:F3},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:I3},223:{},234:{},354:{},421:{},518:{f:yf},521:{f:pc},536:{f:vm},547:{f:gm},561:{},579:{},1030:{f:yf},1033:{f:pc},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function $e(r,e,t,i){var n=e;if(!isNaN(n)){var s=i||(t||[]).length||0,a=r.next(4);a.write_shift(2,n),a.write_shift(2,s),s>0&&Nd(t)&&r.push(t)}}function DF(r,e,t,i){var n=(t||[]).length||0;if(n<=8224)return $e(r,e,t,n);var s=e;if(!isNaN(s)){for(var a=t.parts||[],o=0,l=0,h=0;h+(a[o]||8224)<=8224;)h+=a[o]||8224,o++;var c=r.next(4);for(c.write_shift(2,s),c.write_shift(2,h),r.push(t.slice(l,l+h)),l+=h;l<n;){for(c=r.next(4),c.write_shift(2,60),h=0;h+(a[o]||8224)<=8224;)h+=a[o]||8224,o++;c.write_shift(2,h),r.push(t.slice(l,l+h)),l+=h}}}function wh(r,e,t){return r||(r=Pe(7)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,0),r.write_shift(1,0),r}function MF(r,e,t,i){var n=Pe(9);return wh(n,r,e),L1(t,i||"b",n),n}function OF(r,e,t){var i=Pe(8+2*t.length);return wh(i,r,e),i.write_shift(1,t.length),i.write_shift(t.length,t,"sbcs"),i.l<i.length?i.slice(0,i.l):i}function IF(r,e,t,i){if(e.v!=null)switch(e.t){case"d":case"n":var n=e.t=="d"?Jr(br(e.v)):e.v;n==(n|0)&&n>=0&&n<65536?$e(r,2,D3(t,i,n)):$e(r,3,N3(t,i,n));return;case"b":case"e":$e(r,5,MF(t,i,e.v,e.t));return;case"s":case"str":$e(r,4,OF(t,i,(e.v||"").slice(0,255)));return}$e(r,1,wh(null,t,i))}function BF(r,e,t,i){var n=Array.isArray(e),s=Ht(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(i.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=Lt(s)}for(var h=s.s.r;h<=s.e.r;++h){o=Tr(h);for(var c=s.s.c;c<=s.e.c;++c){h===s.s.r&&(l[c]=vr(c)),a=l[c]+o;var d=n?(e[h]||[])[c]:e[a];d&&IF(r,d,h,c)}}}function HF(r,e){for(var t=e||{},i=Ui(),n=0,s=0;s<r.SheetNames.length;++s)r.SheetNames[s]==t.sheet&&(n=s);if(n==0&&t.sheet&&r.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return $e(i,t.biff==4?1033:t.biff==3?521:9,Wd(r,16,t)),BF(i,r.Sheets[r.SheetNames[n]],n,t),$e(i,10),i.end()}function zF(r,e,t){$e(r,49,D4({sz:12,name:"Arial"},t))}function jF(r,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var n=i[0];n<=i[1];++n)e[n]!=null&&$e(r,1054,z4(n,e[n],t))})}function WF(r,e){var t=Pe(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),$e(r,2151,t),t=Pe(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),O1(Ht(e["!ref"]||"A1"),t),t.write_shift(4,4),$e(r,2152,t)}function UF(r,e){for(var t=0;t<16;++t)$e(r,224,dm({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(i){$e(r,224,dm(i,0,e))})}function VF(r,e){for(var t=0;t<e["!links"].length;++t){var i=e["!links"][t];$e(r,440,p3(i)),i[1].Tooltip&&$e(r,2048,g3(i))}delete e["!links"]}function GF(r,e){if(e){var t=0;e.forEach(function(i,n){++t<=256&&i&&$e(r,125,E3(fu(n,i),n))})}}function qF(r,e,t,i,n){var s=16+ua(n.cellXfs,e,n);if(e.v==null&&!e.bf){$e(r,513,Ha(t,i,s));return}if(e.bf)$e(r,6,wT(e,t,i,n,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?Jr(br(e.v)):e.v;$e(r,515,Z4(t,i,a,s));break;case"b":case"e":$e(r,517,$4(t,i,e.v,s,n,e.t));break;case"s":case"str":if(n.bookSST){var o=$d(n.Strings,e.v,n.revStrings);$e(r,253,O4(t,i,o,s))}else $e(r,516,B4(t,i,(e.v||"").slice(0,255),s,n));break;default:$e(r,513,Ha(t,i,s))}}function XF(r,e,t){var i=Ui(),n=t.SheetNames[r],s=t.Sheets[n]||{},a=(t||{}).Workbook||{},o=(a.Sheets||[])[r]||{},l=Array.isArray(s),h=e.biff==8,c,d="",p=[],f=Ht(s["!ref"]||"A1"),g=h?65536:16384;if(f.e.c>255||f.e.r>=g){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,g-1)}$e(i,2057,Wd(t,16,e)),$e(i,13,wn(1)),$e(i,12,wn(100)),$e(i,15,Ri(!0)),$e(i,17,Ri(!1)),$e(i,16,Ia(.001)),$e(i,95,Ri(!0)),$e(i,42,Ri(!1)),$e(i,43,Ri(!1)),$e(i,130,wn(1)),$e(i,128,Y4()),$e(i,131,Ri(!1)),$e(i,132,Ri(!1)),h&&GF(i,s["!cols"]),$e(i,512,W4(f,e)),h&&(s["!links"]=[]);for(var m=f.s.r;m<=f.e.r;++m){d=Tr(m);for(var b=f.s.c;b<=f.e.c;++b){m===f.s.r&&(p[b]=vr(b)),c=p[b]+d;var w=l?(s[m]||[])[b]:s[c];w&&(qF(i,w,m,b,e),h&&w.l&&s["!links"].push([c,w.l]))}}var E=o.CodeName||o.name||n;return h&&$e(i,574,L4((a.Views||[])[0])),h&&(s["!merges"]||[]).length&&$e(i,229,l3(s["!merges"])),h&&VF(i,s),$e(i,442,N1(E)),h&&WF(i,s),$e(i,10),i.end()}function KF(r,e,t){var i=Ui(),n=(r||{}).Workbook||{},s=n.Sheets||[],a=n.WBProps||{},o=t.biff==8,l=t.biff==5;if($e(i,2057,Wd(r,5,t)),t.bookType=="xla"&&$e(i,135),$e(i,225,o?wn(1200):null),$e(i,193,$C(2)),l&&$e(i,191),l&&$e(i,192),$e(i,226),$e(i,92,b4("SheetJS",t)),$e(i,66,wn(o?1200:1252)),o&&$e(i,353,wn(0)),o&&$e(i,448),$e(i,317,k3(r.SheetNames.length)),o&&r.vbaraw&&$e(i,211),o&&r.vbaraw){var h=a.CodeName||"ThisWorkbook";$e(i,442,N1(h))}$e(i,156,wn(17)),$e(i,25,Ri(!1)),$e(i,18,Ri(!1)),$e(i,19,wn(0)),o&&$e(i,431,Ri(!1)),o&&$e(i,444,wn(0)),$e(i,61,F4()),$e(i,64,Ri(!1)),$e(i,141,wn(0)),$e(i,34,Ri(T6(r)=="true")),$e(i,14,Ri(!0)),o&&$e(i,439,Ri(!1)),$e(i,218,wn(0)),zF(i,r,t),jF(i,r.SSF,t),UF(i,t),o&&$e(i,352,Ri(!1));var c=i.end(),d=Ui();o&&$e(d,140,b3()),o&&t.Strings&&DF(d,252,C4(t.Strings)),$e(d,10);var p=d.end(),f=Ui(),g=0,m=0;for(m=0;m<r.SheetNames.length;++m)g+=(o?12:11)+(o?2:1)*r.SheetNames[m].length;var b=c.length+g+p.length;for(m=0;m<r.SheetNames.length;++m){var w=s[m]||{};$e(f,133,y4({pos:b,hs:w.Hidden||0,dt:0,name:r.SheetNames[m]},t)),b+=e[m].length}var E=f.end();if(g!=E.length)throw new Error("BS8 "+g+" != "+E.length);var C=[];return c.length&&C.push(c),E.length&&C.push(E),p.length&&C.push(p),ii(C)}function YF(r,e){var t=e||{},i=[];r&&!r.SSF&&(r.SSF=cr(vt)),r&&r.SSF&&(jo(),fh(r.SSF),t.revssf=au(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,r0(t),t.cellXfs=[],ua(t.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={});for(var n=0;n<r.SheetNames.length;++n)i[i.length]=XF(n,t,r);return i.unshift(KF(r,i,t)),ii(i)}function kv(r,e){for(var t=0;t<=r.SheetNames.length;++t){var i=r.Sheets[r.SheetNames[t]];if(!(!i||!i["!ref"])){var n=Ni(i["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+r.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return YF(r,e);case 4:case 3:case 2:return HF(r,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function Am(r,e){var t=e||{},i=t.dense?[]:{};r=r.replace(/<!--.*?-->/g,"");var n=r.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var s=r.match(/<\/table/i),a=n.index,o=s&&s.index||r.length,l=DE(r.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,c=0,d=0,p=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(a=0;a<l.length;++a){var m=l[a].trim(),b=m.slice(0,3).toLowerCase();if(b=="<tr"){if(++h,t.sheetRows&&t.sheetRows<=h){--h;break}c=0;continue}if(!(b!="<td"&&b!="<th")){var w=m.split(/<\/t[dh]>/i);for(o=0;o<w.length;++o){var E=w[o].trim();if(E.match(/<t[dh]/i)){for(var C=E,F=0;C.charAt(0)=="<"&&(F=C.indexOf(">"))>-1;)C=C.slice(F+1);for(var L=0;L<g.length;++L){var D=g[L];D.s.c==c&&D.s.r<h&&h<=D.e.r&&(c=D.e.c+1,L=-1)}var S=yt(E.slice(0,E.indexOf(">")));p=S.colspan?+S.colspan:1,((d=+S.rowspan)>1||p>1)&&g.push({s:{r:h,c},e:{r:h+(d||1)-1,c:c+p-1}});var A=S.t||S["data-t"]||"";if(!C.length){c+=p;continue}if(C=Qg(C),f.s.r>h&&(f.s.r=h),f.e.r<h&&(f.e.r=h),f.s.c>c&&(f.s.c=c),f.e.c<c&&(f.e.c=c),!C.length){c+=p;continue}var O={t:"s",v:C};t.raw||!C.trim().length||A=="s"||(C==="TRUE"?O={t:"b",v:!0}:C==="FALSE"?O={t:"b",v:!1}:isNaN(Hn(C))?isNaN(Oo(C).getDate())||(O={t:"d",v:br(C)},t.cellDates||(O={t:"n",v:Jr(O.v)}),O.z=t.dateNF||vt[14]):O={t:"n",v:Hn(C)}),t.dense?(i[h]||(i[h]=[]),i[h][c]=O):i[xt({r:h,c})]=O,c+=p}}}}return i["!ref"]=Lt(f),g.length&&(i["!merges"]=g),i}function Sv(r,e,t,i){for(var n=r["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,h=0;h<n.length;++h)if(!(n[h].s.r>t||n[h].s.c>a)&&!(n[h].e.r<t||n[h].e.c<a)){if(n[h].s.r<t||n[h].s.c<a){o=-1;break}o=n[h].e.r-n[h].s.r+1,l=n[h].e.c-n[h].s.c+1;break}if(!(o<0)){var c=xt({r:t,c:a}),d=i.dense?(r[t]||[])[a]:r[c],p=d&&d.v!=null&&(d.h||kd(d.w||(os(d),d.w)||""))||"",f={};o>1&&(f.rowspan=o),l>1&&(f.colspan=l),i.editable?p='<span contenteditable="true">'+p+"</span>":d&&(f["data-t"]=d&&d.t||"z",d.v!=null&&(f["data-v"]=d.v),d.z!=null&&(f["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+d.l.Target+'">'+p+"</a>")),f.id=(i.id||"sjs")+"-"+c,s.push(Ke("td",p,f))}}var g="<tr>";return g+s.join("")+"</tr>"}var Tv='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Av="</body></html>";function $F(r,e){var t=r.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return ca(Am(t[0],e),e);var i=o0();return t.forEach(function(n,s){l0(i,Am(n,e),"Sheet"+(s+1))}),i}function Fv(r,e,t){var i=[];return i.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function Rv(r,e){var t=e||{},i=t.header!=null?t.header:Tv,n=t.footer!=null?t.footer:Av,s=[i],a=Ni(r["!ref"]);t.dense=Array.isArray(r),s.push(Fv(r,a,t));for(var o=a.s.r;o<=a.e.r;++o)s.push(Sv(r,a,o,t));return s.push("</table>"+n),s.join("")}function Lv(r,e,t){var i=t||{},n=0,s=0;if(i.origin!=null)if(typeof i.origin=="number")n=i.origin;else{var a=typeof i.origin=="string"?yr(i.origin):i.origin;n=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(i.sheetRows||1e7,o.length),h={s:{r:0,c:0},e:{r:n,c:s}};if(r["!ref"]){var c=Ni(r["!ref"]);h.s.r=Math.min(h.s.r,c.s.r),h.s.c=Math.min(h.s.c,c.s.c),h.e.r=Math.max(h.e.r,c.e.r),h.e.c=Math.max(h.e.c,c.e.c),n==-1&&(h.e.r=n=c.e.r+1)}var d=[],p=0,f=r["!rows"]||(r["!rows"]=[]),g=0,m=0,b=0,w=0,E=0,C=0;for(r["!cols"]||(r["!cols"]=[]);g<o.length&&m<l;++g){var F=o[g];if(Fm(F)){if(i.display)continue;f[m]={hidden:!0}}var L=F.children;for(b=w=0;b<L.length;++b){var D=L[b];if(!(i.display&&Fm(D))){var S=D.hasAttribute("data-v")?D.getAttribute("data-v"):D.hasAttribute("v")?D.getAttribute("v"):Qg(D.innerHTML),A=D.getAttribute("data-z")||D.getAttribute("z");for(p=0;p<d.length;++p){var O=d[p];O.s.c==w+s&&O.s.r<m+n&&m+n<=O.e.r&&(w=O.e.c+1-s,p=-1)}C=+D.getAttribute("colspan")||1,((E=+D.getAttribute("rowspan")||1)>1||C>1)&&d.push({s:{r:m+n,c:w+s},e:{r:m+n+(E||1)-1,c:w+s+(C||1)-1}});var U={t:"s",v:S},R=D.getAttribute("data-t")||D.getAttribute("t")||"";S!=null&&(S.length==0?U.t=R||"z":i.raw||S.trim().length==0||R=="s"||(S==="TRUE"?U={t:"b",v:!0}:S==="FALSE"?U={t:"b",v:!1}:isNaN(Hn(S))?isNaN(Oo(S).getDate())||(U={t:"d",v:br(S)},i.cellDates||(U={t:"n",v:Jr(U.v)}),U.z=i.dateNF||vt[14]):U={t:"n",v:Hn(S)})),U.z===void 0&&A!=null&&(U.z=A);var k="",M=D.getElementsByTagName("A");if(M&&M.length)for(var V=0;V<M.length&&!(M[V].hasAttribute("href")&&(k=M[V].getAttribute("href"),k.charAt(0)!="#"));++V);k&&k.charAt(0)!="#"&&(U.l={Target:k}),i.dense?(r[m+n]||(r[m+n]=[]),r[m+n][w+s]=U):r[xt({c:w+s,r:m+n})]=U,h.e.c<w+s&&(h.e.c=w+s),w+=C}}++m}return d.length&&(r["!merges"]=(r["!merges"]||[]).concat(d)),h.e.r=Math.max(h.e.r,m-1+n),r["!ref"]=Lt(h),m>=l&&(r["!fullref"]=Lt((h.e.r=o.length-g+m-1+n,h))),r}function Nv(r,e){var t=e||{},i=t.dense?[]:{};return Lv(i,r,e)}function JF(r,e){return ca(Nv(r,e),e)}function Fm(r){var e="",t=ZF(r);return t&&(e=t(r).getPropertyValue("display")),e||(e=r.style&&r.style.display),e==="none"}function ZF(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function QF(r){var e=r.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(i,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=Vt(e.replace(/<[^>]*>/g,""));return[t]}var Rm={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Pv(r,e){var t=e||{},i=Sd(r),n=[],s,a,o={name:""},l="",h=0,c,d,p={},f=[],g=t.dense?[]:{},m,b,w={value:""},E="",C=0,F=[],L=-1,D=-1,S={s:{r:1e6,c:1e7},e:{r:0,c:0}},A=0,O={},U=[],R={},k=0,M=0,V=[],oe=1,K=1,Y=[],se={Names:[]},q={},fe=["",""],ge=[],_={},P="",N=0,I=!1,X=!1,he=0;for(Jl.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=Jl.exec(i);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(S.e.c>=S.s.c&&S.e.r>=S.s.r?g["!ref"]=Lt(S):g["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=S.e.r&&(g["!fullref"]=g["!ref"],S.e.r=t.sheetRows-1,g["!ref"]=Lt(S)),U.length&&(g["!merges"]=U),V.length&&(g["!rows"]=V),c.name=c.||c.name,typeof JSON<"u"&&JSON.stringify(c),f.push(c.name),p[c.name]=g,X=!1):m[0].charAt(m[0].length-2)!=="/"&&(c=yt(m[0],!1),L=D=-1,S.s.r=S.s.c=1e7,S.e.r=S.e.c=0,g=t.dense?[]:{},U=[],V=[],X=!0);break;case"table-row-group":m[1]==="/"?--A:++A;break;case"table-row":case"":if(m[1]==="/"){L+=oe,oe=1;break}if(d=yt(m[0],!1),d.?L=d.-1:L==-1&&(L=0),oe=+d["number-rows-repeated"]||1,oe<10)for(he=0;he<oe;++he)A>0&&(V[L+he]={level:A});D=-1;break;case"covered-table-cell":m[1]!=="/"&&++D,t.sheetStubs&&(t.dense?(g[L]||(g[L]=[]),g[L][D]={t:"z"}):g[xt({r:L,c:D})]={t:"z"}),E="",F=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++D,w=yt(m[0],!1),K=parseInt(w["number-columns-repeated"]||"1",10),b={t:"z",v:null},w.formula&&t.cellFormula!=!1&&(b.f=km(Vt(w.formula))),(w.||w["value-type"])=="string"&&(b.t="s",b.v=Vt(w["string-value"]||""),t.dense?(g[L]||(g[L]=[]),g[L][D]=b):g[xt({r:L,c:D})]=b),D+=K-1;else if(m[1]!=="/"){++D,E="",C=0,F=[],K=1;var ce=oe?L+oe-1:L;if(D>S.e.c&&(S.e.c=D),D<S.s.c&&(S.s.c=D),L<S.s.r&&(S.s.r=L),ce>S.e.r&&(S.e.r=ce),w=yt(m[0],!1),ge=[],_={},b={t:w.||w["value-type"],v:null},t.cellFormula)if(w.formula&&(w.formula=Vt(w.formula)),w["number-matrix-columns-spanned"]&&w["number-matrix-rows-spanned"]&&(k=parseInt(w["number-matrix-rows-spanned"],10)||0,M=parseInt(w["number-matrix-columns-spanned"],10)||0,R={s:{r:L,c:D},e:{r:L+k-1,c:D+M-1}},b.F=Lt(R),Y.push([R,b.F])),w.formula)b.f=km(w.formula);else for(he=0;he<Y.length;++he)L>=Y[he][0].s.r&&L<=Y[he][0].e.r&&D>=Y[he][0].s.c&&D<=Y[he][0].e.c&&(b.F=Y[he][1]);switch((w["number-columns-spanned"]||w["number-rows-spanned"])&&(k=parseInt(w["number-rows-spanned"],10)||0,M=parseInt(w["number-columns-spanned"],10)||0,R={s:{r:L,c:D},e:{r:L+k-1,c:D+M-1}},U.push(R)),w["number-columns-repeated"]&&(K=parseInt(w["number-columns-repeated"],10)),b.t){case"boolean":b.t="b",b.v=mr(w["boolean-value"]);break;case"float":b.t="n",b.v=parseFloat(w.value);break;case"percentage":b.t="n",b.v=parseFloat(w.value);break;case"currency":b.t="n",b.v=parseFloat(w.value);break;case"date":b.t="d",b.v=br(w["date-value"]),t.cellDates||(b.t="n",b.v=Jr(b.v)),b.z="m/d/yy";break;case"time":b.t="n",b.v=LE(w["time-value"])/86400,t.cellDates&&(b.t="d",b.v=ou(b.v)),b.z="HH:MM:SS";break;case"number":b.t="n",b.v=parseFloat(w.);break;default:if(b.t==="string"||b.t==="text"||!b.t)b.t="s",w["string-value"]!=null&&(E=Vt(w["string-value"]),F=[]);else throw new Error("Unsupported value type "+b.t)}}else{if(I=!1,b.t==="s"&&(b.v=E||"",F.length&&(b.R=F),I=C==0),q.Target&&(b.l=q),ge.length>0&&(b.c=ge,ge=[]),E&&t.cellText!==!1&&(b.w=E),I&&(b.t="z",delete b.v),(!I||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=L))for(var ue=0;ue<oe;++ue){if(K=parseInt(w["number-columns-repeated"]||"1",10),t.dense)for(g[L+ue]||(g[L+ue]=[]),g[L+ue][D]=ue==0?b:cr(b);--K>0;)g[L+ue][D+K]=cr(b);else for(g[xt({r:L+ue,c:D})]=b;--K>0;)g[xt({r:L+ue,c:D+K})]=cr(b);S.e.c<=D&&(S.e.c=D)}K=parseInt(w["number-columns-repeated"]||"1",10),D+=K-1,K=0,b={},E="",F=[]}q={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=n.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&n.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=n.pop())[0]!==m[3])throw"Bad state: "+s;_.t=E,F.length&&(_.R=F),_.a=P,ge.push(_)}else m[0].charAt(m[0].length-2)!=="/"&&n.push([m[3],!1]);P="",N=0,E="",C=0,F=[];break;case"creator":m[1]==="/"?P=i.slice(N,m.index):N=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=n.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&n.push([m[3],!1]);E="",C=0,F=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(O[o.name]=l,(s=n.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(l="",o=yt(m[0],!1),n.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":a=yt(m[0],!1),l+=Rm[m[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":a=yt(m[0],!1),l+=Rm[m[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":l+=i.slice(h,m.index);break}else h=m.index+m[0].length;break;case"named-range":a=yt(m[0],!1),fe=Ef(a["cell-range-address"]);var be={Name:a.name,Ref:fe[0]+"!"+fe[1]};X&&(be.Sheet=f.length),se.Names.push(be);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(m[1]==="/"&&(!w||!w["string-value"])){var Le=QF(i.slice(C,m.index));E=(E.length>0?E+`
`:"")+Le[0]}else yt(m[0],!1),C=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{fe=Ef(yt(m[0])["target-range-address"]),p[fe[0]]["!autofilter"]={ref:fe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(q=yt(m[0],!1),!q.href)break;q.Target=Vt(q.href),delete q.href,q.Target.charAt(0)=="#"&&q.Target.indexOf(".")>-1?(fe=Ef(q.Target.slice(1)),q.Target="#"+fe[0]+"!"+fe[1]):q.Target.match(/^\.\.[\\\/]/)&&(q.Target=q.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(m)}}var Z={Sheets:p,SheetNames:f,Workbook:se};return t.bookSheets&&delete Z.Sheets,Z}function Lm(r,e){e=e||{},bn(r,"META-INF/manifest.xml")&&LC(Vr(r,"META-INF/manifest.xml"),e);var t=en(r,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var i=Pv(sr(t),e);return bn(r,"meta.xml")&&(i.Props=w1(Vr(r,"meta.xml"))),i}function Nm(r,e){return Pv(r,e)}var eR=(function(){var r=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+$l({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+r+"</office:document-styles>";return function(){return Br+e}})(),Pm=(function(){var r=function(s){return rr(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,i=function(s,a,o){var l=[];l.push('      <table:table table:name="'+rr(a.SheetNames[o])+`" table:style-name="ta1">
`);var h=0,c=0,d=Ni(s["!ref"]||"A1"),p=s["!merges"]||[],f=0,g=Array.isArray(s);if(s["!cols"])for(c=0;c<=d.e.c;++c)l.push("        <table:table-column"+(s["!cols"][c]?' table:style-name="co'+s["!cols"][c].ods+'"':"")+`></table:table-column>
`);var m="",b=s["!rows"]||[];for(h=0;h<d.s.r;++h)m=b[h]?' table:style-name="ro'+b[h].ods+'"':"",l.push("        <table:table-row"+m+`></table:table-row>
`);for(;h<=d.e.r;++h){for(m=b[h]?' table:style-name="ro'+b[h].ods+'"':"",l.push("        <table:table-row"+m+`>
`),c=0;c<d.s.c;++c)l.push(e);for(;c<=d.e.c;++c){var w=!1,E={},C="";for(f=0;f!=p.length;++f)if(!(p[f].s.c>c)&&!(p[f].s.r>h)&&!(p[f].e.c<c)&&!(p[f].e.r<h)){(p[f].s.c!=c||p[f].s.r!=h)&&(w=!0),E["table:number-columns-spanned"]=p[f].e.c-p[f].s.c+1,E["table:number-rows-spanned"]=p[f].e.r-p[f].s.r+1;break}if(w){l.push(t);continue}var F=xt({r:h,c}),L=g?(s[h]||[])[c]:s[F];if(L&&L.f&&(E["table:formula"]=rr(kT(L.f)),L.F&&L.F.slice(0,F.length)==F)){var D=Ni(L.F);E["table:number-matrix-columns-spanned"]=D.e.c-D.s.c+1,E["table:number-matrix-rows-spanned"]=D.e.r-D.s.r+1}if(!L){l.push(e);continue}switch(L.t){case"b":C=L.v?"TRUE":"FALSE",E["office:value-type"]="boolean",E["office:boolean-value"]=L.v?"true":"false";break;case"n":C=L.w||String(L.v||0),E["office:value-type"]="float",E["office:value"]=L.v||0;break;case"s":case"str":C=L.v==null?"":L.v,E["office:value-type"]="string";break;case"d":C=L.w||br(L.v).toISOString(),E["office:value-type"]="date",E["office:date-value"]=br(L.v).toISOString(),E["table:style-name"]="ce1";break;default:l.push(e);continue}var S=r(C);if(L.l&&L.l.Target){var A=L.l.Target;A=A.charAt(0)=="#"?"#"+ST(A.slice(1)):A,A.charAt(0)!="#"&&!A.match(/^\w+:/)&&(A="../"+A),S=Ke("text:a",S,{"xlink:href":A.replace(/&/g,"&amp;")})}l.push("          "+Ke("table:table-cell",Ke("text:p",S,{}),E)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},n=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(h){return a.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var c=0;c<h["!cols"].length;++c)if(h["!cols"][c]){var d=h["!cols"][c];if(d.width==null&&d.wpx==null&&d.wch==null)continue;aa(d),d.ods=o;var p=h["!cols"][c].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(h){return a.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var c=0;c<h["!rows"].length;++c)if(h["!rows"][c]){h["!rows"][c].ods=l;var d=h["!rows"][c].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[Br],h=$l({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),c=$l({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+h+c+`>
`),l.push(b1().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+h+`>
`),n(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var d=0;d!=a.SheetNames.length;++d)l.push(i(a.Sheets[a.SheetNames[d]],a,d));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function Dv(r,e){if(e.bookType=="fods")return Pm(r,e);var t=Ed(),i="",n=[],s=[];return i="mimetype",Nt(t,i,"application/vnd.oasis.opendocument.spreadsheet"),i="content.xml",Nt(t,i,Pm(r,e)),n.push([i,"text/xml"]),s.push([i,"ContentFile"]),i="styles.xml",Nt(t,i,eR(r,e)),n.push([i,"text/xml"]),s.push([i,"StylesFile"]),i="meta.xml",Nt(t,i,Br+b1()),n.push([i,"text/xml"]),s.push([i,"MetadataFile"]),i="manifest.rdf",Nt(t,i,DC(s)),n.push([i,"application/rdf+xml"]),i="META-INF/manifest.xml",Nt(t,i,NC(n)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function za(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function sd(r){return typeof TextDecoder<"u"?new TextDecoder().decode(r):sr(ha(r))}function tR(r){return typeof TextEncoder<"u"?new TextEncoder().encode(r):Qi(ns(r))}function rR(r,e){e:for(var t=0;t<=r.length-e.length;++t){for(var i=0;i<e.length;++i)if(r[t+i]!=e[i])continue e;return!0}return!1}function la(r){var e=r.reduce(function(n,s){return n+s.length},0),t=new Uint8Array(e),i=0;return r.forEach(function(n){t.set(n,i),i+=n.length}),t}function Dm(r){return r-=r>>1&1431655765,r=(r&858993459)+(r>>2&858993459),(r+(r>>4)&252645135)*16843009>>>24}function iR(r,e){for(var t=(r[e+15]&127)<<7|r[e+14]>>1,i=r[e+14]&1,n=e+13;n>=e;--n)i=i*256+r[n];return(r[e+15]&128?-i:i)*Math.pow(10,t-6176)}function nR(r,e,t){var i=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,n=t/Math.pow(10,i-6176);r[e+15]|=i>>7,r[e+14]|=(i&127)<<1;for(var s=0;n>=1;++s,n/=256)r[e+s]=n&255;r[e+15]|=t>=0?0:128}function nh(r,e){var t=e?e[0]:0,i=r[t]&127;e:if(r[t++]>=128&&(i|=(r[t]&127)<<7,r[t++]<128||(i|=(r[t]&127)<<14,r[t++]<128)||(i|=(r[t]&127)<<21,r[t++]<128)||(i+=(r[t]&127)*Math.pow(2,28),++t,r[t++]<128)||(i+=(r[t]&127)*Math.pow(2,35),++t,r[t++]<128)||(i+=(r[t]&127)*Math.pow(2,42),++t,r[t++]<128)))break e;return e&&(e[0]=t),i}function Qt(r){var e=new Uint8Array(7);e[0]=r&127;var t=1;e:if(r>127){if(e[t-1]|=128,e[t]=r>>7&127,++t,r<=16383||(e[t-1]|=128,e[t]=r>>14&127,++t,r<=2097151)||(e[t-1]|=128,e[t]=r>>21&127,++t,r<=268435455)||(e[t-1]|=128,e[t]=r/256>>>21&127,++t,r<=34359738367)||(e[t-1]|=128,e[t]=r/65536>>>21&127,++t,r<=4398046511103))break e;e[t-1]|=128,e[t]=r/16777216>>>21&127,++t}return e.slice(0,t)}function Ar(r){var e=0,t=r[e]&127;e:if(r[e++]>=128){if(t|=(r[e]&127)<<7,r[e++]<128||(t|=(r[e]&127)<<14,r[e++]<128)||(t|=(r[e]&127)<<21,r[e++]<128))break e;t|=(r[e]&127)<<28}return t}function qt(r){for(var e=[],t=[0];t[0]<r.length;){var i=t[0],n=nh(r,t),s=n&7;n=Math.floor(n/8);var a=0,o;if(n==0)break;switch(s){case 0:{for(var l=t[0];r[t[0]++]>=128;);o=r.slice(l,t[0])}break;case 5:a=4,o=r.slice(t[0],t[0]+a),t[0]+=a;break;case 1:a=8,o=r.slice(t[0],t[0]+a),t[0]+=a;break;case 2:a=nh(r,t),o=r.slice(t[0],t[0]+a),t[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(n," at offset ").concat(i))}var h={data:o,type:s};e[n]==null?e[n]=[h]:e[n].push(h)}return e}function ai(r){var e=[];return r.forEach(function(t,i){t.forEach(function(n){n.data&&(e.push(Qt(i*8+n.type)),n.type==2&&e.push(Qt(n.data.length)),e.push(n.data))})}),la(e)}function e0(r,e){return r?.map(function(t){return e(t.data)})||[]}function mn(r){for(var e,t=[],i=[0];i[0]<r.length;){var n=nh(r,i),s=qt(r.slice(i[0],i[0]+n));i[0]+=n;var a={id:Ar(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=qt(o.data),h=Ar(l[3][0].data);a.messages.push({meta:l,data:r.slice(i[0],i[0]+h)}),i[0]+=h}),(e=s[3])!=null&&e[0]&&(a.merge=Ar(s[3][0].data)>>>0>0),t.push(a)}return t}function xo(r){var e=[];return r.forEach(function(t){var i=[];i[1]=[{data:Qt(t.id),type:0}],i[2]=[],t.merge!=null&&(i[3]=[{data:Qt(+!!t.merge),type:0}]);var n=[];t.messages.forEach(function(a){n.push(a.data),a.meta[3]=[{type:0,data:Qt(a.data.length)}],i[2].push({data:ai(a.meta),type:2})});var s=ai(i);e.push(Qt(s.length)),e.push(s),n.forEach(function(a){return e.push(a)})}),la(e)}function sR(r,e){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var t=[0],i=nh(e,t),n=[];t[0]<e.length;){var s=e[t[0]]&3;if(s==0){var a=e[t[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[t[0]],o>1&&(a|=e[t[0]+1]<<8),o>2&&(a|=e[t[0]+2]<<16),o>3&&(a|=e[t[0]+3]<<24),a>>>=0,a++,t[0]+=o}n.push(e.slice(t[0],t[0]+a)),t[0]+=a;continue}else{var l=0,h=0;if(s==1?(h=(e[t[0]]>>2&7)+4,l=(e[t[0]++]&224)<<3,l|=e[t[0]++]):(h=(e[t[0]++]>>2)+1,s==2?(l=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(l=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),n=[la(n)],l==0)throw new Error("Invalid offset 0");if(l>n[0].length)throw new Error("Invalid offset beyond length");if(h>=l)for(n.push(n[0].slice(-l)),h-=l;h>=n[n.length-1].length;)n.push(n[n.length-1]),h-=n[n.length-1].length;n.push(n[0].slice(-l,-l+h))}}var c=la(n);if(c.length!=i)throw new Error("Unexpected length: ".concat(c.length," != ").concat(i));return c}function gn(r){for(var e=[],t=0;t<r.length;){var i=r[t++],n=r[t]|r[t+1]<<8|r[t+2]<<16;t+=3,e.push(sR(i,r.slice(t,t+n))),t+=n}if(t!==r.length)throw new Error("data is not a valid framed stream!");return la(e)}function yo(r){for(var e=[],t=0;t<r.length;){var i=Math.min(r.length-t,268435455),n=new Uint8Array(4);e.push(n);var s=Qt(i),a=s.length;e.push(s),i<=60?(a++,e.push(new Uint8Array([i-1<<2]))):i<=256?(a+=2,e.push(new Uint8Array([240,i-1&255]))):i<=65536?(a+=3,e.push(new Uint8Array([244,i-1&255,i-1>>8&255]))):i<=16777216?(a+=4,e.push(new Uint8Array([248,i-1&255,i-1>>8&255,i-1>>16&255]))):i<=4294967296&&(a+=5,e.push(new Uint8Array([252,i-1&255,i-1>>8&255,i-1>>16&255,i-1>>>24&255]))),e.push(r.slice(t,t+i)),a+=i,n[0]=0,n[1]=a&255,n[2]=a>>8&255,n[3]=a>>16&255,t+=i}return la(e)}function aR(r,e,t,i){var n=za(r),s=n.getUint32(4,!0),a=(i>1?12:8)+Dm(s&(i>1?3470:398))*4,o=-1,l=-1,h=NaN,c=new Date(2001,0,1);s&512&&(o=n.getUint32(a,!0),a+=4),a+=Dm(s&(i>1?12288:4096))*4,s&16&&(l=n.getUint32(a,!0),a+=4),s&32&&(h=n.getFloat64(a,!0),a+=8),s&64&&(c.setTime(c.getTime()+n.getFloat64(a,!0)*1e3),a+=8);var d;switch(r[2]){case 0:break;case 2:d={t:"n",v:h};break;case 3:d={t:"s",v:e[l]};break;case 5:d={t:"d",v:c};break;case 6:d={t:"b",v:h>0};break;case 7:d={t:"n",v:h/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:t[o]};else if(l>-1)d={t:"s",v:e[l]};else if(!isNaN(h))d={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(r.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(r.slice(0,4)))}return d}function oR(r,e,t){var i=za(r),n=i.getUint32(8,!0),s=12,a=-1,o=-1,l=NaN,h=NaN,c=new Date(2001,0,1);n&1&&(l=iR(r,s),s+=16),n&2&&(h=i.getFloat64(s,!0),s+=8),n&4&&(c.setTime(c.getTime()+i.getFloat64(s,!0)*1e3),s+=8),n&8&&(o=i.getUint32(s,!0),s+=4),n&16&&(a=i.getUint32(s,!0),s+=4);var d;switch(r[1]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:e[o]};break;case 5:d={t:"d",v:c};break;case 6:d={t:"b",v:h>0};break;case 7:d={t:"n",v:h/86400};break;case 8:d={t:"e",v:0};break;case 9:if(a>-1)d={t:"s",v:t[a]};else throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(n&31," : ").concat(r.slice(0,4)));break;case 10:d={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(n&31," : ").concat(r.slice(0,4)))}return d}function _f(r,e){var t=new Uint8Array(32),i=za(t),n=12,s=0;switch(t[0]=5,r.t){case"n":t[1]=2,nR(t,n,r.v),s|=1,n+=16;break;case"b":t[1]=6,i.setFloat64(n,r.v?1:0,!0),s|=2,n+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[1]=3,i.setUint32(n,e.indexOf(r.v),!0),s|=8,n+=4;break;default:throw"unsupported cell type "+r.t}return i.setUint32(8,s,!0),t.slice(0,n)}function kf(r,e){var t=new Uint8Array(32),i=za(t),n=12,s=0;switch(t[0]=3,r.t){case"n":t[2]=2,i.setFloat64(n,r.v,!0),s|=32,n+=8;break;case"b":t[2]=6,i.setFloat64(n,r.v?1:0,!0),s|=32,n+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[2]=3,i.setUint32(n,e.indexOf(r.v),!0),s|=16,n+=4;break;default:throw"unsupported cell type "+r.t}return i.setUint32(4,s,!0),t.slice(0,n)}function lR(r,e,t){switch(r[0]){case 0:case 1:case 2:case 3:return aR(r,e,t,r[0]);case 5:return oR(r,e,t);default:throw new Error("Unsupported payload version ".concat(r[0]))}}function bi(r){var e=qt(r);return nh(e[1][0].data)}function Mm(r,e){var t=qt(e.data),i=Ar(t[1][0].data),n=t[3],s=[];return(n||[]).forEach(function(a){var o=qt(a.data),l=Ar(o[1][0].data)>>>0;switch(i){case 1:s[l]=sd(o[3][0].data);break;case 8:{var h=r[bi(o[9][0].data)][0],c=qt(h.data),d=r[bi(c[1][0].data)][0],p=Ar(d.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var f=qt(d.data);s[l]=f[3].map(function(g){return sd(g.data)}).join("")}break}}),s}function hR(r,e){var t,i,n,s,a,o,l,h,c,d,p,f,g,m,b=qt(r),w=Ar(b[1][0].data)>>>0,E=Ar(b[2][0].data)>>>0,C=((i=(t=b[8])==null?void 0:t[0])==null?void 0:i.data)&&Ar(b[8][0].data)>0||!1,F,L;if((s=(n=b[7])==null?void 0:n[0])!=null&&s.data&&e!=0)F=(o=(a=b[7])==null?void 0:a[0])==null?void 0:o.data,L=(h=(l=b[6])==null?void 0:l[0])==null?void 0:h.data;else if((d=(c=b[4])==null?void 0:c[0])!=null&&d.data&&e!=1)F=(f=(p=b[4])==null?void 0:p[0])==null?void 0:f.data,L=(m=(g=b[3])==null?void 0:g[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var D=C?4:1,S=za(F),A=[],O=0;O<F.length/2;++O){var U=S.getUint16(O*2,!0);U<65535&&A.push([O,U])}if(A.length!=E)throw"Expected ".concat(E," cells, found ").concat(A.length);var R=[];for(O=0;O<A.length-1;++O)R[A[O][0]]=L.subarray(A[O][1]*D,A[O+1][1]*D);return A.length>=1&&(R[A[A.length-1][0]]=L.subarray(A[A.length-1][1]*D)),{R:w,cells:R}}function cR(r,e){var t,i=qt(e.data),n=(t=i?.[7])!=null&&t[0]?Ar(i[7][0].data)>>>0>0?1:0:-1,s=e0(i[5],function(a){return hR(a,n)});return{nrows:Ar(i[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,h){if(a[o.R][h])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(h));a[o.R][h]=l}),a},[])}}function uR(r,e,t){var i,n=qt(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Ar(n[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(s.e.c=(Ar(n[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));t["!ref"]=Lt(s);var a=qt(n[4][0].data),o=Mm(r,r[bi(a[4][0].data)][0]),l=(i=a[17])!=null&&i[0]?Mm(r,r[bi(a[17][0].data)][0]):[],h=qt(a[3][0].data),c=0;h[1].forEach(function(d){var p=qt(d.data),f=r[bi(p[2][0].data)][0],g=Ar(f.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var m=cR(r,f);m.data.forEach(function(b,w){b.forEach(function(E,C){var F=xt({r:c+w,c:C}),L=lR(E,o,l);L&&(t[F]=L)})}),c+=m.nrows})}function fR(r,e){var t=qt(e.data),i={"!ref":"A1"},n=r[bi(t[2][0].data)],s=Ar(n[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return uR(r,n[0],i),i}function dR(r,e){var t,i=qt(e.data),n={name:(t=i[1])!=null&&t[0]?sd(i[1][0].data):"",sheets:[]},s=e0(i[2],bi);return s.forEach(function(a){r[a].forEach(function(o){var l=Ar(o.meta[1][0].data);l==6e3&&n.sheets.push(fR(r,o))})}),n}function pR(r,e){var t=o0(),i=qt(e.data),n=e0(i[1],bi);if(n.forEach(function(s){r[s].forEach(function(a){var o=Ar(a.meta[1][0].data);if(o==2){var l=dR(r,a);l.sheets.forEach(function(h,c){l0(t,h,c==0?l.name:l.name+"_"+c,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function Sf(r){var e,t,i,n,s={},a=[];if(r.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),r.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var h;try{h=gn(l.content)}catch(d){return console.log("?? "+l.content.length+" "+(d.message||d))}var c;try{c=mn(h)}catch(d){return console.log("## "+(d.message||d))}c.forEach(function(d){s[d.id]=d.messages,a.push(d.id)})}}),!a.length)throw new Error("File has no messages");var o=((n=(i=(t=(e=s?.[1])==null?void 0:e[0])==null?void 0:t.meta)==null?void 0:i[1])==null?void 0:n[0].data)&&Ar(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(l){s[l].forEach(function(h){var c=Ar(h.meta[1][0].data)>>>0;if(c==1)if(!o)o=h;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return pR(s,o)}function mR(r,e,t){var i,n,s,a;if(!((i=r[6])!=null&&i[0])||!((n=r[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=r[8])==null?void 0:s[0])==null?void 0:a.data)&&Ar(r[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,h=za(r[7][0].data),c=0,d=[],p=za(r[4][0].data),f=0,g=[],m=0;m<e.length;++m){if(e[m]==null){h.setUint16(m*2,65535,!0),p.setUint16(m*2,65535);continue}h.setUint16(m*2,c,!0),p.setUint16(m*2,f,!0);var b,w;switch(typeof e[m]){case"string":b=_f({t:"s",v:e[m]},t),w=kf({t:"s",v:e[m]},t);break;case"number":b=_f({t:"n",v:e[m]},t),w=kf({t:"n",v:e[m]},t);break;case"boolean":b=_f({t:"b",v:e[m]},t),w=kf({t:"b",v:e[m]},t);break;default:throw new Error("Unsupported value "+e[m])}d.push(b),c+=b.length,g.push(w),f+=w.length,++l}for(r[2][0].data=Qt(l);m<r[7][0].data.length/2;++m)h.setUint16(m*2,65535,!0),p.setUint16(m*2,65535,!0);return r[6][0].data=la(d),r[3][0].data=la(g),l}function gR(r,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=r.Sheets[r.SheetNames[0]];r.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var i=Ni(t["!ref"]);i.s.r=i.s.c=0;var n=!1;i.e.c>9&&(n=!0,i.e.c=9),i.e.r>49&&(n=!0,i.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(Lt(i)));var s=Gc(t,{range:i,header:1}),a=["~Sh33tJ5~"];s.forEach(function(P){return P.forEach(function(N){typeof N=="string"&&a.push(N)})});var o={},l=[],h=ut.read(e.numbers,{type:"base64"});h.FileIndex.map(function(P,N){return[P,h.FullPaths[N]]}).forEach(function(P){var N=P[0],I=P[1];if(N.type==2&&N.name.match(/\.iwa/)){var X=N.content,he=gn(X),ce=mn(he);ce.forEach(function(ue){l.push(ue.id),o[ue.id]={deps:[],location:I,type:Ar(ue.messages[0].meta[1][0].data)}})}}),l.sort(function(P,N){return P-N});var c=l.filter(function(P){return P>1}).map(function(P){return[P,Qt(P)]});h.FileIndex.map(function(P,N){return[P,h.FullPaths[N]]}).forEach(function(P){var N=P[0];if(P[1],!!N.name.match(/\.iwa/)){var I=mn(gn(N.content));I.forEach(function(X){X.messages.forEach(function(he){c.forEach(function(ce){X.messages.some(function(ue){return Ar(ue.meta[1][0].data)!=11006&&rR(ue.data,ce[1])})&&o[ce[0]].deps.push(X.id)})})})}});for(var d=ut.find(h,o[1].location),p=mn(gn(d.content)),f,g=0;g<p.length;++g){var m=p[g];m.id==1&&(f=m)}var b=bi(qt(f.messages[0].data)[1][0].data);for(d=ut.find(h,o[b].location),p=mn(gn(d.content)),g=0;g<p.length;++g)m=p[g],m.id==b&&(f=m);for(b=bi(qt(f.messages[0].data)[2][0].data),d=ut.find(h,o[b].location),p=mn(gn(d.content)),g=0;g<p.length;++g)m=p[g],m.id==b&&(f=m);for(b=bi(qt(f.messages[0].data)[2][0].data),d=ut.find(h,o[b].location),p=mn(gn(d.content)),g=0;g<p.length;++g)m=p[g],m.id==b&&(f=m);var w=qt(f.messages[0].data);{w[6][0].data=Qt(i.e.r+1),w[7][0].data=Qt(i.e.c+1);var E=bi(w[46][0].data),C=ut.find(h,o[E].location),F=mn(gn(C.content));{for(var L=0;L<F.length&&F[L].id!=E;++L);if(F[L].id!=E)throw"Bad ColumnRowUIDMapArchive";var D=qt(F[L].messages[0].data);D[1]=[],D[2]=[],D[3]=[];for(var S=0;S<=i.e.c;++S){var A=[];A[1]=A[2]=[{type:0,data:Qt(S+420690)}],D[1].push({type:2,data:ai(A)}),D[2].push({type:0,data:Qt(S)}),D[3].push({type:0,data:Qt(S)})}D[4]=[],D[5]=[],D[6]=[];for(var O=0;O<=i.e.r;++O)A=[],A[1]=A[2]=[{type:0,data:Qt(O+726270)}],D[4].push({type:2,data:ai(A)}),D[5].push({type:0,data:Qt(O)}),D[6].push({type:0,data:Qt(O)});F[L].messages[0].data=ai(D)}C.content=yo(xo(F)),C.size=C.content.length,delete w[46];var U=qt(w[4][0].data);{U[7][0].data=Qt(i.e.r+1);var R=qt(U[1][0].data),k=bi(R[2][0].data);C=ut.find(h,o[k].location),F=mn(gn(C.content));{if(F[0].id!=k)throw"Bad HeaderStorageBucket";var M=qt(F[0].messages[0].data);for(O=0;O<s.length;++O){var V=qt(M[2][0].data);V[1][0].data=Qt(O),V[4][0].data=Qt(s[O].length),M[2][O]={type:M[2][0].type,data:ai(V)}}F[0].messages[0].data=ai(M)}C.content=yo(xo(F)),C.size=C.content.length;var oe=bi(U[2][0].data);C=ut.find(h,o[oe].location),F=mn(gn(C.content));{if(F[0].id!=oe)throw"Bad HeaderStorageBucket";for(M=qt(F[0].messages[0].data),S=0;S<=i.e.c;++S)V=qt(M[2][0].data),V[1][0].data=Qt(S),V[4][0].data=Qt(i.e.r+1),M[2][S]={type:M[2][0].type,data:ai(V)};F[0].messages[0].data=ai(M)}C.content=yo(xo(F)),C.size=C.content.length;var K=bi(U[4][0].data);(function(){for(var P=ut.find(h,o[K].location),N=mn(gn(P.content)),I,X=0;X<N.length;++X){var he=N[X];he.id==K&&(I=he)}var ce=qt(I.messages[0].data);{ce[3]=[];var ue=[];a.forEach(function(Z,Ue){ue[1]=[{type:0,data:Qt(Ue)}],ue[2]=[{type:0,data:Qt(1)}],ue[3]=[{type:2,data:tR(Z)}],ce[3].push({type:2,data:ai(ue)})})}I.messages[0].data=ai(ce);var be=xo(N),Le=yo(be);P.content=Le,P.size=P.content.length})();var Y=qt(U[3][0].data);{var se=Y[1][0];delete Y[2];var q=qt(se.data);{var fe=bi(q[2][0].data);(function(){for(var P=ut.find(h,o[fe].location),N=mn(gn(P.content)),I,X=0;X<N.length;++X){var he=N[X];he.id==fe&&(I=he)}var ce=qt(I.messages[0].data);{delete ce[6],delete Y[7];var ue=new Uint8Array(ce[5][0].data);ce[5]=[];for(var be=0,Le=0;Le<=i.e.r;++Le){var Z=qt(ue);be+=mR(Z,s[Le],a),Z[1][0].data=Qt(Le),ce[5].push({data:ai(Z),type:2})}ce[1]=[{type:0,data:Qt(i.e.c+1)}],ce[2]=[{type:0,data:Qt(i.e.r+1)}],ce[3]=[{type:0,data:Qt(be)}],ce[4]=[{type:0,data:Qt(i.e.r+1)}]}I.messages[0].data=ai(ce);var Ue=xo(N),Ye=yo(Ue);P.content=Ye,P.size=P.content.length})()}se.data=ai(q)}U[3][0].data=ai(Y)}w[4][0].data=ai(U)}f.messages[0].data=ai(w);var ge=xo(p),_=yo(ge);return d.content=_,d.size=d.content.length,h}function Mv(r){return function(t){for(var i=0;i!=r.length;++i){var n=r[i];t[n[0]]===void 0&&(t[n[0]]=n[1]),n[2]==="n"&&(t[n[0]]=Number(t[n[0]]))}}}function t0(r){Mv([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(r)}function r0(r){Mv([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(r)}function vR(r){return It.WS.indexOf(r)>-1?"sheet":r==It.CS?"chart":r==It.DS?"dialog":r==It.MS?"macro":r&&r.length?r:"sheet"}function bR(r,e){if(!r)return 0;try{r=e.map(function(i){return i.id||(i.id=i.strRelID),[i.name,r["!id"][i.id].Target,vR(r["!id"][i.id].Type)]})}catch{return null}return!r||r.length===0?null:r}function wR(r,e,t,i,n,s,a,o,l,h,c,d){try{s[i]=Bl(en(r,t,!0),e);var p=Vr(r,e),f;switch(o){case"sheet":f=G6(p,e,n,l,s[i],h,c,d);break;case"chart":if(f=q6(p,e,n,l,s[i],h,c,d),!f||!f["!drawel"])break;var g=Sl(f["!drawel"].Target,e),m=Zl(g),b=Pk(en(r,g,!0),Bl(en(r,m,!0),g)),w=Sl(b,g),E=Zl(w);f=x6(en(r,w,!0),w,l,Bl(en(r,E,!0),w),h,f);break;case"macro":f=X6(p,e,n,l,s[i],h,c,d);break;case"dialog":f=K6(p,e,n,l,s[i],h,c,d);break;default:throw new Error("Unrecognized sheet type "+o)}a[i]=f;var C=[];s&&s[i]&&Fr(s[i]).forEach(function(F){var L="";if(s[i][F].Type==It.CMNT){L=Sl(s[i][F].Target,e);var D=Z6(Vr(r,L,!0),L,l);if(!D||!D.length)return;xm(f,D,!1)}s[i][F].Type==It.TCMNT&&(L=Sl(s[i][F].Target,e),C=C.concat(Mk(Vr(r,L,!0),l)))}),C&&C.length&&xm(f,C,!0,l.people||[])}catch(F){if(l.WTF)throw F}}function dn(r){return r.charAt(0)=="/"?r.slice(1):r}function Ov(r,e){if(jo(),e=e||{},t0(e),bn(r,"META-INF/manifest.xml")||bn(r,"objectdata.xml"))return Lm(r,e);if(bn(r,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Sf<"u"){if(r.FileIndex)return Sf(r);var t=ut.utils.cfb_new();return jp(r).forEach(function(V){Nt(t,V,OE(r,V))}),Sf(t)}throw new Error("Unsupported NUMBERS file")}if(!bn(r,"[Content_Types].xml"))throw bn(r,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):bn(r,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var i=jp(r),n=FC(en(r,"[Content_Types].xml")),s=!1,a,o;if(n.workbooks.length===0&&(o="xl/workbook.xml",Vr(r,o,!0)&&n.workbooks.push(o)),n.workbooks.length===0){if(o="xl/workbook.bin",!Vr(r,o,!0))throw new Error("Could not find workbook");n.workbooks.push(o),s=!0}n.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},h={};if(!e.bookSheets&&!e.bookProps){if(Hl=[],n.sst)try{Hl=J6(Vr(r,dn(n.sst)),n.sst,e)}catch(V){if(e.WTF)throw V}e.cellStyles&&n.themes.length&&(l=$6(en(r,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],e)),n.style&&(h=Y6(Vr(r,dn(n.style)),n.style,l,e))}n.links.map(function(V){try{var oe=Bl(en(r,Zl(dn(V))),V);return eF(Vr(r,dn(V)),oe,V,e)}catch{}});var c=V6(Vr(r,dn(n.workbooks[0])),n.workbooks[0],e),d={},p="";n.coreprops.length&&(p=Vr(r,dn(n.coreprops[0]),!0),p&&(d=w1(p)),n.extprops.length!==0&&(p=Vr(r,dn(n.extprops[0]),!0),p&&OC(p,d,e)));var f={};(!e.bookSheets||e.bookProps)&&n.custprops.length!==0&&(p=en(r,dn(n.custprops[0]),!0),p&&(f=BC(p,e)));var g={};if((e.bookSheets||e.bookProps)&&(c.Sheets?a=c.Sheets.map(function(oe){return oe.name}):d.Worksheets&&d.SheetNames.length>0&&(a=d.SheetNames),e.bookProps&&(g.Props=d,g.Custprops=f),e.bookSheets&&typeof a<"u"&&(g.SheetNames=a),e.bookSheets?g.SheetNames:e.bookProps))return g;a={};var m={};e.bookDeps&&n.calcchain&&(m=Q6(Vr(r,dn(n.calcchain)),n.calcchain));var b=0,w={},E,C;{var F=c.Sheets;d.Worksheets=F.length,d.SheetNames=[];for(var L=0;L!=F.length;++L)d.SheetNames[L]=F[L].name}var D=s?"bin":"xml",S=n.workbooks[0].lastIndexOf("/"),A=(n.workbooks[0].slice(0,S+1)+"_rels/"+n.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");bn(r,A)||(A="xl/_rels/workbook."+D+".rels");var O=Bl(en(r,A,!0),A.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(e.xlmeta=tF(Vr(r,dn(n.metadata[0])),n.metadata[0],e)),(n.people||[]).length>=1&&(e.people=Ik(Vr(r,dn(n.people[0])),e)),O&&(O=bR(O,c.Sheets));var U=Vr(r,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=d.Worksheets;++b){var R="sheet";if(O&&O[b]?(E="xl/"+O[b][1].replace(/[\/]?xl\//,""),bn(r,E)||(E=O[b][1]),bn(r,E)||(E=A.replace(/_rels\/.*$/,"")+O[b][1]),R=O[b][2]):(E="xl/worksheets/sheet"+(b+1-U)+"."+D,E=E.replace(/sheet0\./,"sheet.")),C=E.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(b!=e.sheets)continue e;break;case"string":if(d.SheetNames[b].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var k=!1,M=0;M!=e.sheets.length;++M)typeof e.sheets[M]=="number"&&e.sheets[M]==b&&(k=1),typeof e.sheets[M]=="string"&&e.sheets[M].toLowerCase()==d.SheetNames[b].toLowerCase()&&(k=1);if(!k)continue e}}wR(r,E,C,d.SheetNames[b],b,w,a,R,e,c,l,h)}return g={Directory:n,Workbook:c,Props:d,Custprops:f,Deps:m,Sheets:a,SheetNames:d.SheetNames,Strings:Hl,Styles:h,Themes:l,SSF:cr(vt)},e&&e.bookFiles&&(r.files?(g.keys=i,g.files=r.files):(g.keys=[],g.files={},r.FullPaths.forEach(function(V,oe){V=V.replace(/^Root Entry[\/]/,""),g.keys.push(V),g.files[V]=r.FileIndex[oe]}))),e&&e.bookVBA&&(n.vba.length>0?g.vbaraw=Vr(r,dn(n.vba[0]),!0):n.defaults&&n.defaults.bin===Gk&&(g.vbaraw=Vr(r,"xl/vbaProject.bin",!0))),g}function xR(r,e){var t=e||{},i="Workbook",n=ut.find(r,i);try{if(i="/!DataSpaces/Version",n=ut.find(r,i),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(r_(n.content),i="/!DataSpaces/DataSpaceMap",n=ut.find(r,i),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+i);var s=n_(n.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=ut.find(r,i),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+i);var a=s_(n.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=ut.find(r,i),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+i);o_(n.content)}catch{}if(i="/EncryptionInfo",n=ut.find(r,i),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+i);var o=l_(n.content);if(i="/EncryptedPackage",n=ut.find(r,i),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],n.content,t.password||"",t);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],n.content,t.password||"",t);throw new Error("File is password-protected")}function yR(r,e){return e.bookType=="ods"?Dv(r,e):e.bookType=="numbers"?gR(r,e):e.bookType=="xlsb"?ER(r,e):Iv(r,e)}function ER(r,e){Ro=1024,r&&!r.SSF&&(r.SSF=cr(vt)),r&&r.SSF&&(jo(),fh(r.SSF),e.revssf=au(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,zl?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",i=nv.indexOf(e.bookType)>-1,n=zd();r0(e=e||{});var s=Ed(),a="",o=0;if(e.cellXfs=[],ua(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),a="docProps/core.xml",Nt(s,a,x1(r.Props,e)),n.coreprops.push(a),er(e.rels,2,a,It.CORE_PROPS),a="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var l=[],h=0;h<r.SheetNames.length;++h)(r.Workbook.Sheets[h]||{}).Hidden!=2&&l.push(r.SheetNames[h]);r.Props.SheetNames=l}for(r.Props.Worksheets=r.Props.SheetNames.length,Nt(s,a,C1(r.Props)),n.extprops.push(a),er(e.rels,3,a,It.EXT_PROPS),r.Custprops!==r.Props&&Fr(r.Custprops||{}).length>0&&(a="docProps/custom.xml",Nt(s,a,_1(r.Custprops)),n.custprops.push(a),er(e.rels,4,a,It.CUST_PROPS)),o=1;o<=r.SheetNames.length;++o){var c={"!id":{}},d=r.Sheets[r.SheetNames[o-1]],p=(d||{})["!type"]||"sheet";switch(p){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,Nt(s,a,iF(o-1,a,e,r,c)),n.sheets.push(a),er(e.wbrels,-1,"worksheets/sheet"+o+"."+t,It.WS[0])}if(d){var f=d["!comments"],g=!1,m="";f&&f.length>0&&(m="xl/comments"+o+"."+t,Nt(s,m,aF(f,m)),n.comments.push(m),er(c,-1,"../comments"+o+"."+t,It.CMNT),g=!0),d["!legacy"]&&g&&Nt(s,"xl/drawings/vmlDrawing"+o+".vml",rv(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}c["!id"].rId1&&Nt(s,Zl(a),No(c))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,Nt(s,a,sF(e.Strings,a,e)),n.strs.push(a),er(e.wbrels,-1,"sharedStrings."+t,It.SST)),a="xl/workbook."+t,Nt(s,a,rF(r,a)),n.workbooks.push(a),er(e.rels,1,a,It.WB),a="xl/theme/theme1.xml",Nt(s,a,qd(r.Themes,e)),n.themes.push(a),er(e.wbrels,-1,"theme/theme1.xml",It.THEME),a="xl/styles."+t,Nt(s,a,nF(r,a,e)),n.styles.push(a),er(e.wbrels,-1,"styles."+t,It.STY),r.vbaraw&&i&&(a="xl/vbaProject.bin",Nt(s,a,r.vbaraw),n.vba.push(a),er(e.wbrels,-1,"vbaProject.bin",It.VBA)),a="xl/metadata."+t,Nt(s,a,oF(a)),n.metadata.push(a),er(e.wbrels,-1,"metadata."+t,It.XLMETA),Nt(s,"[Content_Types].xml",v1(n,e)),Nt(s,"_rels/.rels",No(e.rels)),Nt(s,"xl/_rels/workbook."+t+".rels",No(e.wbrels)),delete e.revssf,delete e.ssf,s}function Iv(r,e){Ro=1024,r&&!r.SSF&&(r.SSF=cr(vt)),r&&r.SSF&&(jo(),fh(r.SSF),e.revssf=au(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,zl?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",i=nv.indexOf(e.bookType)>-1,n=zd();r0(e=e||{});var s=Ed(),a="",o=0;if(e.cellXfs=[],ua(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),a="docProps/core.xml",Nt(s,a,x1(r.Props,e)),n.coreprops.push(a),er(e.rels,2,a,It.CORE_PROPS),a="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var l=[],h=0;h<r.SheetNames.length;++h)(r.Workbook.Sheets[h]||{}).Hidden!=2&&l.push(r.SheetNames[h]);r.Props.SheetNames=l}r.Props.Worksheets=r.Props.SheetNames.length,Nt(s,a,C1(r.Props)),n.extprops.push(a),er(e.rels,3,a,It.EXT_PROPS),r.Custprops!==r.Props&&Fr(r.Custprops||{}).length>0&&(a="docProps/custom.xml",Nt(s,a,_1(r.Custprops)),n.custprops.push(a),er(e.rels,4,a,It.CUST_PROPS));var c=["SheetJ5"];for(e.tcid=0,o=1;o<=r.SheetNames.length;++o){var d={"!id":{}},p=r.Sheets[r.SheetNames[o-1]],f=(p||{})["!type"]||"sheet";switch(f){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,Nt(s,a,mv(o-1,e,r,d)),n.sheets.push(a),er(e.wbrels,-1,"worksheets/sheet"+o+"."+t,It.WS[0])}if(p){var g=p["!comments"],m=!1,b="";if(g&&g.length>0){var w=!1;g.forEach(function(E){E[1].forEach(function(C){C.T==!0&&(w=!0)})}),w&&(b="xl/threadedComments/threadedComment"+o+"."+t,Nt(s,b,Ok(g,c,e)),n.threadedcomments.push(b),er(d,-1,"../threadedComments/threadedComment"+o+"."+t,It.TCMNT)),b="xl/comments"+o+"."+t,Nt(s,b,iv(g)),n.comments.push(b),er(d,-1,"../comments"+o+"."+t,It.CMNT),m=!0}p["!legacy"]&&m&&Nt(s,"xl/drawings/vmlDrawing"+o+".vml",rv(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}d["!id"].rId1&&Nt(s,Zl(a),No(d))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,Nt(s,a,V1(e.Strings,e)),n.strs.push(a),er(e.wbrels,-1,"sharedStrings."+t,It.SST)),a="xl/workbook."+t,Nt(s,a,yv(r)),n.workbooks.push(a),er(e.rels,1,a,It.WB),a="xl/theme/theme1.xml",Nt(s,a,qd(r.Themes,e)),n.themes.push(a),er(e.wbrels,-1,"theme/theme1.xml",It.THEME),a="xl/styles."+t,Nt(s,a,Z1(r,e)),n.styles.push(a),er(e.wbrels,-1,"styles."+t,It.STY),r.vbaraw&&i&&(a="xl/vbaProject.bin",Nt(s,a,r.vbaraw),n.vba.push(a),er(e.wbrels,-1,"vbaProject.bin",It.VBA)),a="xl/metadata."+t,Nt(s,a,tv()),n.metadata.push(a),er(e.wbrels,-1,"metadata."+t,It.XLMETA),c.length>1&&(a="xl/persons/person.xml",Nt(s,a,Bk(c)),n.people.push(a),er(e.wbrels,-1,"persons/person.xml",It.PEOPLE)),Nt(s,"[Content_Types].xml",v1(n,e)),Nt(s,"_rels/.rels",No(e.rels)),Nt(s,"xl/_rels/workbook."+t+".rels",No(e.wbrels)),delete e.revssf,delete e.ssf,s}function i0(r,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":t=rn(r.slice(0,12));break;case"binary":t=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function CR(r,e){return ut.find(r,"EncryptedPackage")?xR(r,e):Qd(r,e)}function _R(r,e){var t,i=r,n=e||{};return n.type||(n.type=Ot&&Buffer.isBuffer(r)?"buffer":"base64"),t=$g(i,n),Ov(t,n)}function Bv(r,e){var t=0;e:for(;t<r.length;)switch(r.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return id(r.slice(t),e);default:break e}return Io.to_workbook(r,e)}function kR(r,e){var t="",i=i0(r,e);switch(e.type){case"base64":t=rn(r);break;case"binary":t=r;break;case"buffer":t=r.toString("binary");break;case"array":t=Oa(r);break;default:throw new Error("Unrecognized type "+e.type)}return i[0]==239&&i[1]==187&&i[2]==191&&(t=sr(t)),e.type="binary",Bv(t,e)}function SR(r,e){var t=r;return e.type=="base64"&&(t=rn(t)),t=jt.utils.decode(1200,t.slice(2),"str"),e.type="binary",Bv(t,e)}function TR(r){return r.match(/[^\x00-\x7F]/)?ns(r):r}function Tf(r,e,t,i){return i?(t.type="string",Io.to_workbook(r,t)):Io.to_workbook(e,t)}function Vc(r,e){nu();var t=e||{};if(typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer)return Vc(new Uint8Array(r),(t=cr(t),t.type="array",t));typeof Uint8Array<"u"&&r instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var i=r,n=[0,0,0,0],s=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Do={},t.dateNF&&(Do.dateNF=t.dateNF),t.type||(t.type=Ot&&Buffer.isBuffer(r)?"buffer":"base64"),t.type=="file"&&(t.type=Ot?"buffer":"binary",i=AE(r),typeof Uint8Array<"u"&&!Ot&&(t.type="array")),t.type=="string"&&(s=!0,t.type="binary",t.codepage=65001,i=TR(r)),t.type=="array"&&typeof Uint8Array<"u"&&r instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return t=cr(t),t.type="array",Vc(bd(i),t)}switch((n=i0(i,t))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return CR(ut.read(i,t),t);break;case 9:if(n[1]<=8)return Qd(i,t);break;case 60:return id(i,t);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return H3(i,t);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return W1.to_workbook(i,t);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?_R(i,t):Tf(r,i,t,s);case 239:return n[3]===60?id(i,t):Tf(r,i,t,s);case 255:if(n[1]===254)return SR(i,t);if(n[1]===0&&n[2]===2&&n[3]===0)return La.to_workbook(i,t);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return La.to_workbook(i,t);break;case 3:case 131:case 139:case 140:return rd.to_workbook(i,t);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return Y1.to_workbook(i,t);break;case 10:case 13:case 32:return kR(i,t);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return B3.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?rd.to_workbook(i,t):Tf(r,i,t,s)}function Om(r,e){var t=e||{};return t.type="file",Vc(r,t)}function Hv(r,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return dh(e.file,ut.write(r,{type:Ot?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return ut.write(r,e)}function AR(r,e){var t=cr(e||{}),i=yR(r,t);return zv(i,t)}function FR(r,e){var t=cr(e||{}),i=Iv(r,t);return zv(i,t)}function zv(r,e){var t={},i=Ot?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=i;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=i;break;default:throw new Error("Unrecognized type "+e.type)}var n=r.FullPaths?ut.write(r,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):r.generate(t);if(typeof Deno<"u"&&typeof n=="string"){if(e.type=="binary"||e.type=="base64")return n;n=new Uint8Array(uh(n))}return e.password&&typeof encrypt_agile<"u"?Hv(encrypt_agile(n,e.password),e):e.type==="file"?dh(e.file,n):e.type=="string"?sr(n):n}function RR(r,e){var t=e||{},i=PF(r,t);return Hv(i,t)}function es(r,e,t){t||(t="");var i=t+r;switch(e.type){case"base64":return Xl(ns(i));case"binary":return ns(i);case"string":return r;case"file":return dh(e.file,i,"utf8");case"buffer":return Ot?Ts(i,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(i):es(i,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function LR(r,e){switch(e.type){case"base64":return Xl(r);case"binary":return r;case"string":return r;case"file":return dh(e.file,r,"binary");case"buffer":return Ot?Ts(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function bc(r,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",i=0;i<r.length;++i)t+=String.fromCharCode(r[i]);return e.type=="base64"?Xl(t):e.type=="string"?sr(t):t;case"file":return dh(e.file,r);case"buffer":return r;default:throw new Error("Unrecognized type "+e.type)}}function n0(r,e){nu(),xv(r);var t=cr(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var i=n0(r,t);return t.type="array",uh(i)}return FR(r,t)}function du(r,e){nu(),xv(r);var t=cr(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var i=du(r,t);return t.type="array",uh(i)}var n=0;if(t.sheet&&(typeof t.sheet=="number"?n=t.sheet:n=r.SheetNames.indexOf(t.sheet),!r.SheetNames[n]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return es(SF(r,t),t);case"slk":case"sylk":return es(j1.from_sheet(r.Sheets[r.SheetNames[n]],t),t);case"htm":case"html":return es(Rv(r.Sheets[r.SheetNames[n]],t),t);case"txt":return LR(Uv(r.Sheets[r.SheetNames[n]],t),t);case"csv":return es(a0(r.Sheets[r.SheetNames[n]],t),t,"\uFEFF");case"dif":return es(W1.from_sheet(r.Sheets[r.SheetNames[n]],t),t);case"dbf":return bc(rd.from_sheet(r.Sheets[r.SheetNames[n]],t),t);case"prn":return es(Io.from_sheet(r.Sheets[r.SheetNames[n]],t),t);case"rtf":return es(Y1.from_sheet(r.Sheets[r.SheetNames[n]],t),t);case"eth":return es(U1.from_sheet(r.Sheets[r.SheetNames[n]],t),t);case"fods":return es(Dv(r,t),t);case"wk1":return bc(La.sheet_to_wk1(r.Sheets[r.SheetNames[n]],t),t);case"wk3":return bc(La.book_to_wk3(r,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),bc(kv(r,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),RR(r,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return AR(r,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function s0(r){if(!r.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=r.file.slice(r.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(r.bookType=t.slice(1)),r.bookType=e[r.bookType]||r.bookType}}function Im(r,e,t){var i=t||{};return i.type="file",i.file=e,s0(i),du(r,i)}function NR(r,e,t){var i=t||{};return i.type="file",i.file=e,s0(i),n0(r,i)}function PR(r,e,t,i){var n=t||{};n.type="file",n.file=r,s0(n),n.type="buffer";var s=i;return s instanceof Function||(s=t),ta.writeFile(r,du(e,n),s)}function jv(r,e,t,i,n,s,a,o){var l=Tr(t),h=o.defval,c=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,p=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:t,enumerable:!1})}catch{p.__rowNum__=t}else p.__rowNum__=t;if(!a||r[t])for(var f=e.s.c;f<=e.e.c;++f){var g=a?r[t][f]:r[i[f]+l];if(g===void 0||g.t===void 0){if(h===void 0)continue;s[f]!=null&&(p[s[f]]=h);continue}var m=g.v;switch(g.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[f]!=null){if(m==null)if(g.t=="e"&&m===null)p[s[f]]=null;else if(h!==void 0)p[s[f]]=h;else if(c&&m===null)p[s[f]]=null;else continue;else p[s[f]]=c&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?m:os(g,m,o);m!=null&&(d=!1)}}return{row:p,isempty:d}}function Gc(r,e){if(r==null||r["!ref"]==null)return[];var t={t:"n",v:0},i=0,n=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},h=e||{},c=h.range!=null?h.range:r["!ref"];switch(h.header===1?i=1:h.header==="A"?i=2:Array.isArray(h.header)?i=3:h.header==null&&(i=0),typeof c){case"string":l=Ht(c);break;case"number":l=Ht(r["!ref"]),l.s.r=c;break;default:l=c}i>0&&(n=0);var d=Tr(l.s.r),p=[],f=[],g=0,m=0,b=Array.isArray(r),w=l.s.r,E=0,C={};b&&!r[w]&&(r[w]=[]);var F=h.skipHidden&&r["!cols"]||[],L=h.skipHidden&&r["!rows"]||[];for(E=l.s.c;E<=l.e.c;++E)if(!(F[E]||{}).hidden)switch(p[E]=vr(E),t=b?r[w][E]:r[p[E]+d],i){case 1:s[E]=E-l.s.c;break;case 2:s[E]=p[E];break;case 3:s[E]=h.header[E-l.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=a=os(t,null,h),m=C[a]||0,!m)C[a]=1;else{do o=a+"_"+m++;while(C[o]);C[a]=m,C[o]=1}s[E]=o}for(w=l.s.r+n;w<=l.e.r;++w)if(!(L[w]||{}).hidden){var D=jv(r,l,w,p,i,s,b,h);(D.isempty===!1||(i===1?h.blankrows!==!1:h.blankrows))&&(f[g++]=D.row)}return f.length=g,f}var Bm=/"/g;function Wv(r,e,t,i,n,s,a,o){for(var l=!0,h=[],c="",d=Tr(t),p=e.s.c;p<=e.e.c;++p)if(i[p]){var f=o.dense?(r[t]||[])[p]:r[i[p]+d];if(f==null)c="";else if(f.v!=null){l=!1,c=""+(o.rawNumbers&&f.t=="n"?f.v:os(f,null,o));for(var g=0,m=0;g!==c.length;++g)if((m=c.charCodeAt(g))===n||m===s||m===34||o.forceQuotes){c='"'+c.replace(Bm,'""')+'"';break}c=="ID"&&(c='"ID"')}else f.f!=null&&!f.F?(l=!1,c="="+f.f,c.indexOf(",")>=0&&(c='"'+c.replace(Bm,'""')+'"')):c="";h.push(c)}return o.blankrows===!1&&l?null:h.join(a)}function a0(r,e){var t=[],i=e??{};if(r==null||r["!ref"]==null)return"";var n=Ht(r["!ref"]),s=i.FS!==void 0?i.FS:",",a=s.charCodeAt(0),o=i.RS!==void 0?i.RS:`
`,l=o.charCodeAt(0),h=new RegExp((s=="|"?"\\|":s)+"+$"),c="",d=[];i.dense=Array.isArray(r);for(var p=i.skipHidden&&r["!cols"]||[],f=i.skipHidden&&r["!rows"]||[],g=n.s.c;g<=n.e.c;++g)(p[g]||{}).hidden||(d[g]=vr(g));for(var m=0,b=n.s.r;b<=n.e.r;++b)(f[b]||{}).hidden||(c=Wv(r,n,b,d,a,l,s,i),c!=null&&(i.strip&&(c=c.replace(h,"")),(c||i.blankrows!==!1)&&t.push((m++?o:"")+c)));return delete i.dense,t.join("")}function Uv(r,e){e||(e={}),e.FS="	",e.RS=`
`;var t=a0(r,e);if(typeof jt>"u"||e.type=="string")return t;var i=jt.utils.encode(1200,t,"str");return""+i}function DR(r){var e="",t,i="";if(r==null||r["!ref"]==null)return[];var n=Ht(r["!ref"]),s="",a=[],o,l=[],h=Array.isArray(r);for(o=n.s.c;o<=n.e.c;++o)a[o]=vr(o);for(var c=n.s.r;c<=n.e.r;++c)for(s=Tr(c),o=n.s.c;o<=n.e.c;++o)if(e=a[o]+s,t=h?(r[c]||[])[o]:r[e],i="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;i=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)i=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)i=""+t.v;else if(t.t=="b")i=t.v?"TRUE":"FALSE";else if(t.w!==void 0)i="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?i="'"+t.v:i=""+t.v}}l[l.length]=e+"="+i}return l}function Vv(r,e,t){var i=t||{},n=+!i.skipHeader,s=r||{},a=0,o=0;if(s&&i.origin!=null)if(typeof i.origin=="number")a=i.origin;else{var l=typeof i.origin=="string"?yr(i.origin):i.origin;a=l.r,o=l.c}var h,c={s:{c:0,r:0},e:{c:o,r:a+e.length-1+n}};if(s["!ref"]){var d=Ht(s["!ref"]);c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),a==-1&&(a=d.e.r+1,c.e.r=a+e.length-1+n)}else a==-1&&(a=0,c.e.r=e.length-1+n);var p=i.header||[],f=0;e.forEach(function(m,b){Fr(m).forEach(function(w){(f=p.indexOf(w))==-1&&(p[f=p.length]=w);var E=m[w],C="z",F="",L=xt({c:o+f,r:a+b+n});h=sh(s,L),E&&typeof E=="object"&&!(E instanceof Date)?s[L]=E:(typeof E=="number"?C="n":typeof E=="boolean"?C="b":typeof E=="string"?C="s":E instanceof Date?(C="d",i.cellDates||(C="n",E=Jr(E)),F=i.dateNF||vt[14]):E===null&&i.nullError&&(C="e",E=0),h?(h.t=C,h.v=E,delete h.w,delete h.R,F&&(h.z=F)):s[L]=h={t:C,v:E},F&&(h.z=F))})}),c.e.c=Math.max(c.e.c,o+p.length-1);var g=Tr(a);if(n)for(f=0;f<p.length;++f)s[vr(f+o)+g]={t:"s",v:p[f]};return s["!ref"]=Lt(c),s}function MR(r,e){return Vv(null,r,e)}function sh(r,e,t){if(typeof e=="string"){if(Array.isArray(r)){var i=yr(e);return r[i.r]||(r[i.r]=[]),r[i.r][i.c]||(r[i.r][i.c]={t:"z"})}return r[e]||(r[e]={t:"z"})}return typeof e!="number"?sh(r,xt(e)):sh(r,xt({r:e,c:t||0}))}function OR(r,e){if(typeof e=="number"){if(e>=0&&r.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=r.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function o0(){return{SheetNames:[],Sheets:{}}}function l0(r,e,t,i){var n=1;if(!t)for(;n<=65535&&r.SheetNames.indexOf(t="Sheet"+n)!=-1;++n,t=void 0);if(!t||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&r.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);n=s&&+s[2]||0;var a=s&&s[1]||t;for(++n;n<=65535&&r.SheetNames.indexOf(t=a+n)!=-1;++n);}if(wv(t),r.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return r.SheetNames.push(t),r.Sheets[t]=e,t}function IR(r,e,t){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var i=OR(r,e);switch(r.Workbook.Sheets[i]||(r.Workbook.Sheets[i]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}r.Workbook.Sheets[i].Hidden=t}function BR(r,e){return r.z=e,r}function Gv(r,e,t){return e?(r.l={Target:e},t&&(r.l.Tooltip=t)):delete r.l,r}function HR(r,e,t){return Gv(r,"#"+e,t)}function zR(r,e,t){r.c||(r.c=[]),r.c.push({t:e,a:t||"SheetJS"})}function jR(r,e,t,i){for(var n=typeof e!="string"?e:Ht(e),s=typeof e=="string"?e:Lt(e),a=n.s.r;a<=n.e.r;++a)for(var o=n.s.c;o<=n.e.c;++o){var l=sh(r,a,o);l.t="n",l.F=s,delete l.v,a==n.s.r&&o==n.s.c&&(l.f=t,i&&(l.D=!0))}return r}var WR={encode_col:vr,encode_row:Tr,encode_cell:xt,encode_range:Lt,decode_col:Dd,decode_row:Pd,split_cell:aC,decode_cell:yr,decode_range:Ni,format_cell:os,sheet_add_aoa:c1,sheet_add_json:Vv,sheet_add_dom:Lv,aoa_to_sheet:Uo,json_to_sheet:MR,table_to_sheet:Nv,table_to_book:JF,sheet_to_csv:a0,sheet_to_txt:Uv,sheet_to_json:Gc,sheet_to_html:Rv,sheet_to_formulae:DR,sheet_to_row_object_array:Gc,sheet_get_cell:sh,book_new:o0,book_append_sheet:l0,book_set_sheet_visibility:IR,cell_set_number_format:BR,cell_set_hyperlink:Gv,cell_set_internal_link:HR,cell_add_comment:zR,sheet_set_array_formula:jR,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},pu;function UR(r){pu=r}function VR(r,e){var t=pu(),i=e??{};if(r==null||r["!ref"]==null)return t.push(null),t;var n=Ht(r["!ref"]),s=i.FS!==void 0?i.FS:",",a=s.charCodeAt(0),o=i.RS!==void 0?i.RS:`
`,l=o.charCodeAt(0),h=new RegExp((s=="|"?"\\|":s)+"+$"),c="",d=[];i.dense=Array.isArray(r);for(var p=i.skipHidden&&r["!cols"]||[],f=i.skipHidden&&r["!rows"]||[],g=n.s.c;g<=n.e.c;++g)(p[g]||{}).hidden||(d[g]=vr(g));var m=n.s.r,b=!1,w=0;return t._read=function(){if(!b)return b=!0,t.push("\uFEFF");for(;m<=n.e.r;)if(++m,!(f[m-1]||{}).hidden&&(c=Wv(r,n,m-1,d,a,l,s,i),c!=null&&(i.strip&&(c=c.replace(h,"")),c||i.blankrows!==!1)))return t.push((w++?o:"")+c);return t.push(null)},t}function GR(r,e){var t=pu(),i=e||{},n=i.header!=null?i.header:Tv,s=i.footer!=null?i.footer:Av;t.push(n);var a=Ni(r["!ref"]);i.dense=Array.isArray(r),t.push(Fv(r,a,i));var o=a.s.r,l=!1;return t._read=function(){if(o>a.e.r)return l||(l=!0,t.push("</table>"+s)),t.push(null);for(;o<=a.e.r;){t.push(Sv(r,a,o,i)),++o;break}},t}function qR(r,e){var t=pu({objectMode:!0});if(r==null||r["!ref"]==null)return t.push(null),t;var i={t:"n",v:0},n=0,s=1,a=[],o=0,l="",h={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},d=c.range!=null?c.range:r["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)&&(n=3),typeof d){case"string":h=Ht(d);break;case"number":h=Ht(r["!ref"]),h.s.r=d;break;default:h=d}n>0&&(s=0);var p=Tr(h.s.r),f=[],g=0,m=Array.isArray(r),b=h.s.r,w=0,E={};m&&!r[b]&&(r[b]=[]);var C=c.skipHidden&&r["!cols"]||[],F=c.skipHidden&&r["!rows"]||[];for(w=h.s.c;w<=h.e.c;++w)if(!(C[w]||{}).hidden)switch(f[w]=vr(w),i=m?r[b][w]:r[f[w]+p],n){case 1:a[w]=w-h.s.c;break;case 2:a[w]=f[w];break;case 3:a[w]=c.header[w-h.s.c];break;default:if(i==null&&(i={w:"__EMPTY",t:"s"}),l=o=os(i,null,c),g=E[o]||0,!g)E[o]=1;else{do l=o+"_"+g++;while(E[l]);E[o]=g,E[l]=1}a[w]=l}return b=h.s.r+s,t._read=function(){for(;b<=h.e.r;)if(!(F[b-1]||{}).hidden){var L=jv(r,h,b,f,n,a,m,c);if(++b,L.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows)){t.push(L.row);return}}return t.push(null)},t}var XR={to_json:qR,to_html:GR,to_csv:VR,set_readable:UR};const KR=ql.version,YR=Object.freeze(Object.defineProperty({__proto__:null,CFB:ut,SSF:Vg,parse_xlscfb:Qd,parse_zip:Ov,read:Vc,readFile:Om,readFileSync:Om,set_cptable:Jy,set_fs:SE,stream:XR,utils:WR,version:KR,write:du,writeFile:Im,writeFileAsync:PR,writeFileSync:Im,writeFileXLSX:NR,writeXLSX:n0},Symbol.toStringTag,{value:"Module"}));window.Tabulator=U5;window.jspdf={jsPDF:dt};window.jsPDF=dt;window.XLSX=YR;export{tr as _,Vy as c,m8 as g};
